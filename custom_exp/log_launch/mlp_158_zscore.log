Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1369919:MainThread](2026-01-11 21:52:10,243) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1369919:MainThread](2026-01-11 21:52:10,812) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1369919:MainThread](2026-01-11 21:52:10,813) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 21:52:10.823 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y
2026-01-11 21:52:10.823 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/log/mlp_158_zscore_csi500_topk_20260111_215210.log
2026-01-11 21:52:10.824 | INFO     | __main__:__init__:115 - Model name: mlp_158_zscore_csi500_topk
2026-01-11 21:52:10.827 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 21:52:10.827 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:52:10.827 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 21:52:10.827 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:52:10.827 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 21:52:33,475) INFO - qlib.timer - [log.py:127] - Time cost: 22.646s | Loading data Done
[1369919:MainThread](2026-01-11 21:52:33,815) INFO - qlib.timer - [log.py:127] - Time cost: 0.086s | DropCol Done
[1369919:MainThread](2026-01-11 21:52:34,740) INFO - qlib.timer - [log.py:127] - Time cost: 0.924s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 21:52:35,521) INFO - qlib.timer - [log.py:127] - Time cost: 0.780s | Fillna Done
[1369919:MainThread](2026-01-11 21:52:36,471) INFO - qlib.timer - [log.py:127] - Time cost: 0.082s | DropCol Done
[1369919:MainThread](2026-01-11 21:52:36,614) INFO - qlib.timer - [log.py:127] - Time cost: 0.142s | DropnaLabel Done
[1369919:MainThread](2026-01-11 21:52:36,817) INFO - qlib.timer - [log.py:127] - Time cost: 0.202s | CSRankNorm Done
[1369919:MainThread](2026-01-11 21:52:36,819) INFO - qlib.timer - [log.py:127] - Time cost: 3.343s | fit & process data Done
[1369919:MainThread](2026-01-11 21:52:36,819) INFO - qlib.timer - [log.py:127] - Time cost: 25.991s | Init data Done
2026-01-11 21:52:36.820 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 21:52:37,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 21:52:37,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 21:52:37,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 21:52:37,079) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:52:38.729 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 21:52:39,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 21:52:40,197) INFO - qlib.workflow - [exp.py:258] - Experiment 528155627018642494 starts running ...
[1369919:MainThread](2026-01-11 21:52:40,277) INFO - qlib.workflow - [recorder.py:345] - Recorder 05695b9c731d44088f0a1985875206ba starts running under Experiment 528155627018642494 ...
[1369919:MainThread](2026-01-11 21:52:41,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.305242, valid_loss 1.162764, train_metric nan, valid_metric 0.064972
[1369919:MainThread](2026-01-11 21:52:41,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.162764, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:41,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.091927, valid_loss 1.053232, train_metric nan, valid_metric 0.048629
[1369919:MainThread](2026-01-11 21:52:41,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.162764 to 1.053232, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:42,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.056080, valid_loss 1.039121, train_metric nan, valid_metric 0.064996
[1369919:MainThread](2026-01-11 21:52:42,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.053232 to 1.039121, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:42,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.045329, valid_loss 1.036367, train_metric nan, valid_metric 0.072351
[1369919:MainThread](2026-01-11 21:52:42,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.039121 to 1.036367, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:43,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.035934, valid_loss 1.025206, train_metric nan, valid_metric 0.080717
[1369919:MainThread](2026-01-11 21:52:43,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.036367 to 1.025206, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:43,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.028092, valid_loss 1.025326, train_metric nan, valid_metric 0.083984
[1369919:MainThread](2026-01-11 21:52:44,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.027545, valid_loss 1.024213, train_metric nan, valid_metric 0.077369
[1369919:MainThread](2026-01-11 21:52:44,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.025206 to 1.024213, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:44,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.019895, valid_loss 1.023012, train_metric nan, valid_metric 0.092039
[1369919:MainThread](2026-01-11 21:52:44,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.024213 to 1.023012, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:45,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.015522, valid_loss 1.013006, train_metric nan, valid_metric 0.092465
[1369919:MainThread](2026-01-11 21:52:45,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.023012 to 1.013006, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:46,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.008863, valid_loss 1.009745, train_metric nan, valid_metric 0.091468
[1369919:MainThread](2026-01-11 21:52:46,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.013006 to 1.009745, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:46,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.009195, valid_loss 1.011133, train_metric nan, valid_metric 0.091146
[1369919:MainThread](2026-01-11 21:52:47,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.005441, valid_loss 1.008945, train_metric nan, valid_metric 0.100142
[1369919:MainThread](2026-01-11 21:52:47,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009745 to 1.008945, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:47,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.004857, valid_loss 1.012905, train_metric nan, valid_metric 0.101787
[1369919:MainThread](2026-01-11 21:52:48,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.001154, valid_loss 1.013748, train_metric nan, valid_metric 0.104026
[1369919:MainThread](2026-01-11 21:52:48,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.000346, valid_loss 1.010628, train_metric nan, valid_metric 0.101537
[1369919:MainThread](2026-01-11 21:52:49,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.997203, valid_loss 1.005461, train_metric nan, valid_metric 0.099768
[1369919:MainThread](2026-01-11 21:52:49,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008945 to 1.005461, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:49,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.999909, valid_loss 1.012019, train_metric nan, valid_metric 0.111566
[1369919:MainThread](2026-01-11 21:52:50,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.993144, valid_loss 1.009634, train_metric nan, valid_metric 0.108571
[1369919:MainThread](2026-01-11 21:52:50,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.996166, valid_loss 1.010578, train_metric nan, valid_metric 0.105978
[1369919:MainThread](2026-01-11 21:52:51,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.990362, valid_loss 1.015439, train_metric nan, valid_metric 0.107574
[1369919:MainThread](2026-01-11 21:52:51,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.992871, valid_loss 1.009635, train_metric nan, valid_metric 0.104888
[1369919:MainThread](2026-01-11 21:52:52,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.991415, valid_loss 1.005028, train_metric nan, valid_metric 0.108700
[1369919:MainThread](2026-01-11 21:52:52,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005461 to 1.005028, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:52,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.987926, valid_loss 1.006762, train_metric nan, valid_metric 0.101105
[1369919:MainThread](2026-01-11 21:52:53,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.985970, valid_loss 1.013995, train_metric nan, valid_metric 0.108797
[1369919:MainThread](2026-01-11 21:52:53,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.983668, valid_loss 1.005199, train_metric nan, valid_metric 0.110593
[1369919:MainThread](2026-01-11 21:52:54,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.984312, valid_loss 1.005744, train_metric nan, valid_metric 0.103397
[1369919:MainThread](2026-01-11 21:52:54,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.986436, valid_loss 1.011156, train_metric nan, valid_metric 0.110391
[1369919:MainThread](2026-01-11 21:52:55,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.986589, valid_loss 1.010199, train_metric nan, valid_metric 0.107109
[1369919:MainThread](2026-01-11 21:52:55,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.987543, valid_loss 1.004689, train_metric nan, valid_metric 0.105455
[1369919:MainThread](2026-01-11 21:52:55,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005028 to 1.004689, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:56,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.983733, valid_loss 1.003549, train_metric nan, valid_metric 0.105856
[1369919:MainThread](2026-01-11 21:52:56,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004689 to 1.003549, save checkpoint.
[1369919:MainThread](2026-01-11 21:52:56,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.979033, valid_loss 1.004913, train_metric nan, valid_metric 0.111529
[1369919:MainThread](2026-01-11 21:52:57,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.986514, valid_loss 1.003604, train_metric nan, valid_metric 0.102493
[1369919:MainThread](2026-01-11 21:52:57,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.985979, valid_loss 1.009346, train_metric nan, valid_metric 0.111368
[1369919:MainThread](2026-01-11 21:52:58,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.984779, valid_loss 1.017069, train_metric nan, valid_metric 0.113280
[1369919:MainThread](2026-01-11 21:52:58,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.980263, valid_loss 1.008163, train_metric nan, valid_metric 0.102233
[1369919:MainThread](2026-01-11 21:52:59,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.979396, valid_loss 1.004713, train_metric nan, valid_metric 0.107557
[1369919:MainThread](2026-01-11 21:52:59,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.985121, valid_loss 1.003364, train_metric nan, valid_metric 0.104596
[1369919:MainThread](2026-01-11 21:52:59,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003549 to 1.003364, save checkpoint.
[1369919:MainThread](2026-01-11 21:53:00,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.985222, valid_loss 1.004221, train_metric nan, valid_metric 0.105458
[1369919:MainThread](2026-01-11 21:53:01,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.981314, valid_loss 1.006873, train_metric nan, valid_metric 0.112687
[1369919:MainThread](2026-01-11 21:53:01,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.983830, valid_loss 1.003572, train_metric nan, valid_metric 0.107014
[1369919:MainThread](2026-01-11 21:53:02,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.980855, valid_loss 1.010475, train_metric nan, valid_metric 0.106336
[1369919:MainThread](2026-01-11 21:53:02,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.977759, valid_loss 1.009849, train_metric nan, valid_metric 0.111469
[1369919:MainThread](2026-01-11 21:53:03,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.981291, valid_loss 1.001008, train_metric nan, valid_metric 0.107252
[1369919:MainThread](2026-01-11 21:53:03,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003364 to 1.001008, save checkpoint.
[1369919:MainThread](2026-01-11 21:53:03,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.982265, valid_loss 1.004608, train_metric nan, valid_metric 0.108744
[1369919:MainThread](2026-01-11 21:53:04,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.979387, valid_loss 1.010699, train_metric nan, valid_metric 0.107854
[1369919:MainThread](2026-01-11 21:53:04,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.982847, valid_loss 1.004396, train_metric nan, valid_metric 0.104865
[1369919:MainThread](2026-01-11 21:53:05,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.980553, valid_loss 1.010740, train_metric nan, valid_metric 0.110257
[1369919:MainThread](2026-01-11 21:53:05,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.979614, valid_loss 1.011275, train_metric nan, valid_metric 0.113606
[1369919:MainThread](2026-01-11 21:53:06,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.983031, valid_loss 1.003191, train_metric nan, valid_metric 0.103752
[1369919:MainThread](2026-01-11 21:53:06,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.979603, valid_loss 1.010158, train_metric nan, valid_metric 0.113644
[1369919:MainThread](2026-01-11 21:53:07,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.980012, valid_loss 1.015961, train_metric nan, valid_metric 0.108779
[1369919:MainThread](2026-01-11 21:53:07,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.976438, valid_loss 1.008808, train_metric nan, valid_metric 0.113534
[1369919:MainThread](2026-01-11 21:53:08,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.982991, valid_loss 1.005427, train_metric nan, valid_metric 0.106984
[1369919:MainThread](2026-01-11 21:53:08,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.980520, valid_loss 1.008013, train_metric nan, valid_metric 0.110783
[1369919:MainThread](2026-01-11 21:53:09,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.983226, valid_loss 1.008288, train_metric nan, valid_metric 0.111107
[1369919:MainThread](2026-01-11 21:53:10,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.979202, valid_loss 1.017317, train_metric nan, valid_metric 0.113325
[1369919:MainThread](2026-01-11 21:53:10,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.980929, valid_loss 1.013128, train_metric nan, valid_metric 0.111796
[1369919:MainThread](2026-01-11 21:53:11,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.979369, valid_loss 1.011238, train_metric nan, valid_metric 0.112693
[1369919:MainThread](2026-01-11 21:53:11,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.977717, valid_loss 1.010787, train_metric nan, valid_metric 0.111941
[1369919:MainThread](2026-01-11 21:53:12,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.984970, valid_loss 1.009323, train_metric nan, valid_metric 0.113684
[1369919:MainThread](2026-01-11 21:53:12,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.972710, valid_loss 1.011104, train_metric nan, valid_metric 0.113626
[1369919:MainThread](2026-01-11 21:53:13,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.980576, valid_loss 1.009227, train_metric nan, valid_metric 0.110086
[1369919:MainThread](2026-01-11 21:53:14,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.980561, valid_loss 1.013980, train_metric nan, valid_metric 0.113997
[1369919:MainThread](2026-01-11 21:53:14,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.978841, valid_loss 1.012677, train_metric nan, valid_metric 0.113425
[1369919:MainThread](2026-01-11 21:53:15,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.980335, valid_loss 1.007218, train_metric nan, valid_metric 0.113253
[1369919:MainThread](2026-01-11 21:53:15,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.980205, valid_loss 1.011377, train_metric nan, valid_metric 0.113831
[1369919:MainThread](2026-01-11 21:53:16,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.974874, valid_loss 1.007578, train_metric nan, valid_metric 0.113198
[1369919:MainThread](2026-01-11 21:53:16,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.974465, valid_loss 1.008617, train_metric nan, valid_metric 0.112739
[1369919:MainThread](2026-01-11 21:53:17,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.978705, valid_loss 1.011616, train_metric nan, valid_metric 0.115121
[1369919:MainThread](2026-01-11 21:53:18,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.976093, valid_loss 1.006748, train_metric nan, valid_metric 0.112758
[1369919:MainThread](2026-01-11 21:53:18,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.976010, valid_loss 1.008613, train_metric nan, valid_metric 0.111791
[1369919:MainThread](2026-01-11 21:53:19,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.983396, valid_loss 1.007473, train_metric nan, valid_metric 0.112472
[1369919:MainThread](2026-01-11 21:53:19,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.978745, valid_loss 1.008943, train_metric nan, valid_metric 0.112422
[1369919:MainThread](2026-01-11 21:53:19,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.974817, valid_loss 1.006047, train_metric nan, valid_metric 0.112384
[1369919:MainThread](2026-01-11 21:53:20,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.975768, valid_loss 1.012223, train_metric nan, valid_metric 0.114353
[1369919:MainThread](2026-01-11 21:53:20,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.977348, valid_loss 1.009735, train_metric nan, valid_metric 0.114353
[1369919:MainThread](2026-01-11 21:53:21,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.976125, valid_loss 1.009371, train_metric nan, valid_metric 0.113670
[1369919:MainThread](2026-01-11 21:53:22,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.979279, valid_loss 1.008870, train_metric nan, valid_metric 0.113269
[1369919:MainThread](2026-01-11 21:53:22,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.976649, valid_loss 1.011651, train_metric nan, valid_metric 0.111452
[1369919:MainThread](2026-01-11 21:53:23,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.976663, valid_loss 1.007574, train_metric nan, valid_metric 0.113231
[1369919:MainThread](2026-01-11 21:53:23,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.981681, valid_loss 1.012100, train_metric nan, valid_metric 0.113618
[1369919:MainThread](2026-01-11 21:53:24,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.980392, valid_loss 1.014347, train_metric nan, valid_metric 0.114350
[1369919:MainThread](2026-01-11 21:53:24,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.980018, valid_loss 1.010998, train_metric nan, valid_metric 0.113694
[1369919:MainThread](2026-01-11 21:53:25,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.976646, valid_loss 1.009800, train_metric nan, valid_metric 0.114216
[1369919:MainThread](2026-01-11 21:53:25,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.979273, valid_loss 1.011974, train_metric nan, valid_metric 0.115090
[1369919:MainThread](2026-01-11 21:53:26,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.976275, valid_loss 1.013688, train_metric nan, valid_metric 0.114778
[1369919:MainThread](2026-01-11 21:53:26,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.972414, valid_loss 1.009259, train_metric nan, valid_metric 0.112904
[1369919:MainThread](2026-01-11 21:53:27,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.977942, valid_loss 1.009753, train_metric nan, valid_metric 0.113573
[1369919:MainThread](2026-01-11 21:53:27,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.976824, valid_loss 1.011589, train_metric nan, valid_metric 0.112894
[1369919:MainThread](2026-01-11 21:53:28,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.976883, valid_loss 1.008141, train_metric nan, valid_metric 0.113094
[1369919:MainThread](2026-01-11 21:53:28,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.978339, valid_loss 1.009226, train_metric nan, valid_metric 0.114003
[1369919:MainThread](2026-01-11 21:53:29,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.976585, valid_loss 1.009318, train_metric nan, valid_metric 0.113105
[1369919:MainThread](2026-01-11 21:53:29,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.975156, valid_loss 1.009711, train_metric nan, valid_metric 0.111692
[1369919:MainThread](2026-01-11 21:53:29,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:53:29.911 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:53:31.327 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 21:53:31.327 | INFO     | __main__:train_single_fold:593 -   IC=0.0805, ICIR=0.7527, RankIC=0.1009, RankICIR=0.9018
2026-01-11 21:53:31.327 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 21:53:31,336) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1369919:MainThread](2026-01-11 21:53:50,799) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:53:50,800) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:53:56,699) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f72f167bf10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▎         | 9/244 [00:00<00:02, 85.67it/s]backtest loop:   7%|▋         | 18/244 [00:00<00:03, 68.26it/s]backtest loop:  11%|█         | 26/244 [00:00<00:03, 65.63it/s]backtest loop:  14%|█▍        | 35/244 [00:00<00:02, 71.25it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:02, 77.41it/s]backtest loop:  23%|██▎       | 55/244 [00:00<00:02, 79.31it/s]backtest loop:  26%|██▌       | 64/244 [00:00<00:02, 79.61it/s]backtest loop:  30%|███       | 74/244 [00:00<00:02, 80.12it/s]backtest loop:  34%|███▍      | 83/244 [00:01<00:02, 80.02it/s]backtest loop:  38%|███▊      | 92/244 [00:01<00:01, 81.60it/s]backtest loop:  41%|████▏     | 101/244 [00:01<00:01, 77.37it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 74.04it/s]backtest loop:  48%|████▊     | 117/244 [00:01<00:01, 68.51it/s]backtest loop:  52%|█████▏    | 126/244 [00:01<00:01, 69.81it/s]backtest loop:  55%|█████▌    | 135/244 [00:01<00:01, 74.67it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 75.22it/s]backtest loop:  62%|██████▏   | 151/244 [00:02<00:01, 75.39it/s]backtest loop:  66%|██████▌   | 161/244 [00:02<00:01, 77.85it/s]backtest loop:  70%|███████   | 171/244 [00:02<00:00, 79.31it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:00, 79.37it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 81.20it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 82.24it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 83.28it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 85.18it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 85.45it/s]backtest loop:  98%|█████████▊| 239/244 [00:03<00:00, 87.76it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 79.12it/s]
2026-01-11 21:53:59.815 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.4465, Sharpe(w/cost)=4.1992, MaxDD=-0.0262
2026-01-11 21:54:03.572 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 21:54:23.271 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:54:23.371 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_0_pred.parquet
2026-01-11 21:54:23.392 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:54:23.392 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 21:54:23.392 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:54:23.392 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 21:55:11,857) INFO - qlib.timer - [log.py:127] - Time cost: 48.463s | Loading data Done
[1369919:MainThread](2026-01-11 21:55:12,206) INFO - qlib.timer - [log.py:127] - Time cost: 0.111s | DropCol Done
[1369919:MainThread](2026-01-11 21:55:13,393) INFO - qlib.timer - [log.py:127] - Time cost: 1.179s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 21:55:13,942) INFO - qlib.timer - [log.py:127] - Time cost: 0.548s | Fillna Done
[1369919:MainThread](2026-01-11 21:55:14,725) INFO - qlib.timer - [log.py:127] - Time cost: 0.078s | DropCol Done
[1369919:MainThread](2026-01-11 21:55:14,866) INFO - qlib.timer - [log.py:127] - Time cost: 0.140s | DropnaLabel Done
[1369919:MainThread](2026-01-11 21:55:15,066) INFO - qlib.timer - [log.py:127] - Time cost: 0.200s | CSRankNorm Done
[1369919:MainThread](2026-01-11 21:55:15,068) INFO - qlib.timer - [log.py:127] - Time cost: 3.211s | fit & process data Done
[1369919:MainThread](2026-01-11 21:55:15,069) INFO - qlib.timer - [log.py:127] - Time cost: 51.676s | Init data Done
2026-01-11 21:55:15.069 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 21:55:15,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 21:55:15,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 21:55:15,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 21:55:15,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:55:15.085 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 21:55:16,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 21:55:17,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.240055, valid_loss 1.130598, train_metric nan, valid_metric 0.034118
[1369919:MainThread](2026-01-11 21:55:17,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.130598, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:17,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.073839, valid_loss 1.045554, train_metric nan, valid_metric 0.056743
[1369919:MainThread](2026-01-11 21:55:17,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.130598 to 1.045554, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:18,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.046931, valid_loss 1.030764, train_metric nan, valid_metric 0.075508
[1369919:MainThread](2026-01-11 21:55:18,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.045554 to 1.030764, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:18,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.031911, valid_loss 1.021121, train_metric nan, valid_metric 0.086196
[1369919:MainThread](2026-01-11 21:55:18,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.030764 to 1.021121, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:19,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.025701, valid_loss 1.024835, train_metric nan, valid_metric 0.090173
[1369919:MainThread](2026-01-11 21:55:20,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.024352, valid_loss 1.011497, train_metric nan, valid_metric 0.095200
[1369919:MainThread](2026-01-11 21:55:20,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.021121 to 1.011497, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:20,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.014288, valid_loss 1.016726, train_metric nan, valid_metric 0.088325
[1369919:MainThread](2026-01-11 21:55:21,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.012057, valid_loss 1.033664, train_metric nan, valid_metric 0.107997
[1369919:MainThread](2026-01-11 21:55:21,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.006308, valid_loss 1.011722, train_metric nan, valid_metric 0.106713
[1369919:MainThread](2026-01-11 21:55:22,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.006033, valid_loss 1.006673, train_metric nan, valid_metric 0.104391
[1369919:MainThread](2026-01-11 21:55:22,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.011497 to 1.006673, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:22,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.005202, valid_loss 1.021233, train_metric nan, valid_metric 0.102667
[1369919:MainThread](2026-01-11 21:55:23,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 0.998533, valid_loss 1.011087, train_metric nan, valid_metric 0.105279
[1369919:MainThread](2026-01-11 21:55:23,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.000158, valid_loss 1.000740, train_metric nan, valid_metric 0.109468
[1369919:MainThread](2026-01-11 21:55:23,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006673 to 1.000740, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:24,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.996775, valid_loss 1.002515, train_metric nan, valid_metric 0.111824
[1369919:MainThread](2026-01-11 21:55:24,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.996386, valid_loss 1.005650, train_metric nan, valid_metric 0.114864
[1369919:MainThread](2026-01-11 21:55:25,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.993720, valid_loss 1.001826, train_metric nan, valid_metric 0.112190
[1369919:MainThread](2026-01-11 21:55:25,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.994048, valid_loss 1.007473, train_metric nan, valid_metric 0.106797
[1369919:MainThread](2026-01-11 21:55:26,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.992484, valid_loss 1.000848, train_metric nan, valid_metric 0.113713
[1369919:MainThread](2026-01-11 21:55:26,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.986820, valid_loss 1.000651, train_metric nan, valid_metric 0.112953
[1369919:MainThread](2026-01-11 21:55:26,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000740 to 1.000651, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:27,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.992804, valid_loss 0.997277, train_metric nan, valid_metric 0.106988
[1369919:MainThread](2026-01-11 21:55:27,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000651 to 0.997277, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:28,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.990412, valid_loss 1.001450, train_metric nan, valid_metric 0.112828
[1369919:MainThread](2026-01-11 21:55:28,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.990419, valid_loss 0.998114, train_metric nan, valid_metric 0.113920
[1369919:MainThread](2026-01-11 21:55:29,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.990521, valid_loss 1.011119, train_metric nan, valid_metric 0.118228
[1369919:MainThread](2026-01-11 21:55:29,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.986054, valid_loss 0.996594, train_metric nan, valid_metric 0.116362
[1369919:MainThread](2026-01-11 21:55:29,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997277 to 0.996594, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:30,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.987382, valid_loss 0.997767, train_metric nan, valid_metric 0.114593
[1369919:MainThread](2026-01-11 21:55:30,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.984544, valid_loss 0.997967, train_metric nan, valid_metric 0.119606
[1369919:MainThread](2026-01-11 21:55:31,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.984509, valid_loss 1.000805, train_metric nan, valid_metric 0.117088
[1369919:MainThread](2026-01-11 21:55:31,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.987700, valid_loss 0.999812, train_metric nan, valid_metric 0.119451
[1369919:MainThread](2026-01-11 21:55:32,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.987363, valid_loss 1.011514, train_metric nan, valid_metric 0.119395
[1369919:MainThread](2026-01-11 21:55:32,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.985780, valid_loss 0.998687, train_metric nan, valid_metric 0.119588
[1369919:MainThread](2026-01-11 21:55:33,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.986223, valid_loss 1.001812, train_metric nan, valid_metric 0.118972
[1369919:MainThread](2026-01-11 21:55:34,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.985340, valid_loss 1.010279, train_metric nan, valid_metric 0.120299
[1369919:MainThread](2026-01-11 21:55:34,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.985297, valid_loss 1.005091, train_metric nan, valid_metric 0.118943
[1369919:MainThread](2026-01-11 21:55:35,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.980919, valid_loss 0.997662, train_metric nan, valid_metric 0.118185
[1369919:MainThread](2026-01-11 21:55:35,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.984242, valid_loss 0.998391, train_metric nan, valid_metric 0.116840
[1369919:MainThread](2026-01-11 21:55:36,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.983290, valid_loss 0.993994, train_metric nan, valid_metric 0.117017
[1369919:MainThread](2026-01-11 21:55:36,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996594 to 0.993994, save checkpoint.
[1369919:MainThread](2026-01-11 21:55:36,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.983605, valid_loss 1.000777, train_metric nan, valid_metric 0.122359
[1369919:MainThread](2026-01-11 21:55:37,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.982746, valid_loss 0.998551, train_metric nan, valid_metric 0.118076
[1369919:MainThread](2026-01-11 21:55:37,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.982523, valid_loss 1.005921, train_metric nan, valid_metric 0.119523
[1369919:MainThread](2026-01-11 21:55:38,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.981802, valid_loss 1.008023, train_metric nan, valid_metric 0.118812
[1369919:MainThread](2026-01-11 21:55:38,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.983678, valid_loss 0.998839, train_metric nan, valid_metric 0.114982
[1369919:MainThread](2026-01-11 21:55:39,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.984959, valid_loss 1.007625, train_metric nan, valid_metric 0.121136
[1369919:MainThread](2026-01-11 21:55:40,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.987348, valid_loss 1.003270, train_metric nan, valid_metric 0.116755
[1369919:MainThread](2026-01-11 21:55:40,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.982953, valid_loss 0.999172, train_metric nan, valid_metric 0.117525
[1369919:MainThread](2026-01-11 21:55:41,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.982187, valid_loss 1.006963, train_metric nan, valid_metric 0.116838
[1369919:MainThread](2026-01-11 21:55:41,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.985140, valid_loss 0.999684, train_metric nan, valid_metric 0.118117
[1369919:MainThread](2026-01-11 21:55:42,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.983043, valid_loss 1.007196, train_metric nan, valid_metric 0.118906
[1369919:MainThread](2026-01-11 21:55:42,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.980756, valid_loss 1.003808, train_metric nan, valid_metric 0.120838
[1369919:MainThread](2026-01-11 21:55:43,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.984846, valid_loss 1.004997, train_metric nan, valid_metric 0.120038
[1369919:MainThread](2026-01-11 21:55:43,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.981736, valid_loss 1.002172, train_metric nan, valid_metric 0.118101
[1369919:MainThread](2026-01-11 21:55:44,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.979120, valid_loss 1.003127, train_metric nan, valid_metric 0.115226
[1369919:MainThread](2026-01-11 21:55:45,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.984134, valid_loss 0.999629, train_metric nan, valid_metric 0.118415
[1369919:MainThread](2026-01-11 21:55:45,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.977774, valid_loss 1.008234, train_metric nan, valid_metric 0.120934
[1369919:MainThread](2026-01-11 21:55:46,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.978431, valid_loss 1.006587, train_metric nan, valid_metric 0.120735
[1369919:MainThread](2026-01-11 21:55:46,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.985770, valid_loss 1.006856, train_metric nan, valid_metric 0.116067
[1369919:MainThread](2026-01-11 21:55:47,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.984256, valid_loss 1.002592, train_metric nan, valid_metric 0.120525
[1369919:MainThread](2026-01-11 21:55:47,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.981237, valid_loss 1.006684, train_metric nan, valid_metric 0.121385
[1369919:MainThread](2026-01-11 21:55:48,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.980534, valid_loss 1.004863, train_metric nan, valid_metric 0.120794
[1369919:MainThread](2026-01-11 21:55:48,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.979157, valid_loss 1.007417, train_metric nan, valid_metric 0.118936
[1369919:MainThread](2026-01-11 21:55:49,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.983233, valid_loss 1.001727, train_metric nan, valid_metric 0.119356
[1369919:MainThread](2026-01-11 21:55:49,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.979738, valid_loss 1.002164, train_metric nan, valid_metric 0.120169
[1369919:MainThread](2026-01-11 21:55:50,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.978550, valid_loss 1.003765, train_metric nan, valid_metric 0.118803
[1369919:MainThread](2026-01-11 21:55:51,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.985886, valid_loss 1.002022, train_metric nan, valid_metric 0.118276
[1369919:MainThread](2026-01-11 21:55:51,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.979488, valid_loss 1.006847, train_metric nan, valid_metric 0.121753
[1369919:MainThread](2026-01-11 21:55:52,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.983228, valid_loss 1.003222, train_metric nan, valid_metric 0.118120
[1369919:MainThread](2026-01-11 21:55:52,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.983859, valid_loss 1.003408, train_metric nan, valid_metric 0.120059
[1369919:MainThread](2026-01-11 21:55:53,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.984442, valid_loss 1.004111, train_metric nan, valid_metric 0.116696
[1369919:MainThread](2026-01-11 21:55:53,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.976035, valid_loss 1.004635, train_metric nan, valid_metric 0.117411
[1369919:MainThread](2026-01-11 21:55:54,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.982455, valid_loss 0.998951, train_metric nan, valid_metric 0.117274
[1369919:MainThread](2026-01-11 21:55:54,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.979701, valid_loss 1.004426, train_metric nan, valid_metric 0.119769
[1369919:MainThread](2026-01-11 21:55:55,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.986157, valid_loss 1.002628, train_metric nan, valid_metric 0.119960
[1369919:MainThread](2026-01-11 21:55:56,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.982109, valid_loss 1.004921, train_metric nan, valid_metric 0.121220
[1369919:MainThread](2026-01-11 21:55:56,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.979770, valid_loss 1.004954, train_metric nan, valid_metric 0.118169
[1369919:MainThread](2026-01-11 21:55:57,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.984258, valid_loss 1.004999, train_metric nan, valid_metric 0.119761
[1369919:MainThread](2026-01-11 21:55:57,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.978399, valid_loss 1.007190, train_metric nan, valid_metric 0.120107
[1369919:MainThread](2026-01-11 21:55:58,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.981310, valid_loss 1.004217, train_metric nan, valid_metric 0.117916
[1369919:MainThread](2026-01-11 21:55:58,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.986946, valid_loss 1.004637, train_metric nan, valid_metric 0.119005
[1369919:MainThread](2026-01-11 21:55:59,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.980108, valid_loss 1.004244, train_metric nan, valid_metric 0.118880
[1369919:MainThread](2026-01-11 21:55:59,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.981585, valid_loss 1.003581, train_metric nan, valid_metric 0.117709
[1369919:MainThread](2026-01-11 21:56:00,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.981860, valid_loss 1.004190, train_metric nan, valid_metric 0.117990
[1369919:MainThread](2026-01-11 21:56:00,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.977260, valid_loss 1.007082, train_metric nan, valid_metric 0.120142
[1369919:MainThread](2026-01-11 21:56:01,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.981718, valid_loss 1.004361, train_metric nan, valid_metric 0.117858
[1369919:MainThread](2026-01-11 21:56:02,017) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.982526, valid_loss 1.005182, train_metric nan, valid_metric 0.119685
[1369919:MainThread](2026-01-11 21:56:02,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.975379, valid_loss 1.004714, train_metric nan, valid_metric 0.118853
[1369919:MainThread](2026-01-11 21:56:03,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.979572, valid_loss 1.005721, train_metric nan, valid_metric 0.119346
[1369919:MainThread](2026-01-11 21:56:03,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.980582, valid_loss 1.004767, train_metric nan, valid_metric 0.118562
[1369919:MainThread](2026-01-11 21:56:03,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:56:03.736 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:56:05.275 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 21:56:05.275 | INFO     | __main__:train_single_fold:593 -   IC=0.0608, ICIR=0.5947, RankIC=0.0727, RankICIR=0.8023
2026-01-11 21:56:05.275 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 21:56:05,284) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 21:56:27,609) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:56:27,610) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:56:33,536) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71bb7ddb10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 6/244 [00:00<00:04, 56.22it/s]backtest loop:   7%|▋         | 16/244 [00:00<00:02, 80.40it/s]backtest loop:  10%|█         | 25/244 [00:00<00:02, 83.04it/s]backtest loop:  15%|█▍        | 36/244 [00:00<00:02, 91.15it/s]backtest loop:  19%|█▉        | 47/244 [00:00<00:02, 96.97it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:01, 101.25it/s]backtest loop:  28%|██▊       | 69/244 [00:00<00:01, 99.87it/s] backtest loop:  33%|███▎      | 81/244 [00:00<00:01, 103.78it/s]backtest loop:  39%|███▉      | 95/244 [00:00<00:01, 113.05it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 111.79it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 110.34it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:00, 113.08it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:00, 111.74it/s]backtest loop:  64%|██████▍   | 157/244 [00:01<00:00, 115.36it/s]backtest loop:  69%|██████▉   | 169/244 [00:01<00:00, 113.13it/s]backtest loop:  74%|███████▍  | 181/244 [00:01<00:00, 111.13it/s]backtest loop:  79%|███████▉  | 193/244 [00:01<00:00, 107.40it/s]backtest loop:  84%|████████▎ | 204/244 [00:01<00:00, 98.21it/s] backtest loop:  88%|████████▊ | 215/244 [00:02<00:00, 100.59it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 104.61it/s]backtest loop:  98%|█████████▊| 238/244 [00:02<00:00, 104.55it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 103.57it/s]
2026-01-11 21:56:35.914 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0605, Sharpe(w/cost)=1.1698, MaxDD=-0.0476
2026-01-11 21:56:40.094 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 21:57:01.975 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:57:02.085 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_1_pred.parquet
2026-01-11 21:57:02.105 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 21:57:02.105 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 21:57:03.540 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0724
2026-01-11 21:57:03.861 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0636, ICIR=0.6168, RankIC=0.0757
[1369919:MainThread](2026-01-11 21:57:03,867) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 21:57:26,039) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:57:26,041) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:57:32,430) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f7308565b10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 35.46it/s]backtest loop:   5%|▍         | 12/244 [00:00<00:03, 58.36it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:03, 60.13it/s]backtest loop:  12%|█▏        | 29/244 [00:00<00:03, 70.22it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 76.27it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 79.08it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 81.29it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 82.34it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 82.49it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 83.63it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 85.27it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 86.26it/s]backtest loop:  47%|████▋     | 115/244 [00:01<00:01, 88.44it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 86.80it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 86.86it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 85.09it/s]backtest loop:  63%|██████▎   | 154/244 [00:01<00:01, 87.05it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 80.95it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 73.80it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 80.12it/s]backtest loop:  79%|███████▊  | 192/244 [00:02<00:00, 85.03it/s]backtest loop:  82%|████████▏ | 201/244 [00:02<00:00, 86.13it/s]backtest loop:  86%|████████▌ | 210/244 [00:02<00:00, 81.03it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 73.49it/s]backtest loop:  93%|█████████▎| 228/244 [00:02<00:00, 76.93it/s]backtest loop:  98%|█████████▊| 238/244 [00:02<00:00, 82.65it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 80.53it/s]
2026-01-11 21:57:35.483 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1015, Sharpe(w/cost)=1.9694
2026-01-11 21:57:35.543 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:57:35.544 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 21:57:35.544 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:57:35.544 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 21:58:30,768) INFO - qlib.timer - [log.py:127] - Time cost: 55.222s | Loading data Done
[1369919:MainThread](2026-01-11 21:58:31,083) INFO - qlib.timer - [log.py:127] - Time cost: 0.076s | DropCol Done
[1369919:MainThread](2026-01-11 21:58:32,289) INFO - qlib.timer - [log.py:127] - Time cost: 1.203s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 21:58:32,818) INFO - qlib.timer - [log.py:127] - Time cost: 0.528s | Fillna Done
[1369919:MainThread](2026-01-11 21:58:33,563) INFO - qlib.timer - [log.py:127] - Time cost: 0.076s | DropCol Done
[1369919:MainThread](2026-01-11 21:58:33,709) INFO - qlib.timer - [log.py:127] - Time cost: 0.145s | DropnaLabel Done
[1369919:MainThread](2026-01-11 21:58:33,907) INFO - qlib.timer - [log.py:127] - Time cost: 0.197s | CSRankNorm Done
[1369919:MainThread](2026-01-11 21:58:33,909) INFO - qlib.timer - [log.py:127] - Time cost: 3.140s | fit & process data Done
[1369919:MainThread](2026-01-11 21:58:33,909) INFO - qlib.timer - [log.py:127] - Time cost: 58.365s | Init data Done
2026-01-11 21:58:33.910 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 21:58:33,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 21:58:33,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 21:58:33,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 21:58:33,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:58:33.925 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 21:58:35,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 21:58:36,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.209787, valid_loss 1.041429, train_metric nan, valid_metric 0.015605
[1369919:MainThread](2026-01-11 21:58:36,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.041429, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:36,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.063878, valid_loss 1.012776, train_metric nan, valid_metric 0.040242
[1369919:MainThread](2026-01-11 21:58:36,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.041429 to 1.012776, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:37,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.037675, valid_loss 1.004613, train_metric nan, valid_metric 0.055389
[1369919:MainThread](2026-01-11 21:58:37,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012776 to 1.004613, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:37,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.023748, valid_loss 1.001645, train_metric nan, valid_metric 0.054749
[1369919:MainThread](2026-01-11 21:58:37,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004613 to 1.001645, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:38,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.018105, valid_loss 0.999879, train_metric nan, valid_metric 0.061760
[1369919:MainThread](2026-01-11 21:58:38,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001645 to 0.999879, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:38,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.012759, valid_loss 0.996751, train_metric nan, valid_metric 0.070095
[1369919:MainThread](2026-01-11 21:58:38,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999879 to 0.996751, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:39,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.007262, valid_loss 0.996135, train_metric nan, valid_metric 0.069231
[1369919:MainThread](2026-01-11 21:58:39,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996751 to 0.996135, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:39,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.011545, valid_loss 0.995737, train_metric nan, valid_metric 0.073920
[1369919:MainThread](2026-01-11 21:58:40,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996135 to 0.995737, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:40,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.000200, valid_loss 0.994403, train_metric nan, valid_metric 0.075009
[1369919:MainThread](2026-01-11 21:58:40,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995737 to 0.994403, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:41,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.001257, valid_loss 0.994281, train_metric nan, valid_metric 0.078253
[1369919:MainThread](2026-01-11 21:58:41,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994403 to 0.994281, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:41,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 0.998416, valid_loss 0.994187, train_metric nan, valid_metric 0.083154
[1369919:MainThread](2026-01-11 21:58:41,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994281 to 0.994187, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:42,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 0.997353, valid_loss 0.992458, train_metric nan, valid_metric 0.084287
[1369919:MainThread](2026-01-11 21:58:42,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994187 to 0.992458, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:42,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 0.999480, valid_loss 0.993687, train_metric nan, valid_metric 0.077153
[1369919:MainThread](2026-01-11 21:58:43,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.995147, valid_loss 0.993628, train_metric nan, valid_metric 0.084690
[1369919:MainThread](2026-01-11 21:58:43,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.995509, valid_loss 0.991810, train_metric nan, valid_metric 0.087530
[1369919:MainThread](2026-01-11 21:58:43,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992458 to 0.991810, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:44,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.987053, valid_loss 0.992224, train_metric nan, valid_metric 0.081506
[1369919:MainThread](2026-01-11 21:58:44,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.991621, valid_loss 0.992930, train_metric nan, valid_metric 0.077305
[1369919:MainThread](2026-01-11 21:58:45,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.984735, valid_loss 0.991923, train_metric nan, valid_metric 0.083013
[1369919:MainThread](2026-01-11 21:58:45,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.985700, valid_loss 0.992300, train_metric nan, valid_metric 0.082717
[1369919:MainThread](2026-01-11 21:58:46,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.990956, valid_loss 0.992110, train_metric nan, valid_metric 0.081990
[1369919:MainThread](2026-01-11 21:58:47,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.985828, valid_loss 0.990629, train_metric nan, valid_metric 0.088333
[1369919:MainThread](2026-01-11 21:58:47,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.991810 to 0.990629, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:47,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.989888, valid_loss 0.990555, train_metric nan, valid_metric 0.092238
[1369919:MainThread](2026-01-11 21:58:47,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.990629 to 0.990555, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:48,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.985740, valid_loss 0.990866, train_metric nan, valid_metric 0.092445
[1369919:MainThread](2026-01-11 21:58:48,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.986171, valid_loss 0.993601, train_metric nan, valid_metric 0.087577
[1369919:MainThread](2026-01-11 21:58:49,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.984219, valid_loss 0.992149, train_metric nan, valid_metric 0.089284
[1369919:MainThread](2026-01-11 21:58:49,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.985681, valid_loss 0.993130, train_metric nan, valid_metric 0.086000
[1369919:MainThread](2026-01-11 21:58:50,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.983538, valid_loss 0.992017, train_metric nan, valid_metric 0.083486
[1369919:MainThread](2026-01-11 21:58:50,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.984201, valid_loss 0.991888, train_metric nan, valid_metric 0.089721
[1369919:MainThread](2026-01-11 21:58:51,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.978964, valid_loss 0.991321, train_metric nan, valid_metric 0.087775
[1369919:MainThread](2026-01-11 21:58:51,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.985197, valid_loss 0.991123, train_metric nan, valid_metric 0.087408
[1369919:MainThread](2026-01-11 21:58:52,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.984156, valid_loss 0.989899, train_metric nan, valid_metric 0.092279
[1369919:MainThread](2026-01-11 21:58:52,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.990555 to 0.989899, save checkpoint.
[1369919:MainThread](2026-01-11 21:58:53,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.983472, valid_loss 0.991796, train_metric nan, valid_metric 0.089921
[1369919:MainThread](2026-01-11 21:58:53,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.983064, valid_loss 0.991220, train_metric nan, valid_metric 0.086012
[1369919:MainThread](2026-01-11 21:58:54,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.983469, valid_loss 0.990998, train_metric nan, valid_metric 0.089464
[1369919:MainThread](2026-01-11 21:58:54,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.983736, valid_loss 0.994081, train_metric nan, valid_metric 0.087080
[1369919:MainThread](2026-01-11 21:58:55,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.981735, valid_loss 0.992086, train_metric nan, valid_metric 0.092001
[1369919:MainThread](2026-01-11 21:58:55,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.984869, valid_loss 0.991615, train_metric nan, valid_metric 0.085812
[1369919:MainThread](2026-01-11 21:58:56,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.983315, valid_loss 0.992376, train_metric nan, valid_metric 0.084825
[1369919:MainThread](2026-01-11 21:58:56,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.980701, valid_loss 0.991893, train_metric nan, valid_metric 0.090199
[1369919:MainThread](2026-01-11 21:58:57,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.979496, valid_loss 0.990669, train_metric nan, valid_metric 0.088172
[1369919:MainThread](2026-01-11 21:58:58,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.984188, valid_loss 0.991121, train_metric nan, valid_metric 0.086790
[1369919:MainThread](2026-01-11 21:58:58,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.979669, valid_loss 0.992411, train_metric nan, valid_metric 0.088341
[1369919:MainThread](2026-01-11 21:58:59,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.979546, valid_loss 0.990551, train_metric nan, valid_metric 0.090330
[1369919:MainThread](2026-01-11 21:58:59,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.982798, valid_loss 0.991489, train_metric nan, valid_metric 0.091115
[1369919:MainThread](2026-01-11 21:59:00,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.983671, valid_loss 0.989900, train_metric nan, valid_metric 0.093674
[1369919:MainThread](2026-01-11 21:59:00,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.981576, valid_loss 0.991482, train_metric nan, valid_metric 0.091470
[1369919:MainThread](2026-01-11 21:59:01,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.977695, valid_loss 0.989822, train_metric nan, valid_metric 0.094190
[1369919:MainThread](2026-01-11 21:59:01,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.989899 to 0.989822, save checkpoint.
[1369919:MainThread](2026-01-11 21:59:02,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.978916, valid_loss 0.991272, train_metric nan, valid_metric 0.088202
[1369919:MainThread](2026-01-11 21:59:02,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.975061, valid_loss 0.990887, train_metric nan, valid_metric 0.092152
[1369919:MainThread](2026-01-11 21:59:03,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.982983, valid_loss 0.990719, train_metric nan, valid_metric 0.091760
[1369919:MainThread](2026-01-11 21:59:03,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.978519, valid_loss 0.992425, train_metric nan, valid_metric 0.089630
[1369919:MainThread](2026-01-11 21:59:04,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.979753, valid_loss 0.991456, train_metric nan, valid_metric 0.089483
[1369919:MainThread](2026-01-11 21:59:05,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.983051, valid_loss 0.991345, train_metric nan, valid_metric 0.089813
[1369919:MainThread](2026-01-11 21:59:05,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.976022, valid_loss 0.990655, train_metric nan, valid_metric 0.091834
[1369919:MainThread](2026-01-11 21:59:06,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.979053, valid_loss 0.990932, train_metric nan, valid_metric 0.094156
[1369919:MainThread](2026-01-11 21:59:06,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.978856, valid_loss 0.990717, train_metric nan, valid_metric 0.091605
[1369919:MainThread](2026-01-11 21:59:07,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.980847, valid_loss 0.990926, train_metric nan, valid_metric 0.088825
[1369919:MainThread](2026-01-11 21:59:07,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.976618, valid_loss 0.991479, train_metric nan, valid_metric 0.091237
[1369919:MainThread](2026-01-11 21:59:08,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.980533, valid_loss 0.990563, train_metric nan, valid_metric 0.092066
[1369919:MainThread](2026-01-11 21:59:08,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.976271, valid_loss 0.991094, train_metric nan, valid_metric 0.088205
[1369919:MainThread](2026-01-11 21:59:09,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.980096, valid_loss 0.990572, train_metric nan, valid_metric 0.093114
[1369919:MainThread](2026-01-11 21:59:09,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.978677, valid_loss 0.991524, train_metric nan, valid_metric 0.091344
[1369919:MainThread](2026-01-11 21:59:10,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.974402, valid_loss 0.991322, train_metric nan, valid_metric 0.090403
[1369919:MainThread](2026-01-11 21:59:10,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.981198, valid_loss 0.991758, train_metric nan, valid_metric 0.086453
[1369919:MainThread](2026-01-11 21:59:11,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.981181, valid_loss 0.991671, train_metric nan, valid_metric 0.088510
[1369919:MainThread](2026-01-11 21:59:11,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.978899, valid_loss 0.991453, train_metric nan, valid_metric 0.085970
[1369919:MainThread](2026-01-11 21:59:12,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.980368, valid_loss 0.990744, train_metric nan, valid_metric 0.090391
[1369919:MainThread](2026-01-11 21:59:13,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.977407, valid_loss 0.991023, train_metric nan, valid_metric 0.090990
[1369919:MainThread](2026-01-11 21:59:13,594) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.980331, valid_loss 0.991057, train_metric nan, valid_metric 0.089413
[1369919:MainThread](2026-01-11 21:59:14,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.980645, valid_loss 0.990819, train_metric nan, valid_metric 0.089597
[1369919:MainThread](2026-01-11 21:59:14,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.976763, valid_loss 0.990818, train_metric nan, valid_metric 0.092935
[1369919:MainThread](2026-01-11 21:59:15,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.978111, valid_loss 0.991026, train_metric nan, valid_metric 0.090830
[1369919:MainThread](2026-01-11 21:59:15,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.974376, valid_loss 0.990939, train_metric nan, valid_metric 0.090576
[1369919:MainThread](2026-01-11 21:59:16,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.983453, valid_loss 0.991211, train_metric nan, valid_metric 0.091318
[1369919:MainThread](2026-01-11 21:59:16,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.976409, valid_loss 0.990566, train_metric nan, valid_metric 0.091658
[1369919:MainThread](2026-01-11 21:59:17,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.973687, valid_loss 0.990712, train_metric nan, valid_metric 0.091704
[1369919:MainThread](2026-01-11 21:59:18,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.977028, valid_loss 0.990712, train_metric nan, valid_metric 0.091895
[1369919:MainThread](2026-01-11 21:59:18,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.976404, valid_loss 0.990744, train_metric nan, valid_metric 0.091303
[1369919:MainThread](2026-01-11 21:59:19,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.977519, valid_loss 0.990557, train_metric nan, valid_metric 0.092080
[1369919:MainThread](2026-01-11 21:59:19,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.975150, valid_loss 0.990887, train_metric nan, valid_metric 0.091745
[1369919:MainThread](2026-01-11 21:59:20,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.973496, valid_loss 0.990677, train_metric nan, valid_metric 0.090971
[1369919:MainThread](2026-01-11 21:59:20,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.977577, valid_loss 0.990721, train_metric nan, valid_metric 0.091547
[1369919:MainThread](2026-01-11 21:59:21,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.977053, valid_loss 0.991013, train_metric nan, valid_metric 0.090154
[1369919:MainThread](2026-01-11 21:59:21,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.977024, valid_loss 0.990819, train_metric nan, valid_metric 0.091809
[1369919:MainThread](2026-01-11 21:59:22,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.980474, valid_loss 0.990801, train_metric nan, valid_metric 0.090585
[1369919:MainThread](2026-01-11 21:59:23,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.979714, valid_loss 0.990769, train_metric nan, valid_metric 0.092527
[1369919:MainThread](2026-01-11 21:59:23,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.978047, valid_loss 0.990647, train_metric nan, valid_metric 0.091536
[1369919:MainThread](2026-01-11 21:59:24,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.975908, valid_loss 0.990976, train_metric nan, valid_metric 0.090588
[1369919:MainThread](2026-01-11 21:59:24,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.979007, valid_loss 0.990727, train_metric nan, valid_metric 0.091086
[1369919:MainThread](2026-01-11 21:59:25,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.976238, valid_loss 0.990955, train_metric nan, valid_metric 0.091209
[1369919:MainThread](2026-01-11 21:59:25,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.980403, valid_loss 0.990579, train_metric nan, valid_metric 0.091612
[1369919:MainThread](2026-01-11 21:59:26,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.974146, valid_loss 0.990861, train_metric nan, valid_metric 0.092037
[1369919:MainThread](2026-01-11 21:59:27,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.973896, valid_loss 0.990798, train_metric nan, valid_metric 0.092099
[1369919:MainThread](2026-01-11 21:59:27,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.975992, valid_loss 0.990582, train_metric nan, valid_metric 0.091672
[1369919:MainThread](2026-01-11 21:59:28,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.973350, valid_loss 0.990674, train_metric nan, valid_metric 0.091450
[1369919:MainThread](2026-01-11 21:59:28,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.978438, valid_loss 0.990942, train_metric nan, valid_metric 0.091630
[1369919:MainThread](2026-01-11 21:59:29,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.974256, valid_loss 0.990714, train_metric nan, valid_metric 0.091864
[1369919:MainThread](2026-01-11 21:59:29,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:59:29.252 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:59:30.748 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 21:59:30.749 | INFO     | __main__:train_single_fold:593 -   IC=0.0452, ICIR=0.4280, RankIC=0.0425, RankICIR=0.4441
2026-01-11 21:59:30.749 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 21:59:30,755) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 21:59:56,876) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 21:59:56,877) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:00:03,566) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b98c5b10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 31.64it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 59.81it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 69.56it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:02, 71.37it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:02, 71.08it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 72.84it/s]backtest loop:  24%|██▍       | 58/243 [00:00<00:02, 77.23it/s]backtest loop:  27%|██▋       | 66/243 [00:00<00:02, 76.95it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 76.27it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 76.36it/s]backtest loop:  37%|███▋      | 90/243 [00:01<00:02, 76.43it/s]backtest loop:  41%|████      | 100/243 [00:01<00:01, 77.55it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 78.55it/s]backtest loop:  49%|████▉     | 119/243 [00:01<00:01, 79.57it/s]backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 80.18it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 81.04it/s]backtest loop:  61%|██████▏   | 149/243 [00:01<00:01, 81.89it/s]backtest loop:  65%|██████▌   | 159/243 [00:02<00:01, 81.88it/s]backtest loop:  70%|██████▉   | 169/243 [00:02<00:00, 81.18it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 81.35it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 81.41it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 82.01it/s]backtest loop:  85%|████████▌ | 207/243 [00:02<00:00, 82.45it/s]backtest loop:  89%|████████▉ | 216/243 [00:02<00:00, 81.20it/s]backtest loop:  93%|█████████▎| 225/243 [00:02<00:00, 79.69it/s]backtest loop:  96%|█████████▌| 233/243 [00:03<00:00, 78.01it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.54it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.66it/s]
2026-01-11 22:00:06.719 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0088, Sharpe(w/cost)=-0.1243, MaxDD=-0.0756
2026-01-11 22:00:10.486 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 22:00:27.700 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:00:27.830 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_2_pred.parquet
2026-01-11 22:00:27.850 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 22:00:27.850 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 22:00:29.574 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0458
2026-01-11 22:00:31.087 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0424
2026-01-11 22:00:31.435 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0532, ICIR=0.5622, RankIC=0.0468
[1369919:MainThread](2026-01-11 22:00:31,442) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:01:00,593) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:01:00,594) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:01:07,097) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f73a6197b50>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 31.89it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 61.23it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 71.86it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:02, 73.59it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:02, 74.01it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 73.68it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 75.53it/s]backtest loop:  28%|██▊       | 67/243 [00:00<00:02, 76.16it/s]backtest loop:  32%|███▏      | 77/243 [00:01<00:02, 77.77it/s]backtest loop:  35%|███▍      | 85/243 [00:01<00:02, 76.37it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 78.30it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 79.17it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 79.23it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 80.37it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 81.60it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 82.51it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 83.40it/s]backtest loop:  67%|██████▋   | 164/243 [00:02<00:00, 83.34it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 84.21it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 84.14it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 86.10it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 85.07it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 83.93it/s]backtest loop:  91%|█████████▏| 222/243 [00:02<00:00, 85.52it/s]backtest loop:  95%|█████████▌| 231/243 [00:02<00:00, 83.37it/s]backtest loop:  99%|█████████▉| 240/243 [00:03<00:00, 81.98it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.35it/s]
2026-01-11 22:01:10.183 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0224, Sharpe(w/cost)=-0.3924
2026-01-11 22:01:10.240 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:01:10.240 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 22:01:10.240 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:01:10.240 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 22:02:09,131) INFO - qlib.timer - [log.py:127] - Time cost: 58.888s | Loading data Done
[1369919:MainThread](2026-01-11 22:02:09,598) INFO - qlib.timer - [log.py:127] - Time cost: 0.190s | DropCol Done
[1369919:MainThread](2026-01-11 22:02:10,815) INFO - qlib.timer - [log.py:127] - Time cost: 1.215s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 22:02:11,338) INFO - qlib.timer - [log.py:127] - Time cost: 0.522s | Fillna Done
[1369919:MainThread](2026-01-11 22:02:12,161) INFO - qlib.timer - [log.py:127] - Time cost: 0.083s | DropCol Done
[1369919:MainThread](2026-01-11 22:02:12,314) INFO - qlib.timer - [log.py:127] - Time cost: 0.152s | DropnaLabel Done
[1369919:MainThread](2026-01-11 22:02:12,516) INFO - qlib.timer - [log.py:127] - Time cost: 0.201s | CSRankNorm Done
[1369919:MainThread](2026-01-11 22:02:12,518) INFO - qlib.timer - [log.py:127] - Time cost: 3.386s | fit & process data Done
[1369919:MainThread](2026-01-11 22:02:12,519) INFO - qlib.timer - [log.py:127] - Time cost: 62.277s | Init data Done
2026-01-11 22:02:12.519 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 22:02:12,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 22:02:12,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 22:02:12,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 22:02:12,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:02:12.535 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 22:02:13,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 22:02:14,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.297130, valid_loss 1.084938, train_metric nan, valid_metric 0.019450
[1369919:MainThread](2026-01-11 22:02:14,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.084938, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:15,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.102040, valid_loss 1.029353, train_metric nan, valid_metric 0.030869
[1369919:MainThread](2026-01-11 22:02:15,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.084938 to 1.029353, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:16,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.074165, valid_loss 1.018811, train_metric nan, valid_metric 0.030503
[1369919:MainThread](2026-01-11 22:02:16,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.029353 to 1.018811, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:16,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.049636, valid_loss 1.020052, train_metric nan, valid_metric 0.035836
[1369919:MainThread](2026-01-11 22:02:17,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.042501, valid_loss 1.012896, train_metric nan, valid_metric 0.040959
[1369919:MainThread](2026-01-11 22:02:17,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018811 to 1.012896, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:17,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.033777, valid_loss 1.006078, train_metric nan, valid_metric 0.041084
[1369919:MainThread](2026-01-11 22:02:17,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012896 to 1.006078, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:18,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.024474, valid_loss 1.008382, train_metric nan, valid_metric 0.042756
[1369919:MainThread](2026-01-11 22:02:18,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.019582, valid_loss 1.004117, train_metric nan, valid_metric 0.049851
[1369919:MainThread](2026-01-11 22:02:18,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006078 to 1.004117, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:19,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.016718, valid_loss 1.002959, train_metric nan, valid_metric 0.042935
[1369919:MainThread](2026-01-11 22:02:19,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004117 to 1.002959, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:19,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.014311, valid_loss 1.000932, train_metric nan, valid_metric 0.049398
[1369919:MainThread](2026-01-11 22:02:19,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002959 to 1.000932, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:20,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.011269, valid_loss 1.000728, train_metric nan, valid_metric 0.051289
[1369919:MainThread](2026-01-11 22:02:20,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000932 to 1.000728, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:20,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.011966, valid_loss 1.000576, train_metric nan, valid_metric 0.056097
[1369919:MainThread](2026-01-11 22:02:20,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000728 to 1.000576, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:21,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.004422, valid_loss 1.000037, train_metric nan, valid_metric 0.049141
[1369919:MainThread](2026-01-11 22:02:21,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000576 to 1.000037, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:22,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.005392, valid_loss 0.999509, train_metric nan, valid_metric 0.054950
[1369919:MainThread](2026-01-11 22:02:22,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000037 to 0.999509, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:22,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.002818, valid_loss 0.998263, train_metric nan, valid_metric 0.055869
[1369919:MainThread](2026-01-11 22:02:22,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999509 to 0.998263, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:23,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.999955, valid_loss 1.000404, train_metric nan, valid_metric 0.050898
[1369919:MainThread](2026-01-11 22:02:23,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.995750, valid_loss 0.998180, train_metric nan, valid_metric 0.056870
[1369919:MainThread](2026-01-11 22:02:23,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998263 to 0.998180, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:24,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.993952, valid_loss 0.999215, train_metric nan, valid_metric 0.054662
[1369919:MainThread](2026-01-11 22:02:24,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.993698, valid_loss 0.998240, train_metric nan, valid_metric 0.056276
[1369919:MainThread](2026-01-11 22:02:25,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.989302, valid_loss 1.002396, train_metric nan, valid_metric 0.054094
[1369919:MainThread](2026-01-11 22:02:25,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.990934, valid_loss 0.998105, train_metric nan, valid_metric 0.058242
[1369919:MainThread](2026-01-11 22:02:25,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998180 to 0.998105, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:26,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.992718, valid_loss 0.997011, train_metric nan, valid_metric 0.056962
[1369919:MainThread](2026-01-11 22:02:26,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998105 to 0.997011, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:27,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.990724, valid_loss 0.998087, train_metric nan, valid_metric 0.056677
[1369919:MainThread](2026-01-11 22:02:27,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.990196, valid_loss 0.999544, train_metric nan, valid_metric 0.057986
[1369919:MainThread](2026-01-11 22:02:28,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.989262, valid_loss 0.996846, train_metric nan, valid_metric 0.054936
[1369919:MainThread](2026-01-11 22:02:28,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997011 to 0.996846, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:28,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.988155, valid_loss 0.998310, train_metric nan, valid_metric 0.060030
[1369919:MainThread](2026-01-11 22:02:29,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.982887, valid_loss 0.998761, train_metric nan, valid_metric 0.055169
[1369919:MainThread](2026-01-11 22:02:29,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.986311, valid_loss 0.998677, train_metric nan, valid_metric 0.062255
[1369919:MainThread](2026-01-11 22:02:30,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.984856, valid_loss 0.999301, train_metric nan, valid_metric 0.058913
[1369919:MainThread](2026-01-11 22:02:30,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.987516, valid_loss 0.999325, train_metric nan, valid_metric 0.058964
[1369919:MainThread](2026-01-11 22:02:31,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.979124, valid_loss 0.997263, train_metric nan, valid_metric 0.055585
[1369919:MainThread](2026-01-11 22:02:31,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.988390, valid_loss 0.997125, train_metric nan, valid_metric 0.062950
[1369919:MainThread](2026-01-11 22:02:32,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.985187, valid_loss 0.997123, train_metric nan, valid_metric 0.059055
[1369919:MainThread](2026-01-11 22:02:33,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.985536, valid_loss 0.996975, train_metric nan, valid_metric 0.060904
[1369919:MainThread](2026-01-11 22:02:33,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.984591, valid_loss 0.996916, train_metric nan, valid_metric 0.059049
[1369919:MainThread](2026-01-11 22:02:34,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.982263, valid_loss 0.998923, train_metric nan, valid_metric 0.059448
[1369919:MainThread](2026-01-11 22:02:34,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.983584, valid_loss 0.996762, train_metric nan, valid_metric 0.059374
[1369919:MainThread](2026-01-11 22:02:34,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996846 to 0.996762, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:35,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.986087, valid_loss 0.997273, train_metric nan, valid_metric 0.060124
[1369919:MainThread](2026-01-11 22:02:35,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.980147, valid_loss 0.996432, train_metric nan, valid_metric 0.061423
[1369919:MainThread](2026-01-11 22:02:35,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996762 to 0.996432, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:36,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.982504, valid_loss 0.997262, train_metric nan, valid_metric 0.061555
[1369919:MainThread](2026-01-11 22:02:36,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.982911, valid_loss 0.997325, train_metric nan, valid_metric 0.058409
[1369919:MainThread](2026-01-11 22:02:37,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.978950, valid_loss 0.996716, train_metric nan, valid_metric 0.060737
[1369919:MainThread](2026-01-11 22:02:38,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.982434, valid_loss 0.997584, train_metric nan, valid_metric 0.057607
[1369919:MainThread](2026-01-11 22:02:38,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.980223, valid_loss 0.998499, train_metric nan, valid_metric 0.058134
[1369919:MainThread](2026-01-11 22:02:39,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.981443, valid_loss 0.997638, train_metric nan, valid_metric 0.061593
[1369919:MainThread](2026-01-11 22:02:39,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.982147, valid_loss 0.996895, train_metric nan, valid_metric 0.061148
[1369919:MainThread](2026-01-11 22:02:40,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.977571, valid_loss 0.997338, train_metric nan, valid_metric 0.062190
[1369919:MainThread](2026-01-11 22:02:40,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.980118, valid_loss 0.998699, train_metric nan, valid_metric 0.060249
[1369919:MainThread](2026-01-11 22:02:41,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.984702, valid_loss 0.996686, train_metric nan, valid_metric 0.064538
[1369919:MainThread](2026-01-11 22:02:41,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.979566, valid_loss 0.997657, train_metric nan, valid_metric 0.061243
[1369919:MainThread](2026-01-11 22:02:42,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.981928, valid_loss 0.998139, train_metric nan, valid_metric 0.062781
[1369919:MainThread](2026-01-11 22:02:42,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.978897, valid_loss 0.998065, train_metric nan, valid_metric 0.059969
[1369919:MainThread](2026-01-11 22:02:43,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.980450, valid_loss 0.996674, train_metric nan, valid_metric 0.062602
[1369919:MainThread](2026-01-11 22:02:43,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.981607, valid_loss 0.997343, train_metric nan, valid_metric 0.062060
[1369919:MainThread](2026-01-11 22:02:44,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.982976, valid_loss 0.998111, train_metric nan, valid_metric 0.064233
[1369919:MainThread](2026-01-11 22:02:44,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.981183, valid_loss 0.996309, train_metric nan, valid_metric 0.063017
[1369919:MainThread](2026-01-11 22:02:44,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996432 to 0.996309, save checkpoint.
[1369919:MainThread](2026-01-11 22:02:45,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.981407, valid_loss 0.997843, train_metric nan, valid_metric 0.062474
[1369919:MainThread](2026-01-11 22:02:46,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.980511, valid_loss 0.996818, train_metric nan, valid_metric 0.062986
[1369919:MainThread](2026-01-11 22:02:46,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.983233, valid_loss 0.996361, train_metric nan, valid_metric 0.064515
[1369919:MainThread](2026-01-11 22:02:47,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.979951, valid_loss 0.997087, train_metric nan, valid_metric 0.061797
[1369919:MainThread](2026-01-11 22:02:47,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.977292, valid_loss 0.998641, train_metric nan, valid_metric 0.061895
[1369919:MainThread](2026-01-11 22:02:48,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.981917, valid_loss 0.996886, train_metric nan, valid_metric 0.063379
[1369919:MainThread](2026-01-11 22:02:48,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.979347, valid_loss 0.996733, train_metric nan, valid_metric 0.061823
[1369919:MainThread](2026-01-11 22:02:49,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.977275, valid_loss 0.997021, train_metric nan, valid_metric 0.060554
[1369919:MainThread](2026-01-11 22:02:50,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.979708, valid_loss 0.997729, train_metric nan, valid_metric 0.060897
[1369919:MainThread](2026-01-11 22:02:50,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.981341, valid_loss 0.997949, train_metric nan, valid_metric 0.060700
[1369919:MainThread](2026-01-11 22:02:51,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.978706, valid_loss 0.998854, train_metric nan, valid_metric 0.059242
[1369919:MainThread](2026-01-11 22:02:51,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.978114, valid_loss 0.997382, train_metric nan, valid_metric 0.061982
[1369919:MainThread](2026-01-11 22:02:52,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.977437, valid_loss 0.996418, train_metric nan, valid_metric 0.063506
[1369919:MainThread](2026-01-11 22:02:53,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.977749, valid_loss 0.997407, train_metric nan, valid_metric 0.061891
[1369919:MainThread](2026-01-11 22:02:53,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.981258, valid_loss 0.997158, train_metric nan, valid_metric 0.060516
[1369919:MainThread](2026-01-11 22:02:54,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.977750, valid_loss 0.997907, train_metric nan, valid_metric 0.060109
[1369919:MainThread](2026-01-11 22:02:54,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.981911, valid_loss 0.997277, train_metric nan, valid_metric 0.060724
[1369919:MainThread](2026-01-11 22:02:55,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.975280, valid_loss 0.997039, train_metric nan, valid_metric 0.063236
[1369919:MainThread](2026-01-11 22:02:55,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.978110, valid_loss 0.996950, train_metric nan, valid_metric 0.062874
[1369919:MainThread](2026-01-11 22:02:56,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.980595, valid_loss 0.997603, train_metric nan, valid_metric 0.061738
[1369919:MainThread](2026-01-11 22:02:57,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.978339, valid_loss 0.996977, train_metric nan, valid_metric 0.062230
[1369919:MainThread](2026-01-11 22:02:57,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.978325, valid_loss 0.997320, train_metric nan, valid_metric 0.062235
[1369919:MainThread](2026-01-11 22:02:58,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.975353, valid_loss 0.997196, train_metric nan, valid_metric 0.061981
[1369919:MainThread](2026-01-11 22:02:58,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.974566, valid_loss 0.997018, train_metric nan, valid_metric 0.063004
[1369919:MainThread](2026-01-11 22:02:59,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.978823, valid_loss 0.997286, train_metric nan, valid_metric 0.063689
[1369919:MainThread](2026-01-11 22:02:59,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.979866, valid_loss 0.996943, train_metric nan, valid_metric 0.063250
[1369919:MainThread](2026-01-11 22:03:00,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.981021, valid_loss 0.997350, train_metric nan, valid_metric 0.061683
[1369919:MainThread](2026-01-11 22:03:01,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.981752, valid_loss 0.997562, train_metric nan, valid_metric 0.061931
[1369919:MainThread](2026-01-11 22:03:01,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.973642, valid_loss 0.997154, train_metric nan, valid_metric 0.061299
[1369919:MainThread](2026-01-11 22:03:02,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.978621, valid_loss 0.997110, train_metric nan, valid_metric 0.061743
[1369919:MainThread](2026-01-11 22:03:02,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.976049, valid_loss 0.997282, train_metric nan, valid_metric 0.061832
[1369919:MainThread](2026-01-11 22:03:03,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.977500, valid_loss 0.997241, train_metric nan, valid_metric 0.061438
[1369919:MainThread](2026-01-11 22:03:03,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.978310, valid_loss 0.997192, train_metric nan, valid_metric 0.062363
[1369919:MainThread](2026-01-11 22:03:04,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.974226, valid_loss 0.997470, train_metric nan, valid_metric 0.062480
[1369919:MainThread](2026-01-11 22:03:04,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.978384, valid_loss 0.997036, train_metric nan, valid_metric 0.062924
[1369919:MainThread](2026-01-11 22:03:05,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.975318, valid_loss 0.997287, train_metric nan, valid_metric 0.062747
[1369919:MainThread](2026-01-11 22:03:06,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.974690, valid_loss 0.997500, train_metric nan, valid_metric 0.062147
[1369919:MainThread](2026-01-11 22:03:06,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.977629, valid_loss 0.997409, train_metric nan, valid_metric 0.062459
[1369919:MainThread](2026-01-11 22:03:07,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.977839, valid_loss 0.997226, train_metric nan, valid_metric 0.063371
[1369919:MainThread](2026-01-11 22:03:07,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.979510, valid_loss 0.997033, train_metric nan, valid_metric 0.062978
[1369919:MainThread](2026-01-11 22:03:08,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.976352, valid_loss 0.997599, train_metric nan, valid_metric 0.062244
[1369919:MainThread](2026-01-11 22:03:08,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.980898, valid_loss 0.997155, train_metric nan, valid_metric 0.062248
[1369919:MainThread](2026-01-11 22:03:09,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.977927, valid_loss 0.997486, train_metric nan, valid_metric 0.062922
[1369919:MainThread](2026-01-11 22:03:09,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.980467, valid_loss 0.996814, train_metric nan, valid_metric 0.062651
[1369919:MainThread](2026-01-11 22:03:10,052) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.977875, valid_loss 0.997040, train_metric nan, valid_metric 0.062397
[1369919:MainThread](2026-01-11 22:03:10,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.977562, valid_loss 0.997172, train_metric nan, valid_metric 0.062229
[1369919:MainThread](2026-01-11 22:03:11,144) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.980126, valid_loss 0.997678, train_metric nan, valid_metric 0.062032
[1369919:MainThread](2026-01-11 22:03:11,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.977327, valid_loss 0.997319, train_metric nan, valid_metric 0.062260
[1369919:MainThread](2026-01-11 22:03:12,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.980377, valid_loss 0.996721, train_metric nan, valid_metric 0.062552
[1369919:MainThread](2026-01-11 22:03:12,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.976483, valid_loss 0.997114, train_metric nan, valid_metric 0.062327
[1369919:MainThread](2026-01-11 22:03:12,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:03:12.819 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:03:14.310 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 22:03:14.310 | INFO     | __main__:train_single_fold:593 -   IC=0.0112, ICIR=0.1152, RankIC=0.0374, RankICIR=0.3994
2026-01-11 22:03:14.310 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 22:03:14,317) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:03:41,032) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:03:41,033) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:03:48,214) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71bbae5b10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 24.95it/s]backtest loop:   5%|▍         | 12/244 [00:00<00:03, 59.96it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:03, 62.38it/s]backtest loop:  11%|█         | 27/244 [00:00<00:03, 68.02it/s]backtest loop:  14%|█▍        | 34/244 [00:00<00:03, 67.26it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:02, 71.14it/s]backtest loop:  21%|██▏       | 52/244 [00:00<00:02, 75.43it/s]backtest loop:  25%|██▍       | 60/244 [00:00<00:02, 75.05it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 71.44it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 72.50it/s]backtest loop:  35%|███▍      | 85/244 [00:01<00:02, 73.37it/s]backtest loop:  39%|███▊      | 94/244 [00:01<00:02, 74.83it/s]backtest loop:  42%|████▏     | 102/244 [00:01<00:01, 75.78it/s]backtest loop:  45%|████▌     | 110/244 [00:01<00:01, 75.45it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 73.15it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 75.79it/s]backtest loop:  56%|█████▌    | 137/244 [00:01<00:01, 79.09it/s]backtest loop:  59%|█████▉    | 145/244 [00:01<00:01, 77.31it/s]backtest loop:  63%|██████▎   | 153/244 [00:02<00:01, 74.36it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 76.26it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 77.51it/s]backtest loop:  74%|███████▍  | 181/244 [00:02<00:00, 80.17it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 73.78it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 75.24it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 77.54it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 79.23it/s]backtest loop:  93%|█████████▎| 227/244 [00:03<00:00, 80.58it/s]backtest loop:  97%|█████████▋| 236/244 [00:03<00:00, 80.89it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 74.50it/s]
2026-01-11 22:03:51.513 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1603, Sharpe(w/cost)=-2.4908, MaxDD=-0.1775
2026-01-11 22:03:55.320 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 22:04:10.583 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:04:10.681 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_3_pred.parquet
2026-01-11 22:04:10.703 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 22:04:10.703 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 22:04:12.217 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0390
2026-01-11 22:04:13.500 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0427
2026-01-11 22:04:14.915 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0467
2026-01-11 22:04:15.278 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0229, ICIR=0.2304, RankIC=0.0429
[1369919:MainThread](2026-01-11 22:04:15,284) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:04:43,295) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:04:43,296) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:04:50,130) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f72f8445b10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 24.65it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:04, 57.51it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 68.43it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 73.25it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:02, 76.15it/s]backtest loop:  21%|██▏       | 52/244 [00:00<00:02, 79.66it/s]backtest loop:  25%|██▌       | 61/244 [00:00<00:02, 79.21it/s]backtest loop:  28%|██▊       | 69/244 [00:00<00:02, 78.20it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 77.86it/s]backtest loop:  35%|███▍      | 85/244 [00:01<00:02, 77.78it/s]backtest loop:  39%|███▊      | 94/244 [00:01<00:01, 77.59it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 77.72it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 78.84it/s]backtest loop:  50%|█████     | 123/244 [00:01<00:01, 79.68it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 80.07it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 80.83it/s]backtest loop:  62%|██████▏   | 152/244 [00:01<00:01, 83.03it/s]backtest loop:  66%|██████▌   | 161/244 [00:02<00:01, 82.04it/s]backtest loop:  70%|██████▉   | 170/244 [00:02<00:00, 81.23it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:00, 80.24it/s]backtest loop:  77%|███████▋  | 188/244 [00:02<00:00, 76.85it/s]backtest loop:  81%|████████  | 197/244 [00:02<00:00, 76.64it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 77.98it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 79.00it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 79.33it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 79.87it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 77.48it/s]
2026-01-11 22:04:53.305 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0647, Sharpe(w/cost)=-0.9560
2026-01-11 22:04:53.359 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:04:53.360 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 22:04:53.360 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:04:53.360 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 22:05:53,085) INFO - qlib.timer - [log.py:127] - Time cost: 59.722s | Loading data Done
[1369919:MainThread](2026-01-11 22:05:53,416) INFO - qlib.timer - [log.py:127] - Time cost: 0.078s | DropCol Done
[1369919:MainThread](2026-01-11 22:05:54,590) INFO - qlib.timer - [log.py:127] - Time cost: 1.172s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 22:05:55,179) INFO - qlib.timer - [log.py:127] - Time cost: 0.588s | Fillna Done
[1369919:MainThread](2026-01-11 22:05:55,908) INFO - qlib.timer - [log.py:127] - Time cost: 0.077s | DropCol Done
[1369919:MainThread](2026-01-11 22:05:56,057) INFO - qlib.timer - [log.py:127] - Time cost: 0.148s | DropnaLabel Done
[1369919:MainThread](2026-01-11 22:05:56,260) INFO - qlib.timer - [log.py:127] - Time cost: 0.202s | CSRankNorm Done
[1369919:MainThread](2026-01-11 22:05:56,262) INFO - qlib.timer - [log.py:127] - Time cost: 3.177s | fit & process data Done
[1369919:MainThread](2026-01-11 22:05:56,263) INFO - qlib.timer - [log.py:127] - Time cost: 62.901s | Init data Done
2026-01-11 22:05:56.263 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 22:05:56,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 22:05:56,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 22:05:56,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 22:05:56,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:05:56.278 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 22:05:57,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 22:05:58,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.355215, valid_loss 1.111455, train_metric nan, valid_metric 0.013667
[1369919:MainThread](2026-01-11 22:05:58,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.111455, save checkpoint.
[1369919:MainThread](2026-01-11 22:05:59,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.094488, valid_loss 1.046789, train_metric nan, valid_metric 0.030381
[1369919:MainThread](2026-01-11 22:05:59,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.111455 to 1.046789, save checkpoint.
[1369919:MainThread](2026-01-11 22:05:59,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.056263, valid_loss 1.048206, train_metric nan, valid_metric 0.020211
[1369919:MainThread](2026-01-11 22:06:00,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.042737, valid_loss 1.018497, train_metric nan, valid_metric 0.032451
[1369919:MainThread](2026-01-11 22:06:00,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.046789 to 1.018497, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:00,840) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.041955, valid_loss 1.013620, train_metric nan, valid_metric 0.025931
[1369919:MainThread](2026-01-11 22:06:00,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018497 to 1.013620, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:01,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.027059, valid_loss 1.016286, train_metric nan, valid_metric 0.036128
[1369919:MainThread](2026-01-11 22:06:02,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.027611, valid_loss 1.028381, train_metric nan, valid_metric 0.044763
[1369919:MainThread](2026-01-11 22:06:02,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.020419, valid_loss 1.005144, train_metric nan, valid_metric 0.043196
[1369919:MainThread](2026-01-11 22:06:02,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.013620 to 1.005144, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:03,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.019897, valid_loss 1.006973, train_metric nan, valid_metric 0.042904
[1369919:MainThread](2026-01-11 22:06:03,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.012408, valid_loss 1.008968, train_metric nan, valid_metric 0.045303
[1369919:MainThread](2026-01-11 22:06:04,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.016524, valid_loss 1.005991, train_metric nan, valid_metric 0.035411
[1369919:MainThread](2026-01-11 22:06:04,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.007269, valid_loss 1.004192, train_metric nan, valid_metric 0.040343
[1369919:MainThread](2026-01-11 22:06:04,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005144 to 1.004192, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:05,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.005060, valid_loss 1.004876, train_metric nan, valid_metric 0.040569
[1369919:MainThread](2026-01-11 22:06:05,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.002682, valid_loss 1.003753, train_metric nan, valid_metric 0.036508
[1369919:MainThread](2026-01-11 22:06:05,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004192 to 1.003753, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:06,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.999852, valid_loss 1.002340, train_metric nan, valid_metric 0.037449
[1369919:MainThread](2026-01-11 22:06:06,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003753 to 1.002340, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:06,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.999221, valid_loss 1.004035, train_metric nan, valid_metric 0.047155
[1369919:MainThread](2026-01-11 22:06:07,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.001391, valid_loss 1.005052, train_metric nan, valid_metric 0.049007
[1369919:MainThread](2026-01-11 22:06:07,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.994801, valid_loss 1.009799, train_metric nan, valid_metric 0.043122
[1369919:MainThread](2026-01-11 22:06:08,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.998659, valid_loss 1.003084, train_metric nan, valid_metric 0.051720
[1369919:MainThread](2026-01-11 22:06:08,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.997090, valid_loss 1.002809, train_metric nan, valid_metric 0.047344
[1369919:MainThread](2026-01-11 22:06:09,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.992624, valid_loss 1.013681, train_metric nan, valid_metric 0.052625
[1369919:MainThread](2026-01-11 22:06:09,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.993256, valid_loss 1.001090, train_metric nan, valid_metric 0.048036
[1369919:MainThread](2026-01-11 22:06:10,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002340 to 1.001090, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:10,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.989338, valid_loss 1.001337, train_metric nan, valid_metric 0.050576
[1369919:MainThread](2026-01-11 22:06:11,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.987657, valid_loss 1.000140, train_metric nan, valid_metric 0.048031
[1369919:MainThread](2026-01-11 22:06:11,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001090 to 1.000140, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:11,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.993810, valid_loss 1.003041, train_metric nan, valid_metric 0.049900
[1369919:MainThread](2026-01-11 22:06:12,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.986720, valid_loss 1.003021, train_metric nan, valid_metric 0.043495
[1369919:MainThread](2026-01-11 22:06:12,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.991113, valid_loss 1.004792, train_metric nan, valid_metric 0.038509
[1369919:MainThread](2026-01-11 22:06:13,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.986432, valid_loss 1.004862, train_metric nan, valid_metric 0.051999
[1369919:MainThread](2026-01-11 22:06:13,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.986008, valid_loss 1.002437, train_metric nan, valid_metric 0.054785
[1369919:MainThread](2026-01-11 22:06:14,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.987667, valid_loss 1.000472, train_metric nan, valid_metric 0.054766
[1369919:MainThread](2026-01-11 22:06:15,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.990399, valid_loss 1.002448, train_metric nan, valid_metric 0.042568
[1369919:MainThread](2026-01-11 22:06:15,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.988456, valid_loss 1.000763, train_metric nan, valid_metric 0.053616
[1369919:MainThread](2026-01-11 22:06:16,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.990136, valid_loss 1.000052, train_metric nan, valid_metric 0.057326
[1369919:MainThread](2026-01-11 22:06:16,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000140 to 1.000052, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:16,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.991262, valid_loss 1.003922, train_metric nan, valid_metric 0.046669
[1369919:MainThread](2026-01-11 22:06:17,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.984258, valid_loss 1.000780, train_metric nan, valid_metric 0.050374
[1369919:MainThread](2026-01-11 22:06:17,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.985285, valid_loss 1.000276, train_metric nan, valid_metric 0.047860
[1369919:MainThread](2026-01-11 22:06:18,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.981305, valid_loss 0.999705, train_metric nan, valid_metric 0.051199
[1369919:MainThread](2026-01-11 22:06:18,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000052 to 0.999705, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:18,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.981743, valid_loss 1.001411, train_metric nan, valid_metric 0.048198
[1369919:MainThread](2026-01-11 22:06:19,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.989344, valid_loss 0.998876, train_metric nan, valid_metric 0.047729
[1369919:MainThread](2026-01-11 22:06:19,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999705 to 0.998876, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:20,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.982354, valid_loss 1.001331, train_metric nan, valid_metric 0.045866
[1369919:MainThread](2026-01-11 22:06:20,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.981532, valid_loss 1.001182, train_metric nan, valid_metric 0.045093
[1369919:MainThread](2026-01-11 22:06:21,028) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.985407, valid_loss 1.000064, train_metric nan, valid_metric 0.050546
[1369919:MainThread](2026-01-11 22:06:21,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.987632, valid_loss 0.999268, train_metric nan, valid_metric 0.051111
[1369919:MainThread](2026-01-11 22:06:22,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.984716, valid_loss 1.001236, train_metric nan, valid_metric 0.054541
[1369919:MainThread](2026-01-11 22:06:22,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.983036, valid_loss 0.999517, train_metric nan, valid_metric 0.047722
[1369919:MainThread](2026-01-11 22:06:23,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.983673, valid_loss 0.999801, train_metric nan, valid_metric 0.051770
[1369919:MainThread](2026-01-11 22:06:23,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.984598, valid_loss 1.000076, train_metric nan, valid_metric 0.049889
[1369919:MainThread](2026-01-11 22:06:24,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.984380, valid_loss 1.000274, train_metric nan, valid_metric 0.053227
[1369919:MainThread](2026-01-11 22:06:24,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.982916, valid_loss 1.001073, train_metric nan, valid_metric 0.050195
[1369919:MainThread](2026-01-11 22:06:25,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.983520, valid_loss 1.000618, train_metric nan, valid_metric 0.047699
[1369919:MainThread](2026-01-11 22:06:26,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.983176, valid_loss 1.001005, train_metric nan, valid_metric 0.047079
[1369919:MainThread](2026-01-11 22:06:26,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.982034, valid_loss 1.002043, train_metric nan, valid_metric 0.053202
[1369919:MainThread](2026-01-11 22:06:27,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.980784, valid_loss 1.000099, train_metric nan, valid_metric 0.049211
[1369919:MainThread](2026-01-11 22:06:27,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.982599, valid_loss 1.000558, train_metric nan, valid_metric 0.049137
[1369919:MainThread](2026-01-11 22:06:28,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.982825, valid_loss 0.999255, train_metric nan, valid_metric 0.051569
[1369919:MainThread](2026-01-11 22:06:28,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.985380, valid_loss 0.999748, train_metric nan, valid_metric 0.052562
[1369919:MainThread](2026-01-11 22:06:29,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.982137, valid_loss 0.999773, train_metric nan, valid_metric 0.049417
[1369919:MainThread](2026-01-11 22:06:30,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.981166, valid_loss 0.999962, train_metric nan, valid_metric 0.048517
[1369919:MainThread](2026-01-11 22:06:30,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.985084, valid_loss 0.998962, train_metric nan, valid_metric 0.051177
[1369919:MainThread](2026-01-11 22:06:31,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.984413, valid_loss 0.999871, train_metric nan, valid_metric 0.050710
[1369919:MainThread](2026-01-11 22:06:31,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.983132, valid_loss 0.999445, train_metric nan, valid_metric 0.054217
[1369919:MainThread](2026-01-11 22:06:32,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.982387, valid_loss 0.999082, train_metric nan, valid_metric 0.051340
[1369919:MainThread](2026-01-11 22:06:32,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.980819, valid_loss 0.999234, train_metric nan, valid_metric 0.051574
[1369919:MainThread](2026-01-11 22:06:33,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.979994, valid_loss 0.999552, train_metric nan, valid_metric 0.048116
[1369919:MainThread](2026-01-11 22:06:33,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.981953, valid_loss 1.000111, train_metric nan, valid_metric 0.047929
[1369919:MainThread](2026-01-11 22:06:34,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.976911, valid_loss 0.999266, train_metric nan, valid_metric 0.051563
[1369919:MainThread](2026-01-11 22:06:34,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.980866, valid_loss 0.999517, train_metric nan, valid_metric 0.051019
[1369919:MainThread](2026-01-11 22:06:35,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.982756, valid_loss 0.998593, train_metric nan, valid_metric 0.054802
[1369919:MainThread](2026-01-11 22:06:35,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998876 to 0.998593, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:35,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.983969, valid_loss 0.998924, train_metric nan, valid_metric 0.054625
[1369919:MainThread](2026-01-11 22:06:36,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.983232, valid_loss 0.999215, train_metric nan, valid_metric 0.051292
[1369919:MainThread](2026-01-11 22:06:36,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.984234, valid_loss 0.999056, train_metric nan, valid_metric 0.051270
[1369919:MainThread](2026-01-11 22:06:37,264) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.981642, valid_loss 0.999376, train_metric nan, valid_metric 0.052387
[1369919:MainThread](2026-01-11 22:06:37,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.981875, valid_loss 0.998463, train_metric nan, valid_metric 0.052194
[1369919:MainThread](2026-01-11 22:06:37,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998593 to 0.998463, save checkpoint.
[1369919:MainThread](2026-01-11 22:06:38,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.978809, valid_loss 0.998938, train_metric nan, valid_metric 0.050541
[1369919:MainThread](2026-01-11 22:06:38,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.977206, valid_loss 0.999829, train_metric nan, valid_metric 0.051052
[1369919:MainThread](2026-01-11 22:06:39,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.978269, valid_loss 1.000147, train_metric nan, valid_metric 0.050921
[1369919:MainThread](2026-01-11 22:06:40,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.976582, valid_loss 1.000124, train_metric nan, valid_metric 0.050253
[1369919:MainThread](2026-01-11 22:06:40,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.980243, valid_loss 1.000022, train_metric nan, valid_metric 0.051297
[1369919:MainThread](2026-01-11 22:06:41,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.980965, valid_loss 0.999671, train_metric nan, valid_metric 0.051143
[1369919:MainThread](2026-01-11 22:06:41,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.981026, valid_loss 1.000565, train_metric nan, valid_metric 0.051439
[1369919:MainThread](2026-01-11 22:06:42,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.980492, valid_loss 0.999633, train_metric nan, valid_metric 0.052228
[1369919:MainThread](2026-01-11 22:06:42,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.980000, valid_loss 0.999221, train_metric nan, valid_metric 0.050741
[1369919:MainThread](2026-01-11 22:06:43,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.983341, valid_loss 0.999937, train_metric nan, valid_metric 0.049573
[1369919:MainThread](2026-01-11 22:06:43,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.983360, valid_loss 0.999836, train_metric nan, valid_metric 0.050810
[1369919:MainThread](2026-01-11 22:06:44,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.979810, valid_loss 1.000652, train_metric nan, valid_metric 0.051651
[1369919:MainThread](2026-01-11 22:06:44,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.979231, valid_loss 0.999734, train_metric nan, valid_metric 0.052893
[1369919:MainThread](2026-01-11 22:06:45,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.975774, valid_loss 1.000182, train_metric nan, valid_metric 0.052302
[1369919:MainThread](2026-01-11 22:06:46,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.984471, valid_loss 0.999875, train_metric nan, valid_metric 0.051109
[1369919:MainThread](2026-01-11 22:06:46,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.981191, valid_loss 0.999088, train_metric nan, valid_metric 0.052563
[1369919:MainThread](2026-01-11 22:06:47,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.977533, valid_loss 0.999231, train_metric nan, valid_metric 0.051881
[1369919:MainThread](2026-01-11 22:06:47,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.980368, valid_loss 0.999148, train_metric nan, valid_metric 0.053797
[1369919:MainThread](2026-01-11 22:06:48,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.979185, valid_loss 0.999742, train_metric nan, valid_metric 0.053204
[1369919:MainThread](2026-01-11 22:06:48,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.975432, valid_loss 0.999938, train_metric nan, valid_metric 0.053047
[1369919:MainThread](2026-01-11 22:06:49,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.981265, valid_loss 1.000383, train_metric nan, valid_metric 0.053615
[1369919:MainThread](2026-01-11 22:06:49,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.978840, valid_loss 0.999629, train_metric nan, valid_metric 0.052098
[1369919:MainThread](2026-01-11 22:06:50,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.977649, valid_loss 1.000003, train_metric nan, valid_metric 0.052625
[1369919:MainThread](2026-01-11 22:06:51,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.979098, valid_loss 0.999689, train_metric nan, valid_metric 0.053583
[1369919:MainThread](2026-01-11 22:06:51,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.978031, valid_loss 0.999287, train_metric nan, valid_metric 0.052323
[1369919:MainThread](2026-01-11 22:06:52,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.979694, valid_loss 0.999226, train_metric nan, valid_metric 0.052247
[1369919:MainThread](2026-01-11 22:06:52,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.982280, valid_loss 0.999423, train_metric nan, valid_metric 0.052683
[1369919:MainThread](2026-01-11 22:06:53,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.976873, valid_loss 0.999646, train_metric nan, valid_metric 0.052311
[1369919:MainThread](2026-01-11 22:06:53,754) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.980901, valid_loss 0.999701, train_metric nan, valid_metric 0.051958
[1369919:MainThread](2026-01-11 22:06:54,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.984535, valid_loss 0.999210, train_metric nan, valid_metric 0.051451
[1369919:MainThread](2026-01-11 22:06:54,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.979889, valid_loss 0.999470, train_metric nan, valid_metric 0.052857
[1369919:MainThread](2026-01-11 22:06:55,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.980899, valid_loss 0.998924, train_metric nan, valid_metric 0.051305
[1369919:MainThread](2026-01-11 22:06:55,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.981195, valid_loss 0.999841, train_metric nan, valid_metric 0.051126
[1369919:MainThread](2026-01-11 22:06:56,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.980699, valid_loss 0.999474, train_metric nan, valid_metric 0.051568
[1369919:MainThread](2026-01-11 22:06:57,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.982028, valid_loss 0.999629, train_metric nan, valid_metric 0.051340
[1369919:MainThread](2026-01-11 22:06:57,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.979988, valid_loss 0.999654, train_metric nan, valid_metric 0.051130
[1369919:MainThread](2026-01-11 22:06:58,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.977679, valid_loss 0.999906, train_metric nan, valid_metric 0.050800
[1369919:MainThread](2026-01-11 22:06:58,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.977439, valid_loss 0.999664, train_metric nan, valid_metric 0.050918
[1369919:MainThread](2026-01-11 22:06:59,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.976510, valid_loss 0.999530, train_metric nan, valid_metric 0.051120
[1369919:MainThread](2026-01-11 22:06:59,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.975441, valid_loss 0.999712, train_metric nan, valid_metric 0.051547
[1369919:MainThread](2026-01-11 22:07:00,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.982333, valid_loss 0.999809, train_metric nan, valid_metric 0.051681
[1369919:MainThread](2026-01-11 22:07:00,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.980835, valid_loss 0.999969, train_metric nan, valid_metric 0.051416
[1369919:MainThread](2026-01-11 22:07:01,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.981066, valid_loss 0.999857, train_metric nan, valid_metric 0.051677
[1369919:MainThread](2026-01-11 22:07:02,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.978897, valid_loss 0.999819, train_metric nan, valid_metric 0.051755
[1369919:MainThread](2026-01-11 22:07:02,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.981623, valid_loss 0.999856, train_metric nan, valid_metric 0.051768
[1369919:MainThread](2026-01-11 22:07:03,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.978833, valid_loss 0.999859, train_metric nan, valid_metric 0.052312
[1369919:MainThread](2026-01-11 22:07:03,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.976538, valid_loss 0.999564, train_metric nan, valid_metric 0.052250
[1369919:MainThread](2026-01-11 22:07:04,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.980068, valid_loss 0.999382, train_metric nan, valid_metric 0.051688
[1369919:MainThread](2026-01-11 22:07:04,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.980388, valid_loss 0.999668, train_metric nan, valid_metric 0.051796
[1369919:MainThread](2026-01-11 22:07:05,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2460]: train_loss 0.977122, valid_loss 0.999781, train_metric nan, valid_metric 0.051754
[1369919:MainThread](2026-01-11 22:07:05,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:07:05.295 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:07:06.562 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 22:07:06.562 | INFO     | __main__:train_single_fold:593 -   IC=0.0298, ICIR=0.2664, RankIC=0.0472, RankICIR=0.4582
2026-01-11 22:07:06.562 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 22:07:06,568) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:07:32,811) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:07:32,812) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:07:40,217) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b91b9d10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 22.82it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 53.21it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 63.67it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:03, 70.22it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 73.93it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 75.58it/s]backtest loop:  23%|██▎       | 57/243 [00:00<00:02, 75.33it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:02, 75.45it/s]backtest loop:  31%|███       | 75/243 [00:01<00:02, 77.22it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 76.62it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 77.43it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 79.19it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 80.09it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 79.05it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 79.39it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 79.90it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 80.57it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 81.09it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 81.14it/s]backtest loop:  74%|███████▍  | 180/243 [00:02<00:00, 81.13it/s]backtest loop:  78%|███████▊  | 189/243 [00:02<00:00, 76.80it/s]backtest loop:  81%|████████  | 197/243 [00:02<00:00, 76.85it/s]backtest loop:  84%|████████▍ | 205/243 [00:02<00:00, 72.09it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 73.94it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 76.03it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 78.13it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.39it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.02it/s]
2026-01-11 22:07:43.439 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0822, Sharpe(w/cost)=-1.0370, MaxDD=-0.1480
2026-01-11 22:07:48.782 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 22:08:06.551 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:08:06.620 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_4_pred.parquet
2026-01-11 22:08:06.637 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 22:08:06.638 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 22:08:08.068 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0360
2026-01-11 22:08:09.448 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0436
2026-01-11 22:08:10.737 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0429
2026-01-11 22:08:12.045 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0441
2026-01-11 22:08:12.362 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0300, ICIR=0.2526, RankIC=0.0482
[1369919:MainThread](2026-01-11 22:08:12,369) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:08:35,282) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:08:35,283) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:08:42,033) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f717262ff90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.72it/s]backtest loop:   5%|▌         | 13/243 [00:00<00:03, 64.03it/s]backtest loop:   9%|▉         | 22/243 [00:00<00:02, 73.92it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 79.62it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 85.70it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 89.41it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:01, 91.13it/s]backtest loop:  29%|██▉       | 71/243 [00:00<00:01, 92.62it/s]backtest loop:  33%|███▎      | 81/243 [00:00<00:01, 92.26it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 93.10it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 92.87it/s]backtest loop:  46%|████▌     | 111/243 [00:01<00:01, 93.55it/s]backtest loop:  50%|████▉     | 121/243 [00:01<00:01, 89.30it/s]backtest loop:  54%|█████▍    | 131/243 [00:01<00:01, 91.26it/s]backtest loop:  58%|█████▊    | 141/243 [00:01<00:01, 92.32it/s]backtest loop:  62%|██████▏   | 151/243 [00:01<00:00, 93.08it/s]backtest loop:  66%|██████▋   | 161/243 [00:01<00:00, 93.36it/s]backtest loop:  70%|███████   | 171/243 [00:01<00:00, 93.50it/s]backtest loop:  74%|███████▍  | 181/243 [00:02<00:00, 93.89it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 90.96it/s]backtest loop:  83%|████████▎ | 201/243 [00:02<00:00, 92.52it/s]backtest loop:  87%|████████▋ | 211/243 [00:02<00:00, 93.43it/s]backtest loop:  91%|█████████ | 221/243 [00:02<00:00, 94.38it/s]backtest loop:  95%|█████████▌| 231/243 [00:02<00:00, 95.20it/s]backtest loop:  99%|█████████▉| 241/243 [00:02<00:00, 95.49it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 90.10it/s]
2026-01-11 22:08:44.750 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0482, Sharpe(w/cost)=-0.5658
2026-01-11 22:08:44.792 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:08:44.792 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 22:08:44.792 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:08:44.792 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 22:09:40,535) INFO - qlib.timer - [log.py:127] - Time cost: 55.740s | Loading data Done
[1369919:MainThread](2026-01-11 22:09:40,907) INFO - qlib.timer - [log.py:127] - Time cost: 0.090s | DropCol Done
[1369919:MainThread](2026-01-11 22:09:42,080) INFO - qlib.timer - [log.py:127] - Time cost: 1.172s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 22:09:42,598) INFO - qlib.timer - [log.py:127] - Time cost: 0.518s | Fillna Done
[1369919:MainThread](2026-01-11 22:09:43,320) INFO - qlib.timer - [log.py:127] - Time cost: 0.072s | DropCol Done
[1369919:MainThread](2026-01-11 22:09:43,468) INFO - qlib.timer - [log.py:127] - Time cost: 0.147s | DropnaLabel Done
[1369919:MainThread](2026-01-11 22:09:43,688) INFO - qlib.timer - [log.py:127] - Time cost: 0.219s | CSRankNorm Done
[1369919:MainThread](2026-01-11 22:09:43,690) INFO - qlib.timer - [log.py:127] - Time cost: 3.154s | fit & process data Done
[1369919:MainThread](2026-01-11 22:09:43,691) INFO - qlib.timer - [log.py:127] - Time cost: 58.897s | Init data Done
2026-01-11 22:09:43.691 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 22:09:43,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 22:09:43,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 22:09:43,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 22:09:43,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:09:43.706 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 22:09:44,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 22:09:46,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.226539, valid_loss 1.110379, train_metric nan, valid_metric 0.022421
[1369919:MainThread](2026-01-11 22:09:46,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.110379, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:46,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.080308, valid_loss 1.030419, train_metric nan, valid_metric 0.028911
[1369919:MainThread](2026-01-11 22:09:46,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.110379 to 1.030419, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:47,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.055790, valid_loss 1.024544, train_metric nan, valid_metric 0.028996
[1369919:MainThread](2026-01-11 22:09:47,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.030419 to 1.024544, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:47,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.037917, valid_loss 1.014203, train_metric nan, valid_metric 0.037563
[1369919:MainThread](2026-01-11 22:09:47,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.024544 to 1.014203, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:48,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.035790, valid_loss 1.007175, train_metric nan, valid_metric 0.035143
[1369919:MainThread](2026-01-11 22:09:48,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.014203 to 1.007175, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:48,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.018596, valid_loss 1.009980, train_metric nan, valid_metric 0.035858
[1369919:MainThread](2026-01-11 22:09:49,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.017886, valid_loss 1.011206, train_metric nan, valid_metric 0.051252
[1369919:MainThread](2026-01-11 22:09:49,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.011765, valid_loss 1.003010, train_metric nan, valid_metric 0.046012
[1369919:MainThread](2026-01-11 22:09:49,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007175 to 1.003010, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:49,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.008956, valid_loss 1.004957, train_metric nan, valid_metric 0.038886
[1369919:MainThread](2026-01-11 22:09:50,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.004270, valid_loss 1.001901, train_metric nan, valid_metric 0.043726
[1369919:MainThread](2026-01-11 22:09:50,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003010 to 1.001901, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:50,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.002002, valid_loss 1.005704, train_metric nan, valid_metric 0.040336
[1369919:MainThread](2026-01-11 22:09:51,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.002931, valid_loss 1.000009, train_metric nan, valid_metric 0.050258
[1369919:MainThread](2026-01-11 22:09:51,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001901 to 1.000009, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:51,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.003521, valid_loss 1.001863, train_metric nan, valid_metric 0.047834
[1369919:MainThread](2026-01-11 22:09:52,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.997295, valid_loss 1.003122, train_metric nan, valid_metric 0.049818
[1369919:MainThread](2026-01-11 22:09:52,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.999416, valid_loss 1.002455, train_metric nan, valid_metric 0.037085
[1369919:MainThread](2026-01-11 22:09:53,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.996688, valid_loss 1.001711, train_metric nan, valid_metric 0.042397
[1369919:MainThread](2026-01-11 22:09:53,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.991316, valid_loss 0.999323, train_metric nan, valid_metric 0.051196
[1369919:MainThread](2026-01-11 22:09:53,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000009 to 0.999323, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:54,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.995850, valid_loss 0.999279, train_metric nan, valid_metric 0.045590
[1369919:MainThread](2026-01-11 22:09:54,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999323 to 0.999279, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:55,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.991912, valid_loss 0.999056, train_metric nan, valid_metric 0.048070
[1369919:MainThread](2026-01-11 22:09:55,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999279 to 0.999056, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:55,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.996120, valid_loss 0.998888, train_metric nan, valid_metric 0.053021
[1369919:MainThread](2026-01-11 22:09:55,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999056 to 0.998888, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:56,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.992444, valid_loss 0.997843, train_metric nan, valid_metric 0.052590
[1369919:MainThread](2026-01-11 22:09:56,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998888 to 0.997843, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:56,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.993701, valid_loss 0.999130, train_metric nan, valid_metric 0.052763
[1369919:MainThread](2026-01-11 22:09:57,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.990240, valid_loss 1.004175, train_metric nan, valid_metric 0.055925
[1369919:MainThread](2026-01-11 22:09:57,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.992110, valid_loss 0.998278, train_metric nan, valid_metric 0.050186
[1369919:MainThread](2026-01-11 22:09:57,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.988304, valid_loss 0.998574, train_metric nan, valid_metric 0.054124
[1369919:MainThread](2026-01-11 22:09:58,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.989220, valid_loss 0.997746, train_metric nan, valid_metric 0.052363
[1369919:MainThread](2026-01-11 22:09:58,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997843 to 0.997746, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:58,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.986376, valid_loss 1.012433, train_metric nan, valid_metric 0.053428
[1369919:MainThread](2026-01-11 22:09:59,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.986376, valid_loss 0.997321, train_metric nan, valid_metric 0.053757
[1369919:MainThread](2026-01-11 22:09:59,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997746 to 0.997321, save checkpoint.
[1369919:MainThread](2026-01-11 22:09:59,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.986745, valid_loss 0.999183, train_metric nan, valid_metric 0.050582
[1369919:MainThread](2026-01-11 22:10:00,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.987637, valid_loss 0.998004, train_metric nan, valid_metric 0.050675
[1369919:MainThread](2026-01-11 22:10:01,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.983979, valid_loss 0.998718, train_metric nan, valid_metric 0.050713
[1369919:MainThread](2026-01-11 22:10:01,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.987435, valid_loss 0.998330, train_metric nan, valid_metric 0.053332
[1369919:MainThread](2026-01-11 22:10:02,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.986624, valid_loss 0.999348, train_metric nan, valid_metric 0.054052
[1369919:MainThread](2026-01-11 22:10:02,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.984784, valid_loss 0.997689, train_metric nan, valid_metric 0.054792
[1369919:MainThread](2026-01-11 22:10:03,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.988393, valid_loss 0.998398, train_metric nan, valid_metric 0.048581
[1369919:MainThread](2026-01-11 22:10:03,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.980203, valid_loss 0.999334, train_metric nan, valid_metric 0.053110
[1369919:MainThread](2026-01-11 22:10:04,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.985329, valid_loss 1.001214, train_metric nan, valid_metric 0.048925
[1369919:MainThread](2026-01-11 22:10:04,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.982467, valid_loss 0.998995, train_metric nan, valid_metric 0.052714
[1369919:MainThread](2026-01-11 22:10:05,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.987968, valid_loss 1.000194, train_metric nan, valid_metric 0.049005
[1369919:MainThread](2026-01-11 22:10:05,656) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.988504, valid_loss 0.998666, train_metric nan, valid_metric 0.054376
[1369919:MainThread](2026-01-11 22:10:06,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.985501, valid_loss 0.998312, train_metric nan, valid_metric 0.056173
[1369919:MainThread](2026-01-11 22:10:06,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.983371, valid_loss 0.999286, train_metric nan, valid_metric 0.053328
[1369919:MainThread](2026-01-11 22:10:07,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.984254, valid_loss 0.998266, train_metric nan, valid_metric 0.050785
[1369919:MainThread](2026-01-11 22:10:08,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.984165, valid_loss 0.999918, train_metric nan, valid_metric 0.052446
[1369919:MainThread](2026-01-11 22:10:08,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.984469, valid_loss 0.998024, train_metric nan, valid_metric 0.054243
[1369919:MainThread](2026-01-11 22:10:09,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.985959, valid_loss 0.998103, train_metric nan, valid_metric 0.055064
[1369919:MainThread](2026-01-11 22:10:09,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.987031, valid_loss 0.998877, train_metric nan, valid_metric 0.053047
[1369919:MainThread](2026-01-11 22:10:09,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.980712, valid_loss 0.998702, train_metric nan, valid_metric 0.054329
[1369919:MainThread](2026-01-11 22:10:10,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.987142, valid_loss 1.000577, train_metric nan, valid_metric 0.053494
[1369919:MainThread](2026-01-11 22:10:11,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.983844, valid_loss 0.998453, train_metric nan, valid_metric 0.051392
[1369919:MainThread](2026-01-11 22:10:11,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.985466, valid_loss 0.999398, train_metric nan, valid_metric 0.052630
[1369919:MainThread](2026-01-11 22:10:12,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.982710, valid_loss 0.999053, train_metric nan, valid_metric 0.053840
[1369919:MainThread](2026-01-11 22:10:12,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.986112, valid_loss 0.998700, train_metric nan, valid_metric 0.053098
[1369919:MainThread](2026-01-11 22:10:12,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.986972, valid_loss 0.998029, train_metric nan, valid_metric 0.058901
[1369919:MainThread](2026-01-11 22:10:13,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.981963, valid_loss 0.999282, train_metric nan, valid_metric 0.057760
[1369919:MainThread](2026-01-11 22:10:14,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.982501, valid_loss 0.997788, train_metric nan, valid_metric 0.056808
[1369919:MainThread](2026-01-11 22:10:14,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.984742, valid_loss 0.997979, train_metric nan, valid_metric 0.055585
[1369919:MainThread](2026-01-11 22:10:15,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.986813, valid_loss 0.998652, train_metric nan, valid_metric 0.052313
[1369919:MainThread](2026-01-11 22:10:15,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.986523, valid_loss 0.999037, train_metric nan, valid_metric 0.052031
[1369919:MainThread](2026-01-11 22:10:16,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.981585, valid_loss 0.998025, train_metric nan, valid_metric 0.051881
[1369919:MainThread](2026-01-11 22:10:16,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.981928, valid_loss 0.998216, train_metric nan, valid_metric 0.054352
[1369919:MainThread](2026-01-11 22:10:17,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.984515, valid_loss 0.998619, train_metric nan, valid_metric 0.056636
[1369919:MainThread](2026-01-11 22:10:17,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.976550, valid_loss 0.998544, train_metric nan, valid_metric 0.055824
[1369919:MainThread](2026-01-11 22:10:18,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.985202, valid_loss 0.998217, train_metric nan, valid_metric 0.051845
[1369919:MainThread](2026-01-11 22:10:18,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.978977, valid_loss 0.998836, train_metric nan, valid_metric 0.057167
[1369919:MainThread](2026-01-11 22:10:19,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.983469, valid_loss 0.998153, train_metric nan, valid_metric 0.054968
[1369919:MainThread](2026-01-11 22:10:19,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.978820, valid_loss 0.998463, train_metric nan, valid_metric 0.056038
[1369919:MainThread](2026-01-11 22:10:19,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.984211, valid_loss 0.997702, train_metric nan, valid_metric 0.055852
[1369919:MainThread](2026-01-11 22:10:20,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.980506, valid_loss 0.998148, train_metric nan, valid_metric 0.054545
[1369919:MainThread](2026-01-11 22:10:20,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.985053, valid_loss 0.999157, train_metric nan, valid_metric 0.053709
[1369919:MainThread](2026-01-11 22:10:21,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.980837, valid_loss 0.998587, train_metric nan, valid_metric 0.052972
[1369919:MainThread](2026-01-11 22:10:21,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.983337, valid_loss 0.998329, train_metric nan, valid_metric 0.055678
[1369919:MainThread](2026-01-11 22:10:21,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.982081, valid_loss 0.998698, train_metric nan, valid_metric 0.055496
[1369919:MainThread](2026-01-11 22:10:22,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.979474, valid_loss 0.998394, train_metric nan, valid_metric 0.054336
[1369919:MainThread](2026-01-11 22:10:22,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.984069, valid_loss 0.999026, train_metric nan, valid_metric 0.053807
[1369919:MainThread](2026-01-11 22:10:23,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.982471, valid_loss 0.998270, train_metric nan, valid_metric 0.052726
[1369919:MainThread](2026-01-11 22:10:23,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.981788, valid_loss 0.998095, train_metric nan, valid_metric 0.054704
[1369919:MainThread](2026-01-11 22:10:24,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.987180, valid_loss 0.998405, train_metric nan, valid_metric 0.054484
[1369919:MainThread](2026-01-11 22:10:24,114) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:10:24.127 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:10:25.295 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 22:10:25.295 | INFO     | __main__:train_single_fold:593 -   IC=0.0113, ICIR=0.1163, RankIC=0.0284, RankICIR=0.3037
2026-01-11 22:10:25.295 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 22:10:25,301) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:10:50,403) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:10:50,404) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:10:57,457) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b95af990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 37.57it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:03, 60.64it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 66.47it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 70.54it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 73.40it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 76.04it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 78.39it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 77.96it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 78.41it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 77.24it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 77.10it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 78.02it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 77.50it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 78.14it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 78.93it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 78.95it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 79.47it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 79.65it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 79.64it/s]backtest loop:  73%|███████▎  | 178/243 [00:02<00:00, 78.60it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 77.90it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 76.77it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 77.12it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 78.10it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 78.64it/s]backtest loop:  96%|█████████▌| 233/243 [00:03<00:00, 78.94it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.23it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.04it/s]
2026-01-11 22:11:00.630 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1311, Sharpe(w/cost)=1.4842, MaxDD=-0.0727
2026-01-11 22:11:04.243 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 22:11:20.760 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:11:20.833 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_5_pred.parquet
2026-01-11 22:11:20.850 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 22:11:20.850 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 22:11:22.165 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0196
2026-01-11 22:11:23.642 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0196
2026-01-11 22:11:24.958 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0271
2026-01-11 22:11:26.424 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0246
2026-01-11 22:11:27.429 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0252
2026-01-11 22:11:27.755 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0130, ICIR=0.1189, RankIC=0.0284
[1369919:MainThread](2026-01-11 22:11:27,761) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:11:57,809) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:11:57,810) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:12:06,105) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71bba2f990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.22it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 51.72it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 64.00it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 68.89it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 70.17it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 73.24it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 76.17it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 77.15it/s]backtest loop:  30%|███       | 73/243 [00:01<00:02, 80.79it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 76.52it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 77.53it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 78.02it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 78.31it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 78.65it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 80.31it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 80.76it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 81.50it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 81.88it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 81.72it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 81.39it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 78.07it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 79.72it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 81.48it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 81.98it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 82.84it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 82.87it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.78it/s]
2026-01-11 22:12:09.253 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0483, Sharpe(w/cost)=0.5379
2026-01-11 22:12:09.365 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:12:09.365 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 22:12:09.365 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:12:09.365 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 22:13:14,621) INFO - qlib.timer - [log.py:127] - Time cost: 65.253s | Loading data Done
[1369919:MainThread](2026-01-11 22:13:14,959) INFO - qlib.timer - [log.py:127] - Time cost: 0.083s | DropCol Done
[1369919:MainThread](2026-01-11 22:13:16,004) INFO - qlib.timer - [log.py:127] - Time cost: 1.043s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 22:13:16,549) INFO - qlib.timer - [log.py:127] - Time cost: 0.544s | Fillna Done
[1369919:MainThread](2026-01-11 22:13:17,405) INFO - qlib.timer - [log.py:127] - Time cost: 0.080s | DropCol Done
[1369919:MainThread](2026-01-11 22:13:17,563) INFO - qlib.timer - [log.py:127] - Time cost: 0.157s | DropnaLabel Done
[1369919:MainThread](2026-01-11 22:13:17,776) INFO - qlib.timer - [log.py:127] - Time cost: 0.212s | CSRankNorm Done
[1369919:MainThread](2026-01-11 22:13:17,778) INFO - qlib.timer - [log.py:127] - Time cost: 3.157s | fit & process data Done
[1369919:MainThread](2026-01-11 22:13:17,779) INFO - qlib.timer - [log.py:127] - Time cost: 68.412s | Init data Done
2026-01-11 22:13:17.779 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 22:13:17,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 22:13:17,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 22:13:17,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 22:13:17,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:13:17.795 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 22:13:19,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 22:13:20,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.176799, valid_loss 1.058698, train_metric nan, valid_metric 0.019016
[1369919:MainThread](2026-01-11 22:13:20,139) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.058698, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:20,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.067119, valid_loss 1.018582, train_metric nan, valid_metric 0.025680
[1369919:MainThread](2026-01-11 22:13:20,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.058698 to 1.018582, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:21,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.037789, valid_loss 1.013492, train_metric nan, valid_metric 0.028820
[1369919:MainThread](2026-01-11 22:13:21,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018582 to 1.013492, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:21,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.027328, valid_loss 1.012434, train_metric nan, valid_metric 0.014669
[1369919:MainThread](2026-01-11 22:13:21,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.013492 to 1.012434, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:22,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.024665, valid_loss 1.009253, train_metric nan, valid_metric 0.031149
[1369919:MainThread](2026-01-11 22:13:22,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012434 to 1.009253, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:22,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.018937, valid_loss 1.006519, train_metric nan, valid_metric 0.035138
[1369919:MainThread](2026-01-11 22:13:22,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009253 to 1.006519, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:23,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.013881, valid_loss 1.003258, train_metric nan, valid_metric 0.035512
[1369919:MainThread](2026-01-11 22:13:23,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006519 to 1.003258, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:24,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.007934, valid_loss 1.002698, train_metric nan, valid_metric 0.034726
[1369919:MainThread](2026-01-11 22:13:24,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003258 to 1.002698, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:24,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.000848, valid_loss 1.010552, train_metric nan, valid_metric 0.037302
[1369919:MainThread](2026-01-11 22:13:25,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 0.998468, valid_loss 1.002495, train_metric nan, valid_metric 0.037961
[1369919:MainThread](2026-01-11 22:13:25,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002698 to 1.002495, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:25,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 0.998165, valid_loss 1.002313, train_metric nan, valid_metric 0.039017
[1369919:MainThread](2026-01-11 22:13:25,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002495 to 1.002313, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:26,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.001026, valid_loss 1.002071, train_metric nan, valid_metric 0.040249
[1369919:MainThread](2026-01-11 22:13:26,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002313 to 1.002071, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:26,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 0.998754, valid_loss 0.998802, train_metric nan, valid_metric 0.039269
[1369919:MainThread](2026-01-11 22:13:26,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002071 to 0.998802, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:27,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.991867, valid_loss 0.999840, train_metric nan, valid_metric 0.038994
[1369919:MainThread](2026-01-11 22:13:27,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.997232, valid_loss 1.001222, train_metric nan, valid_metric 0.034788
[1369919:MainThread](2026-01-11 22:13:28,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.995033, valid_loss 1.001440, train_metric nan, valid_metric 0.038364
[1369919:MainThread](2026-01-11 22:13:28,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.991013, valid_loss 1.000951, train_metric nan, valid_metric 0.040825
[1369919:MainThread](2026-01-11 22:13:29,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.995190, valid_loss 1.000910, train_metric nan, valid_metric 0.041458
[1369919:MainThread](2026-01-11 22:13:30,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.991235, valid_loss 1.000763, train_metric nan, valid_metric 0.042062
[1369919:MainThread](2026-01-11 22:13:30,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.991700, valid_loss 0.999445, train_metric nan, valid_metric 0.038412
[1369919:MainThread](2026-01-11 22:13:31,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.994564, valid_loss 0.999088, train_metric nan, valid_metric 0.046206
[1369919:MainThread](2026-01-11 22:13:31,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.992918, valid_loss 1.001646, train_metric nan, valid_metric 0.043119
[1369919:MainThread](2026-01-11 22:13:32,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.992013, valid_loss 0.998965, train_metric nan, valid_metric 0.045212
[1369919:MainThread](2026-01-11 22:13:32,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.990533, valid_loss 0.999143, train_metric nan, valid_metric 0.041400
[1369919:MainThread](2026-01-11 22:13:33,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.988105, valid_loss 0.999344, train_metric nan, valid_metric 0.042827
[1369919:MainThread](2026-01-11 22:13:33,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.991351, valid_loss 0.998422, train_metric nan, valid_metric 0.045647
[1369919:MainThread](2026-01-11 22:13:33,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998802 to 0.998422, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:34,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.987879, valid_loss 1.000000, train_metric nan, valid_metric 0.043131
[1369919:MainThread](2026-01-11 22:13:35,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.988880, valid_loss 0.998792, train_metric nan, valid_metric 0.046125
[1369919:MainThread](2026-01-11 22:13:35,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.988559, valid_loss 0.998706, train_metric nan, valid_metric 0.042697
[1369919:MainThread](2026-01-11 22:13:36,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.990054, valid_loss 0.998901, train_metric nan, valid_metric 0.041003
[1369919:MainThread](2026-01-11 22:13:36,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.988004, valid_loss 0.999334, train_metric nan, valid_metric 0.044318
[1369919:MainThread](2026-01-11 22:13:37,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.985607, valid_loss 0.998318, train_metric nan, valid_metric 0.045374
[1369919:MainThread](2026-01-11 22:13:37,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998422 to 0.998318, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:37,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.985797, valid_loss 0.998006, train_metric nan, valid_metric 0.046597
[1369919:MainThread](2026-01-11 22:13:37,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998318 to 0.998006, save checkpoint.
[1369919:MainThread](2026-01-11 22:13:38,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.987255, valid_loss 1.001544, train_metric nan, valid_metric 0.045497
[1369919:MainThread](2026-01-11 22:13:39,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.990657, valid_loss 0.998666, train_metric nan, valid_metric 0.042488
[1369919:MainThread](2026-01-11 22:13:39,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.989699, valid_loss 0.998427, train_metric nan, valid_metric 0.045317
[1369919:MainThread](2026-01-11 22:13:39,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.986445, valid_loss 0.998783, train_metric nan, valid_metric 0.042827
[1369919:MainThread](2026-01-11 22:13:40,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.983292, valid_loss 1.000045, train_metric nan, valid_metric 0.046652
[1369919:MainThread](2026-01-11 22:13:41,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.987040, valid_loss 0.998832, train_metric nan, valid_metric 0.046396
[1369919:MainThread](2026-01-11 22:13:41,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.985400, valid_loss 1.000260, train_metric nan, valid_metric 0.043388
[1369919:MainThread](2026-01-11 22:13:42,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.986438, valid_loss 0.998837, train_metric nan, valid_metric 0.043167
[1369919:MainThread](2026-01-11 22:13:43,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.984662, valid_loss 0.998940, train_metric nan, valid_metric 0.045713
[1369919:MainThread](2026-01-11 22:13:43,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.988850, valid_loss 0.998456, train_metric nan, valid_metric 0.044047
[1369919:MainThread](2026-01-11 22:13:44,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.989057, valid_loss 0.999121, train_metric nan, valid_metric 0.042325
[1369919:MainThread](2026-01-11 22:13:44,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.984607, valid_loss 0.999315, train_metric nan, valid_metric 0.044268
[1369919:MainThread](2026-01-11 22:13:45,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.982183, valid_loss 0.998159, train_metric nan, valid_metric 0.043959
[1369919:MainThread](2026-01-11 22:13:46,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.985934, valid_loss 0.998742, train_metric nan, valid_metric 0.044889
[1369919:MainThread](2026-01-11 22:13:46,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.986194, valid_loss 0.998670, train_metric nan, valid_metric 0.045626
[1369919:MainThread](2026-01-11 22:13:47,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.985120, valid_loss 0.998836, train_metric nan, valid_metric 0.042880
[1369919:MainThread](2026-01-11 22:13:47,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.986480, valid_loss 0.998758, train_metric nan, valid_metric 0.042830
[1369919:MainThread](2026-01-11 22:13:48,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.985200, valid_loss 0.998323, train_metric nan, valid_metric 0.044437
[1369919:MainThread](2026-01-11 22:13:48,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.990587, valid_loss 0.999100, train_metric nan, valid_metric 0.044571
[1369919:MainThread](2026-01-11 22:13:49,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.985574, valid_loss 0.999823, train_metric nan, valid_metric 0.045451
[1369919:MainThread](2026-01-11 22:13:49,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.987696, valid_loss 1.000868, train_metric nan, valid_metric 0.043600
[1369919:MainThread](2026-01-11 22:13:50,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.986161, valid_loss 1.000498, train_metric nan, valid_metric 0.044017
[1369919:MainThread](2026-01-11 22:13:51,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.991203, valid_loss 0.999741, train_metric nan, valid_metric 0.044631
[1369919:MainThread](2026-01-11 22:13:51,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.983799, valid_loss 0.999370, train_metric nan, valid_metric 0.044274
[1369919:MainThread](2026-01-11 22:13:52,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.986323, valid_loss 0.999453, train_metric nan, valid_metric 0.044526
[1369919:MainThread](2026-01-11 22:13:52,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.987303, valid_loss 0.999006, train_metric nan, valid_metric 0.044040
[1369919:MainThread](2026-01-11 22:13:53,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.986750, valid_loss 0.999366, train_metric nan, valid_metric 0.044503
[1369919:MainThread](2026-01-11 22:13:54,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.985230, valid_loss 0.998898, train_metric nan, valid_metric 0.044772
[1369919:MainThread](2026-01-11 22:13:54,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.983390, valid_loss 0.999622, train_metric nan, valid_metric 0.044106
[1369919:MainThread](2026-01-11 22:13:55,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.984688, valid_loss 0.999997, train_metric nan, valid_metric 0.044155
[1369919:MainThread](2026-01-11 22:13:55,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.985576, valid_loss 0.999681, train_metric nan, valid_metric 0.043517
[1369919:MainThread](2026-01-11 22:13:56,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.985152, valid_loss 0.999695, train_metric nan, valid_metric 0.045172
[1369919:MainThread](2026-01-11 22:13:56,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.984125, valid_loss 0.999762, train_metric nan, valid_metric 0.042733
[1369919:MainThread](2026-01-11 22:13:57,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.987346, valid_loss 0.998822, train_metric nan, valid_metric 0.042700
[1369919:MainThread](2026-01-11 22:13:58,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.983827, valid_loss 0.998830, train_metric nan, valid_metric 0.044474
[1369919:MainThread](2026-01-11 22:13:58,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.984599, valid_loss 0.999344, train_metric nan, valid_metric 0.045863
[1369919:MainThread](2026-01-11 22:13:59,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.989301, valid_loss 0.998670, train_metric nan, valid_metric 0.045380
[1369919:MainThread](2026-01-11 22:13:59,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.988020, valid_loss 0.998450, train_metric nan, valid_metric 0.044194
[1369919:MainThread](2026-01-11 22:14:00,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.985475, valid_loss 0.998612, train_metric nan, valid_metric 0.043356
[1369919:MainThread](2026-01-11 22:14:00,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.985257, valid_loss 0.998936, train_metric nan, valid_metric 0.044282
[1369919:MainThread](2026-01-11 22:14:01,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.986365, valid_loss 0.999228, train_metric nan, valid_metric 0.044024
[1369919:MainThread](2026-01-11 22:14:02,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.980232, valid_loss 0.999348, train_metric nan, valid_metric 0.045046
[1369919:MainThread](2026-01-11 22:14:02,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.985766, valid_loss 0.999322, train_metric nan, valid_metric 0.045380
[1369919:MainThread](2026-01-11 22:14:03,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.986703, valid_loss 0.999120, train_metric nan, valid_metric 0.043246
[1369919:MainThread](2026-01-11 22:14:03,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.986392, valid_loss 0.999297, train_metric nan, valid_metric 0.043881
[1369919:MainThread](2026-01-11 22:14:04,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.984001, valid_loss 0.998946, train_metric nan, valid_metric 0.044977
[1369919:MainThread](2026-01-11 22:14:04,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.982302, valid_loss 0.998978, train_metric nan, valid_metric 0.044635
[1369919:MainThread](2026-01-11 22:14:05,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.985111, valid_loss 0.998946, train_metric nan, valid_metric 0.043966
[1369919:MainThread](2026-01-11 22:14:05,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.987185, valid_loss 0.999106, train_metric nan, valid_metric 0.044352
[1369919:MainThread](2026-01-11 22:14:06,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.985724, valid_loss 0.999383, train_metric nan, valid_metric 0.044613
[1369919:MainThread](2026-01-11 22:14:06,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:14:06.282 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:14:07.706 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 22:14:07.707 | INFO     | __main__:train_single_fold:593 -   IC=0.0267, ICIR=0.2503, RankIC=0.0485, RankICIR=0.4749
2026-01-11 22:14:07.707 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 22:14:07,714) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:14:39,702) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:14:39,703) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:14:49,002) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71725df990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.31it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 48.44it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 63.17it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 69.85it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 73.84it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 75.57it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 77.06it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 75.96it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 77.01it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 76.17it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 76.47it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 76.85it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 80.19it/s]backtest loop:  50%|█████     | 121/242 [00:01<00:01, 79.22it/s]backtest loop:  53%|█████▎    | 129/242 [00:01<00:01, 77.95it/s]backtest loop:  57%|█████▋    | 138/242 [00:01<00:01, 77.57it/s]backtest loop:  61%|██████    | 147/242 [00:01<00:01, 80.66it/s]backtest loop:  64%|██████▍   | 156/242 [00:02<00:01, 79.50it/s]backtest loop:  68%|██████▊   | 164/242 [00:02<00:00, 78.27it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 76.54it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 77.73it/s]backtest loop:  79%|███████▉  | 191/242 [00:02<00:00, 80.64it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 79.96it/s]backtest loop:  86%|████████▋ | 209/242 [00:02<00:00, 78.51it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 75.11it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 76.79it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 80.21it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.95it/s]
2026-01-11 22:14:52.212 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1169, Sharpe(w/cost)=1.5777, MaxDD=-0.0534
2026-01-11 22:14:56.022 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 22:15:11.575 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:15:11.679 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_6_pred.parquet
2026-01-11 22:15:11.699 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 22:15:11.699 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 22:15:13.124 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0335
2026-01-11 22:15:14.480 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0328
2026-01-11 22:15:15.851 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0346
2026-01-11 22:15:17.341 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0351
2026-01-11 22:15:18.730 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0377
2026-01-11 22:15:20.099 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0438
2026-01-11 22:15:20.491 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0281, ICIR=0.2435, RankIC=0.0472
[1369919:MainThread](2026-01-11 22:15:20,497) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:15:53,672) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:15:53,673) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:16:03,136) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b845db10>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.37it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 51.49it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.75it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 71.26it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:02, 72.97it/s]backtest loop:  18%|█▊        | 44/242 [00:00<00:02, 74.34it/s]backtest loop:  22%|██▏       | 54/242 [00:00<00:02, 77.56it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 76.00it/s]backtest loop:  30%|██▉       | 72/242 [00:01<00:02, 77.28it/s]backtest loop:  33%|███▎      | 80/242 [00:01<00:02, 76.65it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:01, 77.29it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 76.96it/s]backtest loop:  45%|████▍     | 108/242 [00:01<00:01, 78.43it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 78.94it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 79.93it/s]backtest loop:  57%|█████▋    | 138/242 [00:01<00:01, 79.82it/s]backtest loop:  60%|██████    | 146/242 [00:01<00:01, 78.72it/s]backtest loop:  64%|██████▎   | 154/242 [00:02<00:01, 78.27it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:01, 78.07it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 78.36it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 80.12it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 80.79it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 81.64it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 81.86it/s]backtest loop:  91%|█████████▏| 221/242 [00:02<00:00, 82.91it/s]backtest loop:  95%|█████████▌| 230/242 [00:02<00:00, 82.15it/s]backtest loop:  99%|█████████▉| 239/242 [00:03<00:00, 81.47it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 77.06it/s]
2026-01-11 22:16:06.301 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1453, Sharpe(w/cost)=2.0522
2026-01-11 22:16:06.348 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:16:06.348 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 22:16:06.348 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:16:06.348 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 22:17:13,631) INFO - qlib.timer - [log.py:127] - Time cost: 67.281s | Loading data Done
[1369919:MainThread](2026-01-11 22:17:13,968) INFO - qlib.timer - [log.py:127] - Time cost: 0.080s | DropCol Done
[1369919:MainThread](2026-01-11 22:17:14,866) INFO - qlib.timer - [log.py:127] - Time cost: 0.896s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 22:17:15,420) INFO - qlib.timer - [log.py:127] - Time cost: 0.553s | Fillna Done
[1369919:MainThread](2026-01-11 22:17:16,168) INFO - qlib.timer - [log.py:127] - Time cost: 0.082s | DropCol Done
[1369919:MainThread](2026-01-11 22:17:16,328) INFO - qlib.timer - [log.py:127] - Time cost: 0.159s | DropnaLabel Done
[1369919:MainThread](2026-01-11 22:17:16,543) INFO - qlib.timer - [log.py:127] - Time cost: 0.214s | CSRankNorm Done
[1369919:MainThread](2026-01-11 22:17:16,545) INFO - qlib.timer - [log.py:127] - Time cost: 2.913s | fit & process data Done
[1369919:MainThread](2026-01-11 22:17:16,545) INFO - qlib.timer - [log.py:127] - Time cost: 70.196s | Init data Done
2026-01-11 22:17:16.546 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 22:17:16,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 22:17:16,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 22:17:16,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 22:17:16,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:17:16.561 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 22:17:18,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 22:17:18,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.237782, valid_loss 1.048473, train_metric nan, valid_metric 0.018013
[1369919:MainThread](2026-01-11 22:17:18,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.048473, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:19,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.092293, valid_loss 1.022042, train_metric nan, valid_metric 0.024983
[1369919:MainThread](2026-01-11 22:17:19,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.048473 to 1.022042, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:20,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.057628, valid_loss 1.012578, train_metric nan, valid_metric 0.030741
[1369919:MainThread](2026-01-11 22:17:20,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.022042 to 1.012578, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:20,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.048403, valid_loss 1.010518, train_metric nan, valid_metric 0.027195
[1369919:MainThread](2026-01-11 22:17:20,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012578 to 1.010518, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:21,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.039904, valid_loss 1.011594, train_metric nan, valid_metric 0.032536
[1369919:MainThread](2026-01-11 22:17:21,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.029329, valid_loss 1.004291, train_metric nan, valid_metric 0.030120
[1369919:MainThread](2026-01-11 22:17:21,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.010518 to 1.004291, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:22,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.030385, valid_loss 1.004763, train_metric nan, valid_metric 0.031123
[1369919:MainThread](2026-01-11 22:17:22,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.029229, valid_loss 1.004761, train_metric nan, valid_metric 0.024444
[1369919:MainThread](2026-01-11 22:17:23,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.022224, valid_loss 1.006994, train_metric nan, valid_metric 0.037188
[1369919:MainThread](2026-01-11 22:17:23,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.016092, valid_loss 1.002156, train_metric nan, valid_metric 0.040971
[1369919:MainThread](2026-01-11 22:17:23,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004291 to 1.002156, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:24,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.015523, valid_loss 1.001821, train_metric nan, valid_metric 0.033174
[1369919:MainThread](2026-01-11 22:17:24,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002156 to 1.001821, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:25,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.010342, valid_loss 1.005268, train_metric nan, valid_metric 0.030542
[1369919:MainThread](2026-01-11 22:17:25,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.012651, valid_loss 1.000137, train_metric nan, valid_metric 0.035452
[1369919:MainThread](2026-01-11 22:17:25,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001821 to 1.000137, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:26,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.005238, valid_loss 1.002055, train_metric nan, valid_metric 0.023236
[1369919:MainThread](2026-01-11 22:17:26,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.010731, valid_loss 0.998776, train_metric nan, valid_metric 0.039235
[1369919:MainThread](2026-01-11 22:17:26,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000137 to 0.998776, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:27,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.004298, valid_loss 1.001479, train_metric nan, valid_metric 0.040697
[1369919:MainThread](2026-01-11 22:17:27,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.008188, valid_loss 1.000494, train_metric nan, valid_metric 0.041823
[1369919:MainThread](2026-01-11 22:17:28,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.999728, valid_loss 0.999288, train_metric nan, valid_metric 0.034654
[1369919:MainThread](2026-01-11 22:17:29,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.004416, valid_loss 1.000372, train_metric nan, valid_metric 0.039455
[1369919:MainThread](2026-01-11 22:17:29,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.001630, valid_loss 1.001605, train_metric nan, valid_metric 0.042213
[1369919:MainThread](2026-01-11 22:17:30,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.997209, valid_loss 0.998561, train_metric nan, valid_metric 0.043575
[1369919:MainThread](2026-01-11 22:17:30,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998776 to 0.998561, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:30,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.001129, valid_loss 1.000985, train_metric nan, valid_metric 0.026482
[1369919:MainThread](2026-01-11 22:17:31,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.997653, valid_loss 0.999834, train_metric nan, valid_metric 0.029115
[1369919:MainThread](2026-01-11 22:17:31,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.995868, valid_loss 0.998339, train_metric nan, valid_metric 0.044201
[1369919:MainThread](2026-01-11 22:17:31,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998561 to 0.998339, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:32,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.000211, valid_loss 0.998904, train_metric nan, valid_metric 0.037516
[1369919:MainThread](2026-01-11 22:17:33,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.998871, valid_loss 0.998253, train_metric nan, valid_metric 0.042533
[1369919:MainThread](2026-01-11 22:17:33,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998339 to 0.998253, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:33,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.995316, valid_loss 0.999067, train_metric nan, valid_metric 0.042100
[1369919:MainThread](2026-01-11 22:17:34,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.991420, valid_loss 1.000389, train_metric nan, valid_metric 0.033541
[1369919:MainThread](2026-01-11 22:17:34,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.994577, valid_loss 1.000613, train_metric nan, valid_metric 0.043065
[1369919:MainThread](2026-01-11 22:17:35,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.994469, valid_loss 0.997171, train_metric nan, valid_metric 0.047247
[1369919:MainThread](2026-01-11 22:17:35,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998253 to 0.997171, save checkpoint.
[1369919:MainThread](2026-01-11 22:17:35,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.990597, valid_loss 0.998380, train_metric nan, valid_metric 0.043736
[1369919:MainThread](2026-01-11 22:17:36,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.990960, valid_loss 1.003607, train_metric nan, valid_metric 0.035404
[1369919:MainThread](2026-01-11 22:17:37,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.992405, valid_loss 0.998189, train_metric nan, valid_metric 0.039274
[1369919:MainThread](2026-01-11 22:17:37,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.993355, valid_loss 0.999133, train_metric nan, valid_metric 0.039117
[1369919:MainThread](2026-01-11 22:17:38,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.988388, valid_loss 0.998091, train_metric nan, valid_metric 0.041785
[1369919:MainThread](2026-01-11 22:17:38,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.990134, valid_loss 0.998533, train_metric nan, valid_metric 0.033920
[1369919:MainThread](2026-01-11 22:17:39,326) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.992951, valid_loss 0.999642, train_metric nan, valid_metric 0.033212
[1369919:MainThread](2026-01-11 22:17:39,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.991092, valid_loss 0.998403, train_metric nan, valid_metric 0.035121
[1369919:MainThread](2026-01-11 22:17:40,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.989040, valid_loss 0.998756, train_metric nan, valid_metric 0.036802
[1369919:MainThread](2026-01-11 22:17:40,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.993499, valid_loss 0.997432, train_metric nan, valid_metric 0.040353
[1369919:MainThread](2026-01-11 22:17:41,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.988963, valid_loss 0.997996, train_metric nan, valid_metric 0.042536
[1369919:MainThread](2026-01-11 22:17:41,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.997095, valid_loss 0.998710, train_metric nan, valid_metric 0.040637
[1369919:MainThread](2026-01-11 22:17:42,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.989003, valid_loss 0.997788, train_metric nan, valid_metric 0.044257
[1369919:MainThread](2026-01-11 22:17:43,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.986508, valid_loss 0.997298, train_metric nan, valid_metric 0.046348
[1369919:MainThread](2026-01-11 22:17:43,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.992168, valid_loss 0.998175, train_metric nan, valid_metric 0.038992
[1369919:MainThread](2026-01-11 22:17:44,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.989272, valid_loss 0.998199, train_metric nan, valid_metric 0.036969
[1369919:MainThread](2026-01-11 22:17:44,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.991157, valid_loss 0.997760, train_metric nan, valid_metric 0.039161
[1369919:MainThread](2026-01-11 22:17:45,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.989568, valid_loss 0.998416, train_metric nan, valid_metric 0.045097
[1369919:MainThread](2026-01-11 22:17:45,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.988744, valid_loss 0.998657, train_metric nan, valid_metric 0.037875
[1369919:MainThread](2026-01-11 22:17:46,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.987884, valid_loss 0.997903, train_metric nan, valid_metric 0.045043
[1369919:MainThread](2026-01-11 22:17:47,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.988047, valid_loss 0.997912, train_metric nan, valid_metric 0.042803
[1369919:MainThread](2026-01-11 22:17:47,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.991080, valid_loss 0.997747, train_metric nan, valid_metric 0.044340
[1369919:MainThread](2026-01-11 22:17:48,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.989075, valid_loss 0.998561, train_metric nan, valid_metric 0.040053
[1369919:MainThread](2026-01-11 22:17:48,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.992060, valid_loss 0.997792, train_metric nan, valid_metric 0.042107
[1369919:MainThread](2026-01-11 22:17:49,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.986768, valid_loss 0.998115, train_metric nan, valid_metric 0.039713
[1369919:MainThread](2026-01-11 22:17:49,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.990122, valid_loss 0.998540, train_metric nan, valid_metric 0.040102
[1369919:MainThread](2026-01-11 22:17:50,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.989589, valid_loss 0.998720, train_metric nan, valid_metric 0.038924
[1369919:MainThread](2026-01-11 22:17:50,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.987311, valid_loss 0.998118, train_metric nan, valid_metric 0.043151
[1369919:MainThread](2026-01-11 22:17:51,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.987061, valid_loss 0.997961, train_metric nan, valid_metric 0.041359
[1369919:MainThread](2026-01-11 22:17:51,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.988289, valid_loss 0.998006, train_metric nan, valid_metric 0.041288
[1369919:MainThread](2026-01-11 22:17:52,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.989775, valid_loss 0.998744, train_metric nan, valid_metric 0.040173
[1369919:MainThread](2026-01-11 22:17:53,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.987426, valid_loss 0.998340, train_metric nan, valid_metric 0.044133
[1369919:MainThread](2026-01-11 22:17:53,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.989557, valid_loss 0.997888, train_metric nan, valid_metric 0.042390
[1369919:MainThread](2026-01-11 22:17:54,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.988171, valid_loss 0.998251, train_metric nan, valid_metric 0.042810
[1369919:MainThread](2026-01-11 22:17:54,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.987862, valid_loss 0.999124, train_metric nan, valid_metric 0.040493
[1369919:MainThread](2026-01-11 22:17:55,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.986986, valid_loss 0.998008, train_metric nan, valid_metric 0.040138
[1369919:MainThread](2026-01-11 22:17:55,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.987312, valid_loss 0.998060, train_metric nan, valid_metric 0.041247
[1369919:MainThread](2026-01-11 22:17:56,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.988725, valid_loss 0.998116, train_metric nan, valid_metric 0.039678
[1369919:MainThread](2026-01-11 22:17:56,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.984145, valid_loss 0.998506, train_metric nan, valid_metric 0.042980
[1369919:MainThread](2026-01-11 22:17:57,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.985408, valid_loss 0.998175, train_metric nan, valid_metric 0.042436
[1369919:MainThread](2026-01-11 22:17:58,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.986847, valid_loss 0.998019, train_metric nan, valid_metric 0.042053
[1369919:MainThread](2026-01-11 22:17:58,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.985095, valid_loss 0.998353, train_metric nan, valid_metric 0.040100
[1369919:MainThread](2026-01-11 22:17:59,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.989707, valid_loss 0.997940, train_metric nan, valid_metric 0.041375
[1369919:MainThread](2026-01-11 22:17:59,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.986802, valid_loss 0.998048, train_metric nan, valid_metric 0.041848
[1369919:MainThread](2026-01-11 22:18:00,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.989942, valid_loss 0.997876, train_metric nan, valid_metric 0.042799
[1369919:MainThread](2026-01-11 22:18:00,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.990212, valid_loss 0.998186, train_metric nan, valid_metric 0.041613
[1369919:MainThread](2026-01-11 22:18:01,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.987214, valid_loss 0.998511, train_metric nan, valid_metric 0.040738
[1369919:MainThread](2026-01-11 22:18:02,029) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.987307, valid_loss 0.998221, train_metric nan, valid_metric 0.041727
[1369919:MainThread](2026-01-11 22:18:02,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.984487, valid_loss 0.998155, train_metric nan, valid_metric 0.042092
[1369919:MainThread](2026-01-11 22:18:03,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.990376, valid_loss 0.998029, train_metric nan, valid_metric 0.043044
[1369919:MainThread](2026-01-11 22:18:03,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:18:03.150 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:18:04.630 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 22:18:04.630 | INFO     | __main__:train_single_fold:593 -   IC=0.0058, ICIR=0.0459, RankIC=0.0291, RankICIR=0.2671
2026-01-11 22:18:04.630 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 22:18:04,637) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:18:37,164) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:18:37,166) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:18:46,946) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f72f86e5110>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.89it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 48.04it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.47it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 68.20it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 74.48it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 74.04it/s]backtest loop:  22%|██▏       | 54/242 [00:00<00:02, 73.86it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 74.20it/s]backtest loop:  29%|██▉       | 70/242 [00:01<00:02, 74.26it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 74.02it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:02, 73.03it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:02, 73.80it/s]backtest loop:  42%|████▏     | 102/242 [00:01<00:01, 73.83it/s]backtest loop:  45%|████▌     | 110/242 [00:01<00:01, 73.79it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 74.16it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 78.58it/s]backtest loop:  56%|█████▌    | 135/242 [00:01<00:01, 77.43it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 76.25it/s]backtest loop:  63%|██████▎   | 152/242 [00:02<00:01, 79.56it/s]backtest loop:  66%|██████▌   | 160/242 [00:02<00:01, 77.40it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:00, 76.42it/s]backtest loop:  73%|███████▎  | 177/242 [00:02<00:00, 80.14it/s]backtest loop:  77%|███████▋  | 186/242 [00:02<00:00, 79.27it/s]backtest loop:  80%|████████  | 194/242 [00:02<00:00, 77.67it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 76.51it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 77.38it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 78.08it/s]backtest loop:  96%|█████████▌| 232/242 [00:03<00:00, 78.57it/s]backtest loop: 100%|█████████▉| 241/242 [00:03<00:00, 81.40it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.76it/s]
2026-01-11 22:18:50.207 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0135, Sharpe(w/cost)=-0.2147, MaxDD=-0.0581
2026-01-11 22:18:54.055 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 22:19:10.075 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:19:10.156 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_7_pred.parquet
2026-01-11 22:19:10.173 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 22:19:10.173 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 22:19:11.587 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0195
2026-01-11 22:19:12.908 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0210
2026-01-11 22:19:14.261 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0252
2026-01-11 22:19:15.678 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0261
2026-01-11 22:19:17.120 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0333
2026-01-11 22:19:18.442 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0360
2026-01-11 22:19:19.800 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0379
2026-01-11 22:19:20.139 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0110, ICIR=0.0877, RankIC=0.0343
[1369919:MainThread](2026-01-11 22:19:20,145) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:19:51,331) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:19:51,332) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:20:00,470) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b905a5d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 21.88it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 50.00it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.61it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 70.39it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 74.05it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 76.70it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 79.66it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 75.53it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 75.67it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 75.68it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:01, 76.32it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 78.73it/s]backtest loop:  45%|████▌     | 110/242 [00:01<00:01, 81.05it/s]backtest loop:  49%|████▉     | 119/242 [00:01<00:01, 81.57it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 81.39it/s]backtest loop:  57%|█████▋    | 138/242 [00:01<00:01, 82.85it/s]backtest loop:  61%|██████    | 148/242 [00:01<00:01, 83.22it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 83.10it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:00, 83.87it/s]backtest loop:  74%|███████▎  | 178/242 [00:02<00:00, 84.45it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 84.23it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 85.42it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 85.48it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 85.83it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 85.88it/s]backtest loop:  98%|█████████▊| 237/242 [00:02<00:00, 85.36it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 79.59it/s]
2026-01-11 22:20:03.533 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0593, Sharpe(w/cost)=0.8826
2026-01-11 22:20:03.583 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:20:03.583 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 22:20:03.584 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:20:03.584 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1369919:MainThread](2026-01-11 22:21:14,759) INFO - qlib.timer - [log.py:127] - Time cost: 71.173s | Loading data Done
[1369919:MainThread](2026-01-11 22:21:15,095) INFO - qlib.timer - [log.py:127] - Time cost: 0.080s | DropCol Done
[1369919:MainThread](2026-01-11 22:21:16,055) INFO - qlib.timer - [log.py:127] - Time cost: 0.959s | ZScoreNorm Done
[1369919:MainThread](2026-01-11 22:21:16,677) INFO - qlib.timer - [log.py:127] - Time cost: 0.621s | Fillna Done
[1369919:MainThread](2026-01-11 22:21:17,317) INFO - qlib.timer - [log.py:127] - Time cost: 0.086s | DropCol Done
[1369919:MainThread](2026-01-11 22:21:17,469) INFO - qlib.timer - [log.py:127] - Time cost: 0.152s | DropnaLabel Done
[1369919:MainThread](2026-01-11 22:21:17,691) INFO - qlib.timer - [log.py:127] - Time cost: 0.221s | CSRankNorm Done
[1369919:MainThread](2026-01-11 22:21:17,693) INFO - qlib.timer - [log.py:127] - Time cost: 2.933s | fit & process data Done
[1369919:MainThread](2026-01-11 22:21:17,694) INFO - qlib.timer - [log.py:127] - Time cost: 74.109s | Init data Done
2026-01-11 22:21:17.694 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1369919:MainThread](2026-01-11 22:21:17,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1369919:MainThread](2026-01-11 22:21:17,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1369919:MainThread](2026-01-11 22:21:17,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1369919:MainThread](2026-01-11 22:21:17,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:21:17.709 | INFO     | __main__:train_single_fold:569 - Training mlp_158_zscore model (GPU=0)...
[1369919:MainThread](2026-01-11 22:21:19,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1369919:MainThread](2026-01-11 22:21:20,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.216898, valid_loss 1.048349, train_metric nan, valid_metric 0.012891
[1369919:MainThread](2026-01-11 22:21:20,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.048349, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:20,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.074693, valid_loss 1.018232, train_metric nan, valid_metric 0.009786
[1369919:MainThread](2026-01-11 22:21:20,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.048349 to 1.018232, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:21,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.044271, valid_loss 1.012309, train_metric nan, valid_metric 0.019836
[1369919:MainThread](2026-01-11 22:21:21,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018232 to 1.012309, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:21,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.037249, valid_loss 1.009583, train_metric nan, valid_metric 0.029530
[1369919:MainThread](2026-01-11 22:21:21,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012309 to 1.009583, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:22,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.031285, valid_loss 1.008797, train_metric nan, valid_metric 0.027534
[1369919:MainThread](2026-01-11 22:21:22,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009583 to 1.008797, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:22,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.027777, valid_loss 1.004053, train_metric nan, valid_metric 0.030039
[1369919:MainThread](2026-01-11 22:21:22,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008797 to 1.004053, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:23,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.016123, valid_loss 1.001863, train_metric nan, valid_metric 0.029221
[1369919:MainThread](2026-01-11 22:21:23,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004053 to 1.001863, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:23,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.013498, valid_loss 1.003394, train_metric nan, valid_metric 0.030523
[1369919:MainThread](2026-01-11 22:21:24,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.017438, valid_loss 1.000514, train_metric nan, valid_metric 0.034168
[1369919:MainThread](2026-01-11 22:21:24,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001863 to 1.000514, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:24,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.015960, valid_loss 1.002720, train_metric nan, valid_metric 0.026481
[1369919:MainThread](2026-01-11 22:21:25,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.011555, valid_loss 0.999989, train_metric nan, valid_metric 0.039016
[1369919:MainThread](2026-01-11 22:21:25,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000514 to 0.999989, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:25,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.003473, valid_loss 1.000724, train_metric nan, valid_metric 0.035154
[1369919:MainThread](2026-01-11 22:21:26,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.002593, valid_loss 0.999025, train_metric nan, valid_metric 0.040110
[1369919:MainThread](2026-01-11 22:21:26,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999989 to 0.999025, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:27,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.999706, valid_loss 0.999565, train_metric nan, valid_metric 0.041710
[1369919:MainThread](2026-01-11 22:21:27,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.000029, valid_loss 0.998049, train_metric nan, valid_metric 0.038031
[1369919:MainThread](2026-01-11 22:21:27,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999025 to 0.998049, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:28,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.996469, valid_loss 0.997732, train_metric nan, valid_metric 0.043942
[1369919:MainThread](2026-01-11 22:21:28,089) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998049 to 0.997732, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:28,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.002269, valid_loss 0.997698, train_metric nan, valid_metric 0.044905
[1369919:MainThread](2026-01-11 22:21:28,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997732 to 0.997698, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:29,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.001259, valid_loss 0.998916, train_metric nan, valid_metric 0.041049
[1369919:MainThread](2026-01-11 22:21:29,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.994842, valid_loss 0.998202, train_metric nan, valid_metric 0.038712
[1369919:MainThread](2026-01-11 22:21:30,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.994460, valid_loss 0.998415, train_metric nan, valid_metric 0.043425
[1369919:MainThread](2026-01-11 22:21:30,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.998084, valid_loss 0.996959, train_metric nan, valid_metric 0.040216
[1369919:MainThread](2026-01-11 22:21:30,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997698 to 0.996959, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:31,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.996277, valid_loss 0.997563, train_metric nan, valid_metric 0.044026
[1369919:MainThread](2026-01-11 22:21:32,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.996740, valid_loss 0.997489, train_metric nan, valid_metric 0.039236
[1369919:MainThread](2026-01-11 22:21:32,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.995055, valid_loss 0.997209, train_metric nan, valid_metric 0.042347
[1369919:MainThread](2026-01-11 22:21:33,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.993324, valid_loss 0.997725, train_metric nan, valid_metric 0.039335
[1369919:MainThread](2026-01-11 22:21:33,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.997336, valid_loss 0.997657, train_metric nan, valid_metric 0.037816
[1369919:MainThread](2026-01-11 22:21:34,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.992663, valid_loss 0.996793, train_metric nan, valid_metric 0.043124
[1369919:MainThread](2026-01-11 22:21:34,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996959 to 0.996793, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:34,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.989078, valid_loss 0.996699, train_metric nan, valid_metric 0.045606
[1369919:MainThread](2026-01-11 22:21:34,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996793 to 0.996699, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:35,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.990640, valid_loss 0.997399, train_metric nan, valid_metric 0.038777
[1369919:MainThread](2026-01-11 22:21:36,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.990594, valid_loss 0.998049, train_metric nan, valid_metric 0.043104
[1369919:MainThread](2026-01-11 22:21:36,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.995809, valid_loss 0.996978, train_metric nan, valid_metric 0.043770
[1369919:MainThread](2026-01-11 22:21:37,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.993131, valid_loss 0.996936, train_metric nan, valid_metric 0.040740
[1369919:MainThread](2026-01-11 22:21:37,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.988605, valid_loss 0.997675, train_metric nan, valid_metric 0.042021
[1369919:MainThread](2026-01-11 22:21:38,229) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.986561, valid_loss 0.997271, train_metric nan, valid_metric 0.046994
[1369919:MainThread](2026-01-11 22:21:38,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.989867, valid_loss 0.997890, train_metric nan, valid_metric 0.041402
[1369919:MainThread](2026-01-11 22:21:39,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.990921, valid_loss 0.998530, train_metric nan, valid_metric 0.043793
[1369919:MainThread](2026-01-11 22:21:39,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.988807, valid_loss 0.996899, train_metric nan, valid_metric 0.040806
[1369919:MainThread](2026-01-11 22:21:40,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.988303, valid_loss 0.996636, train_metric nan, valid_metric 0.042344
[1369919:MainThread](2026-01-11 22:21:40,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996699 to 0.996636, save checkpoint.
[1369919:MainThread](2026-01-11 22:21:41,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.987734, valid_loss 0.997791, train_metric nan, valid_metric 0.040992
[1369919:MainThread](2026-01-11 22:21:41,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.988670, valid_loss 0.997041, train_metric nan, valid_metric 0.045462
[1369919:MainThread](2026-01-11 22:21:42,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.990175, valid_loss 0.997538, train_metric nan, valid_metric 0.039303
[1369919:MainThread](2026-01-11 22:21:42,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.989101, valid_loss 0.997910, train_metric nan, valid_metric 0.032799
[1369919:MainThread](2026-01-11 22:21:43,319) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.992021, valid_loss 0.996769, train_metric nan, valid_metric 0.041858
[1369919:MainThread](2026-01-11 22:21:43,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.994533, valid_loss 0.997431, train_metric nan, valid_metric 0.040646
[1369919:MainThread](2026-01-11 22:21:44,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.990318, valid_loss 0.997639, train_metric nan, valid_metric 0.043385
[1369919:MainThread](2026-01-11 22:21:44,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.988566, valid_loss 0.996995, train_metric nan, valid_metric 0.048579
[1369919:MainThread](2026-01-11 22:21:45,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.989416, valid_loss 0.999103, train_metric nan, valid_metric 0.040083
[1369919:MainThread](2026-01-11 22:21:45,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.990548, valid_loss 0.997732, train_metric nan, valid_metric 0.046371
[1369919:MainThread](2026-01-11 22:21:46,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.989636, valid_loss 0.999229, train_metric nan, valid_metric 0.036532
[1369919:MainThread](2026-01-11 22:21:46,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.991497, valid_loss 0.998884, train_metric nan, valid_metric 0.040991
[1369919:MainThread](2026-01-11 22:21:47,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.987470, valid_loss 0.997605, train_metric nan, valid_metric 0.041363
[1369919:MainThread](2026-01-11 22:21:48,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.988860, valid_loss 0.997538, train_metric nan, valid_metric 0.044135
[1369919:MainThread](2026-01-11 22:21:48,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.992497, valid_loss 0.996732, train_metric nan, valid_metric 0.046801
[1369919:MainThread](2026-01-11 22:21:49,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.990027, valid_loss 0.997565, train_metric nan, valid_metric 0.042001
[1369919:MainThread](2026-01-11 22:21:49,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.990494, valid_loss 0.998119, train_metric nan, valid_metric 0.035744
[1369919:MainThread](2026-01-11 22:21:50,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.988077, valid_loss 0.997388, train_metric nan, valid_metric 0.044728
[1369919:MainThread](2026-01-11 22:21:50,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.990235, valid_loss 0.997028, train_metric nan, valid_metric 0.042141
[1369919:MainThread](2026-01-11 22:21:51,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.986917, valid_loss 0.997784, train_metric nan, valid_metric 0.043690
[1369919:MainThread](2026-01-11 22:21:51,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.984741, valid_loss 0.997570, train_metric nan, valid_metric 0.037868
[1369919:MainThread](2026-01-11 22:21:52,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.988782, valid_loss 0.997003, train_metric nan, valid_metric 0.044792
[1369919:MainThread](2026-01-11 22:21:53,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.989658, valid_loss 0.997122, train_metric nan, valid_metric 0.043591
[1369919:MainThread](2026-01-11 22:21:53,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.987741, valid_loss 0.997191, train_metric nan, valid_metric 0.041209
[1369919:MainThread](2026-01-11 22:21:54,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.987905, valid_loss 0.997796, train_metric nan, valid_metric 0.043105
[1369919:MainThread](2026-01-11 22:21:54,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.986618, valid_loss 0.997419, train_metric nan, valid_metric 0.042525
[1369919:MainThread](2026-01-11 22:21:55,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.986296, valid_loss 0.997610, train_metric nan, valid_metric 0.037661
[1369919:MainThread](2026-01-11 22:21:55,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.989595, valid_loss 0.997317, train_metric nan, valid_metric 0.040254
[1369919:MainThread](2026-01-11 22:21:56,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.989270, valid_loss 0.997907, train_metric nan, valid_metric 0.038211
[1369919:MainThread](2026-01-11 22:21:57,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.983010, valid_loss 0.997425, train_metric nan, valid_metric 0.039969
[1369919:MainThread](2026-01-11 22:21:57,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.987182, valid_loss 0.997807, train_metric nan, valid_metric 0.042900
[1369919:MainThread](2026-01-11 22:21:58,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.989148, valid_loss 0.997387, train_metric nan, valid_metric 0.039252
[1369919:MainThread](2026-01-11 22:21:58,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.984893, valid_loss 0.997495, train_metric nan, valid_metric 0.042320
[1369919:MainThread](2026-01-11 22:21:59,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.990853, valid_loss 0.997226, train_metric nan, valid_metric 0.042848
[1369919:MainThread](2026-01-11 22:21:59,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.985330, valid_loss 0.997384, train_metric nan, valid_metric 0.043584
[1369919:MainThread](2026-01-11 22:22:00,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.988377, valid_loss 0.997405, train_metric nan, valid_metric 0.039433
[1369919:MainThread](2026-01-11 22:22:00,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.987957, valid_loss 0.997355, train_metric nan, valid_metric 0.040897
[1369919:MainThread](2026-01-11 22:22:01,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.988612, valid_loss 0.997011, train_metric nan, valid_metric 0.041782
[1369919:MainThread](2026-01-11 22:22:02,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.986198, valid_loss 0.997053, train_metric nan, valid_metric 0.045027
[1369919:MainThread](2026-01-11 22:22:02,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.984421, valid_loss 0.997502, train_metric nan, valid_metric 0.042260
[1369919:MainThread](2026-01-11 22:22:03,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.990381, valid_loss 0.997612, train_metric nan, valid_metric 0.041129
[1369919:MainThread](2026-01-11 22:22:03,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.989572, valid_loss 0.997275, train_metric nan, valid_metric 0.041682
[1369919:MainThread](2026-01-11 22:22:04,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.983958, valid_loss 0.997387, train_metric nan, valid_metric 0.041845
[1369919:MainThread](2026-01-11 22:22:04,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.988452, valid_loss 0.997309, train_metric nan, valid_metric 0.044694
[1369919:MainThread](2026-01-11 22:22:05,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.984637, valid_loss 0.997158, train_metric nan, valid_metric 0.043254
[1369919:MainThread](2026-01-11 22:22:06,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.990641, valid_loss 0.997509, train_metric nan, valid_metric 0.040262
[1369919:MainThread](2026-01-11 22:22:06,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.988107, valid_loss 0.997341, train_metric nan, valid_metric 0.042308
[1369919:MainThread](2026-01-11 22:22:07,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.987786, valid_loss 0.997526, train_metric nan, valid_metric 0.041434
[1369919:MainThread](2026-01-11 22:22:07,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.986241, valid_loss 0.997380, train_metric nan, valid_metric 0.041694
[1369919:MainThread](2026-01-11 22:22:08,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.989989, valid_loss 0.997464, train_metric nan, valid_metric 0.040786
[1369919:MainThread](2026-01-11 22:22:08,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:22:08.356 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:22:09.794 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 22:22:09.795 | INFO     | __main__:train_single_fold:593 -   IC=0.0211, ICIR=0.1210, RankIC=0.0419, RankICIR=0.2314
2026-01-11 22:22:09.795 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1369919:MainThread](2026-01-11 22:22:09,802) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:22:40,265) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:22:40,266) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:22:50,136) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b3c17990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.01it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 50.98it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.59it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 68.24it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 73.19it/s]backtest loop:  20%|█▉        | 48/242 [00:00<00:02, 75.86it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 77.92it/s]backtest loop:  27%|██▋       | 66/242 [00:00<00:02, 77.36it/s]backtest loop:  31%|███▏      | 76/242 [00:01<00:02, 78.56it/s]backtest loop:  35%|███▍      | 84/242 [00:01<00:02, 75.62it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 76.53it/s]backtest loop:  42%|████▏     | 102/242 [00:01<00:01, 79.82it/s]backtest loop:  46%|████▌     | 111/242 [00:01<00:01, 79.47it/s]backtest loop:  49%|████▉     | 119/242 [00:01<00:01, 77.57it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 76.98it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 78.04it/s]backtest loop:  61%|██████    | 147/242 [00:01<00:01, 78.99it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 79.62it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 79.69it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 78.58it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 78.49it/s]backtest loop:  79%|███████▉  | 191/242 [00:02<00:00, 78.07it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 78.69it/s]backtest loop:  86%|████████▋ | 209/242 [00:02<00:00, 81.62it/s]backtest loop:  90%|█████████ | 218/242 [00:02<00:00, 78.17it/s]backtest loop:  93%|█████████▎| 226/242 [00:02<00:00, 76.45it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 75.95it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.69it/s]
2026-01-11 22:22:53.356 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0501, Sharpe(w/cost)=0.4776, MaxDD=-0.1992
2026-01-11 22:22:57.166 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 22:23:15.385 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:23:15.454 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/fold_8_pred.parquet
2026-01-11 22:23:15.473 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 22:23:15.473 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 22:23:16.807 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0244
2026-01-11 22:23:17.952 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0347
2026-01-11 22:23:19.167 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0208
2026-01-11 22:23:20.530 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0232
2026-01-11 22:23:21.997 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0322
2026-01-11 22:23:23.254 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0405
2026-01-11 22:23:24.656 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0441
2026-01-11 22:23:26.121 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0410
2026-01-11 22:23:26.561 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0240, ICIR=0.1376, RankIC=0.0454
[1369919:MainThread](2026-01-11 22:23:26,569) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1369919:MainThread](2026-01-11 22:24:00,680) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:24:00,681) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:24:10,629) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71b08060d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 21.59it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 45.84it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.75it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 68.22it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 72.77it/s]backtest loop:  20%|█▉        | 48/242 [00:00<00:02, 76.36it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 77.86it/s]backtest loop:  27%|██▋       | 66/242 [00:00<00:02, 77.83it/s]backtest loop:  31%|███▏      | 76/242 [00:01<00:02, 78.74it/s]backtest loop:  35%|███▍      | 84/242 [00:01<00:02, 77.99it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 77.15it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 78.08it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 77.69it/s]backtest loop:  50%|█████     | 122/242 [00:01<00:01, 78.71it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 79.39it/s]backtest loop:  58%|█████▊    | 141/242 [00:01<00:01, 81.96it/s]backtest loop:  62%|██████▏   | 150/242 [00:01<00:01, 80.77it/s]backtest loop:  66%|██████▌   | 159/242 [00:02<00:01, 80.22it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:00, 79.91it/s]backtest loop:  73%|███████▎  | 177/242 [00:02<00:00, 79.41it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 76.52it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 78.31it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 78.83it/s]backtest loop:  89%|████████▉ | 215/242 [00:02<00:00, 79.98it/s]backtest loop:  93%|█████████▎| 225/242 [00:02<00:00, 80.54it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 80.73it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 76.63it/s]
2026-01-11 22:24:13.810 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0199, Sharpe(w/cost)=0.1787
2026-01-11 22:24:13.869 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 22:24:13.869 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 22:24:13.869 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 22:24:13.876 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 22:24:13.876 | INFO     | __main__:_print_summary:827 -   IC: 0.0325
2026-01-11 22:24:13.876 | INFO     | __main__:_print_summary:828 -   ICIR: 0.2990
2026-01-11 22:24:13.876 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0498
2026-01-11 22:24:13.876 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0600
2026-01-11 22:24:13.876 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.5602
2026-01-11 22:24:13.877 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0461
2026-01-11 22:24:13.880 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/summary.csv
2026-01-11 22:24:13.880 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 22:24:13.880 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 22:24:13.880 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 22:24:13.880 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 22:24:13.883 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 22:24:13.883 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0498
2026-01-11 22:24:13.883 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0347
2026-01-11 22:24:13.883 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0347)
2026-01-11 22:24:13.884 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 22:24:13.893 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/ensemble_matrix.csv
2026-01-11 22:24:13.893 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 22:24:13.893 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 22:24:13.893 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 22:24:14.021 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 22:24:14.021 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 22:24:15.897 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0325, ICIR=0.2744, RankIC=0.0499
[1369919:MainThread](2026-01-11 22:24:15,906) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.080524 0.752691 0.100881  0.446464  4.199152 -0.026164         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.060758 0.594750 0.072687  0.060549  1.169805 -0.047569    0.075739    1.969444
    2 2018-01-01 ~ 2018-12-31 0.045215 0.428019 0.042496 -0.008814 -0.124290 -0.075557    0.046779   -0.392409
    3 2019-01-01 ~ 2019-12-31 0.011182 0.115242 0.037419 -0.160300 -2.490803 -0.177528    0.042934   -0.955993
    4 2020-01-01 ~ 2020-12-31 0.029846 0.266394 0.047152 -0.082194 -1.036957 -0.148030    0.048212   -0.565790
    5 2021-01-01 ~ 2021-12-31 0.011291 0.116325 0.028370  0.131076  1.484176 -0.072706    0.028437    0.537917
    6 2022-01-01 ~ 2022-12-31 0.026721 0.250262 0.048542  0.116859  1.577672 -0.053442    0.047237    2.052207
    7 2023-01-01 ~ 2023-12-31 0.005758 0.045863 0.029150 -0.013468 -0.214685 -0.058051    0.034280    0.882555
    8 2024-01-01 ~ 2024-12-31 0.021108 0.121043 0.041915  0.050070  0.477621 -0.199158    0.045360    0.178744

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.1009     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0724  0.0727     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0458  0.0424  0.0425     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0390  0.0427  0.0467  0.0374     NaN     NaN     NaN     NaN     NaN
T4  0.0360  0.0436  0.0429  0.0441  0.0472     NaN     NaN     NaN     NaN
T5  0.0196  0.0196  0.0271  0.0246  0.0252  0.0284     NaN     NaN     NaN
T6  0.0335  0.0328  0.0346  0.0351  0.0377  0.0438  0.0485     NaN     NaN
T7  0.0195  0.0210  0.0252  0.0261  0.0333  0.0360  0.0379  0.0291     NaN
T8  0.0244  0.0347  0.0208  0.0232  0.0322  0.0405  0.0441  0.0410  0.0419
[1369919:MainThread](2026-01-11 22:24:55,858) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:24:55,860) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1369919:MainThread](2026-01-11 22:25:53,034) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f71726a9850>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 3/2187 [00:00<01:33, 23.31it/s]backtest loop:   1%|          | 11/2187 [00:00<00:41, 52.57it/s]backtest loop:   1%|          | 20/2187 [00:00<00:33, 65.62it/s]backtest loop:   1%|▏         | 30/2187 [00:00<00:29, 72.09it/s]backtest loop:   2%|▏         | 40/2187 [00:00<00:27, 77.62it/s]backtest loop:   2%|▏         | 50/2187 [00:00<00:26, 79.74it/s]backtest loop:   3%|▎         | 60/2187 [00:00<00:25, 82.08it/s]backtest loop:   3%|▎         | 69/2187 [00:00<00:25, 82.30it/s]backtest loop:   4%|▎         | 79/2187 [00:01<00:25, 82.41it/s]backtest loop:   4%|▍         | 88/2187 [00:01<00:25, 81.54it/s]backtest loop:   4%|▍         | 98/2187 [00:01<00:25, 81.65it/s]backtest loop:   5%|▍         | 107/2187 [00:01<00:25, 80.77it/s]backtest loop:   5%|▌         | 116/2187 [00:01<00:25, 80.23it/s]backtest loop:   6%|▌         | 125/2187 [00:01<00:24, 82.60it/s]backtest loop:   6%|▌         | 134/2187 [00:01<00:25, 80.43it/s]backtest loop:   7%|▋         | 143/2187 [00:01<00:26, 77.18it/s]backtest loop:   7%|▋         | 151/2187 [00:01<00:27, 74.84it/s]backtest loop:   7%|▋         | 161/2187 [00:02<00:26, 75.91it/s]backtest loop:   8%|▊         | 170/2187 [00:02<00:25, 79.47it/s]backtest loop:   8%|▊         | 179/2187 [00:02<00:26, 74.98it/s]backtest loop:   9%|▊         | 189/2187 [00:02<00:26, 76.68it/s]backtest loop:   9%|▉         | 199/2187 [00:02<00:25, 77.55it/s]backtest loop:  10%|▉         | 209/2187 [00:02<00:25, 78.63it/s]backtest loop:  10%|█         | 219/2187 [00:02<00:24, 79.71it/s]backtest loop:  10%|█         | 229/2187 [00:02<00:23, 81.79it/s]backtest loop:  11%|█         | 239/2187 [00:03<00:23, 84.14it/s]backtest loop:  11%|█▏        | 248/2187 [00:03<00:22, 85.19it/s]backtest loop:  12%|█▏        | 258/2187 [00:03<00:21, 88.37it/s]backtest loop:  12%|█▏        | 268/2187 [00:03<00:21, 87.51it/s]backtest loop:  13%|█▎        | 278/2187 [00:03<00:21, 90.51it/s]backtest loop:  13%|█▎        | 288/2187 [00:03<00:20, 92.02it/s]backtest loop:  14%|█▎        | 298/2187 [00:03<00:20, 91.67it/s]backtest loop:  14%|█▍        | 308/2187 [00:03<00:20, 91.86it/s]backtest loop:  15%|█▍        | 318/2187 [00:03<00:20, 91.62it/s]backtest loop:  15%|█▍        | 328/2187 [00:04<00:20, 90.07it/s]backtest loop:  15%|█▌        | 338/2187 [00:04<00:20, 89.08it/s]backtest loop:  16%|█▌        | 347/2187 [00:04<00:21, 85.83it/s]backtest loop:  16%|█▋        | 356/2187 [00:04<00:21, 83.99it/s]backtest loop:  17%|█▋        | 365/2187 [00:04<00:22, 82.38it/s]backtest loop:  17%|█▋        | 374/2187 [00:04<00:22, 80.47it/s]backtest loop:  18%|█▊        | 383/2187 [00:04<00:22, 79.90it/s]backtest loop:  18%|█▊        | 393/2187 [00:04<00:22, 80.27it/s]backtest loop:  18%|█▊        | 403/2187 [00:04<00:22, 80.74it/s]backtest loop:  19%|█▉        | 413/2187 [00:05<00:21, 80.72it/s]backtest loop:  19%|█▉        | 423/2187 [00:05<00:21, 81.11it/s]backtest loop:  20%|█▉        | 433/2187 [00:05<00:21, 81.04it/s]backtest loop:  20%|██        | 443/2187 [00:05<00:21, 80.20it/s]backtest loop:  21%|██        | 453/2187 [00:05<00:21, 81.55it/s]backtest loop:  21%|██        | 463/2187 [00:05<00:20, 82.59it/s]backtest loop:  22%|██▏       | 473/2187 [00:05<00:20, 83.41it/s]backtest loop:  22%|██▏       | 483/2187 [00:05<00:20, 84.41it/s]backtest loop:  22%|██▏       | 492/2187 [00:06<00:19, 84.81it/s]backtest loop:  23%|██▎       | 502/2187 [00:06<00:19, 86.14it/s]backtest loop:  23%|██▎       | 512/2187 [00:06<00:19, 87.84it/s]backtest loop:  24%|██▍       | 521/2187 [00:06<00:19, 87.60it/s]backtest loop:  24%|██▍       | 530/2187 [00:06<00:19, 85.26it/s]backtest loop:  25%|██▍       | 539/2187 [00:06<00:19, 83.20it/s]backtest loop:  25%|██▌       | 548/2187 [00:06<00:19, 82.15it/s]backtest loop:  25%|██▌       | 557/2187 [00:06<00:19, 81.79it/s]backtest loop:  26%|██▌       | 566/2187 [00:06<00:19, 81.98it/s]backtest loop:  26%|██▋       | 575/2187 [00:07<00:19, 80.63it/s]backtest loop:  27%|██▋       | 584/2187 [00:07<00:19, 80.42it/s]backtest loop:  27%|██▋       | 593/2187 [00:07<00:19, 80.18it/s]backtest loop:  28%|██▊       | 602/2187 [00:07<00:19, 81.16it/s]backtest loop:  28%|██▊       | 612/2187 [00:07<00:18, 83.22it/s]backtest loop:  28%|██▊       | 622/2187 [00:07<00:18, 83.37it/s]backtest loop:  29%|██▉       | 632/2187 [00:07<00:18, 83.70it/s]backtest loop:  29%|██▉       | 642/2187 [00:07<00:18, 83.63it/s]backtest loop:  30%|██▉       | 652/2187 [00:07<00:18, 82.69it/s]backtest loop:  30%|███       | 662/2187 [00:08<00:18, 82.10it/s]backtest loop:  31%|███       | 671/2187 [00:08<00:18, 80.66it/s]backtest loop:  31%|███       | 681/2187 [00:08<00:18, 80.06it/s]backtest loop:  32%|███▏      | 690/2187 [00:08<00:18, 82.08it/s]backtest loop:  32%|███▏      | 699/2187 [00:08<00:18, 79.29it/s]backtest loop:  32%|███▏      | 707/2187 [00:08<00:19, 75.23it/s]backtest loop:  33%|███▎      | 716/2187 [00:08<00:19, 74.26it/s]backtest loop:  33%|███▎      | 725/2187 [00:08<00:18, 78.07it/s]backtest loop:  34%|███▎      | 733/2187 [00:09<00:18, 76.84it/s]backtest loop:  34%|███▍      | 741/2187 [00:09<00:18, 77.30it/s]backtest loop:  34%|███▍      | 749/2187 [00:09<00:18, 77.28it/s]backtest loop:  35%|███▍      | 759/2187 [00:09<00:18, 79.14it/s]backtest loop:  35%|███▌      | 769/2187 [00:09<00:17, 80.44it/s]backtest loop:  36%|███▌      | 779/2187 [00:09<00:17, 81.35it/s]backtest loop:  36%|███▌      | 789/2187 [00:09<00:17, 81.93it/s]backtest loop:  36%|███▋      | 798/2187 [00:09<00:17, 81.53it/s]backtest loop:  37%|███▋      | 808/2187 [00:09<00:16, 82.27it/s]backtest loop:  37%|███▋      | 817/2187 [00:10<00:16, 81.92it/s]backtest loop:  38%|███▊      | 826/2187 [00:10<00:16, 81.60it/s]backtest loop:  38%|███▊      | 835/2187 [00:10<00:16, 81.51it/s]backtest loop:  39%|███▊      | 844/2187 [00:10<00:16, 81.98it/s]backtest loop:  39%|███▉      | 854/2187 [00:10<00:16, 82.46it/s]backtest loop:  39%|███▉      | 863/2187 [00:10<00:15, 83.96it/s]backtest loop:  40%|███▉      | 872/2187 [00:10<00:16, 78.24it/s]backtest loop:  40%|████      | 880/2187 [00:10<00:16, 78.04it/s]backtest loop:  41%|████      | 889/2187 [00:10<00:16, 78.51it/s]backtest loop:  41%|████      | 899/2187 [00:11<00:15, 80.55it/s]backtest loop:  42%|████▏     | 908/2187 [00:11<00:15, 80.75it/s]backtest loop:  42%|████▏     | 917/2187 [00:11<00:15, 80.95it/s]backtest loop:  42%|████▏     | 926/2187 [00:11<00:15, 81.61it/s]backtest loop:  43%|████▎     | 935/2187 [00:11<00:15, 81.84it/s]backtest loop:  43%|████▎     | 944/2187 [00:11<00:15, 81.30it/s]backtest loop:  44%|████▎     | 953/2187 [00:11<00:15, 81.03it/s]backtest loop:  44%|████▍     | 963/2187 [00:11<00:15, 81.30it/s]backtest loop:  44%|████▍     | 973/2187 [00:11<00:14, 81.77it/s]backtest loop:  45%|████▍     | 982/2187 [00:12<00:15, 77.28it/s]backtest loop:  45%|████▌     | 991/2187 [00:12<00:15, 78.08it/s]backtest loop:  46%|████▌     | 1001/2187 [00:12<00:14, 80.03it/s]backtest loop:  46%|████▌     | 1011/2187 [00:12<00:14, 81.42it/s]backtest loop:  47%|████▋     | 1021/2187 [00:12<00:14, 82.03it/s]backtest loop:  47%|████▋     | 1031/2187 [00:12<00:13, 82.89it/s]backtest loop:  48%|████▊     | 1040/2187 [00:12<00:13, 82.09it/s]backtest loop:  48%|████▊     | 1050/2187 [00:12<00:13, 83.07it/s]backtest loop:  48%|████▊     | 1059/2187 [00:13<00:13, 82.37it/s]backtest loop:  49%|████▉     | 1068/2187 [00:13<00:13, 80.66it/s]backtest loop:  49%|████▉     | 1077/2187 [00:13<00:13, 80.89it/s]backtest loop:  50%|████▉     | 1087/2187 [00:13<00:13, 81.94it/s]backtest loop:  50%|█████     | 1096/2187 [00:13<00:13, 81.65it/s]backtest loop:  51%|█████     | 1105/2187 [00:13<00:13, 81.91it/s]backtest loop:  51%|█████     | 1115/2187 [00:13<00:12, 82.54it/s]backtest loop:  51%|█████▏    | 1125/2187 [00:13<00:12, 82.58it/s]backtest loop:  52%|█████▏    | 1135/2187 [00:13<00:12, 81.48it/s]backtest loop:  52%|█████▏    | 1145/2187 [00:14<00:12, 85.29it/s]backtest loop:  53%|█████▎    | 1155/2187 [00:14<00:12, 85.67it/s]backtest loop:  53%|█████▎    | 1164/2187 [00:14<00:12, 83.37it/s]backtest loop:  54%|█████▎    | 1175/2187 [00:14<00:11, 88.97it/s]backtest loop:  54%|█████▍    | 1184/2187 [00:14<00:11, 87.37it/s]backtest loop:  55%|█████▍    | 1194/2187 [00:14<00:11, 87.21it/s]backtest loop:  55%|█████▌    | 1204/2187 [00:14<00:11, 87.16it/s]backtest loop:  56%|█████▌    | 1214/2187 [00:14<00:11, 87.85it/s]backtest loop:  56%|█████▌    | 1223/2187 [00:14<00:11, 85.85it/s]backtest loop:  56%|█████▋    | 1233/2187 [00:15<00:11, 85.44it/s]backtest loop:  57%|█████▋    | 1243/2187 [00:15<00:11, 84.90it/s]backtest loop:  57%|█████▋    | 1252/2187 [00:15<00:11, 84.36it/s]backtest loop:  58%|█████▊    | 1261/2187 [00:15<00:11, 83.15it/s]backtest loop:  58%|█████▊    | 1270/2187 [00:15<00:11, 82.54it/s]backtest loop:  58%|█████▊    | 1279/2187 [00:15<00:11, 82.23it/s]backtest loop:  59%|█████▉    | 1288/2187 [00:15<00:10, 82.01it/s]backtest loop:  59%|█████▉    | 1297/2187 [00:15<00:10, 81.97it/s]backtest loop:  60%|█████▉    | 1306/2187 [00:15<00:10, 82.00it/s]backtest loop:  60%|██████    | 1315/2187 [00:16<00:10, 83.51it/s]backtest loop:  61%|██████    | 1326/2187 [00:16<00:09, 90.00it/s]backtest loop:  61%|██████    | 1337/2187 [00:16<00:08, 94.61it/s]backtest loop:  62%|██████▏   | 1348/2187 [00:16<00:08, 93.77it/s]backtest loop:  62%|██████▏   | 1359/2187 [00:16<00:08, 96.54it/s]backtest loop:  63%|██████▎   | 1369/2187 [00:16<00:08, 97.27it/s]backtest loop:  63%|██████▎   | 1380/2187 [00:16<00:08, 99.15it/s]backtest loop:  64%|██████▎   | 1391/2187 [00:16<00:07, 100.35it/s]backtest loop:  64%|██████▍   | 1402/2187 [00:16<00:08, 91.64it/s] backtest loop:  65%|██████▍   | 1413/2187 [00:17<00:08, 95.74it/s]backtest loop:  65%|██████▌   | 1424/2187 [00:17<00:07, 97.91it/s]backtest loop:  66%|██████▌   | 1434/2187 [00:17<00:07, 96.69it/s]backtest loop:  66%|██████▌   | 1445/2187 [00:17<00:07, 99.38it/s]backtest loop:  67%|██████▋   | 1456/2187 [00:17<00:07, 95.81it/s]backtest loop:  67%|██████▋   | 1466/2187 [00:17<00:07, 92.69it/s]backtest loop:  67%|██████▋   | 1476/2187 [00:17<00:07, 90.95it/s]backtest loop:  68%|██████▊   | 1486/2187 [00:17<00:07, 89.40it/s]backtest loop:  68%|██████▊   | 1495/2187 [00:17<00:07, 87.79it/s]backtest loop:  69%|██████▉   | 1505/2187 [00:18<00:07, 87.88it/s]backtest loop:  69%|██████▉   | 1515/2187 [00:18<00:07, 87.23it/s]backtest loop:  70%|██████▉   | 1524/2187 [00:18<00:07, 86.00it/s]backtest loop:  70%|███████   | 1533/2187 [00:18<00:07, 85.26it/s]backtest loop:  71%|███████   | 1542/2187 [00:18<00:07, 84.79it/s]backtest loop:  71%|███████   | 1551/2187 [00:18<00:07, 84.36it/s]backtest loop:  71%|███████▏  | 1560/2187 [00:18<00:07, 83.71it/s]backtest loop:  72%|███████▏  | 1569/2187 [00:18<00:07, 83.72it/s]backtest loop:  72%|███████▏  | 1579/2187 [00:18<00:07, 84.77it/s]backtest loop:  73%|███████▎  | 1589/2187 [00:19<00:07, 85.36it/s]backtest loop:  73%|███████▎  | 1598/2187 [00:19<00:06, 85.99it/s]backtest loop:  73%|███████▎  | 1607/2187 [00:19<00:06, 85.40it/s]backtest loop:  74%|███████▍  | 1616/2187 [00:19<00:06, 84.87it/s]backtest loop:  74%|███████▍  | 1625/2187 [00:19<00:06, 84.36it/s]backtest loop:  75%|███████▍  | 1634/2187 [00:19<00:06, 85.19it/s]backtest loop:  75%|███████▌  | 1643/2187 [00:19<00:06, 85.10it/s]backtest loop:  76%|███████▌  | 1653/2187 [00:19<00:06, 84.35it/s]backtest loop:  76%|███████▌  | 1663/2187 [00:19<00:06, 85.40it/s]backtest loop:  76%|███████▋  | 1673/2187 [00:20<00:05, 85.89it/s]backtest loop:  77%|███████▋  | 1683/2187 [00:20<00:05, 86.42it/s]backtest loop:  77%|███████▋  | 1693/2187 [00:20<00:05, 87.00it/s]backtest loop:  78%|███████▊  | 1703/2187 [00:20<00:05, 87.81it/s]backtest loop:  78%|███████▊  | 1712/2187 [00:20<00:05, 87.02it/s]backtest loop:  79%|███████▊  | 1722/2187 [00:20<00:05, 86.22it/s]backtest loop:  79%|███████▉  | 1732/2187 [00:20<00:05, 86.33it/s]backtest loop:  80%|███████▉  | 1742/2187 [00:20<00:05, 86.65it/s]backtest loop:  80%|████████  | 1752/2187 [00:20<00:05, 85.51it/s]backtest loop:  81%|████████  | 1762/2187 [00:21<00:04, 85.76it/s]backtest loop:  81%|████████  | 1771/2187 [00:21<00:05, 79.60it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:21<00:04, 81.94it/s]backtest loop:  82%|████████▏ | 1790/2187 [00:21<00:04, 83.15it/s]backtest loop:  82%|████████▏ | 1799/2187 [00:21<00:04, 83.87it/s]backtest loop:  83%|████████▎ | 1808/2187 [00:21<00:04, 84.37it/s]backtest loop:  83%|████████▎ | 1817/2187 [00:21<00:04, 84.71it/s]backtest loop:  83%|████████▎ | 1826/2187 [00:21<00:04, 84.79it/s]backtest loop:  84%|████████▍ | 1836/2187 [00:21<00:04, 85.23it/s]backtest loop:  84%|████████▍ | 1846/2187 [00:22<00:04, 84.91it/s]backtest loop:  85%|████████▍ | 1856/2187 [00:22<00:03, 85.62it/s]backtest loop:  85%|████████▌ | 1866/2187 [00:22<00:03, 85.80it/s]backtest loop:  86%|████████▌ | 1876/2187 [00:22<00:03, 86.56it/s]backtest loop:  86%|████████▌ | 1885/2187 [00:22<00:03, 85.73it/s]backtest loop:  87%|████████▋ | 1895/2187 [00:22<00:03, 85.97it/s]backtest loop:  87%|████████▋ | 1905/2187 [00:22<00:03, 86.58it/s]backtest loop:  88%|████████▊ | 1914/2187 [00:22<00:03, 87.30it/s]backtest loop:  88%|████████▊ | 1923/2187 [00:22<00:03, 85.68it/s]backtest loop:  88%|████████▊ | 1932/2187 [00:23<00:02, 85.21it/s]backtest loop:  89%|████████▉ | 1941/2187 [00:23<00:02, 85.10it/s]backtest loop:  89%|████████▉ | 1950/2187 [00:23<00:02, 84.93it/s]backtest loop:  90%|████████▉ | 1959/2187 [00:23<00:02, 84.47it/s]backtest loop:  90%|█████████ | 1969/2187 [00:23<00:02, 85.16it/s]backtest loop:  90%|█████████ | 1978/2187 [00:23<00:02, 84.50it/s]backtest loop:  91%|█████████ | 1988/2187 [00:23<00:02, 85.11it/s]backtest loop:  91%|█████████▏| 1998/2187 [00:23<00:02, 85.83it/s]backtest loop:  92%|█████████▏| 2007/2187 [00:23<00:02, 83.41it/s]backtest loop:  92%|█████████▏| 2016/2187 [00:24<00:02, 84.09it/s]backtest loop:  93%|█████████▎| 2025/2187 [00:24<00:01, 82.68it/s]backtest loop:  93%|█████████▎| 2034/2187 [00:24<00:01, 82.24it/s]backtest loop:  93%|█████████▎| 2043/2187 [00:24<00:01, 82.73it/s]backtest loop:  94%|█████████▍| 2052/2187 [00:24<00:01, 82.95it/s]backtest loop:  94%|█████████▍| 2062/2187 [00:24<00:01, 84.26it/s]backtest loop:  95%|█████████▍| 2072/2187 [00:24<00:01, 84.99it/s]backtest loop:  95%|█████████▌| 2082/2187 [00:24<00:01, 85.54it/s]backtest loop:  96%|█████████▌| 2091/2187 [00:24<00:01, 86.72it/s]backtest loop:  96%|█████████▌| 2100/2187 [00:25<00:01, 85.51it/s]backtest loop:  96%|█████████▋| 2109/2187 [00:25<00:00, 85.46it/s]backtest loop:  97%|█████████▋| 2118/2187 [00:25<00:00, 85.25it/s]backtest loop:  97%|█████████▋| 2127/2187 [00:25<00:00, 81.79it/s]backtest loop:  98%|█████████▊| 2136/2187 [00:25<00:00, 82.66it/s]backtest loop:  98%|█████████▊| 2145/2187 [00:25<00:00, 83.29it/s]backtest loop:  99%|█████████▊| 2155/2187 [00:25<00:00, 86.03it/s]backtest loop:  99%|█████████▉| 2165/2187 [00:25<00:00, 86.64it/s]backtest loop:  99%|█████████▉| 2175/2187 [00:25<00:00, 86.64it/s]backtest loop: 100%|█████████▉| 2185/2187 [00:26<00:00, 87.75it/s]backtest loop: 100%|██████████| 2187/2187 [00:26<00:00, 83.76it/s]
2026-01-11 22:26:19.249 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 22:26:19.249 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0637
2026-01-11 22:26:19.249 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.7820
2026-01-11 22:26:19.249 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.3285
2026-01-11 22:26:24.853 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pdf/full_backtest_report.pdf
2026-01-11 22:26:48.610 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:26:48.840 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_215210_mlp_158_zscore_6y/pred/full_pred.parquet
[1369919:MainThread](2026-01-11 22:26:49,197) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
