Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1242809:MainThread](2026-01-11 19:54:24,714) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1242809:MainThread](2026-01-11 19:54:25,265) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1242809:MainThread](2026-01-11 19:54:25,266) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 19:54:25.277 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y
2026-01-11 19:54:25.277 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/log/lgb_158_robust_csi500_topk_20260111_195425.log
2026-01-11 19:54:25.277 | INFO     | __main__:__init__:115 - Model name: lgb_158_robust_csi500_topk
2026-01-11 19:54:25.280 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 19:54:25.281 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:54:25.281 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 19:54:25.281 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:54:25.281 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 19:54:48,321) INFO - qlib.timer - [log.py:127] - Time cost: 23.038s | Loading data Done
[1242809:MainThread](2026-01-11 19:54:48,662) INFO - qlib.timer - [log.py:127] - Time cost: 0.087s | DropCol Done
[1242809:MainThread](2026-01-11 19:54:52,290) INFO - qlib.timer - [log.py:127] - Time cost: 3.626s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 19:54:53,893) INFO - qlib.timer - [log.py:127] - Time cost: 1.602s | Fillna Done
[1242809:MainThread](2026-01-11 19:54:54,567) INFO - qlib.timer - [log.py:127] - Time cost: 0.082s | DropCol Done
[1242809:MainThread](2026-01-11 19:54:54,720) INFO - qlib.timer - [log.py:127] - Time cost: 0.152s | DropnaLabel Done
[1242809:MainThread](2026-01-11 19:54:54,938) INFO - qlib.timer - [log.py:127] - Time cost: 0.217s | CSRankNorm Done
[1242809:MainThread](2026-01-11 19:54:54,940) INFO - qlib.timer - [log.py:127] - Time cost: 6.619s | fit & process data Done
[1242809:MainThread](2026-01-11 19:54:54,941) INFO - qlib.timer - [log.py:127] - Time cost: 29.659s | Init data Done
2026-01-11 19:54:54.941 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 19:54:55.191 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
[1242809:MainThread](2026-01-11 19:58:25,965) INFO - qlib.workflow - [exp.py:258] - Experiment 528155627018642494 starts running ...
[1242809:MainThread](2026-01-11 19:58:26,056) INFO - qlib.workflow - [recorder.py:345] - Recorder a7f403b169ee45ccb9e0213779677a6f starts running under Experiment 528155627018642494 ...
2026-01-11 19:58:26.173 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:58:27.564 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 19:58:27.564 | INFO     | __main__:train_single_fold:593 -   IC=0.0754, ICIR=0.6094, RankIC=0.1036, RankICIR=0.8542
2026-01-11 19:58:27.564 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 19:58:27,571) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.983032	valid's l2: 0.990178
[40]	train's l2: 0.977158	valid's l2: 0.990192
[60]	train's l2: 0.972687	valid's l2: 0.991338
Early stopping, best iteration is:
[26]	train's l2: 0.981036	valid's l2: 0.989989
[1242809:MainThread](2026-01-11 19:58:50,614) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 19:58:50,615) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 19:58:55,580) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2794a3d410>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▍         | 10/244 [00:00<00:02, 87.33it/s]backtest loop:   8%|▊         | 20/244 [00:00<00:02, 87.43it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:02, 85.84it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 90.03it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 88.65it/s]backtest loop:  25%|██▍       | 60/244 [00:00<00:02, 87.35it/s]backtest loop:  28%|██▊       | 69/244 [00:00<00:02, 85.74it/s]backtest loop:  32%|███▏      | 79/244 [00:00<00:01, 86.59it/s]backtest loop:  36%|███▌      | 88/244 [00:01<00:01, 84.40it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 84.85it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 83.92it/s]backtest loop:  48%|████▊     | 116/244 [00:01<00:01, 82.17it/s]backtest loop:  52%|█████▏    | 126/244 [00:01<00:01, 83.25it/s]backtest loop:  56%|█████▌    | 136/244 [00:01<00:01, 84.55it/s]backtest loop:  60%|█████▉    | 146/244 [00:01<00:01, 84.86it/s]backtest loop:  64%|██████▍   | 156/244 [00:01<00:01, 84.48it/s]backtest loop:  68%|██████▊   | 166/244 [00:01<00:00, 83.71it/s]backtest loop:  72%|███████▏  | 175/244 [00:02<00:00, 82.54it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 82.88it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 84.06it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 85.10it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 86.73it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 88.15it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 90.16it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 91.07it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 86.14it/s]
2026-01-11 19:58:58.434 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3647, Sharpe(w/cost)=3.5041, MaxDD=-0.0327
2026-01-11 19:59:03.311 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 19:59:18.892 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:59:19.011 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_0_pred.parquet
2026-01-11 19:59:19.037 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:59:19.037 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 19:59:19.037 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:59:19.037 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:00:11,014) INFO - qlib.timer - [log.py:127] - Time cost: 51.975s | Loading data Done
[1242809:MainThread](2026-01-11 20:00:11,410) INFO - qlib.timer - [log.py:127] - Time cost: 0.122s | DropCol Done
[1242809:MainThread](2026-01-11 20:00:15,131) INFO - qlib.timer - [log.py:127] - Time cost: 3.720s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:00:16,323) INFO - qlib.timer - [log.py:127] - Time cost: 1.191s | Fillna Done
[1242809:MainThread](2026-01-11 20:00:16,699) INFO - qlib.timer - [log.py:127] - Time cost: 0.076s | DropCol Done
[1242809:MainThread](2026-01-11 20:00:16,844) INFO - qlib.timer - [log.py:127] - Time cost: 0.145s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:00:17,041) INFO - qlib.timer - [log.py:127] - Time cost: 0.196s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:00:17,043) INFO - qlib.timer - [log.py:127] - Time cost: 6.028s | fit & process data Done
[1242809:MainThread](2026-01-11 20:00:17,043) INFO - qlib.timer - [log.py:127] - Time cost: 58.005s | Init data Done
2026-01-11 20:00:17.044 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:00:17.044 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:03:05.481 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:03:06.935 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 20:03:06.936 | INFO     | __main__:train_single_fold:593 -   IC=0.0516, ICIR=0.3901, RankIC=0.0721, RankICIR=0.7064
2026-01-11 20:03:06.936 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:03:06,946) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.984146	valid's l2: 0.989551
[40]	train's l2: 0.978646	valid's l2: 0.989812
[60]	train's l2: 0.974406	valid's l2: 0.990397
Early stopping, best iteration is:
[25]	train's l2: 0.98261	valid's l2: 0.989286
[1242809:MainThread](2026-01-11 20:03:33,688) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:03:33,689) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:03:39,651) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f253e87f910>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 36.05it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 62.87it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 68.00it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:03, 70.44it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 72.66it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 77.79it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 82.44it/s]backtest loop:  28%|██▊       | 69/244 [00:00<00:02, 86.00it/s]backtest loop:  32%|███▏      | 79/244 [00:01<00:01, 88.51it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 91.63it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 89.45it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 92.23it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 94.46it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 93.51it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 92.76it/s]backtest loop:  61%|██████    | 149/244 [00:01<00:01, 92.57it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:00, 91.70it/s]backtest loop:  69%|██████▉   | 169/244 [00:01<00:00, 90.55it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:00, 90.00it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 88.74it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 85.71it/s]backtest loop:  85%|████████▌ | 208/244 [00:02<00:00, 86.09it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 83.23it/s]backtest loop:  93%|█████████▎| 226/244 [00:02<00:00, 82.16it/s]backtest loop:  96%|█████████▋| 235/244 [00:02<00:00, 79.92it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 81.59it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 84.45it/s]
2026-01-11 20:03:42.564 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1579, Sharpe(w/cost)=3.1718, MaxDD=-0.0227
2026-01-11 20:03:47.749 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 20:04:04.896 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:04:04.995 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_1_pred.parquet
2026-01-11 20:04:05.013 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 20:04:05.013 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 20:04:06.393 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0692
2026-01-11 20:04:06.688 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0521, ICIR=0.3901, RankIC=0.0728
[1242809:MainThread](2026-01-11 20:04:06,692) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:04:34,008) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:04:34,009) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:04:39,412) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f279506f450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 34.91it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 64.73it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 72.95it/s]backtest loop:  13%|█▎        | 32/244 [00:00<00:02, 77.43it/s]backtest loop:  17%|█▋        | 41/244 [00:00<00:02, 80.69it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 83.06it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 85.22it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 84.67it/s]backtest loop:  32%|███▏      | 78/244 [00:00<00:01, 88.26it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 92.73it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 89.69it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 91.90it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 93.17it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 91.85it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 90.46it/s]backtest loop:  61%|██████    | 149/244 [00:01<00:01, 89.84it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:00, 88.92it/s]backtest loop:  69%|██████▉   | 169/244 [00:01<00:00, 88.00it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:00, 87.69it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 88.15it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 86.48it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 86.25it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 86.38it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 87.32it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 88.47it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 86.59it/s]
2026-01-11 20:04:42.250 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1676, Sharpe(w/cost)=3.1356
2026-01-11 20:04:42.351 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:04:42.351 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 20:04:42.351 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:04:42.351 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:05:39,617) INFO - qlib.timer - [log.py:127] - Time cost: 57.264s | Loading data Done
[1242809:MainThread](2026-01-11 20:05:39,943) INFO - qlib.timer - [log.py:127] - Time cost: 0.077s | DropCol Done
[1242809:MainThread](2026-01-11 20:05:43,611) INFO - qlib.timer - [log.py:127] - Time cost: 3.668s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:05:44,757) INFO - qlib.timer - [log.py:127] - Time cost: 1.145s | Fillna Done
[1242809:MainThread](2026-01-11 20:05:45,059) INFO - qlib.timer - [log.py:127] - Time cost: 0.077s | DropCol Done
[1242809:MainThread](2026-01-11 20:05:45,207) INFO - qlib.timer - [log.py:127] - Time cost: 0.146s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:05:45,404) INFO - qlib.timer - [log.py:127] - Time cost: 0.196s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:05:45,406) INFO - qlib.timer - [log.py:127] - Time cost: 5.788s | fit & process data Done
[1242809:MainThread](2026-01-11 20:05:45,406) INFO - qlib.timer - [log.py:127] - Time cost: 63.054s | Init data Done
2026-01-11 20:05:45.407 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:05:45.407 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:11:15.441 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:11:16.820 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 20:11:16.820 | INFO     | __main__:train_single_fold:593 -   IC=0.0572, ICIR=0.5277, RankIC=0.0438, RankICIR=0.4486
2026-01-11 20:11:16.820 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:11:16,828) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.982742	valid's l2: 0.991567
[40]	train's l2: 0.976636	valid's l2: 0.990589
[60]	train's l2: 0.972202	valid's l2: 0.990467
[80]	train's l2: 0.968054	valid's l2: 0.990321
[100]	train's l2: 0.964312	valid's l2: 0.990216
[120]	train's l2: 0.960928	valid's l2: 0.990298
[140]	train's l2: 0.957535	valid's l2: 0.99039
Early stopping, best iteration is:
[99]	train's l2: 0.964498	valid's l2: 0.990209
[1242809:MainThread](2026-01-11 20:11:44,809) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:11:44,810) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:11:50,640) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2587a059d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 37.67it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 67.13it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 77.38it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:02, 75.71it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 78.56it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 78.09it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 80.14it/s]backtest loop:  28%|██▊       | 67/243 [00:00<00:02, 79.63it/s]backtest loop:  32%|███▏      | 77/243 [00:00<00:02, 80.97it/s]backtest loop:  35%|███▌      | 86/243 [00:01<00:01, 81.56it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 82.25it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 83.16it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 83.78it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 84.57it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 85.34it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 85.21it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 85.30it/s]backtest loop:  67%|██████▋   | 164/243 [00:02<00:00, 84.56it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 83.55it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 83.18it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 84.62it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 84.04it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 83.56it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 83.20it/s]backtest loop:  96%|█████████▌| 233/243 [00:02<00:00, 82.97it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 84.28it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 81.94it/s]
2026-01-11 20:11:53.628 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0933, Sharpe(w/cost)=1.2762, MaxDD=-0.0504
2026-01-11 20:11:59.616 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 20:12:15.997 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:12:16.191 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_2_pred.parquet
2026-01-11 20:12:16.211 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 20:12:16.212 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 20:12:17.277 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0434
2026-01-11 20:12:18.113 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0477
2026-01-11 20:12:18.446 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0567, ICIR=0.5144, RankIC=0.0464
[1242809:MainThread](2026-01-11 20:12:18,454) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:12:46,337) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:12:46,338) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:12:52,201) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2587d2f450>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 38.99it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 67.48it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 78.82it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:02, 78.84it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 80.68it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 81.27it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 82.54it/s]backtest loop:  28%|██▊       | 68/243 [00:00<00:02, 83.60it/s]backtest loop:  32%|███▏      | 77/243 [00:00<00:01, 84.15it/s]backtest loop:  35%|███▌      | 86/243 [00:01<00:01, 84.56it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 84.79it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 85.30it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 84.42it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 85.15it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 86.28it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 86.73it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 86.67it/s]backtest loop:  67%|██████▋   | 164/243 [00:01<00:00, 85.98it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 86.13it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 85.28it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 86.30it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 85.29it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 84.27it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 83.39it/s]backtest loop:  96%|█████████▌| 233/243 [00:02<00:00, 83.09it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.44it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.35it/s]
2026-01-11 20:12:55.136 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0141, Sharpe(w/cost)=0.2011
2026-01-11 20:12:55.216 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:12:55.216 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 20:12:55.216 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:12:55.216 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:13:55,036) INFO - qlib.timer - [log.py:127] - Time cost: 59.818s | Loading data Done
[1242809:MainThread](2026-01-11 20:13:55,484) INFO - qlib.timer - [log.py:127] - Time cost: 0.188s | DropCol Done
[1242809:MainThread](2026-01-11 20:13:59,156) INFO - qlib.timer - [log.py:127] - Time cost: 3.671s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:14:00,233) INFO - qlib.timer - [log.py:127] - Time cost: 1.076s | Fillna Done
[1242809:MainThread](2026-01-11 20:14:00,612) INFO - qlib.timer - [log.py:127] - Time cost: 0.075s | DropCol Done
[1242809:MainThread](2026-01-11 20:14:00,755) INFO - qlib.timer - [log.py:127] - Time cost: 0.143s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:14:00,955) INFO - qlib.timer - [log.py:127] - Time cost: 0.199s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:14:00,957) INFO - qlib.timer - [log.py:127] - Time cost: 5.921s | fit & process data Done
[1242809:MainThread](2026-01-11 20:14:00,958) INFO - qlib.timer - [log.py:127] - Time cost: 65.740s | Init data Done
2026-01-11 20:14:00.958 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:14:00.958 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:17:07.924 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:17:09.309 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 20:17:09.309 | INFO     | __main__:train_single_fold:593 -   IC=0.0260, ICIR=0.2263, RankIC=0.0420, RankICIR=0.4054
2026-01-11 20:17:09.309 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:17:09,317) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.982975	valid's l2: 0.994394
[40]	train's l2: 0.97666	valid's l2: 0.994157
[60]	train's l2: 0.97198	valid's l2: 0.99427
[80]	train's l2: 0.967873	valid's l2: 0.994418
Early stopping, best iteration is:
[34]	train's l2: 0.978296	valid's l2: 0.994114
[1242809:MainThread](2026-01-11 20:17:39,894) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:17:39,895) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:17:46,176) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2595f9d9d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 25.24it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 59.18it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 68.16it/s]backtest loop:  13%|█▎        | 32/244 [00:00<00:02, 74.14it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 75.35it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 76.61it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:02, 78.71it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:02, 79.39it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 80.32it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 79.72it/s]backtest loop:  39%|███▊      | 94/244 [00:01<00:01, 77.11it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 78.13it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 80.16it/s]backtest loop:  50%|█████     | 123/244 [00:01<00:01, 80.86it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 79.72it/s]backtest loop:  58%|█████▊    | 142/244 [00:01<00:01, 82.12it/s]backtest loop:  62%|██████▏   | 151/244 [00:01<00:01, 80.90it/s]backtest loop:  66%|██████▌   | 160/244 [00:02<00:01, 80.85it/s]backtest loop:  69%|██████▉   | 169/244 [00:02<00:00, 80.41it/s]backtest loop:  73%|███████▎  | 178/244 [00:02<00:00, 79.96it/s]backtest loop:  77%|███████▋  | 187/244 [00:02<00:00, 76.19it/s]backtest loop:  81%|████████  | 197/244 [00:02<00:00, 79.16it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 80.78it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 80.98it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 81.13it/s]backtest loop:  97%|█████████▋| 236/244 [00:03<00:00, 82.08it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 77.68it/s]
2026-01-11 20:17:49.339 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0811, Sharpe(w/cost)=-1.2461, MaxDD=-0.1123
2026-01-11 20:17:54.886 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 20:18:12.048 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:18:12.106 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_3_pred.parquet
2026-01-11 20:18:12.116 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 20:18:12.117 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 20:18:13.342 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0350
2026-01-11 20:18:14.183 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0402
2026-01-11 20:18:15.041 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0424
2026-01-11 20:18:15.395 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0280, ICIR=0.2456, RankIC=0.0430
[1242809:MainThread](2026-01-11 20:18:15,399) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:18:44,244) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:18:44,245) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:18:50,772) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f26e0084310>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 38.14it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 62.11it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 70.77it/s]backtest loop:  13%|█▎        | 31/244 [00:00<00:02, 73.74it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 74.66it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 76.09it/s]backtest loop:  23%|██▎       | 57/244 [00:00<00:02, 79.82it/s]backtest loop:  27%|██▋       | 65/244 [00:00<00:02, 78.10it/s]backtest loop:  30%|██▉       | 73/244 [00:00<00:02, 77.16it/s]backtest loop:  33%|███▎      | 81/244 [00:01<00:02, 76.36it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:02, 76.09it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 78.77it/s]backtest loop:  43%|████▎     | 106/244 [00:01<00:01, 77.96it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 77.64it/s]backtest loop:  50%|█████     | 123/244 [00:01<00:01, 77.70it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 78.54it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 79.09it/s]backtest loop:  62%|██████▏   | 152/244 [00:01<00:01, 80.80it/s]backtest loop:  66%|██████▌   | 161/244 [00:02<00:01, 79.92it/s]backtest loop:  69%|██████▉   | 169/244 [00:02<00:00, 78.84it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 77.75it/s]backtest loop:  76%|███████▌  | 185/244 [00:02<00:00, 76.79it/s]backtest loop:  79%|███████▉  | 193/244 [00:02<00:00, 73.61it/s]backtest loop:  83%|████████▎ | 202/244 [00:02<00:00, 76.98it/s]backtest loop:  86%|████████▋ | 211/244 [00:02<00:00, 80.00it/s]backtest loop:  90%|█████████ | 220/244 [00:02<00:00, 78.34it/s]backtest loop:  93%|█████████▎| 228/244 [00:02<00:00, 75.82it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 76.18it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 76.39it/s]
2026-01-11 20:18:53.987 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0215, Sharpe(w/cost)=-0.3080
2026-01-11 20:18:54.032 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:18:54.032 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 20:18:54.032 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:18:54.032 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:19:57,106) INFO - qlib.timer - [log.py:127] - Time cost: 63.071s | Loading data Done
[1242809:MainThread](2026-01-11 20:19:57,436) INFO - qlib.timer - [log.py:127] - Time cost: 0.080s | DropCol Done
[1242809:MainThread](2026-01-11 20:20:00,804) INFO - qlib.timer - [log.py:127] - Time cost: 3.368s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:20:01,897) INFO - qlib.timer - [log.py:127] - Time cost: 1.092s | Fillna Done
[1242809:MainThread](2026-01-11 20:20:02,194) INFO - qlib.timer - [log.py:127] - Time cost: 0.081s | DropCol Done
[1242809:MainThread](2026-01-11 20:20:02,348) INFO - qlib.timer - [log.py:127] - Time cost: 0.153s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:20:02,553) INFO - qlib.timer - [log.py:127] - Time cost: 0.203s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:20:02,555) INFO - qlib.timer - [log.py:127] - Time cost: 5.449s | fit & process data Done
[1242809:MainThread](2026-01-11 20:20:02,555) INFO - qlib.timer - [log.py:127] - Time cost: 68.522s | Init data Done
2026-01-11 20:20:02.556 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:20:02.556 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:22:34.933 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:22:36.318 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 20:22:36.318 | INFO     | __main__:train_single_fold:593 -   IC=0.0226, ICIR=0.1640, RankIC=0.0447, RankICIR=0.3522
2026-01-11 20:22:36.318 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:22:36,325) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.984178	valid's l2: 0.994875
[40]	train's l2: 0.978137	valid's l2: 0.995021
[60]	train's l2: 0.973463	valid's l2: 0.995144
Early stopping, best iteration is:
[22]	train's l2: 0.983453	valid's l2: 0.994781
[1242809:MainThread](2026-01-11 20:23:06,835) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:23:06,836) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:23:13,882) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f27950ed9d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.09it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 55.56it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 64.98it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 71.39it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 74.17it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 76.49it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:02, 76.80it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:02, 77.30it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 77.66it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 76.91it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 77.88it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 80.27it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 76.29it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 78.02it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 78.88it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 80.01it/s]backtest loop:  63%|██████▎   | 154/243 [00:02<00:01, 82.49it/s]backtest loop:  67%|██████▋   | 163/243 [00:02<00:00, 81.81it/s]backtest loop:  71%|███████   | 172/243 [00:02<00:00, 80.80it/s]backtest loop:  74%|███████▍  | 181/243 [00:02<00:00, 78.92it/s]backtest loop:  78%|███████▊  | 189/243 [00:02<00:00, 74.58it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 76.73it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 78.40it/s]backtest loop:  90%|█████████ | 219/243 [00:02<00:00, 79.33it/s]backtest loop:  94%|█████████▍| 229/243 [00:02<00:00, 80.16it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 81.75it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.81it/s]
2026-01-11 20:23:17.068 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0222, Sharpe(w/cost)=0.2538, MaxDD=-0.1277
2026-01-11 20:23:21.674 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 20:23:37.053 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:23:37.155 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_4_pred.parquet
2026-01-11 20:23:37.170 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 20:23:37.170 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 20:23:38.454 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0362
2026-01-11 20:23:39.281 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0399
2026-01-11 20:23:40.180 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0454
2026-01-11 20:23:41.061 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0454
2026-01-11 20:23:41.416 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0223, ICIR=0.1553, RankIC=0.0458
[1242809:MainThread](2026-01-11 20:23:41,420) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:24:12,551) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:24:12,552) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:24:19,264) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2795fe6e90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 26.63it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 57.68it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 69.17it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 75.04it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 77.96it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 80.27it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:02, 81.08it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:02, 80.57it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 80.26it/s]backtest loop:  36%|███▌      | 88/243 [00:01<00:01, 80.12it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 79.88it/s]backtest loop:  44%|████▍     | 107/243 [00:01<00:01, 80.86it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 80.36it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 80.20it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 80.59it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 81.05it/s]backtest loop:  64%|██████▍   | 155/243 [00:01<00:01, 81.84it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 81.65it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 81.78it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 77.68it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 78.90it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 79.88it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 80.45it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 80.85it/s]backtest loop:  96%|█████████▋| 234/243 [00:02<00:00, 81.55it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 80.80it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.00it/s]
2026-01-11 20:24:22.359 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0566, Sharpe(w/cost)=-0.6381
2026-01-11 20:24:22.418 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:24:22.418 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 20:24:22.418 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:24:22.418 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:25:26,005) INFO - qlib.timer - [log.py:127] - Time cost: 63.585s | Loading data Done
[1242809:MainThread](2026-01-11 20:25:26,327) INFO - qlib.timer - [log.py:127] - Time cost: 0.077s | DropCol Done
[1242809:MainThread](2026-01-11 20:25:29,970) INFO - qlib.timer - [log.py:127] - Time cost: 3.642s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:25:31,199) INFO - qlib.timer - [log.py:127] - Time cost: 1.228s | Fillna Done
[1242809:MainThread](2026-01-11 20:25:31,544) INFO - qlib.timer - [log.py:127] - Time cost: 0.093s | DropCol Done
[1242809:MainThread](2026-01-11 20:25:31,692) INFO - qlib.timer - [log.py:127] - Time cost: 0.147s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:25:31,895) INFO - qlib.timer - [log.py:127] - Time cost: 0.203s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:25:31,897) INFO - qlib.timer - [log.py:127] - Time cost: 5.892s | fit & process data Done
[1242809:MainThread](2026-01-11 20:25:31,897) INFO - qlib.timer - [log.py:127] - Time cost: 69.478s | Init data Done
2026-01-11 20:25:31.898 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:25:31.898 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:28:25.630 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:28:26.974 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 20:28:26.974 | INFO     | __main__:train_single_fold:593 -   IC=0.0138, ICIR=0.1060, RankIC=0.0267, RankICIR=0.2159
2026-01-11 20:28:26.974 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:28:26,981) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.985063	valid's l2: 0.994871
[40]	train's l2: 0.979021	valid's l2: 0.995254
[60]	train's l2: 0.974188	valid's l2: 0.995772
Early stopping, best iteration is:
[14]	train's l2: 0.987444	valid's l2: 0.99487
[1242809:MainThread](2026-01-11 20:28:59,342) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:28:59,343) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:29:07,075) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2795a27a10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/243 [00:00<00:05, 43.17it/s]backtest loop:   6%|▌         | 15/243 [00:00<00:03, 70.74it/s]backtest loop:  10%|█         | 25/243 [00:00<00:02, 74.96it/s]backtest loop:  14%|█▎        | 33/243 [00:00<00:02, 75.50it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 74.55it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 75.97it/s]backtest loop:  25%|██▍       | 60/243 [00:00<00:02, 78.30it/s]backtest loop:  28%|██▊       | 69/243 [00:00<00:02, 79.15it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 80.24it/s]backtest loop:  36%|███▌      | 88/243 [00:01<00:01, 78.37it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:01, 77.77it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 77.41it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 78.09it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 78.85it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 80.69it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 81.16it/s]backtest loop:  64%|██████▍   | 155/243 [00:01<00:01, 81.82it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 82.22it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 82.69it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 79.69it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 79.88it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 80.93it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 81.24it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 81.42it/s]backtest loop:  96%|█████████▌| 233/243 [00:02<00:00, 81.78it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 82.16it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.23it/s]
2026-01-11 20:29:10.161 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0145, Sharpe(w/cost)=-0.1469, MaxDD=-0.1450
2026-01-11 20:29:15.200 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 20:29:31.265 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:29:31.355 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_5_pred.parquet
2026-01-11 20:29:31.367 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 20:29:31.367 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 20:29:34.327 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0235
2026-01-11 20:29:35.949 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0249
2026-01-11 20:29:37.010 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0261
2026-01-11 20:29:37.863 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0274
2026-01-11 20:29:38.722 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0282
2026-01-11 20:29:39.096 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0114, ICIR=0.0830, RankIC=0.0284
[1242809:MainThread](2026-01-11 20:29:39,101) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:30:19,603) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:30:19,604) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:30:27,058) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2585b9c750>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 29.72it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 57.68it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 68.13it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 71.55it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 73.62it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 76.12it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 76.88it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 77.74it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 79.08it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 78.72it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 77.54it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 78.13it/s]backtest loop:  45%|████▍     | 109/243 [00:01<00:01, 78.61it/s]backtest loop:  48%|████▊     | 117/243 [00:01<00:01, 77.61it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 77.66it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 79.25it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 80.13it/s]backtest loop:  63%|██████▎   | 154/243 [00:02<00:01, 82.43it/s]backtest loop:  67%|██████▋   | 163/243 [00:02<00:00, 81.59it/s]backtest loop:  71%|███████   | 172/243 [00:02<00:00, 81.21it/s]backtest loop:  74%|███████▍  | 181/243 [00:02<00:00, 81.39it/s]backtest loop:  78%|███████▊  | 190/243 [00:02<00:00, 74.10it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 74.51it/s]backtest loop:  85%|████████▌ | 207/243 [00:02<00:00, 77.85it/s]backtest loop:  88%|████████▊ | 215/243 [00:02<00:00, 76.72it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 76.75it/s]backtest loop:  96%|█████████▌| 233/243 [00:03<00:00, 77.64it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.53it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.95it/s]
2026-01-11 20:30:30.235 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0681, Sharpe(w/cost)=-0.6258
2026-01-11 20:30:30.291 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:30:30.291 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 20:30:30.291 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:30:30.291 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:31:44,111) INFO - qlib.timer - [log.py:127] - Time cost: 73.818s | Loading data Done
[1242809:MainThread](2026-01-11 20:31:44,439) INFO - qlib.timer - [log.py:127] - Time cost: 0.079s | DropCol Done
[1242809:MainThread](2026-01-11 20:31:48,805) INFO - qlib.timer - [log.py:127] - Time cost: 4.365s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:31:49,986) INFO - qlib.timer - [log.py:127] - Time cost: 1.180s | Fillna Done
[1242809:MainThread](2026-01-11 20:31:50,320) INFO - qlib.timer - [log.py:127] - Time cost: 0.076s | DropCol Done
[1242809:MainThread](2026-01-11 20:31:50,475) INFO - qlib.timer - [log.py:127] - Time cost: 0.154s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:31:50,686) INFO - qlib.timer - [log.py:127] - Time cost: 0.210s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:31:50,688) INFO - qlib.timer - [log.py:127] - Time cost: 6.576s | fit & process data Done
[1242809:MainThread](2026-01-11 20:31:50,688) INFO - qlib.timer - [log.py:127] - Time cost: 80.395s | Init data Done
2026-01-11 20:31:50.689 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:31:50.689 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:34:23.914 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:34:25.465 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 20:34:25.465 | INFO     | __main__:train_single_fold:593 -   IC=0.0222, ICIR=0.1784, RankIC=0.0471, RankICIR=0.4175
2026-01-11 20:34:25.466 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:34:25,476) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.987186	valid's l2: 0.996169
[40]	train's l2: 0.981686	valid's l2: 0.997103
[60]	train's l2: 0.97745	valid's l2: 0.997483
Early stopping, best iteration is:
[10]	train's l2: 0.990892	valid's l2: 0.996054
[1242809:MainThread](2026-01-11 20:34:59,265) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:34:59,266) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:35:08,107) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f27956759d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 25.95it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 53.40it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 63.02it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 70.45it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 74.15it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 77.10it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 78.73it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 77.84it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 78.79it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 77.96it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 77.94it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 77.91it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 78.62it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 79.43it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 84.20it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 87.70it/s]backtest loop:  63%|██████▎   | 153/242 [00:01<00:00, 90.56it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 92.58it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 94.28it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 95.09it/s]backtest loop:  80%|███████▉  | 193/242 [00:02<00:00, 95.85it/s]backtest loop:  84%|████████▍ | 203/242 [00:02<00:00, 96.37it/s]backtest loop:  88%|████████▊ | 213/242 [00:02<00:00, 97.06it/s]backtest loop:  92%|█████████▏| 223/242 [00:02<00:00, 96.92it/s]backtest loop:  96%|█████████▋| 233/242 [00:02<00:00, 97.01it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 84.44it/s]
2026-01-11 20:35:10.995 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1284, Sharpe(w/cost)=1.7499, MaxDD=-0.0377
2026-01-11 20:35:14.478 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 20:35:30.292 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:35:30.375 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_6_pred.parquet
2026-01-11 20:35:30.402 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 20:35:30.402 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 20:35:31.944 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0313
2026-01-11 20:35:32.834 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0382
2026-01-11 20:35:33.427 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0403
2026-01-11 20:35:34.018 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0407
2026-01-11 20:35:34.854 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0379
2026-01-11 20:35:35.670 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0426
2026-01-11 20:35:36.042 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0245, ICIR=0.1795, RankIC=0.0460
[1242809:MainThread](2026-01-11 20:35:36,045) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:36:10,608) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:36:10,609) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:36:19,401) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f27959a4490>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/242 [00:00<00:06, 34.90it/s]backtest loop:   5%|▌         | 13/242 [00:00<00:03, 62.73it/s]backtest loop:   9%|▊         | 21/242 [00:00<00:03, 68.14it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 70.17it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 74.72it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 74.70it/s]backtest loop:  22%|██▏       | 54/242 [00:00<00:02, 75.80it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 75.10it/s]backtest loop:  30%|██▉       | 72/242 [00:00<00:02, 76.84it/s]backtest loop:  33%|███▎      | 80/242 [00:01<00:02, 76.52it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:01, 76.60it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 74.50it/s]backtest loop:  44%|████▍     | 107/242 [00:01<00:01, 73.57it/s]backtest loop:  48%|████▊     | 115/242 [00:01<00:01, 71.99it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 72.29it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 74.11it/s]backtest loop:  59%|█████▊    | 142/242 [00:01<00:01, 77.29it/s]backtest loop:  62%|██████▏   | 150/242 [00:02<00:01, 75.90it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 74.43it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:00, 76.01it/s]backtest loop:  73%|███████▎  | 177/242 [00:02<00:00, 76.24it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 77.48it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 78.02it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 78.74it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 78.94it/s]backtest loop:  94%|█████████▍| 227/242 [00:03<00:00, 79.12it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 79.54it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.35it/s]
2026-01-11 20:36:22.633 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1295, Sharpe(w/cost)=1.5483
2026-01-11 20:36:22.678 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:36:22.679 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 20:36:22.679 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:36:22.679 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:37:31,406) INFO - qlib.timer - [log.py:127] - Time cost: 68.725s | Loading data Done
[1242809:MainThread](2026-01-11 20:37:31,735) INFO - qlib.timer - [log.py:127] - Time cost: 0.080s | DropCol Done
[1242809:MainThread](2026-01-11 20:37:35,166) INFO - qlib.timer - [log.py:127] - Time cost: 3.431s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:37:36,326) INFO - qlib.timer - [log.py:127] - Time cost: 1.159s | Fillna Done
[1242809:MainThread](2026-01-11 20:37:36,641) INFO - qlib.timer - [log.py:127] - Time cost: 0.085s | DropCol Done
[1242809:MainThread](2026-01-11 20:37:36,791) INFO - qlib.timer - [log.py:127] - Time cost: 0.150s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:37:36,999) INFO - qlib.timer - [log.py:127] - Time cost: 0.208s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:37:37,001) INFO - qlib.timer - [log.py:127] - Time cost: 5.594s | fit & process data Done
[1242809:MainThread](2026-01-11 20:37:37,002) INFO - qlib.timer - [log.py:127] - Time cost: 74.322s | Init data Done
2026-01-11 20:37:37.002 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:37:37.003 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:40:40.852 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:40:42.197 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 20:40:42.197 | INFO     | __main__:train_single_fold:593 -   IC=0.0086, ICIR=0.0677, RankIC=0.0325, RankICIR=0.2935
2026-01-11 20:40:42.197 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:40:42,205) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.988501	valid's l2: 0.995783
[40]	train's l2: 0.983565	valid's l2: 0.996098
[60]	train's l2: 0.979574	valid's l2: 0.996394
Early stopping, best iteration is:
[18]	train's l2: 0.989061	valid's l2: 0.995743
[1242809:MainThread](2026-01-11 20:41:15,212) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:41:15,213) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:41:24,884) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2587cdee90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.88it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 49.29it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 62.29it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 69.56it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 73.08it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 75.18it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 76.69it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 75.89it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 75.38it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 75.04it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:02, 74.86it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 75.54it/s]backtest loop:  45%|████▌     | 110/242 [00:01<00:01, 76.79it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 75.95it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 79.59it/s]backtest loop:  56%|█████▌    | 135/242 [00:01<00:01, 78.02it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 76.94it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 77.95it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:01, 78.53it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 78.95it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 78.38it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 78.24it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 78.47it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 78.78it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 78.92it/s]backtest loop:  96%|█████████▌| 232/242 [00:03<00:00, 78.96it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 79.13it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.79it/s]
2026-01-11 20:41:28.101 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0456, Sharpe(w/cost)=0.7827, MaxDD=-0.0584
2026-01-11 20:41:31.519 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 20:41:47.720 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:41:47.805 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_7_pred.parquet
2026-01-11 20:41:47.820 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 20:41:47.820 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 20:41:49.469 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0182
2026-01-11 20:41:50.410 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0273
2026-01-11 20:41:51.330 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0261
2026-01-11 20:41:52.232 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0336
2026-01-11 20:41:52.957 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0336
2026-01-11 20:41:53.864 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0337
2026-01-11 20:41:54.793 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0309
2026-01-11 20:41:55.158 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0113, ICIR=0.0841, RankIC=0.0341
[1242809:MainThread](2026-01-11 20:41:55,163) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:42:30,844) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:42:30,845) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:42:40,205) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2586258810>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.84it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 46.92it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.39it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 68.28it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 74.76it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 74.37it/s]backtest loop:  22%|██▏       | 54/242 [00:00<00:02, 74.23it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 74.03it/s]backtest loop:  29%|██▉       | 70/242 [00:01<00:02, 74.09it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 73.79it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:02, 73.67it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 74.74it/s]backtest loop:  43%|████▎     | 105/242 [00:01<00:01, 76.06it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 75.53it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 76.91it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 80.33it/s]backtest loop:  58%|█████▊    | 141/242 [00:01<00:01, 79.25it/s]backtest loop:  62%|██████▏   | 149/242 [00:02<00:01, 77.70it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 77.35it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 78.97it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 76.97it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 76.03it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 76.01it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 77.05it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 78.13it/s]backtest loop:  91%|█████████▏| 221/242 [00:02<00:00, 80.59it/s]backtest loop:  95%|█████████▌| 230/242 [00:03<00:00, 79.58it/s]backtest loop:  98%|█████████▊| 238/242 [00:03<00:00, 77.87it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.91it/s]
2026-01-11 20:42:43.458 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0785, Sharpe(w/cost)=1.3607
2026-01-11 20:42:43.533 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:42:43.533 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 20:42:43.533 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:42:43.533 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1242809:MainThread](2026-01-11 20:43:54,296) INFO - qlib.timer - [log.py:127] - Time cost: 70.761s | Loading data Done
[1242809:MainThread](2026-01-11 20:43:54,656) INFO - qlib.timer - [log.py:127] - Time cost: 0.088s | DropCol Done
[1242809:MainThread](2026-01-11 20:43:58,345) INFO - qlib.timer - [log.py:127] - Time cost: 3.687s | RobustZScoreNorm Done
[1242809:MainThread](2026-01-11 20:43:59,811) INFO - qlib.timer - [log.py:127] - Time cost: 1.466s | Fillna Done
[1242809:MainThread](2026-01-11 20:44:00,133) INFO - qlib.timer - [log.py:127] - Time cost: 0.078s | DropCol Done
[1242809:MainThread](2026-01-11 20:44:00,298) INFO - qlib.timer - [log.py:127] - Time cost: 0.164s | DropnaLabel Done
[1242809:MainThread](2026-01-11 20:44:00,513) INFO - qlib.timer - [log.py:127] - Time cost: 0.214s | CSRankNorm Done
[1242809:MainThread](2026-01-11 20:44:00,515) INFO - qlib.timer - [log.py:127] - Time cost: 6.218s | fit & process data Done
[1242809:MainThread](2026-01-11 20:44:00,515) INFO - qlib.timer - [log.py:127] - Time cost: 76.981s | Init data Done
2026-01-11 20:44:00.516 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:44:00.516 | INFO     | __main__:train_single_fold:569 - Training lgb_158_robust model (GPU=0)...
2026-01-11 20:47:26.308 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:47:27.676 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 20:47:27.677 | INFO     | __main__:train_single_fold:593 -   IC=0.0213, ICIR=0.1270, RankIC=0.0467, RankICIR=0.2657
2026-01-11 20:47:27.677 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1242809:MainThread](2026-01-11 20:47:27,684) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.98901	valid's l2: 0.995518
[40]	train's l2: 0.984367	valid's l2: 0.995612
[60]	train's l2: 0.980462	valid's l2: 0.995797
Early stopping, best iteration is:
[22]	train's l2: 0.988495	valid's l2: 0.995461
[1242809:MainThread](2026-01-11 20:48:00,856) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:48:00,857) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:48:10,210) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f258684d9d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 26.28it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 53.41it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 62.15it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 68.65it/s]backtest loop:  15%|█▌        | 37/242 [00:00<00:02, 74.27it/s]backtest loop:  19%|█▊        | 45/242 [00:00<00:02, 74.63it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 74.70it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 75.11it/s]backtest loop:  29%|██▉       | 71/242 [00:00<00:02, 77.31it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:02, 76.39it/s]backtest loop:  36%|███▋      | 88/242 [00:01<00:01, 77.16it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 78.30it/s]backtest loop:  44%|████▍     | 107/242 [00:01<00:01, 78.75it/s]backtest loop:  48%|████▊     | 117/242 [00:01<00:01, 79.80it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 80.40it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 80.34it/s]backtest loop:  61%|██████    | 147/242 [00:01<00:01, 80.69it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 81.07it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 81.14it/s]backtest loop:  73%|███████▎  | 176/242 [00:02<00:00, 80.41it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 78.03it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 79.38it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 79.96it/s]backtest loop:  89%|████████▉ | 215/242 [00:02<00:00, 80.63it/s]backtest loop:  93%|█████████▎| 225/242 [00:02<00:00, 81.05it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 81.25it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 77.16it/s]
2026-01-11 20:48:13.367 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0142, Sharpe(w/cost)=0.1382, MaxDD=-0.1626
2026-01-11 20:48:17.300 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 20:48:33.747 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:48:33.805 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/fold_8_pred.parquet
2026-01-11 20:48:33.821 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 20:48:33.821 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 20:48:35.088 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0215
2026-01-11 20:48:35.953 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0245
2026-01-11 20:48:36.837 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0242
2026-01-11 20:48:37.702 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0257
2026-01-11 20:48:38.549 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0232
2026-01-11 20:48:39.454 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0290
2026-01-11 20:48:40.308 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0313
2026-01-11 20:48:41.159 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0360
2026-01-11 20:48:41.566 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0194, ICIR=0.1138, RankIC=0.0414
[1242809:MainThread](2026-01-11 20:48:41,571) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1242809:MainThread](2026-01-11 20:49:18,742) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:49:18,743) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:49:28,087) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2586038810>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 25.93it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 53.14it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.05it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 67.86it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 72.52it/s]backtest loop:  20%|█▉        | 48/242 [00:00<00:02, 75.36it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 77.08it/s]backtest loop:  27%|██▋       | 66/242 [00:00<00:02, 76.81it/s]backtest loop:  31%|███▏      | 76/242 [00:01<00:02, 78.33it/s]backtest loop:  35%|███▍      | 84/242 [00:01<00:02, 77.90it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 77.67it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 78.43it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 78.25it/s]backtest loop:  50%|█████     | 122/242 [00:01<00:01, 79.07it/s]backtest loop:  54%|█████▍    | 131/242 [00:01<00:01, 80.41it/s]backtest loop:  58%|█████▊    | 140/242 [00:01<00:01, 79.31it/s]backtest loop:  61%|██████    | 148/242 [00:01<00:01, 78.06it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 77.89it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 78.56it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 77.15it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 77.31it/s]backtest loop:  79%|███████▉  | 191/242 [00:02<00:00, 76.86it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 77.56it/s]backtest loop:  87%|████████▋ | 210/242 [00:02<00:00, 78.96it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 79.44it/s]backtest loop:  95%|█████████▌| 230/242 [00:03<00:00, 80.11it/s]backtest loop:  99%|█████████▉| 240/242 [00:03<00:00, 80.16it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 76.29it/s]
2026-01-11 20:49:31.280 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0468, Sharpe(w/cost)=0.4543
2026-01-11 20:49:31.326 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 20:49:31.326 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 20:49:31.326 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 20:49:31.332 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 20:49:31.332 | INFO     | __main__:_print_summary:827 -   IC: 0.0332
2026-01-11 20:49:31.332 | INFO     | __main__:_print_summary:828 -   ICIR: 0.2663
2026-01-11 20:49:31.332 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0510
2026-01-11 20:49:31.332 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0812
2026-01-11 20:49:31.333 | INFO     | __main__:_print_summary:831 -   Sharpe: 1.0537
2026-01-11 20:49:31.333 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0447
2026-01-11 20:49:31.335 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/summary.csv
2026-01-11 20:49:31.336 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 20:49:31.336 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 20:49:31.336 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 20:49:31.336 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 20:49:31.339 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 20:49:31.339 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0510
2026-01-11 20:49:31.339 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0340
2026-01-11 20:49:31.339 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0340)
2026-01-11 20:49:31.339 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 20:49:31.340 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/ensemble_matrix.csv
2026-01-11 20:49:31.340 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 20:49:31.340 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 20:49:31.340 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 20:49:31.479 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 20:49:31.480 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 20:49:33.393 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0332, ICIR=0.2516, RankIC=0.0511
[1242809:MainThread](2026-01-11 20:49:33,402) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.075382 0.609355 0.103561  0.364734  3.504086 -0.032686         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.051634 0.390110 0.072131  0.157864  3.171809 -0.022702    0.072785    3.135600
    2 2018-01-01 ~ 2018-12-31 0.057197 0.527677 0.043814  0.093350  1.276167 -0.050353    0.046400    0.201092
    3 2019-01-01 ~ 2019-12-31 0.026015 0.226303 0.041974 -0.081079 -1.246072 -0.112312    0.042963   -0.308003
    4 2020-01-01 ~ 2020-12-31 0.022559 0.163974 0.044729  0.022211  0.253794 -0.127742    0.045815   -0.638095
    5 2021-01-01 ~ 2021-12-31 0.013795 0.105991 0.026673 -0.014491 -0.146940 -0.144994    0.028372   -0.625782
    6 2022-01-01 ~ 2022-12-31 0.022213 0.178354 0.047066  0.128353  1.749934 -0.037736    0.045977    1.548312
    7 2023-01-01 ~ 2023-12-31 0.008646 0.067734 0.032515  0.045648  0.782687 -0.058370    0.034123    1.360693
    8 2024-01-01 ~ 2024-12-31 0.021315 0.127050 0.046687  0.014217  0.138179 -0.162587    0.041360    0.454268

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.1036     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0692  0.0721     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0434  0.0477  0.0438     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0350  0.0402  0.0424  0.0420     NaN     NaN     NaN     NaN     NaN
T4  0.0362  0.0399  0.0454  0.0454  0.0447     NaN     NaN     NaN     NaN
T5  0.0235  0.0249  0.0261  0.0274  0.0282  0.0267     NaN     NaN     NaN
T6  0.0313  0.0382  0.0403  0.0407  0.0379  0.0426  0.0471     NaN     NaN
T7  0.0182  0.0273  0.0261  0.0336  0.0336  0.0337  0.0309  0.0325     NaN
T8  0.0215  0.0245  0.0242  0.0257  0.0232  0.0290  0.0313  0.0360  0.0467
[1242809:MainThread](2026-01-11 20:50:12,720) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:50:12,724) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1242809:MainThread](2026-01-11 20:50:59,700) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f25856488d0>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 3/2187 [00:00<01:17, 28.06it/s]backtest loop:   1%|          | 13/2187 [00:00<00:31, 68.58it/s]backtest loop:   1%|          | 22/2187 [00:00<00:27, 77.64it/s]backtest loop:   1%|▏         | 32/2187 [00:00<00:25, 84.33it/s]backtest loop:   2%|▏         | 44/2187 [00:00<00:22, 95.56it/s]backtest loop:   2%|▏         | 54/2187 [00:00<00:22, 96.52it/s]backtest loop:   3%|▎         | 64/2187 [00:00<00:23, 92.16it/s]backtest loop:   3%|▎         | 74/2187 [00:00<00:22, 94.05it/s]backtest loop:   4%|▍         | 84/2187 [00:00<00:22, 94.51it/s]backtest loop:   4%|▍         | 94/2187 [00:01<00:22, 94.19it/s]backtest loop:   5%|▍         | 104/2187 [00:01<00:21, 94.96it/s]backtest loop:   5%|▌         | 114/2187 [00:01<00:21, 95.10it/s]backtest loop:   6%|▌         | 124/2187 [00:01<00:21, 95.51it/s]backtest loop:   6%|▌         | 134/2187 [00:01<00:21, 95.94it/s]backtest loop:   7%|▋         | 144/2187 [00:01<00:21, 96.73it/s]backtest loop:   7%|▋         | 154/2187 [00:01<00:21, 96.35it/s]backtest loop:   7%|▋         | 164/2187 [00:01<00:21, 95.77it/s]backtest loop:   8%|▊         | 174/2187 [00:01<00:22, 90.46it/s]backtest loop:   8%|▊         | 184/2187 [00:02<00:21, 92.49it/s]backtest loop:   9%|▉         | 194/2187 [00:02<00:21, 93.88it/s]backtest loop:   9%|▉         | 204/2187 [00:02<00:20, 94.62it/s]backtest loop:  10%|▉         | 215/2187 [00:02<00:20, 97.47it/s]backtest loop:  10%|█         | 226/2187 [00:02<00:19, 100.56it/s]backtest loop:  11%|█         | 237/2187 [00:02<00:18, 102.92it/s]backtest loop:  11%|█▏        | 248/2187 [00:02<00:19, 99.84it/s] backtest loop:  12%|█▏        | 261/2187 [00:02<00:17, 107.58it/s]backtest loop:  12%|█▏        | 272/2187 [00:02<00:18, 104.42it/s]backtest loop:  13%|█▎        | 283/2187 [00:02<00:18, 101.96it/s]backtest loop:  14%|█▎        | 296/2187 [00:03<00:17, 108.45it/s]backtest loop:  14%|█▍        | 307/2187 [00:03<00:17, 105.95it/s]backtest loop:  15%|█▍        | 320/2187 [00:03<00:16, 110.85it/s]backtest loop:  15%|█▌        | 332/2187 [00:03<00:16, 109.35it/s]backtest loop:  16%|█▌        | 343/2187 [00:03<00:17, 106.87it/s]backtest loop:  16%|█▋        | 356/2187 [00:03<00:16, 111.64it/s]backtest loop:  17%|█▋        | 368/2187 [00:03<00:16, 108.36it/s]backtest loop:  17%|█▋        | 379/2187 [00:03<00:16, 108.34it/s]backtest loop:  18%|█▊        | 390/2187 [00:03<00:16, 107.88it/s]backtest loop:  18%|█▊        | 401/2187 [00:04<00:16, 106.74it/s]backtest loop:  19%|█▉        | 412/2187 [00:04<00:16, 104.52it/s]backtest loop:  19%|█▉        | 423/2187 [00:04<00:17, 98.27it/s] backtest loop:  20%|█▉        | 433/2187 [00:04<00:18, 97.30it/s]backtest loop:  20%|██        | 443/2187 [00:04<00:18, 95.38it/s]backtest loop:  21%|██        | 453/2187 [00:04<00:18, 94.29it/s]backtest loop:  21%|██        | 463/2187 [00:04<00:18, 93.89it/s]backtest loop:  22%|██▏       | 473/2187 [00:04<00:18, 92.87it/s]backtest loop:  22%|██▏       | 483/2187 [00:04<00:18, 94.54it/s]backtest loop:  23%|██▎       | 494/2187 [00:05<00:17, 97.34it/s]backtest loop:  23%|██▎       | 505/2187 [00:05<00:16, 100.20it/s]backtest loop:  24%|██▎       | 516/2187 [00:05<00:16, 98.46it/s] backtest loop:  24%|██▍       | 526/2187 [00:05<00:17, 94.51it/s]backtest loop:  25%|██▍       | 536/2187 [00:05<00:17, 95.26it/s]backtest loop:  25%|██▌       | 547/2187 [00:05<00:17, 94.13it/s]backtest loop:  25%|██▌       | 557/2187 [00:05<00:17, 94.86it/s]backtest loop:  26%|██▌       | 567/2187 [00:05<00:16, 95.94it/s]backtest loop:  26%|██▋       | 577/2187 [00:05<00:16, 96.05it/s]backtest loop:  27%|██▋       | 587/2187 [00:06<00:16, 94.17it/s]backtest loop:  27%|██▋       | 597/2187 [00:06<00:16, 95.40it/s]backtest loop:  28%|██▊       | 607/2187 [00:06<00:17, 92.69it/s]backtest loop:  28%|██▊       | 617/2187 [00:06<00:16, 94.66it/s]backtest loop:  29%|██▊       | 627/2187 [00:06<00:16, 95.47it/s]backtest loop:  29%|██▉       | 638/2187 [00:06<00:15, 97.80it/s]backtest loop:  30%|██▉       | 648/2187 [00:06<00:15, 97.90it/s]backtest loop:  30%|███       | 659/2187 [00:06<00:15, 99.45it/s]backtest loop:  31%|███       | 669/2187 [00:06<00:15, 98.51it/s]backtest loop:  31%|███       | 680/2187 [00:06<00:15, 100.23it/s]backtest loop:  32%|███▏      | 691/2187 [00:07<00:15, 94.73it/s] backtest loop:  32%|███▏      | 701/2187 [00:07<00:15, 94.23it/s]backtest loop:  33%|███▎      | 711/2187 [00:07<00:15, 94.89it/s]backtest loop:  33%|███▎      | 721/2187 [00:07<00:15, 95.07it/s]backtest loop:  33%|███▎      | 731/2187 [00:07<00:15, 96.13it/s]backtest loop:  34%|███▍      | 742/2187 [00:07<00:14, 99.42it/s]backtest loop:  34%|███▍      | 753/2187 [00:07<00:14, 101.09it/s]backtest loop:  35%|███▍      | 764/2187 [00:07<00:14, 97.47it/s] backtest loop:  35%|███▌      | 775/2187 [00:07<00:14, 100.70it/s]backtest loop:  36%|███▌      | 786/2187 [00:08<00:13, 101.83it/s]backtest loop:  36%|███▋      | 797/2187 [00:08<00:13, 102.96it/s]backtest loop:  37%|███▋      | 808/2187 [00:08<00:13, 99.76it/s] backtest loop:  37%|███▋      | 819/2187 [00:08<00:13, 101.47it/s]backtest loop:  38%|███▊      | 830/2187 [00:08<00:13, 98.60it/s] backtest loop:  38%|███▊      | 841/2187 [00:08<00:13, 100.91it/s]backtest loop:  39%|███▉      | 852/2187 [00:08<00:13, 101.11it/s]backtest loop:  39%|███▉      | 863/2187 [00:08<00:12, 102.53it/s]backtest loop:  40%|███▉      | 874/2187 [00:08<00:13, 99.52it/s] backtest loop:  40%|████      | 885/2187 [00:09<00:12, 101.06it/s]backtest loop:  41%|████      | 896/2187 [00:09<00:12, 103.04it/s]backtest loop:  41%|████▏     | 907/2187 [00:09<00:12, 104.64it/s]backtest loop:  42%|████▏     | 918/2187 [00:09<00:13, 97.03it/s] backtest loop:  43%|████▎     | 930/2187 [00:09<00:12, 101.63it/s]backtest loop:  43%|████▎     | 941/2187 [00:09<00:12, 103.56it/s]backtest loop:  44%|████▎     | 952/2187 [00:09<00:11, 104.45it/s]backtest loop:  44%|████▍     | 963/2187 [00:09<00:12, 100.62it/s]backtest loop:  45%|████▍     | 974/2187 [00:09<00:11, 102.39it/s]backtest loop:  45%|████▌     | 985/2187 [00:10<00:12, 99.54it/s] backtest loop:  46%|████▌     | 996/2187 [00:10<00:12, 98.10it/s]backtest loop:  46%|████▌     | 1007/2187 [00:10<00:11, 100.77it/s]backtest loop:  47%|████▋     | 1018/2187 [00:10<00:11, 102.71it/s]backtest loop:  47%|████▋     | 1029/2187 [00:10<00:11, 104.05it/s]backtest loop:  48%|████▊     | 1040/2187 [00:10<00:11, 101.01it/s]backtest loop:  48%|████▊     | 1051/2187 [00:10<00:11, 103.24it/s]backtest loop:  49%|████▊     | 1062/2187 [00:10<00:11, 100.02it/s]backtest loop:  49%|████▉     | 1073/2187 [00:10<00:10, 102.09it/s]backtest loop:  50%|████▉     | 1084/2187 [00:10<00:10, 103.61it/s]backtest loop:  50%|█████     | 1095/2187 [00:11<00:10, 99.67it/s] backtest loop:  51%|█████     | 1106/2187 [00:11<00:10, 101.99it/s]backtest loop:  51%|█████     | 1117/2187 [00:11<00:10, 103.15it/s]backtest loop:  52%|█████▏    | 1129/2187 [00:11<00:09, 106.02it/s]backtest loop:  52%|█████▏    | 1140/2187 [00:11<00:10, 102.23it/s]backtest loop:  53%|█████▎    | 1151/2187 [00:11<00:10, 103.55it/s]backtest loop:  53%|█████▎    | 1162/2187 [00:11<00:10, 99.94it/s] backtest loop:  54%|█████▎    | 1173/2187 [00:11<00:09, 101.80it/s]backtest loop:  54%|█████▍    | 1184/2187 [00:11<00:10, 99.10it/s] backtest loop:  55%|█████▍    | 1195/2187 [00:12<00:09, 100.98it/s]backtest loop:  55%|█████▌    | 1206/2187 [00:12<00:09, 102.84it/s]backtest loop:  56%|█████▌    | 1217/2187 [00:12<00:09, 103.84it/s]backtest loop:  56%|█████▌    | 1228/2187 [00:12<00:09, 100.04it/s]backtest loop:  57%|█████▋    | 1239/2187 [00:12<00:09, 101.58it/s]backtest loop:  57%|█████▋    | 1250/2187 [00:12<00:09, 97.58it/s] backtest loop:  58%|█████▊    | 1260/2187 [00:12<00:09, 97.92it/s]backtest loop:  58%|█████▊    | 1270/2187 [00:12<00:09, 98.07it/s]backtest loop:  59%|█████▊    | 1280/2187 [00:12<00:09, 97.94it/s]backtest loop:  59%|█████▉    | 1290/2187 [00:13<00:09, 98.13it/s]backtest loop:  59%|█████▉    | 1300/2187 [00:13<00:09, 94.00it/s]backtest loop:  60%|█████▉    | 1310/2187 [00:13<00:09, 95.27it/s]backtest loop:  60%|██████    | 1320/2187 [00:13<00:17, 48.89it/s]backtest loop:  61%|██████    | 1330/2187 [00:13<00:15, 57.02it/s]backtest loop:  61%|██████▏   | 1341/2187 [00:13<00:12, 66.36it/s]backtest loop:  62%|██████▏   | 1351/2187 [00:14<00:11, 73.30it/s]backtest loop:  62%|██████▏   | 1361/2187 [00:14<00:10, 79.03it/s]backtest loop:  63%|██████▎   | 1371/2187 [00:14<00:09, 83.09it/s]backtest loop:  63%|██████▎   | 1381/2187 [00:14<00:09, 87.16it/s]backtest loop:  64%|██████▎   | 1391/2187 [00:14<00:08, 90.07it/s]backtest loop:  64%|██████▍   | 1401/2187 [00:14<00:09, 85.56it/s]backtest loop:  65%|██████▍   | 1411/2187 [00:14<00:08, 88.98it/s]backtest loop:  65%|██████▍   | 1421/2187 [00:14<00:08, 91.36it/s]backtest loop:  65%|██████▌   | 1431/2187 [00:14<00:08, 93.02it/s]backtest loop:  66%|██████▌   | 1441/2187 [00:14<00:07, 94.55it/s]backtest loop:  66%|██████▋   | 1451/2187 [00:15<00:07, 95.55it/s]backtest loop:  67%|██████▋   | 1461/2187 [00:15<00:07, 96.37it/s]backtest loop:  67%|██████▋   | 1471/2187 [00:15<00:07, 96.55it/s]backtest loop:  68%|██████▊   | 1481/2187 [00:15<00:07, 96.24it/s]backtest loop:  68%|██████▊   | 1491/2187 [00:15<00:07, 94.64it/s]backtest loop:  69%|██████▊   | 1501/2187 [00:15<00:07, 95.13it/s]backtest loop:  69%|██████▉   | 1511/2187 [00:15<00:07, 95.82it/s]backtest loop:  70%|██████▉   | 1521/2187 [00:15<00:06, 96.90it/s]backtest loop:  70%|███████   | 1531/2187 [00:15<00:06, 96.85it/s]backtest loop:  70%|███████   | 1541/2187 [00:16<00:06, 92.89it/s]backtest loop:  71%|███████   | 1551/2187 [00:16<00:06, 93.91it/s]backtest loop:  71%|███████▏  | 1561/2187 [00:16<00:06, 94.21it/s]backtest loop:  72%|███████▏  | 1571/2187 [00:16<00:06, 94.68it/s]backtest loop:  72%|███████▏  | 1581/2187 [00:16<00:06, 94.52it/s]backtest loop:  73%|███████▎  | 1591/2187 [00:16<00:06, 94.82it/s]backtest loop:  73%|███████▎  | 1601/2187 [00:16<00:06, 94.61it/s]backtest loop:  74%|███████▎  | 1611/2187 [00:16<00:06, 95.20it/s]backtest loop:  74%|███████▍  | 1621/2187 [00:16<00:05, 95.46it/s]backtest loop:  75%|███████▍  | 1631/2187 [00:16<00:05, 95.33it/s]backtest loop:  75%|███████▌  | 1641/2187 [00:17<00:05, 96.17it/s]backtest loop:  75%|███████▌  | 1651/2187 [00:17<00:05, 95.30it/s]backtest loop:  76%|███████▌  | 1661/2187 [00:17<00:05, 95.42it/s]backtest loop:  76%|███████▋  | 1671/2187 [00:17<00:05, 95.49it/s]backtest loop:  77%|███████▋  | 1681/2187 [00:17<00:05, 95.00it/s]backtest loop:  77%|███████▋  | 1691/2187 [00:17<00:05, 95.14it/s]backtest loop:  78%|███████▊  | 1701/2187 [00:17<00:05, 95.56it/s]backtest loop:  78%|███████▊  | 1711/2187 [00:17<00:04, 95.63it/s]backtest loop:  79%|███████▊  | 1721/2187 [00:17<00:04, 95.38it/s]backtest loop:  79%|███████▉  | 1731/2187 [00:17<00:04, 95.50it/s]backtest loop:  80%|███████▉  | 1741/2187 [00:18<00:04, 96.06it/s]backtest loop:  80%|████████  | 1751/2187 [00:18<00:04, 95.88it/s]backtest loop:  81%|████████  | 1761/2187 [00:18<00:04, 96.26it/s]backtest loop:  81%|████████  | 1771/2187 [00:18<00:04, 88.01it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:18<00:04, 90.49it/s]backtest loop:  82%|████████▏ | 1791/2187 [00:18<00:04, 91.96it/s]backtest loop:  82%|████████▏ | 1801/2187 [00:18<00:04, 93.19it/s]backtest loop:  83%|████████▎ | 1811/2187 [00:18<00:04, 93.67it/s]backtest loop:  83%|████████▎ | 1821/2187 [00:18<00:04, 90.50it/s]backtest loop:  84%|████████▎ | 1831/2187 [00:19<00:03, 92.30it/s]backtest loop:  84%|████████▍ | 1841/2187 [00:19<00:03, 92.97it/s]backtest loop:  85%|████████▍ | 1851/2187 [00:19<00:03, 93.27it/s]backtest loop:  85%|████████▌ | 1861/2187 [00:19<00:03, 94.01it/s]backtest loop:  86%|████████▌ | 1871/2187 [00:19<00:03, 94.64it/s]backtest loop:  86%|████████▌ | 1881/2187 [00:19<00:03, 94.83it/s]backtest loop:  86%|████████▋ | 1891/2187 [00:19<00:03, 95.53it/s]backtest loop:  87%|████████▋ | 1901/2187 [00:19<00:02, 95.54it/s]backtest loop:  87%|████████▋ | 1911/2187 [00:19<00:02, 94.38it/s]backtest loop:  88%|████████▊ | 1921/2187 [00:20<00:02, 94.68it/s]backtest loop:  88%|████████▊ | 1931/2187 [00:20<00:02, 94.46it/s]backtest loop:  89%|████████▉ | 1941/2187 [00:20<00:02, 94.67it/s]backtest loop:  89%|████████▉ | 1951/2187 [00:20<00:02, 94.31it/s]backtest loop:  90%|████████▉ | 1961/2187 [00:20<00:02, 94.67it/s]backtest loop:  90%|█████████ | 1971/2187 [00:20<00:02, 95.60it/s]backtest loop:  91%|█████████ | 1981/2187 [00:20<00:02, 95.84it/s]backtest loop:  91%|█████████ | 1991/2187 [00:20<00:02, 96.39it/s]backtest loop:  91%|█████████▏| 2001/2187 [00:20<00:01, 95.74it/s]backtest loop:  92%|█████████▏| 2011/2187 [00:20<00:01, 90.69it/s]backtest loop:  92%|█████████▏| 2021/2187 [00:21<00:01, 92.51it/s]backtest loop:  93%|█████████▎| 2031/2187 [00:21<00:01, 93.62it/s]backtest loop:  93%|█████████▎| 2041/2187 [00:21<00:01, 94.09it/s]backtest loop:  94%|█████████▍| 2051/2187 [00:21<00:01, 94.60it/s]backtest loop:  94%|█████████▍| 2061/2187 [00:21<00:01, 94.74it/s]backtest loop:  95%|█████████▍| 2071/2187 [00:21<00:01, 94.67it/s]backtest loop:  95%|█████████▌| 2081/2187 [00:21<00:01, 94.83it/s]backtest loop:  96%|█████████▌| 2091/2187 [00:21<00:01, 95.22it/s]backtest loop:  96%|█████████▌| 2101/2187 [00:21<00:00, 95.14it/s]backtest loop:  97%|█████████▋| 2111/2187 [00:22<00:00, 94.76it/s]backtest loop:  97%|█████████▋| 2121/2187 [00:22<00:00, 90.62it/s]backtest loop:  97%|█████████▋| 2131/2187 [00:22<00:00, 88.82it/s]backtest loop:  98%|█████████▊| 2141/2187 [00:22<00:00, 90.73it/s]backtest loop:  98%|█████████▊| 2151/2187 [00:22<00:00, 92.24it/s]backtest loop:  99%|█████████▉| 2161/2187 [00:22<00:00, 92.85it/s]backtest loop:  99%|█████████▉| 2171/2187 [00:22<00:00, 93.44it/s]backtest loop: 100%|█████████▉| 2181/2187 [00:22<00:00, 92.79it/s]backtest loop: 100%|██████████| 2187/2187 [00:22<00:00, 95.57it/s]
2026-01-11 20:51:22.672 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 20:51:22.672 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0794
2026-01-11 20:51:22.672 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.9943
2026-01-11 20:51:22.672 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.1777
2026-01-11 20:51:29.021 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pdf/full_backtest_report.pdf
2026-01-11 20:51:50.549 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:51:50.770 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_195425_lgb_158_robust_6y/pred/full_pred.parquet
[1242809:MainThread](2026-01-11 20:51:51,063) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
