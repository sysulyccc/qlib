Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1467613:MainThread](2026-01-11 23:04:29,615) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1467613:MainThread](2026-01-11 23:04:30,118) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1467613:MainThread](2026-01-11 23:04:30,118) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 23:04:30.126 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y
2026-01-11 23:04:30.127 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/log/sfm_360_csi500_topk_20260111_230430.log
2026-01-11 23:04:30.127 | INFO     | __main__:__init__:115 - Model name: sfm_360_csi500_topk
2026-01-11 23:04:30.129 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 23:04:30.129 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 23:04:30.129 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 23:04:30.129 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 23:04:30.130 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-11 23:05:04,267) INFO - qlib.timer - [log.py:127] - Time cost: 34.135s | Loading data Done
[1467613:MainThread](2026-01-11 23:05:12,843) INFO - qlib.timer - [log.py:127] - Time cost: 8.005s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-11 23:05:17,386) INFO - qlib.timer - [log.py:127] - Time cost: 4.541s | Fillna Done
[1467613:MainThread](2026-01-11 23:05:19,117) INFO - qlib.timer - [log.py:127] - Time cost: 0.322s | DropnaLabel Done
[1467613:MainThread](2026-01-11 23:05:19,329) INFO - qlib.timer - [log.py:127] - Time cost: 0.211s | CSRankNorm Done
[1467613:MainThread](2026-01-11 23:05:19,331) INFO - qlib.timer - [log.py:127] - Time cost: 15.064s | fit & process data Done
[1467613:MainThread](2026-01-11 23:05:19,332) INFO - qlib.timer - [log.py:127] - Time cost: 49.202s | Init data Done
2026-01-11 23:05:19.332 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-11 23:05:19,584) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-11 23:05:19,585) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-11 23:05:19,823) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-11 23:05:19,823) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-11 23:05:21.440 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-11 23:05:22,230) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-11 23:05:22,231) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-11 23:05:22,232) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:06:22,587) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:07:02,036) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.992133, valid -0.991890
[1467613:MainThread](2026-01-11 23:07:02,039) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-11 23:07:02,040) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:08:01,962) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:08:41,383) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.988925, valid -0.990687
[1467613:MainThread](2026-01-11 23:08:41,386) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-11 23:08:41,387) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:09:41,419) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:10:22,351) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.988005, valid -0.993078
[1467613:MainThread](2026-01-11 23:10:22,352) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-11 23:10:22,352) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:11:22,425) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:12:02,019) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.984912, valid -0.989978
[1467613:MainThread](2026-01-11 23:12:02,022) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-11 23:12:02,022) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:13:02,186) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:13:41,859) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983784, valid -0.989441
[1467613:MainThread](2026-01-11 23:13:41,861) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-11 23:13:41,862) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:14:36,621) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:15:11,863) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982814, valid -0.990062
[1467613:MainThread](2026-01-11 23:15:11,864) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-11 23:15:11,865) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:16:01,963) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:16:39,108) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982110, valid -0.990909
[1467613:MainThread](2026-01-11 23:16:39,109) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-11 23:16:39,109) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:17:33,222) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:18:12,945) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.980686, valid -0.990776
[1467613:MainThread](2026-01-11 23:18:12,946) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-11 23:18:12,946) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:19:12,586) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:19:52,178) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.979667, valid -0.991581
[1467613:MainThread](2026-01-11 23:19:52,179) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-11 23:19:52,180) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:20:52,007) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:21:31,696) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.979188, valid -0.990664
[1467613:MainThread](2026-01-11 23:21:31,697) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-11 23:21:31,698) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:22:30,520) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:23:10,363) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978804, valid -0.991444
[1467613:MainThread](2026-01-11 23:23:10,364) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-11 23:23:10,365) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:24:09,425) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:24:49,961) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.977599, valid -0.991538
[1467613:MainThread](2026-01-11 23:24:49,962) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-11 23:24:49,962) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:25:48,586) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:26:28,182) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.977546, valid -0.994365
[1467613:MainThread](2026-01-11 23:26:28,182) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-11 23:26:28,183) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:27:28,282) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:28:07,778) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976074, valid -0.992273
[1467613:MainThread](2026-01-11 23:28:07,779) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-11 23:28:07,779) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:29:06,559) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:29:46,068) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975748, valid -0.993561
[1467613:MainThread](2026-01-11 23:29:46,068) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-11 23:29:46,069) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:30:44,944) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:31:26,871) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975058, valid -0.992593
[1467613:MainThread](2026-01-11 23:31:26,872) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-11 23:31:26,873) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:32:26,274) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:33:04,963) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.974033, valid -0.994318
[1467613:MainThread](2026-01-11 23:33:04,964) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-11 23:33:04,964) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:34:03,912) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:34:41,530) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973815, valid -0.993281
[1467613:MainThread](2026-01-11 23:34:41,532) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-11 23:34:41,533) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:35:39,203) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:36:18,957) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973124, valid -0.994644
[1467613:MainThread](2026-01-11 23:36:18,958) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-11 23:36:18,958) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:37:18,287) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:37:58,040) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.972616, valid -0.995860
[1467613:MainThread](2026-01-11 23:37:58,040) INFO - qlib.SFM - [pytorch_sfm.py:410] - best score: -0.989441 @ 4
2026-01-11 23:37:58.272 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 23:38:08.689 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 23:38:08.691 | INFO     | __main__:train_single_fold:593 -   IC=0.0801, ICIR=0.7277, RankIC=0.0961, RankICIR=0.9197
2026-01-11 23:38:08.691 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1467613:MainThread](2026-01-11 23:38:08,716) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1467613:MainThread](2026-01-11 23:38:36,295) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-11 23:38:36,296) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-11 23:38:41,568) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f08105a0ed0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▎         | 9/244 [00:00<00:02, 85.35it/s]backtest loop:   7%|▋         | 18/244 [00:00<00:02, 82.38it/s]backtest loop:  11%|█         | 27/244 [00:00<00:02, 82.22it/s]backtest loop:  15%|█▍        | 36/244 [00:00<00:02, 81.45it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:02, 82.36it/s]backtest loop:  23%|██▎       | 55/244 [00:00<00:02, 83.55it/s]backtest loop:  26%|██▌       | 64/244 [00:00<00:02, 82.29it/s]backtest loop:  30%|███       | 74/244 [00:00<00:02, 82.77it/s]backtest loop:  34%|███▍      | 83/244 [00:01<00:01, 81.63it/s]backtest loop:  38%|███▊      | 93/244 [00:01<00:01, 81.65it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 82.06it/s]backtest loop:  46%|████▌     | 112/244 [00:01<00:01, 80.84it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 80.25it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:01, 80.16it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:01, 81.70it/s]backtest loop:  62%|██████▏   | 151/244 [00:01<00:01, 81.44it/s]backtest loop:  66%|██████▌   | 161/244 [00:01<00:01, 82.59it/s]backtest loop:  70%|███████   | 171/244 [00:02<00:00, 84.25it/s]backtest loop:  74%|███████▍  | 180/244 [00:02<00:00, 84.45it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 88.22it/s]backtest loop:  82%|████████▏ | 200/244 [00:02<00:00, 90.19it/s]backtest loop:  86%|████████▌ | 210/244 [00:02<00:00, 92.81it/s]backtest loop:  90%|█████████ | 220/244 [00:02<00:00, 94.14it/s]backtest loop:  94%|█████████▍| 230/244 [00:02<00:00, 94.09it/s]backtest loop:  98%|█████████▊| 240/244 [00:02<00:00, 94.09it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 85.56it/s]
2026-01-11 23:38:44.451 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3587, Sharpe(w/cost)=3.7968, MaxDD=-0.0193
2026-01-11 23:38:47.989 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 23:39:02.950 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 23:39:03.035 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pred/fold_0_pred.parquet
2026-01-11 23:39:03.070 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 23:39:03.070 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 23:39:03.070 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 23:39:03.070 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-11 23:40:13,112) INFO - qlib.timer - [log.py:127] - Time cost: 70.039s | Loading data Done
[1467613:MainThread](2026-01-11 23:40:22,231) INFO - qlib.timer - [log.py:127] - Time cost: 8.536s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-11 23:40:25,971) INFO - qlib.timer - [log.py:127] - Time cost: 3.738s | Fillna Done
[1467613:MainThread](2026-01-11 23:40:27,775) INFO - qlib.timer - [log.py:127] - Time cost: 0.320s | DropnaLabel Done
[1467613:MainThread](2026-01-11 23:40:27,975) INFO - qlib.timer - [log.py:127] - Time cost: 0.200s | CSRankNorm Done
[1467613:MainThread](2026-01-11 23:40:27,978) INFO - qlib.timer - [log.py:127] - Time cost: 14.866s | fit & process data Done
[1467613:MainThread](2026-01-11 23:40:27,979) INFO - qlib.timer - [log.py:127] - Time cost: 84.908s | Init data Done
2026-01-11 23:40:27.979 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-11 23:40:27,980) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-11 23:40:27,981) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-11 23:40:27,993) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-11 23:40:27,993) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-11 23:40:28.004 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-11 23:40:28,768) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-11 23:40:28,769) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-11 23:40:28,770) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:41:30,344) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:42:11,061) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.992416, valid -0.992310
[1467613:MainThread](2026-01-11 23:42:11,064) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-11 23:42:11,065) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:43:13,280) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:43:53,378) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.991060, valid -0.992037
[1467613:MainThread](2026-01-11 23:43:53,381) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-11 23:43:53,382) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:45:00,997) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:45:44,640) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.989376, valid -0.991080
[1467613:MainThread](2026-01-11 23:45:44,643) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-11 23:45:44,644) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:46:49,474) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:47:30,109) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.987696, valid -0.990715
[1467613:MainThread](2026-01-11 23:47:30,113) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-11 23:47:30,114) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:48:29,185) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:49:05,016) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.986962, valid -0.990512
[1467613:MainThread](2026-01-11 23:49:05,018) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-11 23:49:05,019) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:50:01,686) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:50:37,402) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.986142, valid -0.994246
[1467613:MainThread](2026-01-11 23:50:37,403) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-11 23:50:37,403) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:51:38,137) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:52:17,731) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.984968, valid -0.993049
[1467613:MainThread](2026-01-11 23:52:17,732) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-11 23:52:17,733) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:53:21,338) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:54:01,802) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983908, valid -0.994810
[1467613:MainThread](2026-01-11 23:54:01,803) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-11 23:54:01,804) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:55:03,483) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:55:44,151) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982710, valid -0.995101
[1467613:MainThread](2026-01-11 23:55:44,152) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-11 23:55:44,153) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:56:47,017) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:57:28,233) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982043, valid -0.996216
[1467613:MainThread](2026-01-11 23:57:28,234) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-11 23:57:28,234) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-11 23:58:30,964) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-11 23:59:11,397) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.980707, valid -0.993755
[1467613:MainThread](2026-01-11 23:59:11,398) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-11 23:59:11,399) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:00:13,928) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:00:54,144) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.979355, valid -0.999754
[1467613:MainThread](2026-01-12 00:00:54,145) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-12 00:00:54,145) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:01:56,844) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:02:36,965) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978079, valid -0.996642
[1467613:MainThread](2026-01-12 00:02:36,966) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-12 00:02:36,966) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:03:39,233) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:04:19,313) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.977112, valid -1.001245
[1467613:MainThread](2026-01-12 00:04:19,314) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-12 00:04:19,315) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:05:21,888) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:06:02,230) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976001, valid -1.002142
[1467613:MainThread](2026-01-12 00:06:02,231) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-12 00:06:02,231) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:07:04,478) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:07:44,737) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975026, valid -1.004337
[1467613:MainThread](2026-01-12 00:07:44,738) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-12 00:07:44,739) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:08:49,379) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:09:29,912) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.974856, valid -1.006601
[1467613:MainThread](2026-01-12 00:09:29,913) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-12 00:09:29,913) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:10:33,130) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:11:13,395) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973191, valid -1.006470
[1467613:MainThread](2026-01-12 00:11:13,396) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-12 00:11:13,396) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:12:17,003) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:12:57,569) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.970832, valid -1.011871
[1467613:MainThread](2026-01-12 00:12:57,570) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-12 00:12:57,571) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:14:05,101) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:14:45,185) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.969428, valid -1.008634
[1467613:MainThread](2026-01-12 00:14:45,186) INFO - qlib.SFM - [pytorch_sfm.py:410] - best score: -0.990512 @ 4
2026-01-12 00:14:45.400 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 00:14:55.926 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-12 00:14:55.926 | INFO     | __main__:train_single_fold:593 -   IC=0.0528, ICIR=0.4350, RankIC=0.0740, RankICIR=0.7048
2026-01-12 00:14:55.926 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1467613:MainThread](2026-01-12 00:14:55,934) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 00:15:27,142) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:15:27,143) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:15:33,516) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f08bbf04d10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 37.17it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 64.21it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 68.32it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:03, 71.00it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 73.47it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 76.44it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 78.38it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:02, 77.70it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 80.24it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 79.84it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 80.75it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 80.80it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 81.42it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 82.13it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 82.95it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 83.37it/s]backtest loop:  63%|██████▎   | 154/244 [00:01<00:01, 83.00it/s]backtest loop:  67%|██████▋   | 164/244 [00:02<00:00, 82.73it/s]backtest loop:  71%|███████▏  | 174/244 [00:02<00:00, 82.01it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 82.74it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 82.33it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 82.10it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 81.77it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 82.48it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 82.71it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 82.87it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 79.91it/s]
2026-01-12 00:15:36.592 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0639, Sharpe(w/cost)=1.1794, MaxDD=-0.0308
2026-01-12 00:15:40.149 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pdf/fold_1_backtest_report.pdf
2026-01-12 00:15:55.835 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 00:15:55.920 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pred/fold_1_pred.parquet
2026-01-12 00:15:55.945 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-12 00:15:55.945 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-12 00:16:06.196 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0766
2026-01-12 00:16:06.546 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0598, ICIR=0.4858, RankIC=0.0808
[1467613:MainThread](2026-01-12 00:16:06,552) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 00:16:38,579) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:16:38,580) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:16:44,953) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069cce13d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:07, 32.67it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 63.70it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 69.83it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:02, 71.71it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 74.91it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 78.21it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 79.47it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:02, 78.87it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 81.04it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 81.09it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 80.86it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 80.58it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 80.68it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 81.27it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 82.10it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 82.76it/s]backtest loop:  63%|██████▎   | 154/244 [00:01<00:01, 82.64it/s]backtest loop:  67%|██████▋   | 164/244 [00:02<00:00, 83.40it/s]backtest loop:  71%|███████   | 173/244 [00:02<00:00, 84.52it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 82.94it/s]backtest loop:  78%|███████▊  | 191/244 [00:02<00:00, 83.86it/s]backtest loop:  82%|████████▏ | 200/244 [00:02<00:00, 82.89it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 80.43it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 81.88it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 83.03it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 83.73it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 80.32it/s]
2026-01-12 00:16:48.012 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1025, Sharpe(w/cost)=1.9614
2026-01-12 00:16:48.078 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 00:16:48.078 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-12 00:16:48.078 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 00:16:48.079 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-12 00:18:11,869) INFO - qlib.timer - [log.py:127] - Time cost: 83.789s | Loading data Done
[1467613:MainThread](2026-01-12 00:18:21,034) INFO - qlib.timer - [log.py:127] - Time cost: 8.611s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-12 00:18:24,715) INFO - qlib.timer - [log.py:127] - Time cost: 3.680s | Fillna Done
[1467613:MainThread](2026-01-12 00:18:26,441) INFO - qlib.timer - [log.py:127] - Time cost: 0.319s | DropnaLabel Done
[1467613:MainThread](2026-01-12 00:18:26,645) INFO - qlib.timer - [log.py:127] - Time cost: 0.203s | CSRankNorm Done
[1467613:MainThread](2026-01-12 00:18:26,648) INFO - qlib.timer - [log.py:127] - Time cost: 14.778s | fit & process data Done
[1467613:MainThread](2026-01-12 00:18:26,649) INFO - qlib.timer - [log.py:127] - Time cost: 98.569s | Init data Done
2026-01-12 00:18:26.649 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-12 00:18:26,650) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-12 00:18:26,651) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-12 00:18:27,264) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-12 00:18:27,265) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-12 00:18:27.275 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-12 00:18:28,017) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-12 00:18:28,017) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-12 00:18:28,017) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:19:29,428) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:20:09,404) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.991623, valid -0.995025
[1467613:MainThread](2026-01-12 00:20:09,407) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-12 00:20:09,407) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:21:10,990) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:21:51,548) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.988296, valid -0.993159
[1467613:MainThread](2026-01-12 00:21:51,551) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-12 00:21:51,551) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:22:52,197) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:23:29,537) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.986814, valid -0.991649
[1467613:MainThread](2026-01-12 00:23:29,539) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-12 00:23:29,540) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:24:22,959) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:24:58,645) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.984938, valid -0.991393
[1467613:MainThread](2026-01-12 00:24:58,647) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-12 00:24:58,648) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:25:52,279) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:26:28,806) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983312, valid -0.991249
[1467613:MainThread](2026-01-12 00:26:28,808) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-12 00:26:28,809) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:27:27,911) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:28:09,082) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983003, valid -0.993205
[1467613:MainThread](2026-01-12 00:28:09,083) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-12 00:28:09,083) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:29:09,851) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:29:49,910) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.981259, valid -0.990811
[1467613:MainThread](2026-01-12 00:29:49,913) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-12 00:29:49,913) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:30:51,201) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:31:29,836) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.979701, valid -0.991829
[1467613:MainThread](2026-01-12 00:31:29,837) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-12 00:31:29,838) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:32:27,727) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:33:06,971) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978835, valid -0.992494
[1467613:MainThread](2026-01-12 00:33:06,972) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-12 00:33:06,973) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:34:08,071) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:34:52,575) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976653, valid -0.992013
[1467613:MainThread](2026-01-12 00:34:52,576) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-12 00:34:52,577) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:35:59,616) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:36:43,553) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975399, valid -0.992435
[1467613:MainThread](2026-01-12 00:36:43,554) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-12 00:36:43,554) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:37:49,606) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:38:33,977) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973447, valid -0.993045
[1467613:MainThread](2026-01-12 00:38:33,979) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-12 00:38:33,979) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:39:41,454) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:40:25,541) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.972787, valid -0.992957
[1467613:MainThread](2026-01-12 00:40:25,542) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-12 00:40:25,543) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:41:34,638) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:42:18,061) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.971223, valid -0.993909
[1467613:MainThread](2026-01-12 00:42:18,062) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-12 00:42:18,062) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:43:24,880) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:44:08,606) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.970078, valid -0.995048
[1467613:MainThread](2026-01-12 00:44:08,607) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-12 00:44:08,608) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:45:16,090) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:45:59,450) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.968206, valid -0.994680
[1467613:MainThread](2026-01-12 00:45:59,451) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-12 00:45:59,451) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:47:05,635) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:47:49,779) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.966855, valid -0.994989
[1467613:MainThread](2026-01-12 00:47:49,780) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-12 00:47:49,781) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:48:56,359) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:49:40,832) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.966014, valid -0.995485
[1467613:MainThread](2026-01-12 00:49:40,833) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-12 00:49:40,833) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:50:49,001) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:51:29,940) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.965417, valid -0.995522
[1467613:MainThread](2026-01-12 00:51:29,941) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-12 00:51:29,941) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:52:25,124) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:53:03,080) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.963338, valid -0.997251
[1467613:MainThread](2026-01-12 00:53:03,081) INFO - qlib.SFM - [pytorch_sfm.py:410] - best score: -0.990811 @ 6
2026-01-12 00:53:03.288 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 00:53:11.393 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-12 00:53:11.393 | INFO     | __main__:train_single_fold:593 -   IC=0.0592, ICIR=0.5803, RankIC=0.0483, RankICIR=0.5054
2026-01-12 00:53:11.393 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1467613:MainThread](2026-01-12 00:53:11,400) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 00:53:41,120) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:53:41,120) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:53:46,397) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069f267b10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/243 [00:00<00:05, 46.69it/s]backtest loop:   6%|▌         | 15/243 [00:00<00:03, 74.46it/s]backtest loop:  10%|█         | 25/243 [00:00<00:02, 84.25it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:02, 82.96it/s]backtest loop:  18%|█▊        | 44/243 [00:00<00:02, 87.29it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 90.13it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:01, 92.72it/s]backtest loop:  30%|███       | 74/243 [00:00<00:01, 94.76it/s]backtest loop:  35%|███▍      | 84/243 [00:00<00:01, 96.07it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:01, 97.02it/s]backtest loop:  43%|████▎     | 104/243 [00:01<00:01, 97.79it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 92.88it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 94.21it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 93.83it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 94.40it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:00, 93.55it/s]backtest loop:  67%|██████▋   | 164/243 [00:01<00:00, 93.20it/s]backtest loop:  72%|███████▏  | 174/243 [00:01<00:00, 93.82it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 94.14it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 94.08it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 93.70it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 93.52it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 93.65it/s]backtest loop:  96%|█████████▋| 234/243 [00:02<00:00, 93.54it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 92.09it/s]
2026-01-12 00:53:49.053 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0294, Sharpe(w/cost)=0.4589, MaxDD=-0.0588
2026-01-12 00:53:52.370 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pdf/fold_2_backtest_report.pdf
2026-01-12 00:54:16.768 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 00:54:16.835 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pred/fold_2_pred.parquet
2026-01-12 00:54:16.859 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-12 00:54:16.859 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-12 00:54:28.477 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0484
2026-01-12 00:54:36.981 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0313
2026-01-12 00:54:37.274 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0595, ICIR=0.5782, RankIC=0.0474
[1467613:MainThread](2026-01-12 00:54:37,279) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 00:55:07,384) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:55:07,385) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 00:55:12,903) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069f30cd10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 30.81it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 63.83it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 78.43it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:02, 81.90it/s]backtest loop:  18%|█▊        | 44/243 [00:00<00:02, 86.81it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 90.03it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:01, 92.07it/s]backtest loop:  30%|███       | 74/243 [00:00<00:01, 91.32it/s]backtest loop:  35%|███▍      | 84/243 [00:00<00:01, 93.50it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:01, 95.23it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 95.53it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 98.33it/s]backtest loop:  52%|█████▏    | 126/243 [00:01<00:01, 95.39it/s]backtest loop:  56%|█████▌    | 136/243 [00:01<00:01, 91.79it/s]backtest loop:  60%|██████    | 146/243 [00:01<00:01, 90.54it/s]backtest loop:  64%|██████▍   | 156/243 [00:01<00:00, 90.22it/s]backtest loop:  68%|██████▊   | 166/243 [00:01<00:00, 89.31it/s]backtest loop:  72%|███████▏  | 175/243 [00:01<00:00, 86.87it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 85.37it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 84.42it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 83.71it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 83.22it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 83.06it/s]backtest loop:  96%|█████████▌| 233/243 [00:02<00:00, 81.99it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 82.23it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 86.40it/s]
2026-01-12 00:55:15.740 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0487, Sharpe(w/cost)=-0.8448
2026-01-12 00:55:15.787 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 00:55:15.787 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-12 00:55:15.787 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 00:55:15.787 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-12 00:56:50,083) INFO - qlib.timer - [log.py:127] - Time cost: 94.294s | Loading data Done
[1467613:MainThread](2026-01-12 00:56:59,144) INFO - qlib.timer - [log.py:127] - Time cost: 8.467s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-12 00:57:03,309) INFO - qlib.timer - [log.py:127] - Time cost: 4.164s | Fillna Done
[1467613:MainThread](2026-01-12 00:57:05,241) INFO - qlib.timer - [log.py:127] - Time cost: 0.334s | DropnaLabel Done
[1467613:MainThread](2026-01-12 00:57:05,453) INFO - qlib.timer - [log.py:127] - Time cost: 0.210s | CSRankNorm Done
[1467613:MainThread](2026-01-12 00:57:05,456) INFO - qlib.timer - [log.py:127] - Time cost: 15.372s | fit & process data Done
[1467613:MainThread](2026-01-12 00:57:05,457) INFO - qlib.timer - [log.py:127] - Time cost: 109.668s | Init data Done
2026-01-12 00:57:05.457 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-12 00:57:05,458) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-12 00:57:05,459) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-12 00:57:05,946) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-12 00:57:05,947) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-12 00:57:05.957 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-12 00:57:06,734) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-12 00:57:06,734) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-12 00:57:06,735) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:58:09,126) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 00:58:49,833) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.988938, valid -0.996765
[1467613:MainThread](2026-01-12 00:58:49,836) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-12 00:58:49,837) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 00:59:49,832) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:00:30,983) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.987304, valid -0.994316
[1467613:MainThread](2026-01-12 01:00:30,990) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-12 01:00:30,990) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:01:32,386) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:02:13,710) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.985710, valid -0.995596
[1467613:MainThread](2026-01-12 01:02:13,711) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-12 01:02:13,712) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:03:15,133) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:03:56,183) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.984505, valid -0.995071
[1467613:MainThread](2026-01-12 01:03:56,184) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-12 01:03:56,185) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:04:58,517) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:05:39,533) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983458, valid -0.994741
[1467613:MainThread](2026-01-12 01:05:39,534) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-12 01:05:39,534) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:06:42,115) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:07:28,449) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982240, valid -0.995270
[1467613:MainThread](2026-01-12 01:07:28,451) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-12 01:07:28,452) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:08:34,198) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:09:18,910) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.981432, valid -0.994649
[1467613:MainThread](2026-01-12 01:09:18,911) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-12 01:09:18,911) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:10:24,788) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:11:08,019) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978749, valid -0.995519
[1467613:MainThread](2026-01-12 01:11:08,020) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-12 01:11:08,021) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:12:15,349) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:13:00,224) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978350, valid -0.996141
[1467613:MainThread](2026-01-12 01:13:00,225) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-12 01:13:00,226) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:14:06,365) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:14:47,399) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.977726, valid -0.997134
[1467613:MainThread](2026-01-12 01:14:47,400) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-12 01:14:47,400) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:15:48,722) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:16:29,512) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976240, valid -0.997322
[1467613:MainThread](2026-01-12 01:16:29,513) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-12 01:16:29,513) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:17:31,074) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:18:11,721) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975507, valid -0.995143
[1467613:MainThread](2026-01-12 01:18:11,722) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-12 01:18:11,723) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:19:11,976) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:19:53,064) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973503, valid -0.996521
[1467613:MainThread](2026-01-12 01:19:53,064) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-12 01:19:53,065) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:20:56,331) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:21:37,304) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.974320, valid -0.998130
[1467613:MainThread](2026-01-12 01:21:37,304) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-12 01:21:37,305) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:22:35,509) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:23:14,722) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.971807, valid -0.997358
[1467613:MainThread](2026-01-12 01:23:14,723) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-12 01:23:14,724) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:24:18,623) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:24:55,619) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.970958, valid -0.997621
[1467613:MainThread](2026-01-12 01:24:55,619) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-12 01:24:55,620) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:25:51,981) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:26:29,863) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.969196, valid -0.998099
[1467613:MainThread](2026-01-12 01:26:29,864) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-12 01:26:29,865) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:27:22,557) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:28:03,261) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.967598, valid -0.998275
[1467613:MainThread](2026-01-12 01:28:03,262) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-12 01:28:03,262) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:29:00,856) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:29:41,536) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.967110, valid -0.998668
[1467613:MainThread](2026-01-12 01:29:41,537) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-12 01:29:41,537) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:30:41,794) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:31:22,456) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.966095, valid -1.001447
[1467613:MainThread](2026-01-12 01:31:22,457) INFO - qlib.SFM - [pytorch_sfm.py:410] - best score: -0.994316 @ 1
2026-01-12 01:31:22.669 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 01:31:32.670 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-12 01:31:32.670 | INFO     | __main__:train_single_fold:593 -   IC=0.0287, ICIR=0.2575, RankIC=0.0450, RankICIR=0.4369
2026-01-12 01:31:32.670 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1467613:MainThread](2026-01-12 01:31:32,678) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 01:32:11,731) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 01:32:11,732) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 01:32:18,559) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069f1afb10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:11, 20.91it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:04, 53.94it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 65.58it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 71.69it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:02, 76.22it/s]backtest loop:  21%|██▏       | 52/244 [00:00<00:02, 80.26it/s]backtest loop:  25%|██▌       | 61/244 [00:00<00:02, 80.24it/s]backtest loop:  29%|██▊       | 70/244 [00:00<00:02, 79.49it/s]backtest loop:  32%|███▏      | 79/244 [00:01<00:02, 75.14it/s]backtest loop:  36%|███▌      | 88/244 [00:01<00:01, 78.72it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 77.10it/s]backtest loop:  43%|████▎     | 104/244 [00:01<00:01, 76.61it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 77.02it/s]backtest loop:  50%|█████     | 122/244 [00:01<00:01, 80.54it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:01, 79.44it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 78.08it/s]backtest loop:  61%|██████    | 148/244 [00:01<00:01, 77.94it/s]backtest loop:  65%|██████▍   | 158/244 [00:02<00:01, 78.42it/s]backtest loop:  69%|██████▉   | 168/244 [00:02<00:00, 79.34it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 78.81it/s]backtest loop:  76%|███████▌  | 185/244 [00:02<00:00, 77.73it/s]backtest loop:  79%|███████▉  | 193/244 [00:02<00:00, 76.79it/s]backtest loop:  83%|████████▎ | 202/244 [00:02<00:00, 77.48it/s]backtest loop:  87%|████████▋ | 212/244 [00:02<00:00, 78.24it/s]backtest loop:  91%|█████████ | 222/244 [00:02<00:00, 78.87it/s]backtest loop:  95%|█████████▍| 231/244 [00:03<00:00, 81.43it/s]backtest loop:  98%|█████████▊| 240/244 [00:03<00:00, 80.21it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 76.25it/s]
2026-01-12 01:32:21.782 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0994, Sharpe(w/cost)=-1.5250, MaxDD=-0.1393
2026-01-12 01:32:25.190 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pdf/fold_3_backtest_report.pdf
2026-01-12 01:32:42.004 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 01:32:42.091 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pred/fold_3_pred.parquet
2026-01-12 01:32:42.117 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-12 01:32:42.117 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-12 01:32:52.530 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0482
2026-01-12 01:33:02.186 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0397
2026-01-12 01:33:12.533 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0499
2026-01-12 01:33:12.890 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0330, ICIR=0.2938, RankIC=0.0476
[1467613:MainThread](2026-01-12 01:33:12,896) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 01:33:51,654) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 01:33:51,655) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 01:33:58,588) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069e6dcd10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 24.14it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:04, 56.54it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 66.91it/s]backtest loop:  13%|█▎        | 32/244 [00:00<00:02, 74.70it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 75.02it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 74.73it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:02, 75.55it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:02, 76.03it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 77.33it/s]backtest loop:  35%|███▍      | 85/244 [00:01<00:02, 76.85it/s]backtest loop:  39%|███▊      | 94/244 [00:01<00:01, 75.46it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 75.95it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 77.33it/s]backtest loop:  50%|█████     | 123/244 [00:01<00:01, 77.89it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 78.30it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 78.74it/s]backtest loop:  63%|██████▎   | 153/244 [00:02<00:01, 78.67it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 78.66it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 77.33it/s]backtest loop:  74%|███████▍  | 181/244 [00:02<00:00, 80.55it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 76.23it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 76.02it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 76.96it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 77.36it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 78.37it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 78.77it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 75.83it/s]
2026-01-12 01:34:01.832 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0675, Sharpe(w/cost)=-1.1533
2026-01-12 01:34:01.898 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 01:34:01.899 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-12 01:34:01.899 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 01:34:01.899 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-12 01:35:31,787) INFO - qlib.timer - [log.py:127] - Time cost: 89.885s | Loading data Done
[1467613:MainThread](2026-01-12 01:35:40,164) INFO - qlib.timer - [log.py:127] - Time cost: 7.824s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-12 01:35:44,043) INFO - qlib.timer - [log.py:127] - Time cost: 3.878s | Fillna Done
[1467613:MainThread](2026-01-12 01:35:46,127) INFO - qlib.timer - [log.py:127] - Time cost: 0.340s | DropnaLabel Done
[1467613:MainThread](2026-01-12 01:35:46,347) INFO - qlib.timer - [log.py:127] - Time cost: 0.219s | CSRankNorm Done
[1467613:MainThread](2026-01-12 01:35:46,350) INFO - qlib.timer - [log.py:127] - Time cost: 14.562s | fit & process data Done
[1467613:MainThread](2026-01-12 01:35:46,351) INFO - qlib.timer - [log.py:127] - Time cost: 104.450s | Init data Done
2026-01-12 01:35:46.351 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-12 01:35:46,352) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-12 01:35:46,353) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-12 01:35:46,765) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-12 01:35:46,770) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-12 01:35:46.780 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-12 01:35:47,524) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-12 01:35:47,524) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-12 01:35:47,525) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:36:49,131) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:37:32,887) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.993702, valid -0.996271
[1467613:MainThread](2026-01-12 01:37:32,890) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-12 01:37:32,890) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:38:33,967) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:39:16,547) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.989818, valid -0.997441
[1467613:MainThread](2026-01-12 01:39:16,548) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-12 01:39:16,548) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:40:14,555) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:40:50,810) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.988153, valid -0.997551
[1467613:MainThread](2026-01-12 01:40:50,811) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-12 01:40:50,811) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:41:47,167) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:42:23,373) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.987247, valid -0.995922
[1467613:MainThread](2026-01-12 01:42:23,375) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-12 01:42:23,375) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:43:16,365) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:43:54,862) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.985760, valid -0.998323
[1467613:MainThread](2026-01-12 01:43:54,863) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-12 01:43:54,864) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:44:45,761) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:45:24,942) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.984805, valid -0.995466
[1467613:MainThread](2026-01-12 01:45:24,945) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-12 01:45:24,946) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:46:26,456) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:47:07,391) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983757, valid -0.997048
[1467613:MainThread](2026-01-12 01:47:07,392) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-12 01:47:07,393) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:48:08,257) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:48:49,627) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983549, valid -0.994979
[1467613:MainThread](2026-01-12 01:48:49,631) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-12 01:48:49,631) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:49:53,200) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:50:37,859) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982015, valid -0.996120
[1467613:MainThread](2026-01-12 01:50:37,860) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-12 01:50:37,860) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:51:39,828) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:52:20,722) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.980599, valid -0.997261
[1467613:MainThread](2026-01-12 01:52:20,723) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-12 01:52:20,724) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:53:21,944) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:54:02,676) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.979406, valid -0.997882
[1467613:MainThread](2026-01-12 01:54:02,678) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-12 01:54:02,678) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:55:02,341) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:55:44,644) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978672, valid -0.997153
[1467613:MainThread](2026-01-12 01:55:44,645) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-12 01:55:44,645) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:56:44,957) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:57:19,639) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.977591, valid -0.999046
[1467613:MainThread](2026-01-12 01:57:19,640) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-12 01:57:19,640) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:58:13,293) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 01:58:50,421) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976457, valid -0.999725
[1467613:MainThread](2026-01-12 01:58:50,421) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-12 01:58:50,422) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 01:59:44,197) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:00:20,525) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975597, valid -0.999328
[1467613:MainThread](2026-01-12 02:00:20,526) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-12 02:00:20,526) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:01:20,359) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:02:00,673) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.974374, valid -0.999390
[1467613:MainThread](2026-01-12 02:02:00,674) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-12 02:02:00,674) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:03:02,508) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:03:44,042) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.974850, valid -1.000944
[1467613:MainThread](2026-01-12 02:03:44,044) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-12 02:03:44,045) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:04:46,978) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:05:28,840) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973244, valid -1.000144
[1467613:MainThread](2026-01-12 02:05:28,841) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-12 02:05:28,841) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:06:28,966) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:07:10,507) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973221, valid -1.000167
[1467613:MainThread](2026-01-12 02:07:10,508) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-12 02:07:10,508) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:08:04,913) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:08:41,267) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.970723, valid -1.001766
[1467613:MainThread](2026-01-12 02:08:41,268) INFO - qlib.SFM - [pytorch_sfm.py:410] - best score: -0.994979 @ 7
2026-01-12 02:08:41.492 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 02:08:50.587 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-12 02:08:50.588 | INFO     | __main__:train_single_fold:593 -   IC=0.0233, ICIR=0.2208, RankIC=0.0337, RankICIR=0.3475
2026-01-12 02:08:50.588 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1467613:MainThread](2026-01-12 02:08:50,595) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 02:09:27,344) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:09:27,345) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:09:35,101) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069da90f90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 27.61it/s]backtest loop:   5%|▌         | 13/243 [00:00<00:03, 66.82it/s]backtest loop:   9%|▉         | 23/243 [00:00<00:02, 80.91it/s]backtest loop:  14%|█▎        | 33/243 [00:00<00:02, 87.42it/s]backtest loop:  18%|█▊        | 43/243 [00:00<00:02, 90.16it/s]backtest loop:  22%|██▏       | 53/243 [00:00<00:02, 92.63it/s]backtest loop:  26%|██▌       | 63/243 [00:00<00:01, 94.00it/s]backtest loop:  30%|███       | 73/243 [00:00<00:01, 95.22it/s]backtest loop:  34%|███▍      | 83/243 [00:00<00:01, 91.55it/s]backtest loop:  38%|███▊      | 93/243 [00:01<00:01, 93.28it/s]backtest loop:  42%|████▏     | 103/243 [00:01<00:01, 94.67it/s]backtest loop:  47%|████▋     | 113/243 [00:01<00:01, 94.26it/s]backtest loop:  51%|█████     | 123/243 [00:01<00:01, 92.65it/s]backtest loop:  55%|█████▍    | 133/243 [00:01<00:01, 89.65it/s]backtest loop:  59%|█████▉    | 143/243 [00:01<00:01, 86.64it/s]backtest loop:  63%|██████▎   | 152/243 [00:01<00:01, 83.57it/s]backtest loop:  66%|██████▋   | 161/243 [00:01<00:01, 80.90it/s]backtest loop:  70%|██████▉   | 170/243 [00:01<00:00, 80.07it/s]backtest loop:  74%|███████▍  | 180/243 [00:02<00:00, 79.55it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 78.07it/s]backtest loop:  81%|████████  | 196/243 [00:02<00:00, 77.15it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 76.07it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 79.86it/s]backtest loop:  91%|█████████▏| 222/243 [00:02<00:00, 79.00it/s]backtest loop:  95%|█████████▍| 230/243 [00:02<00:00, 77.62it/s]backtest loop:  98%|█████████▊| 239/243 [00:02<00:00, 77.20it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.16it/s]
2026-01-12 02:09:38.047 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0404, Sharpe(w/cost)=-0.5853, MaxDD=-0.1240
2026-01-12 02:09:41.939 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pdf/fold_4_backtest_report.pdf
2026-01-12 02:09:57.871 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 02:09:57.951 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pred/fold_4_pred.parquet
2026-01-12 02:09:57.973 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-12 02:09:57.973 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-12 02:10:07.594 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0357
2026-01-12 02:10:17.494 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0319
2026-01-12 02:10:27.408 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0363
2026-01-12 02:10:37.232 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0325
2026-01-12 02:10:37.594 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0223, ICIR=0.1921, RankIC=0.0376
[1467613:MainThread](2026-01-12 02:10:37,601) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 02:11:18,466) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:11:18,468) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:11:25,904) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069f910810>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.62it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 52.49it/s]backtest loop:   7%|▋         | 17/243 [00:00<00:04, 54.92it/s]backtest loop:  11%|█         | 26/243 [00:00<00:03, 64.31it/s]backtest loop:  14%|█▎        | 33/243 [00:00<00:03, 64.84it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 68.39it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 73.10it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 71.60it/s]backtest loop:  28%|██▊       | 67/243 [00:01<00:02, 72.04it/s]backtest loop:  31%|███       | 75/243 [00:01<00:02, 68.11it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 70.45it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:02, 72.86it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 75.59it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 77.03it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 76.42it/s]backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 79.81it/s]backtest loop:  57%|█████▋    | 138/243 [00:01<00:01, 79.39it/s]backtest loop:  60%|██████    | 146/243 [00:02<00:01, 78.23it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 79.27it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 79.98it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 80.45it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 76.48it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 77.27it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 78.32it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 79.07it/s]backtest loop:  92%|█████████▏| 224/243 [00:03<00:00, 79.48it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 80.12it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.83it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 74.51it/s]
2026-01-12 02:11:29.188 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0992, Sharpe(w/cost)=-1.3312
2026-01-12 02:11:29.248 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 02:11:29.248 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-12 02:11:29.248 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 02:11:29.248 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-12 02:13:00,714) INFO - qlib.timer - [log.py:127] - Time cost: 91.463s | Loading data Done
[1467613:MainThread](2026-01-12 02:13:08,882) INFO - qlib.timer - [log.py:127] - Time cost: 7.580s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-12 02:13:12,203) INFO - qlib.timer - [log.py:127] - Time cost: 3.320s | Fillna Done
[1467613:MainThread](2026-01-12 02:13:13,951) INFO - qlib.timer - [log.py:127] - Time cost: 0.330s | DropnaLabel Done
[1467613:MainThread](2026-01-12 02:13:14,164) INFO - qlib.timer - [log.py:127] - Time cost: 0.213s | CSRankNorm Done
[1467613:MainThread](2026-01-12 02:13:14,167) INFO - qlib.timer - [log.py:127] - Time cost: 13.453s | fit & process data Done
[1467613:MainThread](2026-01-12 02:13:14,168) INFO - qlib.timer - [log.py:127] - Time cost: 104.919s | Init data Done
2026-01-12 02:13:14.168 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-12 02:13:14,169) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-12 02:13:14,170) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-12 02:13:14,696) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-12 02:13:14,696) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-12 02:13:14.713 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-12 02:13:15,487) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-12 02:13:15,488) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-12 02:13:15,489) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:14:15,554) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:14:56,120) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.992174, valid -0.995256
[1467613:MainThread](2026-01-12 02:14:56,123) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-12 02:14:56,123) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:15:56,646) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:16:37,088) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.989732, valid -0.996096
[1467613:MainThread](2026-01-12 02:16:37,089) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-12 02:16:37,089) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:17:38,116) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:18:18,186) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.988186, valid -0.996754
[1467613:MainThread](2026-01-12 02:18:18,187) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-12 02:18:18,187) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:19:19,410) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:19:55,409) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.986857, valid -0.997293
[1467613:MainThread](2026-01-12 02:19:55,410) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-12 02:19:55,411) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:20:47,183) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:21:23,900) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.985768, valid -0.998062
[1467613:MainThread](2026-01-12 02:21:23,901) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-12 02:21:23,902) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:22:22,672) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:23:02,517) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.984836, valid -0.997150
[1467613:MainThread](2026-01-12 02:23:02,518) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-12 02:23:02,518) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:24:04,466) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:24:44,649) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983851, valid -0.998805
[1467613:MainThread](2026-01-12 02:24:44,650) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-12 02:24:44,650) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:25:45,698) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:26:29,673) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982384, valid -0.998799
[1467613:MainThread](2026-01-12 02:26:29,674) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-12 02:26:29,675) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:27:32,731) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:28:15,935) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.981640, valid -0.999057
[1467613:MainThread](2026-01-12 02:28:15,936) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-12 02:28:15,936) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:29:18,992) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:30:02,542) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.980227, valid -0.999286
[1467613:MainThread](2026-01-12 02:30:02,543) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-12 02:30:02,544) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:31:04,595) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:31:47,425) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.980154, valid -1.000713
[1467613:MainThread](2026-01-12 02:31:47,426) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-12 02:31:47,427) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:32:48,352) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:33:29,355) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.977363, valid -1.001684
[1467613:MainThread](2026-01-12 02:33:29,356) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-12 02:33:29,357) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:34:32,425) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:35:16,539) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976663, valid -1.001115
[1467613:MainThread](2026-01-12 02:35:16,540) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-12 02:35:16,540) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:36:20,228) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:37:03,454) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975085, valid -1.001943
[1467613:MainThread](2026-01-12 02:37:03,455) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-12 02:37:03,455) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:38:06,819) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:38:49,892) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.975478, valid -1.003694
[1467613:MainThread](2026-01-12 02:38:49,893) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-12 02:38:49,894) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:39:53,625) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:40:34,240) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.973311, valid -1.003763
[1467613:MainThread](2026-01-12 02:40:34,241) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-12 02:40:34,242) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:41:36,000) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:42:18,356) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.970947, valid -1.004925
[1467613:MainThread](2026-01-12 02:42:18,357) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-12 02:42:18,358) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:43:20,919) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:44:02,957) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.970244, valid -1.005200
[1467613:MainThread](2026-01-12 02:44:02,958) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-12 02:44:02,959) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:45:04,950) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:45:45,816) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.968983, valid -1.006984
[1467613:MainThread](2026-01-12 02:45:45,817) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-12 02:45:45,818) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:46:46,544) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:47:28,697) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.968855, valid -1.006653
[1467613:MainThread](2026-01-12 02:47:28,698) INFO - qlib.SFM - [pytorch_sfm.py:410] - best score: -0.995256 @ 0
2026-01-12 02:47:28.898 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 02:47:38.580 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-12 02:47:38.580 | INFO     | __main__:train_single_fold:593 -   IC=0.0082, ICIR=0.0659, RankIC=0.0342, RankICIR=0.2741
2026-01-12 02:47:38.581 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1467613:MainThread](2026-01-12 02:47:38,588) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 02:48:27,390) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:48:27,392) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:48:35,914) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f069cecfb10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.47it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:04, 47.96it/s]backtest loop:   7%|▋         | 18/243 [00:00<00:03, 58.74it/s]backtest loop:  10%|█         | 25/243 [00:00<00:03, 60.99it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:03, 60.69it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:03, 63.24it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 69.15it/s]backtest loop:  23%|██▎       | 57/243 [00:00<00:02, 67.48it/s]backtest loop:  27%|██▋       | 65/243 [00:01<00:02, 69.50it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 68.32it/s]backtest loop:  33%|███▎      | 81/243 [00:01<00:02, 68.57it/s]backtest loop:  37%|███▋      | 90/243 [00:01<00:02, 74.09it/s]backtest loop:  40%|████      | 98/243 [00:01<00:01, 74.37it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 74.22it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 75.06it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 77.22it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 78.08it/s]backtest loop:  60%|█████▉    | 145/243 [00:02<00:01, 78.84it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 79.49it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 79.56it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 79.62it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 74.87it/s]backtest loop:  79%|███████▉  | 192/243 [00:02<00:00, 78.24it/s]backtest loop:  82%|████████▏ | 200/243 [00:02<00:00, 76.78it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 76.03it/s]backtest loop:  90%|████████▉ | 218/243 [00:03<00:00, 77.11it/s]backtest loop:  94%|█████████▍| 228/243 [00:03<00:00, 77.83it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 78.44it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 73.04it/s]
2026-01-12 02:48:39.264 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0516, Sharpe(w/cost)=-0.4842, MaxDD=-0.1374
2026-01-12 02:48:43.411 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pdf/fold_5_backtest_report.pdf
2026-01-12 02:49:01.356 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 02:49:01.430 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_230430_sfm_360_6y/pred/fold_5_pred.parquet
2026-01-12 02:49:01.452 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-12 02:49:01.452 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-12 02:49:12.645 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0267
2026-01-12 02:49:23.897 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0229
2026-01-12 02:49:34.867 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0252
2026-01-12 02:49:45.532 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0279
2026-01-12 02:49:56.171 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0270
2026-01-12 02:49:56.557 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0104, ICIR=0.0870, RankIC=0.0345
[1467613:MainThread](2026-01-12 02:49:56,564) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1467613:MainThread](2026-01-12 02:50:42,962) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:50:42,963) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1467613:MainThread](2026-01-12 02:50:50,886) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f08b6587b10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.33it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 52.74it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 63.78it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 67.43it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 70.17it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 72.64it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 75.27it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 75.09it/s]backtest loop:  30%|███       | 73/243 [00:01<00:02, 79.16it/s]backtest loop:  33%|███▎      | 81/243 [00:01<00:02, 74.16it/s]backtest loop:  37%|███▋      | 90/243 [00:01<00:01, 77.26it/s]backtest loop:  40%|████      | 98/243 [00:01<00:01, 76.33it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 76.07it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 81.19it/s]backtest loop:  52%|█████▏    | 126/243 [00:01<00:01, 85.12it/s]backtest loop:  56%|█████▌    | 136/243 [00:01<00:01, 87.72it/s]backtest loop:  60%|██████    | 146/243 [00:01<00:01, 90.20it/s]backtest loop:  64%|██████▍   | 156/243 [00:01<00:00, 91.98it/s]backtest loop:  68%|██████▊   | 166/243 [00:02<00:00, 93.14it/s]backtest loop:  72%|███████▏  | 176/243 [00:02<00:00, 94.35it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 91.51it/s]backtest loop:  81%|████████  | 196/243 [00:02<00:00, 92.76it/s]backtest loop:  85%|████████▍ | 206/243 [00:02<00:00, 93.52it/s]backtest loop:  89%|████████▉ | 216/243 [00:02<00:00, 94.04it/s]backtest loop:  93%|█████████▎| 226/243 [00:02<00:00, 94.29it/s]backtest loop:  97%|█████████▋| 236/243 [00:02<00:00, 94.86it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.08it/s]
2026-01-12 02:50:53.831 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0468, Sharpe(w/cost)=-0.5228
2026-01-12 02:50:53.873 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 02:50:53.873 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-12 02:50:53.873 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 02:50:53.873 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1467613:MainThread](2026-01-12 02:52:32,873) INFO - qlib.timer - [log.py:127] - Time cost: 98.998s | Loading data Done
[1467613:MainThread](2026-01-12 02:52:41,614) INFO - qlib.timer - [log.py:127] - Time cost: 8.130s | RobustZScoreNorm Done
[1467613:MainThread](2026-01-12 02:52:45,413) INFO - qlib.timer - [log.py:127] - Time cost: 3.798s | Fillna Done
[1467613:MainThread](2026-01-12 02:52:47,031) INFO - qlib.timer - [log.py:127] - Time cost: 0.327s | DropnaLabel Done
[1467613:MainThread](2026-01-12 02:52:47,243) INFO - qlib.timer - [log.py:127] - Time cost: 0.212s | CSRankNorm Done
[1467613:MainThread](2026-01-12 02:52:47,246) INFO - qlib.timer - [log.py:127] - Time cost: 14.372s | fit & process data Done
[1467613:MainThread](2026-01-12 02:52:47,247) INFO - qlib.timer - [log.py:127] - Time cost: 113.373s | Init data Done
2026-01-12 02:52:47.248 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1467613:MainThread](2026-01-12 02:52:47,248) INFO - qlib.SFM - [pytorch_sfm.py:219] - SFM pytorch version...
[1467613:MainThread](2026-01-12 02:52:47,249) INFO - qlib.SFM - [pytorch_sfm.py:239] - SFM parameters setting:
d_feat : 6
hidden_size : 64
output_size : 32
frequency_dimension : 25
dropout_W: 0.5
dropout_U: 0.5
n_epochs : 20
lr : 0.001
metric : 
batch_size : 1600
early_stop : 20
eval_steps : 5
optimizer : adam
loss_type : mse
device : cuda:0
use_GPU : True
seed : None
[1467613:MainThread](2026-01-12 02:52:47,940) INFO - qlib.SFM - [pytorch_sfm.py:291] - model:
SFM_Model(
  (activation): Tanh()
  (inner_activation): Hardsigmoid()
  (fc_out): Linear(in_features=32, out_features=1, bias=True)
)
[1467613:MainThread](2026-01-12 02:52:47,945) INFO - qlib.SFM - [pytorch_sfm.py:292] - model size: 0.0211 MB
2026-01-12 02:52:47.956 | INFO     | __main__:train_single_fold:569 - Training sfm_360 model (GPU=0)...
[1467613:MainThread](2026-01-12 02:52:48,754) INFO - qlib.SFM - [pytorch_sfm.py:385] - training...
[1467613:MainThread](2026-01-12 02:52:48,754) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch0:
[1467613:MainThread](2026-01-12 02:52:48,755) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:53:53,236) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:54:36,822) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.993876, valid -0.997615
[1467613:MainThread](2026-01-12 02:54:36,825) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch1:
[1467613:MainThread](2026-01-12 02:54:36,826) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:55:41,593) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:56:26,098) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.992355, valid -0.999854
[1467613:MainThread](2026-01-12 02:56:26,099) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch2:
[1467613:MainThread](2026-01-12 02:56:26,100) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:57:29,940) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 02:58:14,025) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.991028, valid -0.998789
[1467613:MainThread](2026-01-12 02:58:14,033) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch3:
[1467613:MainThread](2026-01-12 02:58:14,034) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 02:59:20,022) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:00:03,221) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.990845, valid -0.999772
[1467613:MainThread](2026-01-12 03:00:03,222) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch4:
[1467613:MainThread](2026-01-12 03:00:03,222) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:01:07,390) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:01:48,770) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.989106, valid -0.999929
[1467613:MainThread](2026-01-12 03:01:48,771) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch5:
[1467613:MainThread](2026-01-12 03:01:48,772) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:02:51,454) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:03:33,623) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.989055, valid -1.001467
[1467613:MainThread](2026-01-12 03:03:33,624) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch6:
[1467613:MainThread](2026-01-12 03:03:33,625) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:04:37,470) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:05:22,223) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.987700, valid -0.999666
[1467613:MainThread](2026-01-12 03:05:22,224) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch7:
[1467613:MainThread](2026-01-12 03:05:22,224) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:06:26,550) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:07:07,706) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.986507, valid -0.999957
[1467613:MainThread](2026-01-12 03:07:07,706) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch8:
[1467613:MainThread](2026-01-12 03:07:07,707) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:08:08,635) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:08:51,365) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.986048, valid -1.001762
[1467613:MainThread](2026-01-12 03:08:51,366) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch9:
[1467613:MainThread](2026-01-12 03:08:51,366) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:09:55,604) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:10:39,240) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.983881, valid -1.002909
[1467613:MainThread](2026-01-12 03:10:39,241) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch10:
[1467613:MainThread](2026-01-12 03:10:39,242) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:11:42,673) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:12:24,144) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.982749, valid -1.003388
[1467613:MainThread](2026-01-12 03:12:24,145) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch11:
[1467613:MainThread](2026-01-12 03:12:24,146) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:13:28,160) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:14:11,789) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.981865, valid -1.004959
[1467613:MainThread](2026-01-12 03:14:11,790) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch12:
[1467613:MainThread](2026-01-12 03:14:11,791) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:15:15,564) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:15:57,502) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.981628, valid -1.004011
[1467613:MainThread](2026-01-12 03:15:57,503) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch13:
[1467613:MainThread](2026-01-12 03:15:57,503) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:17:03,214) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:17:45,235) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978720, valid -1.007426
[1467613:MainThread](2026-01-12 03:17:45,236) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch14:
[1467613:MainThread](2026-01-12 03:17:45,236) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:18:47,846) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:19:29,951) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.978036, valid -1.007568
[1467613:MainThread](2026-01-12 03:19:29,952) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch15:
[1467613:MainThread](2026-01-12 03:19:29,953) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:20:30,368) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:21:10,821) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.976457, valid -1.009753
[1467613:MainThread](2026-01-12 03:21:10,822) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch16:
[1467613:MainThread](2026-01-12 03:21:10,822) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:22:12,000) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:22:54,706) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.974702, valid -1.009057
[1467613:MainThread](2026-01-12 03:22:54,707) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch17:
[1467613:MainThread](2026-01-12 03:22:54,708) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:23:57,976) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:24:41,345) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.972991, valid -1.009983
[1467613:MainThread](2026-01-12 03:24:41,345) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch18:
[1467613:MainThread](2026-01-12 03:24:41,346) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
[1467613:MainThread](2026-01-12 03:25:44,130) INFO - qlib.SFM - [pytorch_sfm.py:392] - evaluating...
[1467613:MainThread](2026-01-12 03:26:25,026) INFO - qlib.SFM - [pytorch_sfm.py:395] - train -0.971479, valid -1.014360
[1467613:MainThread](2026-01-12 03:26:25,027) INFO - qlib.SFM - [pytorch_sfm.py:389] - Epoch19:
[1467613:MainThread](2026-01-12 03:26:25,027) INFO - qlib.SFM - [pytorch_sfm.py:390] - training...
