Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1567253:MainThread](2026-01-12 01:44:48,960) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1567253:MainThread](2026-01-12 01:44:49,396) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1567253:MainThread](2026-01-12 01:44:49,397) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-12 01:44:49.406 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y
2026-01-12 01:44:49.406 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/log/transformer_158_10_robust_csi500_topk_20260112_014449.log
2026-01-12 01:44:49.407 | INFO     | __main__:__init__:115 - Model name: transformer_158_10_robust_csi500_topk
2026-01-12 01:44:49.409 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-12 01:44:49.409 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 01:44:49.409 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-12 01:44:49.409 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 01:44:49.409 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 01:45:03,207) INFO - qlib.timer - [log.py:127] - Time cost: 13.796s | Loading data Done
[1567253:MainThread](2026-01-12 01:45:03,459) INFO - qlib.timer - [log.py:127] - Time cost: 0.015s | FilterCol Done
[1567253:MainThread](2026-01-12 01:45:03,904) INFO - qlib.timer - [log.py:127] - Time cost: 0.444s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 01:45:04,045) INFO - qlib.timer - [log.py:127] - Time cost: 0.140s | Fillna Done
[1567253:MainThread](2026-01-12 01:45:04,138) INFO - qlib.timer - [log.py:127] - Time cost: 0.025s | DropnaLabel Done
[1567253:MainThread](2026-01-12 01:45:04,333) INFO - qlib.timer - [log.py:127] - Time cost: 0.194s | CSRankNorm Done
[1567253:MainThread](2026-01-12 01:45:04,334) INFO - qlib.timer - [log.py:127] - Time cost: 1.126s | fit & process data Done
[1567253:MainThread](2026-01-12 01:45:04,334) INFO - qlib.timer - [log.py:127] - Time cost: 14.924s | Init data Done
2026-01-12 01:45:04.335 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 01:45:04,559) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 01:45:06.050 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 01:45:07,786) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 01:45:07,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 01:45:07,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1567253:MainThread](2026-01-12 01:45:17,793) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:45:24,036) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990257, valid -0.993878
[1567253:MainThread](2026-01-12 01:45:24,040) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 01:45:24,040) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:45:33,153) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:45:40,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988255, valid -0.993587
[1567253:MainThread](2026-01-12 01:45:40,627) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 01:45:40,627) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:45:49,952) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:46:03,087) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988008, valid -0.996115
[1567253:MainThread](2026-01-12 01:46:03,088) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 01:46:03,088) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:46:12,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:46:25,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993283, valid -0.997378
[1567253:MainThread](2026-01-12 01:46:25,755) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 01:46:25,755) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:46:35,678) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:46:46,354) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988068, valid -0.993317
[1567253:MainThread](2026-01-12 01:46:46,357) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 01:46:46,358) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:46:55,868) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:47:03,007) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991080, valid -0.995748
[1567253:MainThread](2026-01-12 01:47:03,007) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 01:47:03,008) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:47:12,449) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:47:23,282) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987115, valid -0.994911
[1567253:MainThread](2026-01-12 01:47:23,282) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 01:47:23,283) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:47:32,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:47:44,594) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986665, valid -0.993211
[1567253:MainThread](2026-01-12 01:47:44,598) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 01:47:44,598) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:47:54,270) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:48:07,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986851, valid -0.993832
[1567253:MainThread](2026-01-12 01:48:08,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 01:48:08,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:48:17,494) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:48:25,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986913, valid -0.993625
[1567253:MainThread](2026-01-12 01:48:25,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 01:48:25,981) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:48:35,415) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:48:50,824) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986750, valid -0.992701
[1567253:MainThread](2026-01-12 01:48:50,829) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 01:48:50,830) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:49:09,525) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:49:20,454) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986766, valid -0.992477
[1567253:MainThread](2026-01-12 01:49:20,457) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 01:49:20,458) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:49:29,674) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:49:42,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986812, valid -0.993100
[1567253:MainThread](2026-01-12 01:49:42,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 01:49:42,806) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:49:52,416) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:50:03,858) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987395, valid -0.993549
[1567253:MainThread](2026-01-12 01:50:03,859) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 01:50:03,859) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:50:19,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:50:35,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986596, valid -0.992181
[1567253:MainThread](2026-01-12 01:50:35,199) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 01:50:35,199) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:50:50,761) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:51:03,999) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987088, valid -0.992495
[1567253:MainThread](2026-01-12 01:51:04,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 01:51:04,000) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:51:13,109) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:51:26,002) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987146, valid -0.992525
[1567253:MainThread](2026-01-12 01:51:26,002) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 01:51:26,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:51:35,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:51:47,863) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986965, valid -0.992046
[1567253:MainThread](2026-01-12 01:51:47,867) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 01:51:47,868) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:51:57,430) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:52:07,568) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986760, valid -0.992925
[1567253:MainThread](2026-01-12 01:52:07,568) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 01:52:07,569) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:52:16,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:52:29,271) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987492, valid -0.994513
[1567253:MainThread](2026-01-12 01:52:29,272) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 01:52:29,272) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:52:38,902) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:52:52,869) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986758, valid -0.993401
[1567253:MainThread](2026-01-12 01:52:52,870) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 01:52:52,870) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:53:02,887) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:53:10,182) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986866, valid -0.991744
[1567253:MainThread](2026-01-12 01:53:10,185) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch22:
[1567253:MainThread](2026-01-12 01:53:10,186) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:53:19,517) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:53:32,795) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987445, valid -0.993338
[1567253:MainThread](2026-01-12 01:53:32,795) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch23:
[1567253:MainThread](2026-01-12 01:53:32,796) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:53:42,009) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:53:55,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986774, valid -0.991751
[1567253:MainThread](2026-01-12 01:53:55,301) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch24:
[1567253:MainThread](2026-01-12 01:53:55,301) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:54:04,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:54:17,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987184, valid -0.992684
[1567253:MainThread](2026-01-12 01:54:17,031) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch25:
[1567253:MainThread](2026-01-12 01:54:17,032) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:54:27,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:54:34,321) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986739, valid -0.993673
[1567253:MainThread](2026-01-12 01:54:34,322) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch26:
[1567253:MainThread](2026-01-12 01:54:34,322) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:54:43,748) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:54:57,598) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987139, valid -0.992632
[1567253:MainThread](2026-01-12 01:54:57,598) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch27:
[1567253:MainThread](2026-01-12 01:54:57,599) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:55:07,272) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:55:18,226) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986683, valid -0.992666
[1567253:MainThread](2026-01-12 01:55:18,227) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch28:
[1567253:MainThread](2026-01-12 01:55:18,227) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:55:27,752) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:55:39,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987727, valid -0.992752
[1567253:MainThread](2026-01-12 01:55:39,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch29:
[1567253:MainThread](2026-01-12 01:55:39,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:55:49,308) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:55:58,756) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987469, valid -0.993948
[1567253:MainThread](2026-01-12 01:55:58,757) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch30:
[1567253:MainThread](2026-01-12 01:55:58,757) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:56:08,601) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:56:19,924) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986707, valid -0.993208
[1567253:MainThread](2026-01-12 01:56:19,924) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch31:
[1567253:MainThread](2026-01-12 01:56:19,925) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:56:29,767) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:56:40,911) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.986396, valid -0.993399
[1567253:MainThread](2026-01-12 01:56:40,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 01:56:40,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.991744 @ 21
2026-01-12 01:56:40.962 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 01:56:44.565 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-12 01:56:44.565 | INFO     | __main__:train_single_fold:593 -   IC=0.0538, ICIR=0.4845, RankIC=0.0798, RankICIR=0.6988
2026-01-12 01:56:44.565 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 01:56:44,573) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 01:56:56,739) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 01:56:56,740) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 01:57:00,757) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1e54fc2350>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▎         | 9/244 [00:00<00:02, 83.80it/s]backtest loop:   7%|▋         | 18/244 [00:00<00:02, 80.64it/s]backtest loop:  11%|█         | 27/244 [00:00<00:02, 80.63it/s]backtest loop:  15%|█▍        | 36/244 [00:00<00:02, 81.18it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:02, 80.67it/s]backtest loop:  22%|██▏       | 54/244 [00:00<00:02, 82.83it/s]backtest loop:  26%|██▌       | 63/244 [00:00<00:02, 81.48it/s]backtest loop:  30%|██▉       | 72/244 [00:00<00:02, 80.47it/s]backtest loop:  33%|███▎      | 81/244 [00:01<00:02, 79.89it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 78.33it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 77.83it/s]backtest loop:  43%|████▎     | 106/244 [00:01<00:01, 77.01it/s]backtest loop:  47%|████▋     | 115/244 [00:01<00:01, 80.22it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 79.11it/s]backtest loop:  54%|█████▍    | 132/244 [00:01<00:01, 77.69it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:01, 77.44it/s]backtest loop:  61%|██████▏   | 150/244 [00:01<00:01, 80.32it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:01, 79.19it/s]backtest loop:  68%|██████▊   | 167/244 [00:02<00:00, 78.21it/s]backtest loop:  72%|███████▏  | 175/244 [00:02<00:00, 77.69it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 78.81it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 80.25it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 80.63it/s]backtest loop:  87%|████████▋ | 213/244 [00:02<00:00, 82.94it/s]backtest loop:  91%|█████████ | 222/244 [00:02<00:00, 83.11it/s]backtest loop:  95%|█████████▍| 231/244 [00:02<00:00, 84.60it/s]backtest loop:  98%|█████████▊| 240/244 [00:02<00:00, 84.06it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 80.41it/s]
2026-01-12 01:57:03.812 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3078, Sharpe(w/cost)=2.7896, MaxDD=-0.0415
2026-01-12 01:57:06.699 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_0_backtest_report.pdf
2026-01-12 01:57:21.203 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 01:57:21.270 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_0_pred.parquet
2026-01-12 01:57:21.313 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 01:57:21.313 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-12 01:57:21.313 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 01:57:21.313 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 01:57:50,241) INFO - qlib.timer - [log.py:127] - Time cost: 28.926s | Loading data Done
[1567253:MainThread](2026-01-12 01:57:50,492) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[1567253:MainThread](2026-01-12 01:57:50,905) INFO - qlib.timer - [log.py:127] - Time cost: 0.412s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 01:57:51,013) INFO - qlib.timer - [log.py:127] - Time cost: 0.107s | Fillna Done
[1567253:MainThread](2026-01-12 01:57:51,095) INFO - qlib.timer - [log.py:127] - Time cost: 0.023s | DropnaLabel Done
[1567253:MainThread](2026-01-12 01:57:51,281) INFO - qlib.timer - [log.py:127] - Time cost: 0.185s | CSRankNorm Done
[1567253:MainThread](2026-01-12 01:57:51,282) INFO - qlib.timer - [log.py:127] - Time cost: 1.041s | fit & process data Done
[1567253:MainThread](2026-01-12 01:57:51,283) INFO - qlib.timer - [log.py:127] - Time cost: 29.969s | Init data Done
2026-01-12 01:57:51.283 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 01:57:51,303) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 01:57:51.329 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 01:57:53,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 01:57:53,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 01:57:53,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:57:59,319) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:58:06,363) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.995121, valid -0.996539
[1567253:MainThread](2026-01-12 01:58:06,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 01:58:06,368) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:58:14,900) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:58:23,017) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990160, valid -0.993211
[1567253:MainThread](2026-01-12 01:58:23,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 01:58:23,021) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:58:30,644) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:58:37,236) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989727, valid -0.992701
[1567253:MainThread](2026-01-12 01:58:37,240) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 01:58:37,241) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:58:43,695) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:58:50,343) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989228, valid -0.992501
[1567253:MainThread](2026-01-12 01:58:50,346) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 01:58:50,347) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:58:56,922) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:59:04,468) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989966, valid -0.996530
[1567253:MainThread](2026-01-12 01:59:04,468) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 01:59:04,469) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:59:10,974) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:59:18,022) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989123, valid -0.994968
[1567253:MainThread](2026-01-12 01:59:18,023) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 01:59:18,023) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:59:24,658) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:59:31,294) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988235, valid -0.991713
[1567253:MainThread](2026-01-12 01:59:31,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 01:59:31,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:59:38,705) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 01:59:45,693) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989286, valid -0.994800
[1567253:MainThread](2026-01-12 01:59:45,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 01:59:45,694) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 01:59:53,637) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:00:00,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988227, valid -0.991655
[1567253:MainThread](2026-01-12 02:00:00,371) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 02:00:00,372) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:00:06,967) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:00:13,900) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990721, valid -0.994498
[1567253:MainThread](2026-01-12 02:00:13,901) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 02:00:13,901) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:00:20,233) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:00:27,574) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989266, valid -0.991069
[1567253:MainThread](2026-01-12 02:00:27,578) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 02:00:27,578) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:00:33,958) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:00:41,833) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989222, valid -0.991091
[1567253:MainThread](2026-01-12 02:00:41,833) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 02:00:41,834) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:00:51,380) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:01:00,334) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988193, valid -0.991965
[1567253:MainThread](2026-01-12 02:01:00,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 02:01:00,336) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:01:10,602) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:01:24,934) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988104, valid -0.992433
[1567253:MainThread](2026-01-12 02:01:24,934) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 02:01:24,935) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:01:35,200) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:01:48,229) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988312, valid -0.991534
[1567253:MainThread](2026-01-12 02:01:48,230) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 02:01:48,230) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:01:58,490) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:02:10,621) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988210, valid -0.990997
[1567253:MainThread](2026-01-12 02:02:10,625) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 02:02:10,625) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:02:20,823) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:02:29,827) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988160, valid -0.992469
[1567253:MainThread](2026-01-12 02:02:29,827) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 02:02:29,828) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:02:40,290) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:02:52,116) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988457, valid -0.991230
[1567253:MainThread](2026-01-12 02:02:52,117) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 02:02:52,118) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:03:02,258) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:03:12,314) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988159, valid -0.991466
[1567253:MainThread](2026-01-12 02:03:12,314) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 02:03:12,315) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:03:22,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:03:36,285) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988457, valid -0.990554
[1567253:MainThread](2026-01-12 02:03:36,289) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 02:03:36,290) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:03:47,404) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:04:00,257) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988499, valid -0.991930
[1567253:MainThread](2026-01-12 02:04:00,258) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 02:04:00,258) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:04:10,193) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:04:22,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988692, valid -0.991091
[1567253:MainThread](2026-01-12 02:04:22,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch22:
[1567253:MainThread](2026-01-12 02:04:22,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:04:32,738) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:04:44,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988242, valid -0.991936
[1567253:MainThread](2026-01-12 02:04:44,503) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch23:
[1567253:MainThread](2026-01-12 02:04:44,503) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:04:54,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:05:08,630) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988333, valid -0.992989
[1567253:MainThread](2026-01-12 02:05:08,630) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch24:
[1567253:MainThread](2026-01-12 02:05:08,631) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:05:18,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:05:27,683) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988322, valid -0.991998
[1567253:MainThread](2026-01-12 02:05:27,684) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch25:
[1567253:MainThread](2026-01-12 02:05:27,684) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:05:37,408) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:05:47,908) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988187, valid -0.992003
[1567253:MainThread](2026-01-12 02:05:47,909) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch26:
[1567253:MainThread](2026-01-12 02:05:47,910) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:05:57,642) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:06:09,061) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988297, valid -0.991634
[1567253:MainThread](2026-01-12 02:06:09,062) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch27:
[1567253:MainThread](2026-01-12 02:06:09,063) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:06:19,271) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:06:31,808) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989185, valid -0.993490
[1567253:MainThread](2026-01-12 02:06:31,808) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch28:
[1567253:MainThread](2026-01-12 02:06:31,809) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:06:42,173) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:06:52,942) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988355, valid -0.991358
[1567253:MainThread](2026-01-12 02:06:52,942) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch29:
[1567253:MainThread](2026-01-12 02:06:52,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:07:02,855) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:07:14,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988478, valid -0.993173
[1567253:MainThread](2026-01-12 02:07:14,316) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 02:07:14,317) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.990554 @ 19
2026-01-12 02:07:14.352 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 02:07:17.933 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-12 02:07:17.933 | INFO     | __main__:train_single_fold:593 -   IC=0.0364, ICIR=0.2816, RankIC=0.0639, RankICIR=0.5772
2026-01-12 02:07:17.933 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 02:07:17,939) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:07:32,001) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:07:32,002) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:07:36,978) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201f645450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/244 [00:00<00:05, 45.29it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 66.13it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 71.75it/s]backtest loop:  13%|█▎        | 31/244 [00:00<00:02, 76.73it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 76.21it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 78.44it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:02, 81.17it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:02, 77.22it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 78.62it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:02, 77.17it/s]backtest loop:  39%|███▉      | 95/244 [00:01<00:01, 80.06it/s]backtest loop:  43%|████▎     | 104/244 [00:01<00:01, 76.29it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 79.09it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 77.98it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 76.99it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 80.39it/s]backtest loop:  60%|██████    | 147/244 [00:01<00:01, 79.40it/s]backtest loop:  64%|██████▎   | 155/244 [00:02<00:01, 77.84it/s]backtest loop:  67%|██████▋   | 164/244 [00:02<00:01, 78.27it/s]backtest loop:  71%|███████▏  | 174/244 [00:02<00:00, 79.67it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 81.04it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 82.10it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 81.85it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 81.83it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 82.38it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 82.92it/s]backtest loop: 100%|█████████▉| 243/244 [00:03<00:00, 84.76it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 78.98it/s]
2026-01-12 02:07:40.085 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0420, Sharpe(w/cost)=0.8144, MaxDD=-0.0302
2026-01-12 02:07:42.822 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_1_backtest_report.pdf
2026-01-12 02:07:55.680 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 02:07:55.734 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_1_pred.parquet
2026-01-12 02:07:55.780 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-12 02:07:55.780 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-12 02:07:58.507 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0629
2026-01-12 02:07:58.802 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0404, ICIR=0.3345, RankIC=0.0655
[1567253:MainThread](2026-01-12 02:07:58,808) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:08:14,461) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:08:14,462) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:08:19,469) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f202453ef90>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 37.70it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 67.46it/s]backtest loop:   8%|▊         | 20/244 [00:00<00:03, 66.16it/s]backtest loop:  12%|█▏        | 29/244 [00:00<00:03, 71.45it/s]backtest loop:  16%|█▌        | 38/244 [00:00<00:02, 77.29it/s]backtest loop:  19%|█▉        | 46/244 [00:00<00:02, 76.35it/s]backtest loop:  22%|██▏       | 54/244 [00:00<00:02, 74.54it/s]backtest loop:  25%|██▌       | 62/244 [00:00<00:02, 74.83it/s]backtest loop:  29%|██▉       | 71/244 [00:00<00:02, 79.18it/s]backtest loop:  32%|███▏      | 79/244 [00:01<00:02, 77.49it/s]backtest loop:  36%|███▌      | 87/244 [00:01<00:02, 76.51it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 75.25it/s]backtest loop:  43%|████▎     | 104/244 [00:01<00:01, 74.92it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 79.00it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 78.16it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 77.50it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 79.69it/s]backtest loop:  60%|█████▉    | 146/244 [00:01<00:01, 78.07it/s]backtest loop:  63%|██████▎   | 154/244 [00:02<00:01, 77.05it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 79.96it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 78.55it/s]backtest loop:  74%|███████▍  | 180/244 [00:02<00:00, 77.95it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 78.45it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 79.29it/s]backtest loop:  85%|████████▌ | 208/244 [00:02<00:00, 82.09it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 81.26it/s]backtest loop:  93%|█████████▎| 226/244 [00:02<00:00, 81.16it/s]backtest loop:  96%|█████████▋| 235/244 [00:03<00:00, 80.56it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 81.13it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 77.49it/s]
2026-01-12 02:08:22.635 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0697, Sharpe(w/cost)=1.5163
2026-01-12 02:08:22.672 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 02:08:22.673 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-12 02:08:22.673 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 02:08:22.673 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 02:09:02,817) INFO - qlib.timer - [log.py:127] - Time cost: 40.142s | Loading data Done
[1567253:MainThread](2026-01-12 02:09:03,071) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[1567253:MainThread](2026-01-12 02:09:03,538) INFO - qlib.timer - [log.py:127] - Time cost: 0.465s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 02:09:03,638) INFO - qlib.timer - [log.py:127] - Time cost: 0.099s | Fillna Done
[1567253:MainThread](2026-01-12 02:09:03,701) INFO - qlib.timer - [log.py:127] - Time cost: 0.024s | DropnaLabel Done
[1567253:MainThread](2026-01-12 02:09:03,895) INFO - qlib.timer - [log.py:127] - Time cost: 0.193s | CSRankNorm Done
[1567253:MainThread](2026-01-12 02:09:03,896) INFO - qlib.timer - [log.py:127] - Time cost: 1.079s | fit & process data Done
[1567253:MainThread](2026-01-12 02:09:03,897) INFO - qlib.timer - [log.py:127] - Time cost: 41.223s | Init data Done
2026-01-12 02:09:03.897 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 02:09:03,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 02:09:03.938 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 02:09:05,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 02:09:05,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 02:09:05,751) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:09:15,605) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:09:24,036) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990877, valid -0.994149
[1567253:MainThread](2026-01-12 02:09:24,040) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 02:09:24,041) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:09:35,192) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:09:47,679) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990200, valid -0.994066
[1567253:MainThread](2026-01-12 02:09:47,684) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 02:09:47,684) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:09:57,688) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:10:07,376) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989054, valid -0.993801
[1567253:MainThread](2026-01-12 02:10:07,380) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 02:10:07,380) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:10:18,164) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:10:31,767) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989702, valid -0.992323
[1567253:MainThread](2026-01-12 02:10:31,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 02:10:31,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:10:42,260) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:10:55,938) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990424, valid -0.992790
[1567253:MainThread](2026-01-12 02:10:55,939) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 02:10:55,939) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:11:06,115) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:11:19,274) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988438, valid -0.993623
[1567253:MainThread](2026-01-12 02:11:19,274) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 02:11:19,275) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:11:29,405) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:11:38,781) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988295, valid -0.993218
[1567253:MainThread](2026-01-12 02:11:38,782) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 02:11:38,782) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:11:49,127) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:11:59,716) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988480, valid -0.993706
[1567253:MainThread](2026-01-12 02:11:59,717) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 02:11:59,717) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:12:10,462) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:12:24,220) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988631, valid -0.992961
[1567253:MainThread](2026-01-12 02:12:24,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 02:12:24,221) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:12:34,059) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:12:48,225) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988546, valid -0.993812
[1567253:MainThread](2026-01-12 02:12:48,226) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 02:12:48,226) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:12:58,060) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:13:11,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988232, valid -0.993158
[1567253:MainThread](2026-01-12 02:13:11,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 02:13:11,196) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:13:21,748) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:13:32,968) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988151, valid -0.993026
[1567253:MainThread](2026-01-12 02:13:32,968) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 02:13:32,969) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:13:42,514) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:13:51,526) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988069, valid -0.992689
[1567253:MainThread](2026-01-12 02:13:51,527) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 02:13:51,527) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:14:01,422) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:14:12,468) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988482, valid -0.991827
[1567253:MainThread](2026-01-12 02:14:12,473) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 02:14:12,473) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:14:22,292) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:14:31,708) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988436, valid -0.992924
[1567253:MainThread](2026-01-12 02:14:31,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 02:14:31,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:14:41,774) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:14:52,874) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988536, valid -0.991818
[1567253:MainThread](2026-01-12 02:14:52,878) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 02:14:52,878) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:15:02,742) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:15:12,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988191, valid -0.993050
[1567253:MainThread](2026-01-12 02:15:12,251) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 02:15:12,251) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:15:22,022) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:15:34,825) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988559, valid -0.994099
[1567253:MainThread](2026-01-12 02:15:34,826) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 02:15:34,826) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:15:44,938) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:15:54,091) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988108, valid -0.991607
[1567253:MainThread](2026-01-12 02:15:54,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 02:15:54,096) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:16:04,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:16:16,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988236, valid -0.992226
[1567253:MainThread](2026-01-12 02:16:16,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 02:16:16,336) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:16:26,017) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:16:36,349) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988362, valid -0.993491
[1567253:MainThread](2026-01-12 02:16:36,350) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 02:16:36,350) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:16:46,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:16:56,753) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988183, valid -0.991775
[1567253:MainThread](2026-01-12 02:16:56,753) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch22:
[1567253:MainThread](2026-01-12 02:16:56,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:17:06,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:17:19,199) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988174, valid -0.992644
[1567253:MainThread](2026-01-12 02:17:19,200) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch23:
[1567253:MainThread](2026-01-12 02:17:19,200) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:17:29,018) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:17:38,091) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989296, valid -0.992280
[1567253:MainThread](2026-01-12 02:17:38,092) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch24:
[1567253:MainThread](2026-01-12 02:17:38,092) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:17:47,958) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:17:57,577) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988014, valid -0.991884
[1567253:MainThread](2026-01-12 02:17:57,578) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch25:
[1567253:MainThread](2026-01-12 02:17:57,578) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:18:07,458) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:18:19,119) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987880, valid -0.991851
[1567253:MainThread](2026-01-12 02:18:19,119) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch26:
[1567253:MainThread](2026-01-12 02:18:19,120) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:18:29,024) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:18:39,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987859, valid -0.991701
[1567253:MainThread](2026-01-12 02:18:39,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch27:
[1567253:MainThread](2026-01-12 02:18:39,566) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:18:49,886) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:19:02,431) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988058, valid -0.992309
[1567253:MainThread](2026-01-12 02:19:02,432) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch28:
[1567253:MainThread](2026-01-12 02:19:02,432) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:19:12,051) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:19:20,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.987707, valid -0.992225
[1567253:MainThread](2026-01-12 02:19:20,916) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 02:19:20,917) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.991607 @ 18
2026-01-12 02:19:20.960 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 02:19:23.875 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-12 02:19:23.876 | INFO     | __main__:train_single_fold:593 -   IC=0.0251, ICIR=0.2471, RankIC=0.0341, RankICIR=0.3415
2026-01-12 02:19:23.876 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 02:19:23,882) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:19:41,615) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:19:41,616) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:19:46,884) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201ea8af10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 36.60it/s]backtest loop:   5%|▌         | 13/243 [00:00<00:03, 65.46it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 69.79it/s]backtest loop:  12%|█▏        | 29/243 [00:00<00:03, 70.40it/s]backtest loop:  15%|█▌        | 37/243 [00:00<00:02, 72.03it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 72.89it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 74.83it/s]backtest loop:  26%|██▌       | 62/243 [00:00<00:02, 75.68it/s]backtest loop:  29%|██▉       | 71/243 [00:00<00:02, 78.68it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 77.89it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 77.62it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:01, 80.02it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 81.07it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 81.14it/s]backtest loop:  51%|█████     | 123/243 [00:01<00:01, 83.39it/s]backtest loop:  54%|█████▍    | 132/243 [00:01<00:01, 83.09it/s]backtest loop:  58%|█████▊    | 141/243 [00:01<00:01, 82.80it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 82.72it/s]backtest loop:  65%|██████▌   | 159/243 [00:02<00:01, 81.48it/s]backtest loop:  69%|██████▉   | 168/243 [00:02<00:00, 83.33it/s]backtest loop:  73%|███████▎  | 177/243 [00:02<00:00, 81.60it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 80.88it/s]backtest loop:  80%|████████  | 195/243 [00:02<00:00, 80.69it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 79.68it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 79.36it/s]backtest loop:  91%|█████████▏| 222/243 [00:02<00:00, 81.87it/s]backtest loop:  95%|█████████▌| 231/243 [00:02<00:00, 80.46it/s]backtest loop:  99%|█████████▉| 240/243 [00:03<00:00, 78.50it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.33it/s]
2026-01-12 02:19:50.003 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0864, Sharpe(w/cost)=-1.2373, MaxDD=-0.1043
2026-01-12 02:19:52.571 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_2_backtest_report.pdf
2026-01-12 02:20:07.067 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 02:20:07.119 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_2_pred.parquet
2026-01-12 02:20:07.165 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-12 02:20:07.165 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-12 02:20:10.964 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0394
2026-01-12 02:20:14.557 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0427
2026-01-12 02:20:14.857 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0279, ICIR=0.2832, RankIC=0.0386
[1567253:MainThread](2026-01-12 02:20:14,862) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:20:31,073) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:20:31,074) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:20:36,361) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201f416f90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 33.06it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:05, 46.53it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:04, 51.65it/s]backtest loop:   9%|▉         | 22/243 [00:00<00:04, 53.36it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:04, 51.53it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:04, 45.46it/s]backtest loop:  16%|█▌        | 39/243 [00:00<00:04, 46.06it/s]backtest loop:  18%|█▊        | 44/243 [00:00<00:04, 46.14it/s]backtest loop:  20%|██        | 49/243 [00:01<00:04, 46.94it/s]backtest loop:  22%|██▏       | 54/243 [00:01<00:03, 47.70it/s]backtest loop:  25%|██▍       | 60/243 [00:01<00:03, 49.85it/s]backtest loop:  27%|██▋       | 66/243 [00:01<00:03, 52.43it/s]backtest loop:  30%|██▉       | 72/243 [00:01<00:03, 51.91it/s]backtest loop:  33%|███▎      | 80/243 [00:01<00:02, 58.74it/s]backtest loop:  37%|███▋      | 89/243 [00:01<00:02, 67.59it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:02, 70.87it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 71.90it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 73.86it/s]backtest loop:  51%|█████     | 123/243 [00:02<00:01, 77.95it/s]backtest loop:  54%|█████▍    | 131/243 [00:02<00:01, 78.16it/s]backtest loop:  57%|█████▋    | 139/243 [00:02<00:01, 77.94it/s]backtest loop:  61%|██████▏   | 149/243 [00:02<00:01, 79.55it/s]backtest loop:  65%|██████▌   | 158/243 [00:02<00:01, 82.15it/s]backtest loop:  69%|██████▊   | 167/243 [00:02<00:00, 80.29it/s]backtest loop:  72%|███████▏  | 176/243 [00:02<00:00, 79.23it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 77.93it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 78.02it/s]backtest loop:  83%|████████▎ | 202/243 [00:03<00:00, 80.60it/s]backtest loop:  87%|████████▋ | 211/243 [00:03<00:00, 79.16it/s]backtest loop:  90%|█████████ | 219/243 [00:03<00:00, 77.70it/s]backtest loop:  94%|█████████▍| 228/243 [00:03<00:00, 77.42it/s]backtest loop:  98%|█████████▊| 237/243 [00:03<00:00, 80.59it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 67.20it/s]
2026-01-12 02:20:39.994 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0584, Sharpe(w/cost)=-0.9435
2026-01-12 02:20:40.034 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 02:20:40.034 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-12 02:20:40.034 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 02:20:40.034 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 02:21:23,143) INFO - qlib.timer - [log.py:127] - Time cost: 43.107s | Loading data Done
[1567253:MainThread](2026-01-12 02:21:23,392) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[1567253:MainThread](2026-01-12 02:21:23,841) INFO - qlib.timer - [log.py:127] - Time cost: 0.448s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 02:21:23,971) INFO - qlib.timer - [log.py:127] - Time cost: 0.129s | Fillna Done
[1567253:MainThread](2026-01-12 02:21:24,061) INFO - qlib.timer - [log.py:127] - Time cost: 0.025s | DropnaLabel Done
[1567253:MainThread](2026-01-12 02:21:24,260) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[1567253:MainThread](2026-01-12 02:21:24,261) INFO - qlib.timer - [log.py:127] - Time cost: 1.118s | fit & process data Done
[1567253:MainThread](2026-01-12 02:21:24,262) INFO - qlib.timer - [log.py:127] - Time cost: 44.227s | Init data Done
2026-01-12 02:21:24.262 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 02:21:24,278) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 02:21:24.346 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 02:21:26,118) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 02:21:26,119) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 02:21:26,119) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:21:36,037) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:21:45,070) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993808, valid -0.997152
[1567253:MainThread](2026-01-12 02:21:45,075) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 02:21:45,076) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:21:54,846) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:22:10,235) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991225, valid -1.001140
[1567253:MainThread](2026-01-12 02:22:10,236) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 02:22:10,236) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:22:20,163) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:22:30,154) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990054, valid -0.996455
[1567253:MainThread](2026-01-12 02:22:30,158) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 02:22:30,159) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:22:40,073) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:22:49,839) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988451, valid -0.996533
[1567253:MainThread](2026-01-12 02:22:49,839) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 02:22:49,840) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:22:59,856) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:23:10,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988599, valid -0.995745
[1567253:MainThread](2026-01-12 02:23:10,500) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 02:23:10,501) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:23:20,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:23:30,466) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988352, valid -0.996690
[1567253:MainThread](2026-01-12 02:23:30,467) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 02:23:30,467) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:23:40,233) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:23:54,187) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988738, valid -1.000071
[1567253:MainThread](2026-01-12 02:23:54,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 02:23:54,188) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:24:04,014) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:24:15,279) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988552, valid -0.998941
[1567253:MainThread](2026-01-12 02:24:15,279) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 02:24:15,280) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:24:24,938) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:24:35,147) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988119, valid -0.995679
[1567253:MainThread](2026-01-12 02:24:35,152) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 02:24:35,152) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:24:45,247) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:24:54,719) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989064, valid -1.000100
[1567253:MainThread](2026-01-12 02:24:54,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 02:24:54,720) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:25:05,259) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:25:17,366) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988390, valid -0.996825
[1567253:MainThread](2026-01-12 02:25:17,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 02:25:17,367) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:25:28,142) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:25:42,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989684, valid -0.996106
[1567253:MainThread](2026-01-12 02:25:42,755) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 02:25:42,756) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:25:55,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:26:11,381) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988267, valid -0.997427
[1567253:MainThread](2026-01-12 02:26:11,382) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 02:26:11,383) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:26:23,775) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:26:39,339) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988393, valid -0.995604
[1567253:MainThread](2026-01-12 02:26:39,344) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 02:26:39,344) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:26:52,481) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:27:07,821) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988047, valid -0.996501
[1567253:MainThread](2026-01-12 02:27:07,822) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 02:27:07,823) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:27:20,609) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:27:38,085) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989256, valid -0.999965
[1567253:MainThread](2026-01-12 02:27:38,086) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 02:27:38,086) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:27:50,433) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:28:05,888) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988126, valid -0.996952
[1567253:MainThread](2026-01-12 02:28:05,889) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 02:28:05,889) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:28:19,360) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:28:36,085) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988387, valid -0.996698
[1567253:MainThread](2026-01-12 02:28:36,086) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 02:28:36,087) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:28:49,477) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:29:05,840) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988726, valid -0.999284
[1567253:MainThread](2026-01-12 02:29:05,841) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 02:29:05,842) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:29:18,921) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:29:33,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988320, valid -0.996445
[1567253:MainThread](2026-01-12 02:29:33,788) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 02:29:33,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:29:46,860) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:30:02,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989109, valid -0.995928
[1567253:MainThread](2026-01-12 02:30:02,213) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 02:30:02,214) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:30:15,156) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:30:31,611) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989089, valid -0.998403
[1567253:MainThread](2026-01-12 02:30:31,612) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch22:
[1567253:MainThread](2026-01-12 02:30:31,613) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:30:45,227) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:31:00,712) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988732, valid -0.997665
[1567253:MainThread](2026-01-12 02:31:00,714) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch23:
[1567253:MainThread](2026-01-12 02:31:00,714) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:31:13,359) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:31:29,830) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.988491, valid -0.995748
[1567253:MainThread](2026-01-12 02:31:29,831) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 02:31:29,832) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.995604 @ 13
2026-01-12 02:31:29.885 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 02:31:35.102 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-12 02:31:35.102 | INFO     | __main__:train_single_fold:593 -   IC=0.0145, ICIR=0.1436, RankIC=0.0432, RankICIR=0.4276
2026-01-12 02:31:35.102 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 02:31:35,111) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:32:01,774) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:32:01,775) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:32:08,653) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f20245b3fd0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 25.84it/s]backtest loop:   4%|▎         | 9/244 [00:00<00:05, 43.89it/s]backtest loop:   7%|▋         | 16/244 [00:00<00:04, 54.54it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 55.95it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:03, 60.19it/s]backtest loop:  15%|█▌        | 37/244 [00:00<00:03, 63.07it/s]backtest loop:  18%|█▊        | 44/244 [00:00<00:03, 61.65it/s]backtest loop:  21%|██        | 51/244 [00:00<00:03, 63.34it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:03, 60.87it/s]backtest loop:  27%|██▋       | 65/244 [00:01<00:02, 63.03it/s]backtest loop:  30%|██▉       | 72/244 [00:01<00:02, 61.35it/s]backtest loop:  32%|███▏      | 79/244 [00:01<00:02, 60.11it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:02, 62.36it/s]backtest loop:  38%|███▊      | 93/244 [00:01<00:02, 64.11it/s]backtest loop:  41%|████      | 100/244 [00:01<00:02, 62.32it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:02, 64.31it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:02, 62.34it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 63.80it/s]backtest loop:  52%|█████▏    | 128/244 [00:02<00:01, 62.21it/s]backtest loop:  55%|█████▌    | 135/244 [00:02<00:01, 63.42it/s]backtest loop:  58%|█████▊    | 142/244 [00:02<00:01, 64.61it/s]backtest loop:  61%|██████    | 149/244 [00:02<00:01, 62.37it/s]backtest loop:  64%|██████▍   | 156/244 [00:02<00:01, 63.94it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 62.32it/s]backtest loop:  70%|██████▉   | 170/244 [00:02<00:01, 63.99it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:01, 62.20it/s]backtest loop:  75%|███████▌  | 184/244 [00:03<00:00, 61.08it/s]backtest loop:  78%|███████▊  | 191/244 [00:03<00:00, 62.99it/s]backtest loop:  81%|████████  | 198/244 [00:03<00:00, 61.79it/s]backtest loop:  84%|████████▍ | 205/244 [00:03<00:00, 63.63it/s]backtest loop:  87%|████████▋ | 213/244 [00:03<00:00, 66.38it/s]backtest loop:  91%|█████████ | 222/244 [00:03<00:00, 69.55it/s]backtest loop:  95%|█████████▍| 231/244 [00:03<00:00, 74.64it/s]backtest loop:  98%|█████████▊| 239/244 [00:03<00:00, 74.19it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 63.46it/s]
2026-01-12 02:32:12.517 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0693, Sharpe(w/cost)=-1.1142, MaxDD=-0.0996
2026-01-12 02:32:16.464 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_3_backtest_report.pdf
2026-01-12 02:32:33.540 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 02:32:33.649 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_3_pred.parquet
2026-01-12 02:32:33.693 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-12 02:32:33.694 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-12 02:32:38.583 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0381
2026-01-12 02:32:43.460 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0417
2026-01-12 02:32:48.405 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0429
2026-01-12 02:32:48.762 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0166, ICIR=0.1635, RankIC=0.0437
[1567253:MainThread](2026-01-12 02:32:48,769) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:33:14,389) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:33:14,390) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:33:21,121) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201e2a6f90>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 27.95it/s]backtest loop:   5%|▍         | 11/244 [00:00<00:04, 57.38it/s]backtest loop:   7%|▋         | 18/244 [00:00<00:03, 62.10it/s]backtest loop:  11%|█         | 27/244 [00:00<00:03, 70.68it/s]backtest loop:  14%|█▍        | 35/244 [00:00<00:03, 66.74it/s]backtest loop:  17%|█▋        | 42/244 [00:00<00:03, 67.10it/s]backtest loop:  20%|██        | 49/244 [00:00<00:03, 63.92it/s]backtest loop:  23%|██▎       | 56/244 [00:00<00:02, 65.19it/s]backtest loop:  26%|██▌       | 63/244 [00:01<00:02, 62.40it/s]backtest loop:  29%|██▊       | 70/244 [00:01<00:02, 64.35it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 62.32it/s]backtest loop:  34%|███▍      | 84/244 [00:01<00:02, 61.46it/s]backtest loop:  37%|███▋      | 91/244 [00:01<00:02, 63.41it/s]backtest loop:  40%|████      | 98/244 [00:01<00:02, 64.94it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:02, 62.27it/s]backtest loop:  46%|████▌     | 112/244 [00:01<00:02, 64.04it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:02, 62.09it/s]backtest loop:  52%|█████▏    | 126/244 [00:01<00:01, 63.98it/s]backtest loop:  55%|█████▍    | 133/244 [00:02<00:01, 61.63it/s]backtest loop:  57%|█████▋    | 140/244 [00:02<00:01, 63.74it/s]backtest loop:  60%|██████    | 147/244 [00:02<00:01, 64.78it/s]backtest loop:  63%|██████▎   | 154/244 [00:02<00:01, 62.24it/s]backtest loop:  66%|██████▌   | 161/244 [00:02<00:01, 63.16it/s]backtest loop:  69%|██████▉   | 168/244 [00:02<00:01, 61.67it/s]backtest loop:  72%|███████▏  | 175/244 [00:02<00:01, 63.32it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:01, 61.63it/s]backtest loop:  77%|███████▋  | 189/244 [00:03<00:00, 60.11it/s]backtest loop:  80%|████████  | 196/244 [00:03<00:00, 62.66it/s]backtest loop:  83%|████████▎ | 203/244 [00:03<00:00, 61.35it/s]backtest loop:  86%|████████▌ | 210/244 [00:03<00:00, 63.33it/s]backtest loop:  89%|████████▉ | 217/244 [00:03<00:00, 61.68it/s]backtest loop:  92%|█████████▏| 224/244 [00:03<00:00, 63.51it/s]backtest loop:  95%|█████████▍| 231/244 [00:03<00:00, 64.98it/s]backtest loop:  98%|█████████▊| 238/244 [00:03<00:00, 63.08it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 62.72it/s]
2026-01-12 02:33:25.032 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0407, Sharpe(w/cost)=-0.6564
2026-01-12 02:33:25.093 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 02:33:25.093 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-12 02:33:25.093 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 02:33:25.093 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 02:34:20,863) INFO - qlib.timer - [log.py:127] - Time cost: 55.767s | Loading data Done
[1567253:MainThread](2026-01-12 02:34:21,135) INFO - qlib.timer - [log.py:127] - Time cost: 0.023s | FilterCol Done
[1567253:MainThread](2026-01-12 02:34:21,637) INFO - qlib.timer - [log.py:127] - Time cost: 0.501s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 02:34:21,788) INFO - qlib.timer - [log.py:127] - Time cost: 0.149s | Fillna Done
[1567253:MainThread](2026-01-12 02:34:21,884) INFO - qlib.timer - [log.py:127] - Time cost: 0.027s | DropnaLabel Done
[1567253:MainThread](2026-01-12 02:34:22,086) INFO - qlib.timer - [log.py:127] - Time cost: 0.202s | CSRankNorm Done
[1567253:MainThread](2026-01-12 02:34:22,088) INFO - qlib.timer - [log.py:127] - Time cost: 1.224s | fit & process data Done
[1567253:MainThread](2026-01-12 02:34:22,088) INFO - qlib.timer - [log.py:127] - Time cost: 56.993s | Init data Done
2026-01-12 02:34:22.089 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 02:34:22,111) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 02:34:22.133 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 02:34:24,334) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 02:34:24,334) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 02:34:24,335) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:34:37,179) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:34:53,591) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991146, valid -0.996596
[1567253:MainThread](2026-01-12 02:34:53,597) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 02:34:53,598) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:35:07,216) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:35:24,144) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990651, valid -0.996204
[1567253:MainThread](2026-01-12 02:35:24,150) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 02:35:24,150) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:35:37,821) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:35:53,047) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993465, valid -1.001857
[1567253:MainThread](2026-01-12 02:35:53,047) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 02:35:53,048) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:36:06,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:36:20,887) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -1.001888, valid -1.007750
[1567253:MainThread](2026-01-12 02:36:20,888) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 02:36:20,889) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:36:34,281) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:36:52,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989875, valid -0.996681
[1567253:MainThread](2026-01-12 02:36:52,099) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 02:36:52,100) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:37:05,248) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:37:21,468) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990586, valid -0.998437
[1567253:MainThread](2026-01-12 02:37:21,468) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 02:37:21,469) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:37:33,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:37:48,428) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990573, valid -0.997638
[1567253:MainThread](2026-01-12 02:37:48,428) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 02:37:48,429) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:38:00,608) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:38:17,825) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990425, valid -0.998736
[1567253:MainThread](2026-01-12 02:38:17,826) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 02:38:17,827) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:38:30,690) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:38:46,972) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989830, valid -0.997530
[1567253:MainThread](2026-01-12 02:38:46,973) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 02:38:46,973) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:39:00,560) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:39:17,234) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989799, valid -0.995901
[1567253:MainThread](2026-01-12 02:39:17,239) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 02:39:17,240) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:39:30,001) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:39:45,215) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989656, valid -0.996804
[1567253:MainThread](2026-01-12 02:39:45,216) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 02:39:45,216) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:39:55,766) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:40:10,422) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989591, valid -0.995835
[1567253:MainThread](2026-01-12 02:40:10,426) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 02:40:10,427) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:40:20,171) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:40:35,185) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991386, valid -0.997489
[1567253:MainThread](2026-01-12 02:40:35,186) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 02:40:35,187) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:40:46,294) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:40:56,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989887, valid -0.997260
[1567253:MainThread](2026-01-12 02:40:56,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 02:40:56,177) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:41:06,878) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:41:23,943) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990222, valid -0.998254
[1567253:MainThread](2026-01-12 02:41:23,944) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 02:41:23,944) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:41:37,426) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:41:53,549) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989836, valid -0.995957
[1567253:MainThread](2026-01-12 02:41:53,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 02:41:53,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:42:06,111) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:42:20,843) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990268, valid -0.996990
[1567253:MainThread](2026-01-12 02:42:20,844) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 02:42:20,845) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:42:33,966) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:42:51,194) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990232, valid -0.997893
[1567253:MainThread](2026-01-12 02:42:51,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 02:42:51,195) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:43:03,797) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:43:20,137) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990613, valid -0.998171
[1567253:MainThread](2026-01-12 02:43:20,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 02:43:20,138) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:43:32,471) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:43:47,621) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989639, valid -0.996747
[1567253:MainThread](2026-01-12 02:43:47,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 02:43:47,622) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:43:59,854) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:44:17,507) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.989720, valid -0.996740
[1567253:MainThread](2026-01-12 02:44:17,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 02:44:17,509) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:44:29,826) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:44:47,564) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990672, valid -0.996486
[1567253:MainThread](2026-01-12 02:44:47,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 02:44:47,565) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.995835 @ 11
2026-01-12 02:44:47.602 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 02:44:52.511 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-12 02:44:52.512 | INFO     | __main__:train_single_fold:593 -   IC=0.0083, ICIR=0.0675, RankIC=0.0390, RankICIR=0.3339
2026-01-12 02:44:52.512 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 02:44:52,520) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:45:19,991) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:45:19,992) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:45:27,369) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201e920810>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:11, 21.63it/s]backtest loop:   4%|▎         | 9/243 [00:00<00:05, 39.62it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:04, 47.11it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 56.71it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:03, 57.41it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:03, 61.08it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:03, 63.44it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:03, 61.28it/s]backtest loop:  25%|██▍       | 60/243 [00:01<00:02, 66.35it/s]backtest loop:  28%|██▊       | 68/243 [00:01<00:02, 68.60it/s]backtest loop:  31%|███▏      | 76/243 [00:01<00:02, 70.04it/s]backtest loop:  35%|███▍      | 84/243 [00:01<00:02, 71.11it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:02, 71.76it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 75.41it/s]backtest loop:  45%|████▍     | 109/243 [00:01<00:01, 74.68it/s]backtest loop:  48%|████▊     | 117/243 [00:01<00:01, 74.25it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 73.88it/s]backtest loop:  55%|█████▍    | 133/243 [00:01<00:01, 75.42it/s]backtest loop:  58%|█████▊    | 141/243 [00:02<00:01, 74.21it/s]backtest loop:  62%|██████▏   | 150/243 [00:02<00:01, 74.17it/s]backtest loop:  65%|██████▌   | 158/243 [00:02<00:01, 75.11it/s]backtest loop:  68%|██████▊   | 166/243 [00:02<00:01, 70.04it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 70.14it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 66.67it/s]backtest loop:  78%|███████▊  | 189/243 [00:02<00:00, 61.34it/s]backtest loop:  81%|████████  | 196/243 [00:02<00:00, 63.18it/s]backtest loop:  84%|████████▎ | 203/243 [00:03<00:00, 64.71it/s]backtest loop:  86%|████████▋ | 210/243 [00:03<00:00, 62.26it/s]backtest loop:  89%|████████▉ | 217/243 [00:03<00:00, 63.94it/s]backtest loop:  92%|█████████▏| 224/243 [00:03<00:00, 62.04it/s]backtest loop:  95%|█████████▌| 231/243 [00:03<00:00, 63.91it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 65.04it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 65.57it/s]
2026-01-12 02:45:31.099 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0791, Sharpe(w/cost)=-0.9664, MaxDD=-0.1203
2026-01-12 02:45:34.247 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_4_backtest_report.pdf
2026-01-12 02:45:50.434 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 02:45:50.503 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_4_pred.parquet
2026-01-12 02:45:50.547 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-12 02:45:50.547 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-12 02:45:55.589 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0332
2026-01-12 02:46:00.493 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0384
2026-01-12 02:46:05.891 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0343
2026-01-12 02:46:10.996 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0326
2026-01-12 02:46:11.390 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0083, ICIR=0.0668, RankIC=0.0388
[1567253:MainThread](2026-01-12 02:46:11,397) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 02:46:39,600) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:46:39,601) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 02:46:46,905) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201c7d8810>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 22.95it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:05, 46.11it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:04, 50.22it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 58.54it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:03, 58.84it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:03, 61.53it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:03, 64.05it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:03, 62.45it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 64.21it/s]backtest loop:  27%|██▋       | 66/243 [00:01<00:02, 62.25it/s]backtest loop:  30%|███       | 73/243 [00:01<00:02, 63.96it/s]backtest loop:  33%|███▎      | 80/243 [00:01<00:02, 62.41it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 60.94it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:02, 63.35it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:02, 63.07it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:02, 65.74it/s]backtest loop:  48%|████▊     | 117/243 [00:01<00:01, 63.20it/s]backtest loop:  51%|█████▏    | 125/243 [00:02<00:01, 62.75it/s]backtest loop:  54%|█████▍    | 132/243 [00:02<00:01, 64.51it/s]backtest loop:  57%|█████▋    | 139/243 [00:02<00:01, 65.65it/s]backtest loop:  60%|██████    | 146/243 [00:02<00:01, 63.34it/s]backtest loop:  63%|██████▎   | 154/243 [00:02<00:01, 65.88it/s]backtest loop:  66%|██████▋   | 161/243 [00:02<00:01, 63.72it/s]backtest loop:  69%|██████▉   | 168/243 [00:02<00:01, 64.64it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:01, 62.61it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 64.36it/s]backtest loop:  78%|███████▊  | 189/243 [00:03<00:00, 60.07it/s]backtest loop:  81%|████████  | 196/243 [00:03<00:00, 62.70it/s]backtest loop:  84%|████████▍ | 204/243 [00:03<00:00, 62.58it/s]backtest loop:  87%|████████▋ | 211/243 [00:03<00:00, 64.36it/s]backtest loop:  90%|████████▉ | 218/243 [00:03<00:00, 65.58it/s]backtest loop:  93%|█████████▎| 225/243 [00:03<00:00, 63.49it/s]backtest loop:  96%|█████████▌| 233/243 [00:03<00:00, 66.94it/s]backtest loop:  99%|█████████▉| 240/243 [00:03<00:00, 64.48it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 62.41it/s]
2026-01-12 02:46:50.821 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0670, Sharpe(w/cost)=-0.8449
2026-01-12 02:46:50.875 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 02:46:50.876 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-12 02:46:50.876 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 02:46:50.876 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 02:47:52,966) INFO - qlib.timer - [log.py:127] - Time cost: 62.087s | Loading data Done
[1567253:MainThread](2026-01-12 02:47:53,220) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[1567253:MainThread](2026-01-12 02:47:53,677) INFO - qlib.timer - [log.py:127] - Time cost: 0.457s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 02:47:53,817) INFO - qlib.timer - [log.py:127] - Time cost: 0.139s | Fillna Done
[1567253:MainThread](2026-01-12 02:47:53,911) INFO - qlib.timer - [log.py:127] - Time cost: 0.026s | DropnaLabel Done
[1567253:MainThread](2026-01-12 02:47:54,129) INFO - qlib.timer - [log.py:127] - Time cost: 0.217s | CSRankNorm Done
[1567253:MainThread](2026-01-12 02:47:54,130) INFO - qlib.timer - [log.py:127] - Time cost: 1.163s | fit & process data Done
[1567253:MainThread](2026-01-12 02:47:54,131) INFO - qlib.timer - [log.py:127] - Time cost: 63.253s | Init data Done
2026-01-12 02:47:54.131 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 02:47:54,154) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 02:47:54.256 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 02:47:56,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 02:47:56,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 02:47:56,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:48:09,729) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:48:24,780) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992527, valid -0.995486
[1567253:MainThread](2026-01-12 02:48:24,786) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 02:48:24,787) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:48:38,650) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:48:52,510) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992593, valid -0.996419
[1567253:MainThread](2026-01-12 02:48:52,511) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 02:48:52,512) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:49:06,511) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:49:24,501) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992342, valid -0.996577
[1567253:MainThread](2026-01-12 02:49:24,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 02:49:24,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:49:38,528) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:49:53,947) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992790, valid -0.996815
[1567253:MainThread](2026-01-12 02:49:53,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 02:49:53,948) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:50:07,249) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:50:22,935) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991430, valid -0.995600
[1567253:MainThread](2026-01-12 02:50:22,936) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 02:50:22,937) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:50:36,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:50:52,546) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990511, valid -0.995982
[1567253:MainThread](2026-01-12 02:50:52,546) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 02:50:52,547) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:51:02,669) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:51:17,502) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990276, valid -0.995202
[1567253:MainThread](2026-01-12 02:51:17,506) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 02:51:17,507) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:51:27,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:51:43,561) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990634, valid -0.995304
[1567253:MainThread](2026-01-12 02:51:43,561) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 02:51:43,562) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:51:56,297) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:52:07,675) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990267, valid -0.996302
[1567253:MainThread](2026-01-12 02:52:07,676) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 02:52:07,676) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:52:18,295) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:52:33,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990514, valid -0.995700
[1567253:MainThread](2026-01-12 02:52:33,660) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 02:52:33,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:52:45,100) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:52:56,402) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990909, valid -0.996082
[1567253:MainThread](2026-01-12 02:52:56,402) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 02:52:56,403) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:53:06,701) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:53:21,736) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990691, valid -0.995146
[1567253:MainThread](2026-01-12 02:53:21,742) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 02:53:21,742) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:53:34,169) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:53:50,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991212, valid -0.997286
[1567253:MainThread](2026-01-12 02:53:50,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 02:53:50,750) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:54:03,172) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:54:20,053) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992496, valid -0.997260
[1567253:MainThread](2026-01-12 02:54:20,054) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 02:54:20,055) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:54:32,752) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:54:48,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990952, valid -0.996192
[1567253:MainThread](2026-01-12 02:54:48,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 02:54:48,773) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:55:00,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:55:15,131) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990920, valid -0.995307
[1567253:MainThread](2026-01-12 02:55:15,132) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 02:55:15,132) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:55:28,136) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:55:44,312) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990755, valid -0.995114
[1567253:MainThread](2026-01-12 02:55:44,317) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 02:55:44,318) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:55:57,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:56:13,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990541, valid -0.995027
[1567253:MainThread](2026-01-12 02:56:13,305) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 02:56:13,306) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:56:26,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:56:42,242) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990935, valid -0.995210
[1567253:MainThread](2026-01-12 02:56:42,242) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 02:56:42,243) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:56:54,912) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:57:11,532) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991095, valid -0.995293
[1567253:MainThread](2026-01-12 02:57:11,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 02:57:11,533) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:57:24,747) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:57:41,223) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991068, valid -0.995426
[1567253:MainThread](2026-01-12 02:57:41,223) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 02:57:41,224) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:57:54,044) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:58:09,003) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990654, valid -0.995235
[1567253:MainThread](2026-01-12 02:58:09,004) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch22:
[1567253:MainThread](2026-01-12 02:58:09,005) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:58:21,277) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:58:37,405) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991727, valid -0.996865
[1567253:MainThread](2026-01-12 02:58:37,405) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch23:
[1567253:MainThread](2026-01-12 02:58:37,406) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:58:50,238) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:59:06,550) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990952, valid -0.995303
[1567253:MainThread](2026-01-12 02:59:06,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch24:
[1567253:MainThread](2026-01-12 02:59:06,551) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:59:18,792) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 02:59:34,429) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991453, valid -0.995857
[1567253:MainThread](2026-01-12 02:59:34,430) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch25:
[1567253:MainThread](2026-01-12 02:59:34,430) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 02:59:47,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:00:01,970) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990893, valid -0.995620
[1567253:MainThread](2026-01-12 03:00:01,970) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch26:
[1567253:MainThread](2026-01-12 03:00:01,971) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:00:15,011) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:00:30,579) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.991247, valid -0.995519
[1567253:MainThread](2026-01-12 03:00:30,579) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch27:
[1567253:MainThread](2026-01-12 03:00:30,580) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:00:43,541) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:00:57,391) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.990793, valid -0.995131
[1567253:MainThread](2026-01-12 03:00:57,392) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 03:00:57,392) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.995027 @ 17
2026-01-12 03:00:57.433 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 03:01:02.679 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-12 03:01:02.679 | INFO     | __main__:train_single_fold:593 -   IC=0.0021, ICIR=0.0163, RankIC=0.0306, RankICIR=0.2344
2026-01-12 03:01:02.679 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 03:01:02,690) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 03:01:27,898) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:01:27,899) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:01:35,533) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201c0ad290>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.38it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:05, 43.33it/s]backtest loop:   7%|▋         | 17/243 [00:00<00:04, 53.71it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 59.46it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:03, 55.49it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:03, 58.45it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:03, 58.86it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:03, 61.68it/s]backtest loop:  24%|██▍       | 59/243 [00:01<00:02, 64.04it/s]backtest loop:  27%|██▋       | 66/243 [00:01<00:02, 62.21it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 62.68it/s]backtest loop:  33%|███▎      | 81/243 [00:01<00:02, 61.77it/s]backtest loop:  36%|███▌      | 88/243 [00:01<00:02, 63.77it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:02, 63.11it/s]backtest loop:  42%|████▏     | 103/243 [00:01<00:02, 64.69it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:02, 63.01it/s]backtest loop:  48%|████▊     | 117/243 [00:01<00:01, 64.40it/s]backtest loop:  51%|█████     | 124/243 [00:02<00:01, 65.78it/s]backtest loop:  54%|█████▍    | 131/243 [00:02<00:01, 63.70it/s]backtest loop:  57%|█████▋    | 138/243 [00:02<00:01, 65.44it/s]backtest loop:  60%|█████▉    | 145/243 [00:02<00:01, 63.37it/s]backtest loop:  63%|██████▎   | 153/243 [00:02<00:01, 66.24it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 64.22it/s]backtest loop:  69%|██████▊   | 167/243 [00:02<00:01, 65.49it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:01, 64.37it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 64.17it/s]backtest loop:  78%|███████▊  | 189/243 [00:03<00:00, 62.84it/s]backtest loop:  81%|████████  | 196/243 [00:03<00:00, 64.65it/s]backtest loop:  84%|████████▎ | 203/243 [00:03<00:00, 63.26it/s]backtest loop:  86%|████████▋ | 210/243 [00:03<00:00, 64.85it/s]backtest loop:  89%|████████▉ | 217/243 [00:03<00:00, 66.12it/s]backtest loop:  92%|█████████▏| 224/243 [00:03<00:00, 63.95it/s]backtest loop:  95%|█████████▌| 231/243 [00:03<00:00, 65.59it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 63.39it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 62.50it/s]
2026-01-12 03:01:39.445 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0746, Sharpe(w/cost)=0.6431, MaxDD=-0.0831
2026-01-12 03:01:42.542 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_5_backtest_report.pdf
2026-01-12 03:01:58.761 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 03:01:58.852 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_5_pred.parquet
2026-01-12 03:01:58.898 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-12 03:01:58.898 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-12 03:02:03.660 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0225
2026-01-12 03:02:08.913 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0294
2026-01-12 03:02:14.213 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0264
2026-01-12 03:02:18.766 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0317
2026-01-12 03:02:23.814 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0331
2026-01-12 03:02:24.232 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0034, ICIR=0.0274, RankIC=0.0311
[1567253:MainThread](2026-01-12 03:02:24,240) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 03:02:49,775) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:02:49,776) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:02:57,813) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201cd650d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.01it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:05, 43.03it/s]backtest loop:   7%|▋         | 17/243 [00:00<00:04, 52.66it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 58.43it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:03, 54.02it/s]backtest loop:  15%|█▌        | 37/243 [00:00<00:03, 58.83it/s]backtest loop:  18%|█▊        | 44/243 [00:00<00:03, 61.71it/s]backtest loop:  21%|██        | 51/243 [00:00<00:03, 60.62it/s]backtest loop:  24%|██▍       | 58/243 [00:01<00:02, 63.06it/s]backtest loop:  27%|██▋       | 65/243 [00:01<00:02, 61.56it/s]backtest loop:  30%|██▉       | 72/243 [00:01<00:02, 63.62it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 61.75it/s]backtest loop:  35%|███▌      | 86/243 [00:01<00:02, 60.94it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:02, 64.61it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:02, 62.54it/s]backtest loop:  44%|████▍     | 108/243 [00:01<00:02, 64.32it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:02, 62.40it/s]backtest loop:  50%|█████     | 122/243 [00:02<00:01, 64.22it/s]backtest loop:  53%|█████▎    | 130/243 [00:02<00:01, 65.36it/s]backtest loop:  57%|█████▋    | 139/243 [00:02<00:01, 71.36it/s]backtest loop:  60%|██████    | 147/243 [00:02<00:01, 72.03it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 72.73it/s]backtest loop:  67%|██████▋   | 164/243 [00:02<00:01, 77.00it/s]backtest loop:  71%|███████   | 172/243 [00:02<00:00, 75.99it/s]backtest loop:  74%|███████▍  | 180/243 [00:02<00:00, 76.59it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 73.04it/s]backtest loop:  81%|████████  | 197/243 [00:03<00:00, 77.08it/s]backtest loop:  84%|████████▍ | 205/243 [00:03<00:00, 76.45it/s]backtest loop:  88%|████████▊ | 213/243 [00:03<00:00, 75.92it/s]backtest loop:  91%|█████████▏| 222/243 [00:03<00:00, 79.33it/s]backtest loop:  95%|█████████▍| 230/243 [00:03<00:00, 78.02it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 76.48it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 67.33it/s]
2026-01-12 03:03:01.446 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0689, Sharpe(w/cost)=0.6634
2026-01-12 03:03:01.494 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 03:03:01.495 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-12 03:03:01.495 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 03:03:01.495 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 03:04:01,084) INFO - qlib.timer - [log.py:127] - Time cost: 59.587s | Loading data Done
[1567253:MainThread](2026-01-12 03:04:01,347) INFO - qlib.timer - [log.py:127] - Time cost: 0.018s | FilterCol Done
[1567253:MainThread](2026-01-12 03:04:01,826) INFO - qlib.timer - [log.py:127] - Time cost: 0.477s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 03:04:02,004) INFO - qlib.timer - [log.py:127] - Time cost: 0.178s | Fillna Done
[1567253:MainThread](2026-01-12 03:04:02,086) INFO - qlib.timer - [log.py:127] - Time cost: 0.031s | DropnaLabel Done
[1567253:MainThread](2026-01-12 03:04:02,294) INFO - qlib.timer - [log.py:127] - Time cost: 0.207s | CSRankNorm Done
[1567253:MainThread](2026-01-12 03:04:02,296) INFO - qlib.timer - [log.py:127] - Time cost: 1.210s | fit & process data Done
[1567253:MainThread](2026-01-12 03:04:02,296) INFO - qlib.timer - [log.py:127] - Time cost: 60.800s | Init data Done
2026-01-12 03:04:02.297 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 03:04:02,314) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 03:04:02.437 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 03:04:04,712) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 03:04:04,712) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 03:04:04,713) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:04:17,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:04:35,210) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994168, valid -0.999485
[1567253:MainThread](2026-01-12 03:04:35,216) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 03:04:35,217) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:04:49,489) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:05:06,648) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994518, valid -1.001072
[1567253:MainThread](2026-01-12 03:05:06,649) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 03:05:06,650) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:05:19,711) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:05:36,171) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992944, valid -0.997881
[1567253:MainThread](2026-01-12 03:05:36,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 03:05:36,176) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:05:49,377) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:06:04,728) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.995806, valid -1.000240
[1567253:MainThread](2026-01-12 03:06:04,729) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 03:06:04,730) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:06:17,573) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:06:29,957) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992745, valid -0.997084
[1567253:MainThread](2026-01-12 03:06:29,961) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 03:06:29,962) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:06:40,111) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:06:56,099) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992575, valid -0.997989
[1567253:MainThread](2026-01-12 03:06:56,100) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 03:06:56,100) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:07:06,420) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:07:21,238) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993336, valid -0.999370
[1567253:MainThread](2026-01-12 03:07:21,239) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 03:07:21,239) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:07:31,902) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:07:45,766) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992133, valid -0.998141
[1567253:MainThread](2026-01-12 03:07:45,768) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 03:07:45,768) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:07:56,184) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:08:06,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992859, valid -0.998837
[1567253:MainThread](2026-01-12 03:08:06,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 03:08:06,098) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:08:17,447) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:08:33,128) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994741, valid -1.001020
[1567253:MainThread](2026-01-12 03:08:33,129) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 03:08:33,129) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:08:43,697) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:08:55,080) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992358, valid -0.997209
[1567253:MainThread](2026-01-12 03:08:55,081) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 03:08:55,081) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:09:07,113) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:09:22,102) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992517, valid -0.997157
[1567253:MainThread](2026-01-12 03:09:22,107) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 03:09:22,108) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:09:34,831) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:09:51,769) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992613, valid -0.997956
[1567253:MainThread](2026-01-12 03:09:51,770) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch13:
[1567253:MainThread](2026-01-12 03:09:51,770) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:10:04,276) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:10:21,392) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992433, valid -0.996745
[1567253:MainThread](2026-01-12 03:10:21,397) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch14:
[1567253:MainThread](2026-01-12 03:10:21,397) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:10:33,718) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:10:50,618) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992968, valid -0.996828
[1567253:MainThread](2026-01-12 03:10:50,618) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch15:
[1567253:MainThread](2026-01-12 03:10:50,619) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:11:03,250) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:11:20,442) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992627, valid -0.996937
[1567253:MainThread](2026-01-12 03:11:20,442) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch16:
[1567253:MainThread](2026-01-12 03:11:20,443) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:11:33,292) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:11:50,318) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992527, valid -0.997032
[1567253:MainThread](2026-01-12 03:11:50,319) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch17:
[1567253:MainThread](2026-01-12 03:11:50,320) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:12:03,350) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:12:20,492) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992605, valid -0.996702
[1567253:MainThread](2026-01-12 03:12:20,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch18:
[1567253:MainThread](2026-01-12 03:12:20,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:12:33,041) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:12:50,182) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992856, valid -0.997250
[1567253:MainThread](2026-01-12 03:12:50,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch19:
[1567253:MainThread](2026-01-12 03:12:50,183) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:13:02,810) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:13:19,771) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992768, valid -0.997127
[1567253:MainThread](2026-01-12 03:13:19,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch20:
[1567253:MainThread](2026-01-12 03:13:19,772) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:13:32,372) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:13:49,723) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992805, valid -0.996923
[1567253:MainThread](2026-01-12 03:13:49,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch21:
[1567253:MainThread](2026-01-12 03:13:49,724) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:14:02,072) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:14:18,738) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992999, valid -0.997178
[1567253:MainThread](2026-01-12 03:14:18,739) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch22:
[1567253:MainThread](2026-01-12 03:14:18,740) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:14:31,190) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:14:48,185) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992741, valid -0.997109
[1567253:MainThread](2026-01-12 03:14:48,185) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch23:
[1567253:MainThread](2026-01-12 03:14:48,186) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:15:00,870) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:15:17,299) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992831, valid -0.997752
[1567253:MainThread](2026-01-12 03:15:17,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch24:
[1567253:MainThread](2026-01-12 03:15:17,300) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:15:29,508) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:15:45,095) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993586, valid -0.997090
[1567253:MainThread](2026-01-12 03:15:45,096) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch25:
[1567253:MainThread](2026-01-12 03:15:45,097) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:15:57,725) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:16:14,804) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992763, valid -0.997460
[1567253:MainThread](2026-01-12 03:16:14,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch26:
[1567253:MainThread](2026-01-12 03:16:14,805) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:16:27,399) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:16:44,661) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992823, valid -0.996723
[1567253:MainThread](2026-01-12 03:16:44,662) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch27:
[1567253:MainThread](2026-01-12 03:16:44,662) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:16:57,406) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:17:13,758) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.992865, valid -0.996801
[1567253:MainThread](2026-01-12 03:17:13,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:191] - early stop
[1567253:MainThread](2026-01-12 03:17:13,759) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:194] - best score: -0.996702 @ 17
2026-01-12 03:17:13.803 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-12 03:17:18.934 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-12 03:17:18.934 | INFO     | __main__:train_single_fold:593 -   IC=0.0193, ICIR=0.1642, RankIC=0.0471, RankICIR=0.4277
2026-01-12 03:17:18.935 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1567253:MainThread](2026-01-12 03:17:18,942) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 03:17:46,734) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:17:46,735) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:17:55,606) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201f0d9450>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.56it/s]backtest loop:   4%|▎         | 9/242 [00:00<00:05, 40.41it/s]backtest loop:   7%|▋         | 16/242 [00:00<00:04, 52.28it/s]backtest loop:  10%|▉         | 23/242 [00:00<00:03, 58.26it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 57.19it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:03, 60.74it/s]backtest loop:  18%|█▊        | 43/242 [00:00<00:03, 63.23it/s]backtest loop:  21%|██        | 50/242 [00:00<00:03, 61.15it/s]backtest loop:  24%|██▎       | 57/242 [00:00<00:03, 61.08it/s]backtest loop:  26%|██▋       | 64/242 [00:01<00:03, 59.09it/s]backtest loop:  29%|██▉       | 71/242 [00:01<00:02, 61.97it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 60.91it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:02, 64.42it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:02, 67.05it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 69.91it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 74.34it/s]backtest loop:  50%|████▉     | 120/242 [00:01<00:01, 74.19it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 74.17it/s]backtest loop:  57%|█████▋    | 137/242 [00:02<00:01, 77.56it/s]backtest loop:  60%|█████▉    | 145/242 [00:02<00:01, 76.13it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 75.68it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 79.12it/s]backtest loop:  70%|███████   | 170/242 [00:02<00:00, 77.79it/s]backtest loop:  74%|███████▎  | 178/242 [00:02<00:00, 76.76it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 76.57it/s]backtest loop:  81%|████████  | 196/242 [00:02<00:00, 79.48it/s]backtest loop:  84%|████████▍ | 204/242 [00:02<00:00, 75.47it/s]backtest loop:  88%|████████▊ | 212/242 [00:03<00:00, 70.86it/s]backtest loop:  91%|█████████ | 220/242 [00:03<00:00, 71.12it/s]backtest loop:  94%|█████████▍| 228/242 [00:03<00:00, 67.17it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 67.46it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 64.70it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 67.61it/s]
2026-01-12 03:17:59.209 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1012, Sharpe(w/cost)=1.3254, MaxDD=-0.0778
2026-01-12 03:18:02.745 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pdf/fold_6_backtest_report.pdf
2026-01-12 03:18:20.002 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-12 03:18:20.124 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260112_014449_transformer_158_10_robust_6y/pred/fold_6_pred.parquet
2026-01-12 03:18:20.170 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-12 03:18:20.171 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-12 03:18:25.658 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0338
2026-01-12 03:18:30.095 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0426
2026-01-12 03:18:35.349 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0401
2026-01-12 03:18:40.511 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0441
2026-01-12 03:18:46.347 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0455
2026-01-12 03:18:51.502 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0439
2026-01-12 03:18:51.854 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0195, ICIR=0.1645, RankIC=0.0485
[1567253:MainThread](2026-01-12 03:18:51,864) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1567253:MainThread](2026-01-12 03:19:19,325) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:19:19,327) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1567253:MainThread](2026-01-12 03:19:27,598) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f201f059b90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 25.75it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 48.60it/s]backtest loop:   7%|▋         | 17/242 [00:00<00:03, 57.46it/s]backtest loop:  10%|▉         | 24/242 [00:00<00:03, 58.95it/s]backtest loop:  13%|█▎        | 31/242 [00:00<00:03, 62.14it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:03, 64.31it/s]backtest loop:  19%|█▊        | 45/242 [00:00<00:03, 62.24it/s]backtest loop:  21%|██▏       | 52/242 [00:00<00:02, 64.10it/s]backtest loop:  24%|██▍       | 59/242 [00:01<00:03, 59.34it/s]backtest loop:  27%|██▋       | 66/242 [00:01<00:02, 59.37it/s]backtest loop:  30%|███       | 73/242 [00:01<00:03, 55.16it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:03, 50.66it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:03, 50.47it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:02, 50.67it/s]backtest loop:  40%|████      | 97/242 [00:01<00:02, 51.01it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:02, 49.99it/s]backtest loop:  45%|████▌     | 109/242 [00:02<00:02, 51.19it/s]backtest loop:  48%|████▊     | 115/242 [00:02<00:02, 49.91it/s]backtest loop:  50%|█████     | 122/242 [00:02<00:02, 54.76it/s]backtest loop:  53%|█████▎    | 128/242 [00:02<00:02, 54.96it/s]backtest loop:  56%|█████▌    | 135/242 [00:02<00:01, 58.74it/s]backtest loop:  59%|█████▊    | 142/242 [00:02<00:01, 61.57it/s]backtest loop:  62%|██████▏   | 149/242 [00:02<00:01, 60.69it/s]backtest loop:  64%|██████▍   | 156/242 [00:02<00:01, 63.04it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:01, 61.59it/s]backtest loop:  70%|███████   | 170/242 [00:02<00:01, 63.80it/s]backtest loop:  73%|███████▎  | 177/242 [00:03<00:01, 62.32it/s]backtest loop:  76%|███████▌  | 184/242 [00:03<00:00, 64.38it/s]backtest loop:  79%|███████▉  | 191/242 [00:03<00:00, 65.71it/s]backtest loop:  82%|████████▏ | 198/242 [00:03<00:00, 63.48it/s]backtest loop:  85%|████████▍ | 205/242 [00:03<00:00, 64.75it/s]backtest loop:  88%|████████▊ | 212/242 [00:03<00:00, 63.24it/s]backtest loop:  90%|█████████ | 219/242 [00:03<00:00, 64.26it/s]backtest loop:  94%|█████████▍| 227/242 [00:03<00:00, 66.03it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 71.43it/s]backtest loop: 100%|██████████| 242/242 [00:04<00:00, 59.67it/s]
2026-01-12 03:19:31.674 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1172, Sharpe(w/cost)=1.6099
2026-01-12 03:19:31.709 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-12 03:19:31.709 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-12 03:19:31.709 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-12 03:19:31.709 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1567253:MainThread](2026-01-12 03:20:30,229) INFO - qlib.timer - [log.py:127] - Time cost: 58.518s | Loading data Done
[1567253:MainThread](2026-01-12 03:20:30,478) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[1567253:MainThread](2026-01-12 03:20:30,959) INFO - qlib.timer - [log.py:127] - Time cost: 0.479s | RobustZScoreNorm Done
[1567253:MainThread](2026-01-12 03:20:31,025) INFO - qlib.timer - [log.py:127] - Time cost: 0.066s | Fillna Done
[1567253:MainThread](2026-01-12 03:20:31,086) INFO - qlib.timer - [log.py:127] - Time cost: 0.026s | DropnaLabel Done
[1567253:MainThread](2026-01-12 03:20:31,296) INFO - qlib.timer - [log.py:127] - Time cost: 0.210s | CSRankNorm Done
[1567253:MainThread](2026-01-12 03:20:31,298) INFO - qlib.timer - [log.py:127] - Time cost: 1.068s | fit & process data Done
[1567253:MainThread](2026-01-12 03:20:31,298) INFO - qlib.timer - [log.py:127] - Time cost: 59.588s | Init data Done
2026-01-12 03:20:31.298 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1567253:MainThread](2026-01-12 03:20:31,310) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:61] - Naive Transformer:
batch_size : 800
device : cuda:0
2026-01-12 03:20:31.343 | INFO     | __main__:train_single_fold:569 - Training transformer_158_10_robust model (GPU=0)...
[1567253:MainThread](2026-01-12 03:20:33,180) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:169] - training...
[1567253:MainThread](2026-01-12 03:20:33,180) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch0:
[1567253:MainThread](2026-01-12 03:20:33,181) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:20:44,585) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:20:58,484) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.999466, valid -1.000934
[1567253:MainThread](2026-01-12 03:20:58,489) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch1:
[1567253:MainThread](2026-01-12 03:20:58,490) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:21:10,733) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:21:26,288) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994596, valid -0.996642
[1567253:MainThread](2026-01-12 03:21:26,292) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch2:
[1567253:MainThread](2026-01-12 03:21:26,292) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:21:37,496) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:21:52,753) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.996787, valid -0.998764
[1567253:MainThread](2026-01-12 03:21:52,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch3:
[1567253:MainThread](2026-01-12 03:21:52,754) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:22:03,277) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:22:19,708) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.998918, valid -1.001248
[1567253:MainThread](2026-01-12 03:22:19,708) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch4:
[1567253:MainThread](2026-01-12 03:22:19,709) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:22:30,980) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:22:46,068) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994221, valid -0.996642
[1567253:MainThread](2026-01-12 03:22:46,069) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch5:
[1567253:MainThread](2026-01-12 03:22:46,069) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:22:59,256) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:23:17,145) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994529, valid -0.997541
[1567253:MainThread](2026-01-12 03:23:17,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch6:
[1567253:MainThread](2026-01-12 03:23:17,146) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:23:30,109) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:23:47,514) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993738, valid -0.996509
[1567253:MainThread](2026-01-12 03:23:47,518) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch7:
[1567253:MainThread](2026-01-12 03:23:47,518) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:24:00,798) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:24:17,789) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993971, valid -0.996221
[1567253:MainThread](2026-01-12 03:24:17,793) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch8:
[1567253:MainThread](2026-01-12 03:24:17,794) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:24:30,497) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:24:47,458) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994355, valid -0.997110
[1567253:MainThread](2026-01-12 03:24:47,459) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch9:
[1567253:MainThread](2026-01-12 03:24:47,460) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:24:59,864) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:25:17,174) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.994057, valid -0.996806
[1567253:MainThread](2026-01-12 03:25:17,174) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch10:
[1567253:MainThread](2026-01-12 03:25:17,175) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:25:27,668) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:25:42,292) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993864, valid -0.996248
[1567253:MainThread](2026-01-12 03:25:42,292) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch11:
[1567253:MainThread](2026-01-12 03:25:42,293) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:25:52,765) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
[1567253:MainThread](2026-01-12 03:26:07,009) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:179] - train -0.993582, valid -0.996003
[1567253:MainThread](2026-01-12 03:26:07,013) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:173] - Epoch12:
[1567253:MainThread](2026-01-12 03:26:07,014) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:174] - training...
[1567253:MainThread](2026-01-12 03:26:17,636) INFO - qlib.TransformerModel - [pytorch_transformer_ts.py:176] - evaluating...
