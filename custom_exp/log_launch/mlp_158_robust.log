Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1357640:MainThread](2026-01-11 21:44:40,152) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1357640:MainThread](2026-01-11 21:44:40,657) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1357640:MainThread](2026-01-11 21:44:40,658) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 21:44:40.667 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y
2026-01-11 21:44:40.667 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/log/mlp_158_robust_csi500_topk_20260111_214440.log
2026-01-11 21:44:40.668 | INFO     | __main__:__init__:115 - Model name: mlp_158_robust_csi500_topk
2026-01-11 21:44:40.671 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 21:44:40.671 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:44:40.671 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 21:44:40.671 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:44:40.671 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 21:45:00,736) INFO - qlib.timer - [log.py:127] - Time cost: 20.063s | Loading data Done
[1357640:MainThread](2026-01-11 21:45:01,064) INFO - qlib.timer - [log.py:127] - Time cost: 0.086s | DropCol Done
[1357640:MainThread](2026-01-11 21:45:04,620) INFO - qlib.timer - [log.py:127] - Time cost: 3.554s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 21:45:06,470) INFO - qlib.timer - [log.py:127] - Time cost: 1.848s | Fillna Done
[1357640:MainThread](2026-01-11 21:45:07,165) INFO - qlib.timer - [log.py:127] - Time cost: 0.077s | DropCol Done
[1357640:MainThread](2026-01-11 21:45:07,315) INFO - qlib.timer - [log.py:127] - Time cost: 0.149s | DropnaLabel Done
[1357640:MainThread](2026-01-11 21:45:07,535) INFO - qlib.timer - [log.py:127] - Time cost: 0.220s | CSRankNorm Done
[1357640:MainThread](2026-01-11 21:45:07,537) INFO - qlib.timer - [log.py:127] - Time cost: 6.800s | fit & process data Done
[1357640:MainThread](2026-01-11 21:45:07,537) INFO - qlib.timer - [log.py:127] - Time cost: 26.865s | Init data Done
2026-01-11 21:45:07.538 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 21:45:07,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 21:45:07,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 21:45:07,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 21:45:07,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:45:09.476 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 21:45:10,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 21:45:10,946) INFO - qlib.workflow - [exp.py:258] - Experiment 528155627018642494 starts running ...
[1357640:MainThread](2026-01-11 21:45:11,049) INFO - qlib.workflow - [recorder.py:345] - Recorder b6f8c212ca0c4aadb0396e6a50388f3e starts running under Experiment 528155627018642494 ...
[1357640:MainThread](2026-01-11 21:45:12,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.531881, valid_loss 1.131155, train_metric nan, valid_metric 0.042990
[1357640:MainThread](2026-01-11 21:45:12,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.131155, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:12,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.130269, valid_loss 1.069358, train_metric nan, valid_metric 0.067696
[1357640:MainThread](2026-01-11 21:45:12,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.131155 to 1.069358, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:13,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.077889, valid_loss 1.031161, train_metric nan, valid_metric 0.073729
[1357640:MainThread](2026-01-11 21:45:13,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.069358 to 1.031161, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:14,108) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.063396, valid_loss 1.015336, train_metric nan, valid_metric 0.073174
[1357640:MainThread](2026-01-11 21:45:14,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.031161 to 1.015336, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:15,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.048441, valid_loss 1.012363, train_metric nan, valid_metric 0.073492
[1357640:MainThread](2026-01-11 21:45:15,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.015336 to 1.012363, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:15,550) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.045987, valid_loss 1.009926, train_metric nan, valid_metric 0.079928
[1357640:MainThread](2026-01-11 21:45:15,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012363 to 1.009926, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:16,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.039767, valid_loss 1.004839, train_metric nan, valid_metric 0.075218
[1357640:MainThread](2026-01-11 21:45:16,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009926 to 1.004839, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:16,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.038524, valid_loss 1.006456, train_metric nan, valid_metric 0.083716
[1357640:MainThread](2026-01-11 21:45:17,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.029042, valid_loss 1.004725, train_metric nan, valid_metric 0.088278
[1357640:MainThread](2026-01-11 21:45:17,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004839 to 1.004725, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:17,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.026019, valid_loss 1.004653, train_metric nan, valid_metric 0.087216
[1357640:MainThread](2026-01-11 21:45:17,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004725 to 1.004653, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:18,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.022255, valid_loss 0.999834, train_metric nan, valid_metric 0.086242
[1357640:MainThread](2026-01-11 21:45:18,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004653 to 0.999834, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:18,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.020529, valid_loss 1.001865, train_metric nan, valid_metric 0.091722
[1357640:MainThread](2026-01-11 21:45:19,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.012470, valid_loss 1.002822, train_metric nan, valid_metric 0.094657
[1357640:MainThread](2026-01-11 21:45:19,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.014371, valid_loss 1.002321, train_metric nan, valid_metric 0.097376
[1357640:MainThread](2026-01-11 21:45:20,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.014048, valid_loss 1.002398, train_metric nan, valid_metric 0.097997
[1357640:MainThread](2026-01-11 21:45:20,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.014348, valid_loss 1.001367, train_metric nan, valid_metric 0.098041
[1357640:MainThread](2026-01-11 21:45:21,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.009362, valid_loss 0.996592, train_metric nan, valid_metric 0.094791
[1357640:MainThread](2026-01-11 21:45:21,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999834 to 0.996592, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:21,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.004354, valid_loss 0.997037, train_metric nan, valid_metric 0.091692
[1357640:MainThread](2026-01-11 21:45:22,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.000468, valid_loss 1.001160, train_metric nan, valid_metric 0.102572
[1357640:MainThread](2026-01-11 21:45:23,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.002828, valid_loss 0.997011, train_metric nan, valid_metric 0.096510
[1357640:MainThread](2026-01-11 21:45:23,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.002336, valid_loss 0.996007, train_metric nan, valid_metric 0.099611
[1357640:MainThread](2026-01-11 21:45:23,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996592 to 0.996007, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:23,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.999568, valid_loss 0.994371, train_metric nan, valid_metric 0.100226
[1357640:MainThread](2026-01-11 21:45:23,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996007 to 0.994371, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:24,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.000328, valid_loss 1.000224, train_metric nan, valid_metric 0.103325
[1357640:MainThread](2026-01-11 21:45:24,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.994031, valid_loss 0.997895, train_metric nan, valid_metric 0.101658
[1357640:MainThread](2026-01-11 21:45:25,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.996815, valid_loss 0.996634, train_metric nan, valid_metric 0.100389
[1357640:MainThread](2026-01-11 21:45:26,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.991889, valid_loss 0.997065, train_metric nan, valid_metric 0.100939
[1357640:MainThread](2026-01-11 21:45:26,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.993046, valid_loss 0.996331, train_metric nan, valid_metric 0.105658
[1357640:MainThread](2026-01-11 21:45:27,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.992767, valid_loss 0.997005, train_metric nan, valid_metric 0.103466
[1357640:MainThread](2026-01-11 21:45:27,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.991789, valid_loss 0.994471, train_metric nan, valid_metric 0.102493
[1357640:MainThread](2026-01-11 21:45:28,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.989846, valid_loss 0.994039, train_metric nan, valid_metric 0.101609
[1357640:MainThread](2026-01-11 21:45:28,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994371 to 0.994039, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:28,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.991302, valid_loss 0.993614, train_metric nan, valid_metric 0.100959
[1357640:MainThread](2026-01-11 21:45:28,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994039 to 0.993614, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:29,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.989191, valid_loss 0.996124, train_metric nan, valid_metric 0.109032
[1357640:MainThread](2026-01-11 21:45:29,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.992740, valid_loss 0.994910, train_metric nan, valid_metric 0.108093
[1357640:MainThread](2026-01-11 21:45:30,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.988946, valid_loss 0.997624, train_metric nan, valid_metric 0.107831
[1357640:MainThread](2026-01-11 21:45:30,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.981509, valid_loss 0.993513, train_metric nan, valid_metric 0.106010
[1357640:MainThread](2026-01-11 21:45:30,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993614 to 0.993513, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:31,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.987778, valid_loss 0.997273, train_metric nan, valid_metric 0.103576
[1357640:MainThread](2026-01-11 21:45:31,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.983402, valid_loss 0.996074, train_metric nan, valid_metric 0.104413
[1357640:MainThread](2026-01-11 21:45:31,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.984867, valid_loss 0.994069, train_metric nan, valid_metric 0.107485
[1357640:MainThread](2026-01-11 21:45:32,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.986866, valid_loss 0.993529, train_metric nan, valid_metric 0.106096
[1357640:MainThread](2026-01-11 21:45:32,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.983798, valid_loss 0.994454, train_metric nan, valid_metric 0.103377
[1357640:MainThread](2026-01-11 21:45:33,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.984451, valid_loss 0.994200, train_metric nan, valid_metric 0.103737
[1357640:MainThread](2026-01-11 21:45:33,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.986358, valid_loss 0.992973, train_metric nan, valid_metric 0.105049
[1357640:MainThread](2026-01-11 21:45:33,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993513 to 0.992973, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:33,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.987496, valid_loss 0.995564, train_metric nan, valid_metric 0.106161
[1357640:MainThread](2026-01-11 21:45:34,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.985450, valid_loss 0.994679, train_metric nan, valid_metric 0.105592
[1357640:MainThread](2026-01-11 21:45:34,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.982238, valid_loss 0.995743, train_metric nan, valid_metric 0.107577
[1357640:MainThread](2026-01-11 21:45:35,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.986148, valid_loss 0.994693, train_metric nan, valid_metric 0.107677
[1357640:MainThread](2026-01-11 21:45:35,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.983872, valid_loss 0.993925, train_metric nan, valid_metric 0.110334
[1357640:MainThread](2026-01-11 21:45:35,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.986920, valid_loss 0.997275, train_metric nan, valid_metric 0.108665
[1357640:MainThread](2026-01-11 21:45:36,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.983497, valid_loss 0.995075, train_metric nan, valid_metric 0.107348
[1357640:MainThread](2026-01-11 21:45:36,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.979996, valid_loss 0.995734, train_metric nan, valid_metric 0.112584
[1357640:MainThread](2026-01-11 21:45:37,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.981337, valid_loss 0.992983, train_metric nan, valid_metric 0.106634
[1357640:MainThread](2026-01-11 21:45:37,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.981481, valid_loss 0.992735, train_metric nan, valid_metric 0.110685
[1357640:MainThread](2026-01-11 21:45:37,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992973 to 0.992735, save checkpoint.
[1357640:MainThread](2026-01-11 21:45:37,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.985921, valid_loss 0.995362, train_metric nan, valid_metric 0.109922
[1357640:MainThread](2026-01-11 21:45:38,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.982815, valid_loss 0.993854, train_metric nan, valid_metric 0.104692
[1357640:MainThread](2026-01-11 21:45:38,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.983640, valid_loss 0.996370, train_metric nan, valid_metric 0.105346
[1357640:MainThread](2026-01-11 21:45:39,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.981437, valid_loss 0.996034, train_metric nan, valid_metric 0.107867
[1357640:MainThread](2026-01-11 21:45:39,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.980860, valid_loss 0.994792, train_metric nan, valid_metric 0.104041
[1357640:MainThread](2026-01-11 21:45:39,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.980614, valid_loss 0.993515, train_metric nan, valid_metric 0.107637
[1357640:MainThread](2026-01-11 21:45:40,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.984669, valid_loss 0.996568, train_metric nan, valid_metric 0.111063
[1357640:MainThread](2026-01-11 21:45:40,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.981946, valid_loss 0.998493, train_metric nan, valid_metric 0.114597
[1357640:MainThread](2026-01-11 21:45:41,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.979176, valid_loss 0.997682, train_metric nan, valid_metric 0.108345
[1357640:MainThread](2026-01-11 21:45:41,586) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.983252, valid_loss 0.994446, train_metric nan, valid_metric 0.107414
[1357640:MainThread](2026-01-11 21:45:41,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.981254, valid_loss 0.998165, train_metric nan, valid_metric 0.110848
[1357640:MainThread](2026-01-11 21:45:42,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.982362, valid_loss 0.993173, train_metric nan, valid_metric 0.101863
[1357640:MainThread](2026-01-11 21:45:42,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.983311, valid_loss 0.993861, train_metric nan, valid_metric 0.110066
[1357640:MainThread](2026-01-11 21:45:43,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.977642, valid_loss 0.995514, train_metric nan, valid_metric 0.111977
[1357640:MainThread](2026-01-11 21:45:43,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.980557, valid_loss 0.995703, train_metric nan, valid_metric 0.112323
[1357640:MainThread](2026-01-11 21:45:44,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.977073, valid_loss 0.997229, train_metric nan, valid_metric 0.110512
[1357640:MainThread](2026-01-11 21:45:44,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.983079, valid_loss 0.995121, train_metric nan, valid_metric 0.110968
[1357640:MainThread](2026-01-11 21:45:44,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.979868, valid_loss 0.999842, train_metric nan, valid_metric 0.112846
[1357640:MainThread](2026-01-11 21:45:45,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.980064, valid_loss 0.994471, train_metric nan, valid_metric 0.105322
[1357640:MainThread](2026-01-11 21:45:45,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.978487, valid_loss 0.996813, train_metric nan, valid_metric 0.112669
[1357640:MainThread](2026-01-11 21:45:46,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.980926, valid_loss 0.995173, train_metric nan, valid_metric 0.109484
[1357640:MainThread](2026-01-11 21:45:46,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.976198, valid_loss 0.996550, train_metric nan, valid_metric 0.112549
[1357640:MainThread](2026-01-11 21:45:46,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.982556, valid_loss 0.995226, train_metric nan, valid_metric 0.107950
[1357640:MainThread](2026-01-11 21:45:47,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.977466, valid_loss 0.994424, train_metric nan, valid_metric 0.111118
[1357640:MainThread](2026-01-11 21:45:47,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.976519, valid_loss 0.994877, train_metric nan, valid_metric 0.109684
[1357640:MainThread](2026-01-11 21:45:48,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.980338, valid_loss 0.994818, train_metric nan, valid_metric 0.110726
[1357640:MainThread](2026-01-11 21:45:48,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.977399, valid_loss 0.994982, train_metric nan, valid_metric 0.112379
[1357640:MainThread](2026-01-11 21:45:48,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.974780, valid_loss 0.995735, train_metric nan, valid_metric 0.109741
[1357640:MainThread](2026-01-11 21:45:49,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.979128, valid_loss 0.997069, train_metric nan, valid_metric 0.113137
[1357640:MainThread](2026-01-11 21:45:49,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.980894, valid_loss 0.995319, train_metric nan, valid_metric 0.108718
[1357640:MainThread](2026-01-11 21:45:50,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.977738, valid_loss 0.994882, train_metric nan, valid_metric 0.108334
[1357640:MainThread](2026-01-11 21:45:50,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.979026, valid_loss 0.995829, train_metric nan, valid_metric 0.110422
[1357640:MainThread](2026-01-11 21:45:51,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.977863, valid_loss 0.997241, train_metric nan, valid_metric 0.111326
[1357640:MainThread](2026-01-11 21:45:51,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.977361, valid_loss 0.995483, train_metric nan, valid_metric 0.111561
[1357640:MainThread](2026-01-11 21:45:52,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.975770, valid_loss 0.995494, train_metric nan, valid_metric 0.111338
[1357640:MainThread](2026-01-11 21:45:52,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.978821, valid_loss 0.995018, train_metric nan, valid_metric 0.110990
[1357640:MainThread](2026-01-11 21:45:52,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.979009, valid_loss 0.995265, train_metric nan, valid_metric 0.110128
[1357640:MainThread](2026-01-11 21:45:53,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.982489, valid_loss 0.994482, train_metric nan, valid_metric 0.110352
[1357640:MainThread](2026-01-11 21:45:53,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.981632, valid_loss 0.994172, train_metric nan, valid_metric 0.108892
[1357640:MainThread](2026-01-11 21:45:54,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.982292, valid_loss 0.995293, train_metric nan, valid_metric 0.111218
[1357640:MainThread](2026-01-11 21:45:54,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.978354, valid_loss 0.995514, train_metric nan, valid_metric 0.109584
[1357640:MainThread](2026-01-11 21:45:54,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.975959, valid_loss 0.996736, train_metric nan, valid_metric 0.113122
[1357640:MainThread](2026-01-11 21:45:55,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.977216, valid_loss 0.996613, train_metric nan, valid_metric 0.112156
[1357640:MainThread](2026-01-11 21:45:55,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.978547, valid_loss 0.995663, train_metric nan, valid_metric 0.110291
[1357640:MainThread](2026-01-11 21:45:56,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.977324, valid_loss 0.994930, train_metric nan, valid_metric 0.110180
[1357640:MainThread](2026-01-11 21:45:56,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.979141, valid_loss 0.994346, train_metric nan, valid_metric 0.108450
[1357640:MainThread](2026-01-11 21:45:57,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.977661, valid_loss 0.995638, train_metric nan, valid_metric 0.110379
[1357640:MainThread](2026-01-11 21:45:57,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.979228, valid_loss 0.995373, train_metric nan, valid_metric 0.110353
[1357640:MainThread](2026-01-11 21:45:57,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.978618, valid_loss 0.995943, train_metric nan, valid_metric 0.111288
[1357640:MainThread](2026-01-11 21:45:58,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.977137, valid_loss 0.995091, train_metric nan, valid_metric 0.109454
[1357640:MainThread](2026-01-11 21:45:58,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:45:58.210 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:45:59.328 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 21:45:59.328 | INFO     | __main__:train_single_fold:593 -   IC=0.0777, ICIR=0.7075, RankIC=0.1022, RankICIR=0.8935
2026-01-11 21:45:59.328 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 21:45:59,335) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1357640:MainThread](2026-01-11 21:46:11,801) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:46:11,802) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:46:16,176) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f698447c510>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   5%|▍         | 11/244 [00:00<00:02, 103.78it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:02, 105.50it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 105.13it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:01, 105.64it/s]backtest loop:  23%|██▎       | 56/244 [00:00<00:01, 105.02it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:01, 101.73it/s]backtest loop:  32%|███▏      | 78/244 [00:00<00:01, 102.80it/s]backtest loop:  36%|███▋      | 89/244 [00:00<00:01, 96.59it/s] backtest loop:  41%|████      | 100/244 [00:00<00:01, 98.87it/s]backtest loop:  45%|████▌     | 111/244 [00:01<00:01, 97.25it/s]backtest loop:  50%|█████     | 122/244 [00:01<00:01, 99.46it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 101.34it/s]backtest loop:  59%|█████▉    | 145/244 [00:01<00:00, 105.14it/s]backtest loop:  64%|██████▍   | 156/244 [00:01<00:00, 101.15it/s]backtest loop:  68%|██████▊   | 167/244 [00:01<00:00, 103.05it/s]backtest loop:  73%|███████▎  | 178/244 [00:01<00:00, 104.98it/s]backtest loop:  77%|███████▋  | 189/244 [00:01<00:00, 102.06it/s]backtest loop:  82%|████████▏ | 200/244 [00:01<00:00, 101.16it/s]backtest loop:  86%|████████▋ | 211/244 [00:02<00:00, 100.48it/s]backtest loop:  91%|█████████ | 222/244 [00:02<00:00, 102.11it/s]backtest loop:  95%|█████████▌| 233/244 [00:02<00:00, 103.64it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 101.93it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 101.94it/s]
2026-01-11 21:46:18.588 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.4092, Sharpe(w/cost)=3.9327, MaxDD=-0.0322
2026-01-11 21:46:23.072 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 21:46:40.359 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:46:40.423 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_0_pred.parquet
2026-01-11 21:46:40.443 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:46:40.443 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 21:46:40.443 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:46:40.443 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 21:47:16,521) INFO - qlib.timer - [log.py:127] - Time cost: 36.075s | Loading data Done
[1357640:MainThread](2026-01-11 21:47:16,924) INFO - qlib.timer - [log.py:127] - Time cost: 0.124s | DropCol Done
[1357640:MainThread](2026-01-11 21:47:20,454) INFO - qlib.timer - [log.py:127] - Time cost: 3.526s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 21:47:21,875) INFO - qlib.timer - [log.py:127] - Time cost: 1.420s | Fillna Done
[1357640:MainThread](2026-01-11 21:47:22,540) INFO - qlib.timer - [log.py:127] - Time cost: 0.073s | DropCol Done
[1357640:MainThread](2026-01-11 21:47:22,681) INFO - qlib.timer - [log.py:127] - Time cost: 0.139s | DropnaLabel Done
[1357640:MainThread](2026-01-11 21:47:22,874) INFO - qlib.timer - [log.py:127] - Time cost: 0.192s | CSRankNorm Done
[1357640:MainThread](2026-01-11 21:47:22,876) INFO - qlib.timer - [log.py:127] - Time cost: 6.354s | fit & process data Done
[1357640:MainThread](2026-01-11 21:47:22,876) INFO - qlib.timer - [log.py:127] - Time cost: 42.432s | Init data Done
2026-01-11 21:47:22.877 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 21:47:22,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 21:47:22,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 21:47:22,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 21:47:22,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:47:22.892 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 21:47:24,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 21:47:24,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.301620, valid_loss 1.116678, train_metric nan, valid_metric 0.059764
[1357640:MainThread](2026-01-11 21:47:24,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.116678, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:25,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.100102, valid_loss 1.038999, train_metric nan, valid_metric 0.054521
[1357640:MainThread](2026-01-11 21:47:25,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.116678 to 1.038999, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:25,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.067595, valid_loss 1.022847, train_metric nan, valid_metric 0.058059
[1357640:MainThread](2026-01-11 21:47:25,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.038999 to 1.022847, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:26,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.047620, valid_loss 1.012057, train_metric nan, valid_metric 0.058640
[1357640:MainThread](2026-01-11 21:47:26,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.022847 to 1.012057, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:26,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.043728, valid_loss 1.008559, train_metric nan, valid_metric 0.063108
[1357640:MainThread](2026-01-11 21:47:26,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012057 to 1.008559, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:26,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.032099, valid_loss 1.004949, train_metric nan, valid_metric 0.075727
[1357640:MainThread](2026-01-11 21:47:26,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008559 to 1.004949, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:27,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.026683, valid_loss 1.002530, train_metric nan, valid_metric 0.084654
[1357640:MainThread](2026-01-11 21:47:27,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004949 to 1.002530, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:28,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.017413, valid_loss 1.001480, train_metric nan, valid_metric 0.087429
[1357640:MainThread](2026-01-11 21:47:28,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002530 to 1.001480, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:28,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.017016, valid_loss 1.001804, train_metric nan, valid_metric 0.088331
[1357640:MainThread](2026-01-11 21:47:29,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.013407, valid_loss 0.998569, train_metric nan, valid_metric 0.096965
[1357640:MainThread](2026-01-11 21:47:29,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001480 to 0.998569, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:29,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.009035, valid_loss 0.998357, train_metric nan, valid_metric 0.099174
[1357640:MainThread](2026-01-11 21:47:29,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998569 to 0.998357, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:30,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.006492, valid_loss 1.000066, train_metric nan, valid_metric 0.097752
[1357640:MainThread](2026-01-11 21:47:31,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.002957, valid_loss 0.997499, train_metric nan, valid_metric 0.101286
[1357640:MainThread](2026-01-11 21:47:31,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998357 to 0.997499, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:31,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.006524, valid_loss 0.997647, train_metric nan, valid_metric 0.097205
[1357640:MainThread](2026-01-11 21:47:32,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.003560, valid_loss 0.996455, train_metric nan, valid_metric 0.096010
[1357640:MainThread](2026-01-11 21:47:32,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997499 to 0.996455, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:32,773) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.998069, valid_loss 0.993786, train_metric nan, valid_metric 0.103244
[1357640:MainThread](2026-01-11 21:47:32,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996455 to 0.993786, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:33,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.996693, valid_loss 1.002030, train_metric nan, valid_metric 0.110264
[1357640:MainThread](2026-01-11 21:47:33,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.998856, valid_loss 0.994504, train_metric nan, valid_metric 0.104847
[1357640:MainThread](2026-01-11 21:47:34,482) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.993841, valid_loss 0.995773, train_metric nan, valid_metric 0.107286
[1357640:MainThread](2026-01-11 21:47:35,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.992281, valid_loss 0.996570, train_metric nan, valid_metric 0.111009
[1357640:MainThread](2026-01-11 21:47:35,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.992454, valid_loss 0.992288, train_metric nan, valid_metric 0.100685
[1357640:MainThread](2026-01-11 21:47:35,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993786 to 0.992288, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:36,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.993958, valid_loss 0.993675, train_metric nan, valid_metric 0.103165
[1357640:MainThread](2026-01-11 21:47:37,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.995105, valid_loss 0.993258, train_metric nan, valid_metric 0.111325
[1357640:MainThread](2026-01-11 21:47:37,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.988181, valid_loss 0.995663, train_metric nan, valid_metric 0.110552
[1357640:MainThread](2026-01-11 21:47:37,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.992436, valid_loss 0.993083, train_metric nan, valid_metric 0.110725
[1357640:MainThread](2026-01-11 21:47:38,350) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.986547, valid_loss 0.998938, train_metric nan, valid_metric 0.116196
[1357640:MainThread](2026-01-11 21:47:38,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.988247, valid_loss 0.991902, train_metric nan, valid_metric 0.107706
[1357640:MainThread](2026-01-11 21:47:38,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992288 to 0.991902, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:39,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.990758, valid_loss 0.993169, train_metric nan, valid_metric 0.115472
[1357640:MainThread](2026-01-11 21:47:39,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.982961, valid_loss 0.993810, train_metric nan, valid_metric 0.110680
[1357640:MainThread](2026-01-11 21:47:40,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.988649, valid_loss 0.995160, train_metric nan, valid_metric 0.114600
[1357640:MainThread](2026-01-11 21:47:40,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.985810, valid_loss 0.995710, train_metric nan, valid_metric 0.114553
[1357640:MainThread](2026-01-11 21:47:40,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.988279, valid_loss 0.994057, train_metric nan, valid_metric 0.110832
[1357640:MainThread](2026-01-11 21:47:41,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.988909, valid_loss 0.994558, train_metric nan, valid_metric 0.114482
[1357640:MainThread](2026-01-11 21:47:41,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.988737, valid_loss 0.993202, train_metric nan, valid_metric 0.114069
[1357640:MainThread](2026-01-11 21:47:42,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.989880, valid_loss 0.993701, train_metric nan, valid_metric 0.112726
[1357640:MainThread](2026-01-11 21:47:42,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.986468, valid_loss 0.992506, train_metric nan, valid_metric 0.110850
[1357640:MainThread](2026-01-11 21:47:42,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.981116, valid_loss 0.994149, train_metric nan, valid_metric 0.111074
[1357640:MainThread](2026-01-11 21:47:43,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.987276, valid_loss 0.994845, train_metric nan, valid_metric 0.111037
[1357640:MainThread](2026-01-11 21:47:43,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.988258, valid_loss 0.994806, train_metric nan, valid_metric 0.116258
[1357640:MainThread](2026-01-11 21:47:44,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.981350, valid_loss 0.993297, train_metric nan, valid_metric 0.113074
[1357640:MainThread](2026-01-11 21:47:44,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.991087, valid_loss 0.991839, train_metric nan, valid_metric 0.110308
[1357640:MainThread](2026-01-11 21:47:44,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.991902 to 0.991839, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:44,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.987608, valid_loss 0.995442, train_metric nan, valid_metric 0.115402
[1357640:MainThread](2026-01-11 21:47:45,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.985006, valid_loss 0.992864, train_metric nan, valid_metric 0.116972
[1357640:MainThread](2026-01-11 21:47:45,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.986605, valid_loss 0.993687, train_metric nan, valid_metric 0.112091
[1357640:MainThread](2026-01-11 21:47:46,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.984148, valid_loss 0.994157, train_metric nan, valid_metric 0.116626
[1357640:MainThread](2026-01-11 21:47:46,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.984694, valid_loss 0.992129, train_metric nan, valid_metric 0.112443
[1357640:MainThread](2026-01-11 21:47:47,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.986371, valid_loss 0.993973, train_metric nan, valid_metric 0.112597
[1357640:MainThread](2026-01-11 21:47:47,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.983394, valid_loss 0.994245, train_metric nan, valid_metric 0.114455
[1357640:MainThread](2026-01-11 21:47:47,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.981895, valid_loss 0.992337, train_metric nan, valid_metric 0.114069
[1357640:MainThread](2026-01-11 21:47:48,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.985553, valid_loss 0.992854, train_metric nan, valid_metric 0.114459
[1357640:MainThread](2026-01-11 21:47:48,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.986373, valid_loss 0.992153, train_metric nan, valid_metric 0.113511
[1357640:MainThread](2026-01-11 21:47:49,104) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.982994, valid_loss 0.992230, train_metric nan, valid_metric 0.115234
[1357640:MainThread](2026-01-11 21:47:49,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.980536, valid_loss 0.993227, train_metric nan, valid_metric 0.113976
[1357640:MainThread](2026-01-11 21:47:49,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.981705, valid_loss 0.992522, train_metric nan, valid_metric 0.115538
[1357640:MainThread](2026-01-11 21:47:50,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.984293, valid_loss 0.993577, train_metric nan, valid_metric 0.116923
[1357640:MainThread](2026-01-11 21:47:50,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.982269, valid_loss 0.992702, train_metric nan, valid_metric 0.113259
[1357640:MainThread](2026-01-11 21:47:51,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.987639, valid_loss 0.993388, train_metric nan, valid_metric 0.116853
[1357640:MainThread](2026-01-11 21:47:51,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.981803, valid_loss 0.995492, train_metric nan, valid_metric 0.116314
[1357640:MainThread](2026-01-11 21:47:51,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.984876, valid_loss 0.997240, train_metric nan, valid_metric 0.117576
[1357640:MainThread](2026-01-11 21:47:52,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.980515, valid_loss 0.994849, train_metric nan, valid_metric 0.116564
[1357640:MainThread](2026-01-11 21:47:52,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.981867, valid_loss 0.994251, train_metric nan, valid_metric 0.116809
[1357640:MainThread](2026-01-11 21:47:53,177) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.983686, valid_loss 0.993389, train_metric nan, valid_metric 0.115648
[1357640:MainThread](2026-01-11 21:47:53,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.983238, valid_loss 0.993319, train_metric nan, valid_metric 0.114133
[1357640:MainThread](2026-01-11 21:47:53,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.980777, valid_loss 0.993797, train_metric nan, valid_metric 0.114862
[1357640:MainThread](2026-01-11 21:47:54,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.984229, valid_loss 0.991612, train_metric nan, valid_metric 0.113067
[1357640:MainThread](2026-01-11 21:47:54,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.991839 to 0.991612, save checkpoint.
[1357640:MainThread](2026-01-11 21:47:54,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.986812, valid_loss 0.993460, train_metric nan, valid_metric 0.112373
[1357640:MainThread](2026-01-11 21:47:55,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.985560, valid_loss 0.993161, train_metric nan, valid_metric 0.115575
[1357640:MainThread](2026-01-11 21:47:55,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.981224, valid_loss 0.993373, train_metric nan, valid_metric 0.115704
[1357640:MainThread](2026-01-11 21:47:56,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.984243, valid_loss 0.993087, train_metric nan, valid_metric 0.117303
[1357640:MainThread](2026-01-11 21:47:56,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.981438, valid_loss 0.994265, train_metric nan, valid_metric 0.115036
[1357640:MainThread](2026-01-11 21:47:56,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.981240, valid_loss 0.993739, train_metric nan, valid_metric 0.117153
[1357640:MainThread](2026-01-11 21:47:57,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.984181, valid_loss 0.993562, train_metric nan, valid_metric 0.115167
[1357640:MainThread](2026-01-11 21:47:57,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.979739, valid_loss 0.994237, train_metric nan, valid_metric 0.114961
[1357640:MainThread](2026-01-11 21:47:58,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.984183, valid_loss 0.994561, train_metric nan, valid_metric 0.115482
[1357640:MainThread](2026-01-11 21:47:58,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.981762, valid_loss 0.993602, train_metric nan, valid_metric 0.114592
[1357640:MainThread](2026-01-11 21:47:58,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.981721, valid_loss 0.993724, train_metric nan, valid_metric 0.113789
[1357640:MainThread](2026-01-11 21:47:59,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.980730, valid_loss 0.994013, train_metric nan, valid_metric 0.115857
[1357640:MainThread](2026-01-11 21:47:59,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.983520, valid_loss 0.993168, train_metric nan, valid_metric 0.115563
[1357640:MainThread](2026-01-11 21:48:00,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.980507, valid_loss 0.993881, train_metric nan, valid_metric 0.115969
[1357640:MainThread](2026-01-11 21:48:00,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.982810, valid_loss 0.993821, train_metric nan, valid_metric 0.115965
[1357640:MainThread](2026-01-11 21:48:00,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.981841, valid_loss 0.992953, train_metric nan, valid_metric 0.115249
[1357640:MainThread](2026-01-11 21:48:01,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.982862, valid_loss 0.993071, train_metric nan, valid_metric 0.114722
[1357640:MainThread](2026-01-11 21:48:01,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.979495, valid_loss 0.992146, train_metric nan, valid_metric 0.114523
[1357640:MainThread](2026-01-11 21:48:02,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.982471, valid_loss 0.992883, train_metric nan, valid_metric 0.115150
[1357640:MainThread](2026-01-11 21:48:02,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.982478, valid_loss 0.992579, train_metric nan, valid_metric 0.114748
[1357640:MainThread](2026-01-11 21:48:03,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.981565, valid_loss 0.993328, train_metric nan, valid_metric 0.115855
[1357640:MainThread](2026-01-11 21:48:03,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.983632, valid_loss 0.992950, train_metric nan, valid_metric 0.112290
[1357640:MainThread](2026-01-11 21:48:03,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.986707, valid_loss 0.993166, train_metric nan, valid_metric 0.115143
[1357640:MainThread](2026-01-11 21:48:04,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.981879, valid_loss 0.993003, train_metric nan, valid_metric 0.115434
[1357640:MainThread](2026-01-11 21:48:04,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.985426, valid_loss 0.992515, train_metric nan, valid_metric 0.115722
[1357640:MainThread](2026-01-11 21:48:05,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.980050, valid_loss 0.993572, train_metric nan, valid_metric 0.117130
[1357640:MainThread](2026-01-11 21:48:05,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.982612, valid_loss 0.993119, train_metric nan, valid_metric 0.115803
[1357640:MainThread](2026-01-11 21:48:06,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.983049, valid_loss 0.993047, train_metric nan, valid_metric 0.115742
[1357640:MainThread](2026-01-11 21:48:06,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.982249, valid_loss 0.993335, train_metric nan, valid_metric 0.115893
[1357640:MainThread](2026-01-11 21:48:07,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.979480, valid_loss 0.993381, train_metric nan, valid_metric 0.115721
[1357640:MainThread](2026-01-11 21:48:07,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.982435, valid_loss 0.993566, train_metric nan, valid_metric 0.115736
[1357640:MainThread](2026-01-11 21:48:08,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.983305, valid_loss 0.993359, train_metric nan, valid_metric 0.115719
[1357640:MainThread](2026-01-11 21:48:08,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.981964, valid_loss 0.993443, train_metric nan, valid_metric 0.115806
[1357640:MainThread](2026-01-11 21:48:08,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.981643, valid_loss 0.993648, train_metric nan, valid_metric 0.116099
[1357640:MainThread](2026-01-11 21:48:09,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.982552, valid_loss 0.993348, train_metric nan, valid_metric 0.115888
[1357640:MainThread](2026-01-11 21:48:09,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.982365, valid_loss 0.993043, train_metric nan, valid_metric 0.115827
[1357640:MainThread](2026-01-11 21:48:10,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.982747, valid_loss 0.992952, train_metric nan, valid_metric 0.115109
[1357640:MainThread](2026-01-11 21:48:10,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.981747, valid_loss 0.993384, train_metric nan, valid_metric 0.115992
[1357640:MainThread](2026-01-11 21:48:11,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.980288, valid_loss 0.993094, train_metric nan, valid_metric 0.115898
[1357640:MainThread](2026-01-11 21:48:11,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.984741, valid_loss 0.993285, train_metric nan, valid_metric 0.116113
[1357640:MainThread](2026-01-11 21:48:11,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.984387, valid_loss 0.993293, train_metric nan, valid_metric 0.116016
[1357640:MainThread](2026-01-11 21:48:12,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.984577, valid_loss 0.992696, train_metric nan, valid_metric 0.114623
[1357640:MainThread](2026-01-11 21:48:12,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.981375, valid_loss 0.993195, train_metric nan, valid_metric 0.115391
[1357640:MainThread](2026-01-11 21:48:13,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.980680, valid_loss 0.993517, train_metric nan, valid_metric 0.116057
[1357640:MainThread](2026-01-11 21:48:13,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.982187, valid_loss 0.993441, train_metric nan, valid_metric 0.116099
[1357640:MainThread](2026-01-11 21:48:14,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.985915, valid_loss 0.993148, train_metric nan, valid_metric 0.115568
[1357640:MainThread](2026-01-11 21:48:14,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.980254, valid_loss 0.992929, train_metric nan, valid_metric 0.114917
[1357640:MainThread](2026-01-11 21:48:14,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.979879, valid_loss 0.993163, train_metric nan, valid_metric 0.115293
[1357640:MainThread](2026-01-11 21:48:15,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.977369, valid_loss 0.993124, train_metric nan, valid_metric 0.115144
[1357640:MainThread](2026-01-11 21:48:15,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.980358, valid_loss 0.993191, train_metric nan, valid_metric 0.115305
[1357640:MainThread](2026-01-11 21:48:15,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:48:15.807 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:48:16.912 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 21:48:16.913 | INFO     | __main__:train_single_fold:593 -   IC=0.0552, ICIR=0.5093, RankIC=0.0707, RankICIR=0.7519
2026-01-11 21:48:16.913 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 21:48:16,919) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:48:40,214) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:48:40,215) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:48:46,896) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6a34eab010>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 38.69it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 67.98it/s]backtest loop:  10%|▉         | 24/244 [00:00<00:02, 79.27it/s]backtest loop:  14%|█▍        | 35/244 [00:00<00:02, 90.67it/s]backtest loop:  19%|█▉        | 46/244 [00:00<00:02, 97.19it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:01, 101.22it/s]backtest loop:  29%|██▊       | 70/244 [00:00<00:01, 103.85it/s]backtest loop:  33%|███▎      | 81/244 [00:00<00:01, 101.74it/s]backtest loop:  38%|███▊      | 93/244 [00:00<00:01, 105.76it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 108.78it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 113.97it/s]backtest loop:  54%|█████▍    | 132/244 [00:01<00:00, 118.52it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:00, 117.91it/s]backtest loop:  64%|██████▍   | 156/244 [00:01<00:00, 112.47it/s]backtest loop:  69%|██████▉   | 168/244 [00:01<00:00, 109.10it/s]backtest loop:  73%|███████▎  | 179/244 [00:01<00:00, 100.98it/s]backtest loop:  78%|███████▊  | 190/244 [00:01<00:00, 98.44it/s] backtest loop:  82%|████████▏ | 200/244 [00:01<00:00, 93.06it/s]backtest loop:  86%|████████▌ | 210/244 [00:02<00:00, 93.19it/s]backtest loop:  90%|█████████ | 220/244 [00:02<00:00, 93.53it/s]backtest loop:  94%|█████████▍| 230/244 [00:02<00:00, 93.49it/s]backtest loop:  98%|█████████▊| 240/244 [00:02<00:00, 95.15it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 99.23it/s]
2026-01-11 21:48:49.379 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0792, Sharpe(w/cost)=1.5160, MaxDD=-0.0515
2026-01-11 21:48:53.612 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 21:49:12.044 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:49:12.116 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_1_pred.parquet
2026-01-11 21:49:12.138 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 21:49:12.138 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 21:49:13.768 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0715
2026-01-11 21:49:14.124 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0570, ICIR=0.4970, RankIC=0.0737
[1357640:MainThread](2026-01-11 21:49:14,131) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:49:39,260) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:49:39,261) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:49:45,714) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6a34c14190>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 35.29it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 63.68it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 73.01it/s]backtest loop:  13%|█▎        | 32/244 [00:00<00:02, 77.50it/s]backtest loop:  17%|█▋        | 41/244 [00:00<00:02, 80.49it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 82.85it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 84.84it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 86.15it/s]backtest loop:  32%|███▏      | 77/244 [00:00<00:01, 86.01it/s]backtest loop:  36%|███▌      | 87/244 [00:01<00:01, 88.22it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 88.54it/s]backtest loop:  43%|████▎     | 106/244 [00:01<00:01, 91.63it/s]backtest loop:  48%|████▊     | 117/244 [00:01<00:01, 96.29it/s]backtest loop:  52%|█████▏    | 127/244 [00:01<00:01, 95.08it/s]backtest loop:  56%|█████▌    | 137/244 [00:01<00:01, 95.32it/s]backtest loop:  60%|██████    | 147/244 [00:01<00:01, 94.35it/s]backtest loop:  64%|██████▍   | 157/244 [00:01<00:00, 95.04it/s]backtest loop:  69%|██████▉   | 168/244 [00:01<00:00, 97.51it/s]backtest loop:  73%|███████▎  | 178/244 [00:02<00:00, 96.33it/s]backtest loop:  77%|███████▋  | 188/244 [00:02<00:00, 95.07it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 93.46it/s]backtest loop:  85%|████████▌ | 208/244 [00:02<00:00, 92.20it/s]backtest loop:  89%|████████▉ | 218/244 [00:02<00:00, 92.10it/s]backtest loop:  93%|█████████▎| 228/244 [00:02<00:00, 91.55it/s]backtest loop:  98%|█████████▊| 238/244 [00:02<00:00, 93.12it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 89.14it/s]
2026-01-11 21:49:48.473 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1023, Sharpe(w/cost)=1.9634
2026-01-11 21:49:48.528 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:49:48.528 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 21:49:48.528 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:49:48.528 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 21:50:42,824) INFO - qlib.timer - [log.py:127] - Time cost: 54.292s | Loading data Done
[1357640:MainThread](2026-01-11 21:50:43,145) INFO - qlib.timer - [log.py:127] - Time cost: 0.078s | DropCol Done
[1357640:MainThread](2026-01-11 21:50:46,751) INFO - qlib.timer - [log.py:127] - Time cost: 3.604s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 21:50:48,616) INFO - qlib.timer - [log.py:127] - Time cost: 1.863s | Fillna Done
[1357640:MainThread](2026-01-11 21:50:49,273) INFO - qlib.timer - [log.py:127] - Time cost: 0.088s | DropCol Done
[1357640:MainThread](2026-01-11 21:50:49,426) INFO - qlib.timer - [log.py:127] - Time cost: 0.151s | DropnaLabel Done
[1357640:MainThread](2026-01-11 21:50:49,629) INFO - qlib.timer - [log.py:127] - Time cost: 0.203s | CSRankNorm Done
[1357640:MainThread](2026-01-11 21:50:49,631) INFO - qlib.timer - [log.py:127] - Time cost: 6.806s | fit & process data Done
[1357640:MainThread](2026-01-11 21:50:49,632) INFO - qlib.timer - [log.py:127] - Time cost: 61.102s | Init data Done
2026-01-11 21:50:49.632 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 21:50:49,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 21:50:49,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 21:50:49,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 21:50:49,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:50:49.649 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 21:50:50,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 21:50:51,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.273242, valid_loss 1.060956, train_metric nan, valid_metric 0.037878
[1357640:MainThread](2026-01-11 21:50:51,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.060956, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:52,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.077624, valid_loss 1.017572, train_metric nan, valid_metric 0.032418
[1357640:MainThread](2026-01-11 21:50:52,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.060956 to 1.017572, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:52,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.047054, valid_loss 1.007423, train_metric nan, valid_metric 0.049181
[1357640:MainThread](2026-01-11 21:50:52,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.017572 to 1.007423, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:53,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.037768, valid_loss 1.001114, train_metric nan, valid_metric 0.060423
[1357640:MainThread](2026-01-11 21:50:53,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007423 to 1.001114, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:53,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.024245, valid_loss 0.999076, train_metric nan, valid_metric 0.061149
[1357640:MainThread](2026-01-11 21:50:53,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001114 to 0.999076, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:54,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.020791, valid_loss 0.997320, train_metric nan, valid_metric 0.064180
[1357640:MainThread](2026-01-11 21:50:54,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999076 to 0.997320, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:54,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.016398, valid_loss 0.995395, train_metric nan, valid_metric 0.070805
[1357640:MainThread](2026-01-11 21:50:54,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997320 to 0.995395, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:55,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.013572, valid_loss 0.995556, train_metric nan, valid_metric 0.068618
[1357640:MainThread](2026-01-11 21:50:55,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.009068, valid_loss 0.993845, train_metric nan, valid_metric 0.076463
[1357640:MainThread](2026-01-11 21:50:55,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995395 to 0.993845, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:56,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.005108, valid_loss 0.996199, train_metric nan, valid_metric 0.079981
[1357640:MainThread](2026-01-11 21:50:57,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.002097, valid_loss 0.996882, train_metric nan, valid_metric 0.080439
[1357640:MainThread](2026-01-11 21:50:57,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 0.999468, valid_loss 0.993924, train_metric nan, valid_metric 0.076432
[1357640:MainThread](2026-01-11 21:50:58,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 0.994818, valid_loss 0.992217, train_metric nan, valid_metric 0.081968
[1357640:MainThread](2026-01-11 21:50:58,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993845 to 0.992217, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:58,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.995367, valid_loss 0.993069, train_metric nan, valid_metric 0.083685
[1357640:MainThread](2026-01-11 21:50:59,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.996611, valid_loss 0.992033, train_metric nan, valid_metric 0.084974
[1357640:MainThread](2026-01-11 21:50:59,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992217 to 0.992033, save checkpoint.
[1357640:MainThread](2026-01-11 21:50:59,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.993934, valid_loss 0.993559, train_metric nan, valid_metric 0.085522
[1357640:MainThread](2026-01-11 21:51:00,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.995086, valid_loss 0.992523, train_metric nan, valid_metric 0.085076
[1357640:MainThread](2026-01-11 21:51:00,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.993626, valid_loss 0.991515, train_metric nan, valid_metric 0.085024
[1357640:MainThread](2026-01-11 21:51:00,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992033 to 0.991515, save checkpoint.
[1357640:MainThread](2026-01-11 21:51:01,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.988594, valid_loss 0.991083, train_metric nan, valid_metric 0.086815
[1357640:MainThread](2026-01-11 21:51:01,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.991515 to 0.991083, save checkpoint.
[1357640:MainThread](2026-01-11 21:51:01,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.990432, valid_loss 0.991575, train_metric nan, valid_metric 0.083917
[1357640:MainThread](2026-01-11 21:51:02,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.991823, valid_loss 0.991589, train_metric nan, valid_metric 0.088874
[1357640:MainThread](2026-01-11 21:51:02,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.985240, valid_loss 0.991396, train_metric nan, valid_metric 0.086978
[1357640:MainThread](2026-01-11 21:51:03,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.985744, valid_loss 0.994102, train_metric nan, valid_metric 0.077286
[1357640:MainThread](2026-01-11 21:51:04,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.989132, valid_loss 0.992099, train_metric nan, valid_metric 0.084095
[1357640:MainThread](2026-01-11 21:51:04,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.984221, valid_loss 0.991412, train_metric nan, valid_metric 0.085522
[1357640:MainThread](2026-01-11 21:51:05,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.985348, valid_loss 0.992451, train_metric nan, valid_metric 0.083414
[1357640:MainThread](2026-01-11 21:51:05,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.986342, valid_loss 0.990991, train_metric nan, valid_metric 0.087916
[1357640:MainThread](2026-01-11 21:51:05,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.991083 to 0.990991, save checkpoint.
[1357640:MainThread](2026-01-11 21:51:06,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.987971, valid_loss 0.992970, train_metric nan, valid_metric 0.087203
[1357640:MainThread](2026-01-11 21:51:06,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.985564, valid_loss 0.992283, train_metric nan, valid_metric 0.086708
[1357640:MainThread](2026-01-11 21:51:07,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.980208, valid_loss 0.992472, train_metric nan, valid_metric 0.088188
[1357640:MainThread](2026-01-11 21:51:07,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.982961, valid_loss 0.990426, train_metric nan, valid_metric 0.090082
[1357640:MainThread](2026-01-11 21:51:07,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.990991 to 0.990426, save checkpoint.
[1357640:MainThread](2026-01-11 21:51:08,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.980037, valid_loss 0.990723, train_metric nan, valid_metric 0.088882
[1357640:MainThread](2026-01-11 21:51:08,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.986737, valid_loss 0.990858, train_metric nan, valid_metric 0.087764
[1357640:MainThread](2026-01-11 21:51:09,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.980215, valid_loss 0.992266, train_metric nan, valid_metric 0.088699
[1357640:MainThread](2026-01-11 21:51:10,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.984383, valid_loss 0.990674, train_metric nan, valid_metric 0.088153
[1357640:MainThread](2026-01-11 21:51:10,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.981940, valid_loss 0.992382, train_metric nan, valid_metric 0.082720
[1357640:MainThread](2026-01-11 21:51:11,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.981550, valid_loss 0.990812, train_metric nan, valid_metric 0.090389
[1357640:MainThread](2026-01-11 21:51:11,759) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.983971, valid_loss 0.991770, train_metric nan, valid_metric 0.086514
[1357640:MainThread](2026-01-11 21:51:12,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.980346, valid_loss 0.991087, train_metric nan, valid_metric 0.089627
[1357640:MainThread](2026-01-11 21:51:12,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.982022, valid_loss 0.991377, train_metric nan, valid_metric 0.085664
[1357640:MainThread](2026-01-11 21:51:13,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.984853, valid_loss 0.991431, train_metric nan, valid_metric 0.091910
[1357640:MainThread](2026-01-11 21:51:13,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.983764, valid_loss 0.990977, train_metric nan, valid_metric 0.089694
[1357640:MainThread](2026-01-11 21:51:14,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.984686, valid_loss 0.990660, train_metric nan, valid_metric 0.090330
[1357640:MainThread](2026-01-11 21:51:14,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.981296, valid_loss 0.990701, train_metric nan, valid_metric 0.090667
[1357640:MainThread](2026-01-11 21:51:15,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.981536, valid_loss 0.991290, train_metric nan, valid_metric 0.091915
[1357640:MainThread](2026-01-11 21:51:15,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.982271, valid_loss 0.990688, train_metric nan, valid_metric 0.091585
[1357640:MainThread](2026-01-11 21:51:16,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.982580, valid_loss 0.990555, train_metric nan, valid_metric 0.089949
[1357640:MainThread](2026-01-11 21:51:16,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.982681, valid_loss 0.991373, train_metric nan, valid_metric 0.086057
[1357640:MainThread](2026-01-11 21:51:17,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.974118, valid_loss 0.991157, train_metric nan, valid_metric 0.087885
[1357640:MainThread](2026-01-11 21:51:17,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.982003, valid_loss 0.990465, train_metric nan, valid_metric 0.090705
[1357640:MainThread](2026-01-11 21:51:18,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.982909, valid_loss 0.990301, train_metric nan, valid_metric 0.091337
[1357640:MainThread](2026-01-11 21:51:18,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.990426 to 0.990301, save checkpoint.
[1357640:MainThread](2026-01-11 21:51:18,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.980651, valid_loss 0.990427, train_metric nan, valid_metric 0.090577
[1357640:MainThread](2026-01-11 21:51:19,455) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.982837, valid_loss 0.990430, train_metric nan, valid_metric 0.089995
[1357640:MainThread](2026-01-11 21:51:19,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.979283, valid_loss 0.990964, train_metric nan, valid_metric 0.087372
[1357640:MainThread](2026-01-11 21:51:20,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.981019, valid_loss 0.990738, train_metric nan, valid_metric 0.090537
[1357640:MainThread](2026-01-11 21:51:21,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.982066, valid_loss 0.990986, train_metric nan, valid_metric 0.089960
[1357640:MainThread](2026-01-11 21:51:21,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.979613, valid_loss 0.991791, train_metric nan, valid_metric 0.091348
[1357640:MainThread](2026-01-11 21:51:22,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.985199, valid_loss 0.990988, train_metric nan, valid_metric 0.092347
[1357640:MainThread](2026-01-11 21:51:22,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.981462, valid_loss 0.991559, train_metric nan, valid_metric 0.086979
[1357640:MainThread](2026-01-11 21:51:23,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.981048, valid_loss 0.991956, train_metric nan, valid_metric 0.089580
[1357640:MainThread](2026-01-11 21:51:23,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.984841, valid_loss 0.990510, train_metric nan, valid_metric 0.089789
[1357640:MainThread](2026-01-11 21:51:24,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.980323, valid_loss 0.991319, train_metric nan, valid_metric 0.090542
[1357640:MainThread](2026-01-11 21:51:24,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.983908, valid_loss 0.991340, train_metric nan, valid_metric 0.089421
[1357640:MainThread](2026-01-11 21:51:25,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.979221, valid_loss 0.991696, train_metric nan, valid_metric 0.089569
[1357640:MainThread](2026-01-11 21:51:25,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.982333, valid_loss 0.990779, train_metric nan, valid_metric 0.090382
[1357640:MainThread](2026-01-11 21:51:26,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.980755, valid_loss 0.990840, train_metric nan, valid_metric 0.091301
[1357640:MainThread](2026-01-11 21:51:26,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.977443, valid_loss 0.991955, train_metric nan, valid_metric 0.090268
[1357640:MainThread](2026-01-11 21:51:27,384) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.984579, valid_loss 0.990844, train_metric nan, valid_metric 0.090891
[1357640:MainThread](2026-01-11 21:51:27,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.982711, valid_loss 0.990404, train_metric nan, valid_metric 0.090687
[1357640:MainThread](2026-01-11 21:51:28,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.982111, valid_loss 0.991573, train_metric nan, valid_metric 0.087562
[1357640:MainThread](2026-01-11 21:51:28,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.979830, valid_loss 0.991208, train_metric nan, valid_metric 0.090229
[1357640:MainThread](2026-01-11 21:51:29,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.978324, valid_loss 0.991277, train_metric nan, valid_metric 0.090554
[1357640:MainThread](2026-01-11 21:51:30,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.980161, valid_loss 0.991360, train_metric nan, valid_metric 0.091305
[1357640:MainThread](2026-01-11 21:51:30,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.977993, valid_loss 0.991160, train_metric nan, valid_metric 0.089858
[1357640:MainThread](2026-01-11 21:51:31,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.981661, valid_loss 0.990923, train_metric nan, valid_metric 0.090817
[1357640:MainThread](2026-01-11 21:51:31,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.981636, valid_loss 0.991022, train_metric nan, valid_metric 0.089944
[1357640:MainThread](2026-01-11 21:51:32,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.979288, valid_loss 0.991095, train_metric nan, valid_metric 0.091012
[1357640:MainThread](2026-01-11 21:51:32,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.978253, valid_loss 0.990890, train_metric nan, valid_metric 0.089844
[1357640:MainThread](2026-01-11 21:51:33,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.979471, valid_loss 0.991077, train_metric nan, valid_metric 0.089638
[1357640:MainThread](2026-01-11 21:51:33,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.979211, valid_loss 0.990717, train_metric nan, valid_metric 0.090714
[1357640:MainThread](2026-01-11 21:51:34,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.983843, valid_loss 0.990990, train_metric nan, valid_metric 0.089106
[1357640:MainThread](2026-01-11 21:51:35,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.979295, valid_loss 0.991027, train_metric nan, valid_metric 0.090603
[1357640:MainThread](2026-01-11 21:51:35,678) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.974584, valid_loss 0.990950, train_metric nan, valid_metric 0.090873
[1357640:MainThread](2026-01-11 21:51:36,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.979930, valid_loss 0.990970, train_metric nan, valid_metric 0.090290
[1357640:MainThread](2026-01-11 21:51:36,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.975589, valid_loss 0.991062, train_metric nan, valid_metric 0.089615
[1357640:MainThread](2026-01-11 21:51:36,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.974149, valid_loss 0.991051, train_metric nan, valid_metric 0.090273
[1357640:MainThread](2026-01-11 21:51:37,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.980156, valid_loss 0.991116, train_metric nan, valid_metric 0.089580
[1357640:MainThread](2026-01-11 21:51:38,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.976580, valid_loss 0.990620, train_metric nan, valid_metric 0.091463
[1357640:MainThread](2026-01-11 21:51:38,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.980002, valid_loss 0.990955, train_metric nan, valid_metric 0.091751
[1357640:MainThread](2026-01-11 21:51:39,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.976105, valid_loss 0.990824, train_metric nan, valid_metric 0.089992
[1357640:MainThread](2026-01-11 21:51:39,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.979517, valid_loss 0.990701, train_metric nan, valid_metric 0.091110
[1357640:MainThread](2026-01-11 21:51:40,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.977718, valid_loss 0.990931, train_metric nan, valid_metric 0.090310
[1357640:MainThread](2026-01-11 21:51:40,793) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.974987, valid_loss 0.991019, train_metric nan, valid_metric 0.089074
[1357640:MainThread](2026-01-11 21:51:41,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.974850, valid_loss 0.990649, train_metric nan, valid_metric 0.091823
[1357640:MainThread](2026-01-11 21:51:41,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.981202, valid_loss 0.990991, train_metric nan, valid_metric 0.089419
[1357640:MainThread](2026-01-11 21:51:42,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.978504, valid_loss 0.991060, train_metric nan, valid_metric 0.091155
[1357640:MainThread](2026-01-11 21:51:42,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.978805, valid_loss 0.990690, train_metric nan, valid_metric 0.090828
[1357640:MainThread](2026-01-11 21:51:43,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.976690, valid_loss 0.990940, train_metric nan, valid_metric 0.089825
[1357640:MainThread](2026-01-11 21:51:43,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.982315, valid_loss 0.991011, train_metric nan, valid_metric 0.090050
[1357640:MainThread](2026-01-11 21:51:44,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.976481, valid_loss 0.990940, train_metric nan, valid_metric 0.090504
[1357640:MainThread](2026-01-11 21:51:45,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.981665, valid_loss 0.990937, train_metric nan, valid_metric 0.090354
[1357640:MainThread](2026-01-11 21:51:45,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:51:45.109 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:51:46.578 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 21:51:46.578 | INFO     | __main__:train_single_fold:593 -   IC=0.0398, ICIR=0.4448, RankIC=0.0421, RankICIR=0.4733
2026-01-11 21:51:46.578 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 21:51:46,586) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:52:12,780) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:52:12,781) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:52:20,067) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684a3f1cd0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 27.17it/s]backtest loop:   4%|▎         | 9/243 [00:00<00:06, 37.74it/s]backtest loop:   8%|▊         | 19/243 [00:00<00:03, 56.91it/s]backtest loop:  12%|█▏        | 29/243 [00:00<00:03, 66.20it/s]backtest loop:  15%|█▌        | 37/243 [00:00<00:02, 69.29it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 71.13it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 72.97it/s]backtest loop:  26%|██▌       | 62/243 [00:00<00:02, 72.66it/s]backtest loop:  30%|██▉       | 72/243 [00:01<00:02, 75.10it/s]backtest loop:  33%|███▎      | 80/243 [00:01<00:02, 74.64it/s]backtest loop:  37%|███▋      | 89/243 [00:01<00:01, 78.88it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 76.47it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 75.68it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 75.70it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 76.85it/s]backtest loop:  55%|█████▍    | 133/243 [00:01<00:01, 79.74it/s]backtest loop:  58%|█████▊    | 142/243 [00:01<00:01, 78.68it/s]backtest loop:  62%|██████▏   | 150/243 [00:02<00:01, 76.40it/s]backtest loop:  65%|██████▌   | 158/243 [00:02<00:01, 76.83it/s]backtest loop:  68%|██████▊   | 166/243 [00:02<00:01, 75.86it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 74.38it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 73.01it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 70.62it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 68.16it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 70.27it/s]backtest loop:  90%|████████▉ | 218/243 [00:03<00:00, 73.32it/s]backtest loop:  93%|█████████▎| 227/243 [00:03<00:00, 76.15it/s]backtest loop:  97%|█████████▋| 235/243 [00:03<00:00, 67.42it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 68.74it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 71.68it/s]
2026-01-11 21:52:23.480 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0202, Sharpe(w/cost)=0.3140, MaxDD=-0.0660
2026-01-11 21:52:27.183 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 21:52:44.814 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:52:44.888 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_2_pred.parquet
2026-01-11 21:52:44.905 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 21:52:44.905 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 21:52:46.371 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0523
2026-01-11 21:52:47.654 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0485
2026-01-11 21:52:48.002 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0458, ICIR=0.5116, RankIC=0.0484
[1357640:MainThread](2026-01-11 21:52:48,008) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:53:16,660) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:53:16,661) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:53:23,230) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684a1cf2d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 32.72it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 60.73it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 71.25it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:02, 73.41it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:02, 74.46it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 75.01it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 77.13it/s]backtest loop:  28%|██▊       | 67/243 [00:00<00:02, 75.98it/s]backtest loop:  32%|███▏      | 77/243 [00:01<00:02, 77.69it/s]backtest loop:  35%|███▍      | 85/243 [00:01<00:02, 77.16it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 78.59it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 79.05it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 79.23it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 80.23it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 81.72it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 82.84it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 83.58it/s]backtest loop:  67%|██████▋   | 164/243 [00:02<00:00, 83.12it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 83.26it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 83.02it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 83.26it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 82.91it/s]backtest loop:  87%|████████▋ | 212/243 [00:02<00:00, 84.75it/s]backtest loop:  91%|█████████ | 221/243 [00:02<00:00, 82.85it/s]backtest loop:  95%|█████████▍| 230/243 [00:02<00:00, 80.17it/s]backtest loop:  98%|█████████▊| 239/243 [00:03<00:00, 79.73it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.88it/s]
2026-01-11 21:53:26.334 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0102, Sharpe(w/cost)=0.1622
2026-01-11 21:53:26.384 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:53:26.384 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 21:53:26.385 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:53:26.385 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 21:54:25,461) INFO - qlib.timer - [log.py:127] - Time cost: 59.073s | Loading data Done
[1357640:MainThread](2026-01-11 21:54:25,903) INFO - qlib.timer - [log.py:127] - Time cost: 0.184s | DropCol Done
[1357640:MainThread](2026-01-11 21:54:29,482) INFO - qlib.timer - [log.py:127] - Time cost: 3.578s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 21:54:31,174) INFO - qlib.timer - [log.py:127] - Time cost: 1.690s | Fillna Done
[1357640:MainThread](2026-01-11 21:54:31,917) INFO - qlib.timer - [log.py:127] - Time cost: 0.087s | DropCol Done
[1357640:MainThread](2026-01-11 21:54:32,069) INFO - qlib.timer - [log.py:127] - Time cost: 0.150s | DropnaLabel Done
[1357640:MainThread](2026-01-11 21:54:32,287) INFO - qlib.timer - [log.py:127] - Time cost: 0.217s | CSRankNorm Done
[1357640:MainThread](2026-01-11 21:54:32,289) INFO - qlib.timer - [log.py:127] - Time cost: 6.828s | fit & process data Done
[1357640:MainThread](2026-01-11 21:54:32,290) INFO - qlib.timer - [log.py:127] - Time cost: 65.904s | Init data Done
2026-01-11 21:54:32.290 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 21:54:32,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 21:54:32,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 21:54:32,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 21:54:32,297) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:54:32.307 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 21:54:33,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 21:54:34,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.309752, valid_loss 1.085447, train_metric nan, valid_metric 0.023184
[1357640:MainThread](2026-01-11 21:54:34,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.085447, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:34,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.102111, valid_loss 1.029347, train_metric nan, valid_metric 0.024407
[1357640:MainThread](2026-01-11 21:54:34,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.085447 to 1.029347, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:35,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.063981, valid_loss 1.029140, train_metric nan, valid_metric 0.033201
[1357640:MainThread](2026-01-11 21:54:35,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.029347 to 1.029140, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:35,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.045955, valid_loss 1.012218, train_metric nan, valid_metric 0.037010
[1357640:MainThread](2026-01-11 21:54:35,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.029140 to 1.012218, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:36,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.037460, valid_loss 1.009667, train_metric nan, valid_metric 0.037358
[1357640:MainThread](2026-01-11 21:54:36,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012218 to 1.009667, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:37,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.031949, valid_loss 1.007981, train_metric nan, valid_metric 0.040548
[1357640:MainThread](2026-01-11 21:54:37,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009667 to 1.007981, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:37,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.025375, valid_loss 1.004913, train_metric nan, valid_metric 0.041313
[1357640:MainThread](2026-01-11 21:54:37,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007981 to 1.004913, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:38,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.016582, valid_loss 1.005748, train_metric nan, valid_metric 0.046535
[1357640:MainThread](2026-01-11 21:54:38,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.013426, valid_loss 1.009942, train_metric nan, valid_metric 0.044389
[1357640:MainThread](2026-01-11 21:54:39,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.009505, valid_loss 1.002239, train_metric nan, valid_metric 0.051504
[1357640:MainThread](2026-01-11 21:54:39,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004913 to 1.002239, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:39,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.005936, valid_loss 1.003046, train_metric nan, valid_metric 0.048752
[1357640:MainThread](2026-01-11 21:54:40,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.004050, valid_loss 1.000459, train_metric nan, valid_metric 0.054283
[1357640:MainThread](2026-01-11 21:54:40,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002239 to 1.000459, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:41,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 0.999664, valid_loss 1.002930, train_metric nan, valid_metric 0.051708
[1357640:MainThread](2026-01-11 21:54:41,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 0.999890, valid_loss 1.002814, train_metric nan, valid_metric 0.052783
[1357640:MainThread](2026-01-11 21:54:42,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.997658, valid_loss 1.000281, train_metric nan, valid_metric 0.055308
[1357640:MainThread](2026-01-11 21:54:42,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000459 to 1.000281, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:42,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.994662, valid_loss 0.999958, train_metric nan, valid_metric 0.056155
[1357640:MainThread](2026-01-11 21:54:42,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000281 to 0.999958, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:43,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.992751, valid_loss 0.998872, train_metric nan, valid_metric 0.052351
[1357640:MainThread](2026-01-11 21:54:43,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999958 to 0.998872, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:44,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.993008, valid_loss 0.997965, train_metric nan, valid_metric 0.053176
[1357640:MainThread](2026-01-11 21:54:44,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998872 to 0.997965, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:44,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.997631, valid_loss 0.998522, train_metric nan, valid_metric 0.059778
[1357640:MainThread](2026-01-11 21:54:45,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.993958, valid_loss 0.998342, train_metric nan, valid_metric 0.059843
[1357640:MainThread](2026-01-11 21:54:45,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.992644, valid_loss 0.998312, train_metric nan, valid_metric 0.057871
[1357640:MainThread](2026-01-11 21:54:46,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.991490, valid_loss 0.997217, train_metric nan, valid_metric 0.059723
[1357640:MainThread](2026-01-11 21:54:46,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997965 to 0.997217, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:47,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.989319, valid_loss 0.996147, train_metric nan, valid_metric 0.061929
[1357640:MainThread](2026-01-11 21:54:47,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997217 to 0.996147, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:47,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.993783, valid_loss 0.997938, train_metric nan, valid_metric 0.058788
[1357640:MainThread](2026-01-11 21:54:48,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.983746, valid_loss 0.997682, train_metric nan, valid_metric 0.057629
[1357640:MainThread](2026-01-11 21:54:48,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.985635, valid_loss 0.998310, train_metric nan, valid_metric 0.059784
[1357640:MainThread](2026-01-11 21:54:49,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.985999, valid_loss 0.999752, train_metric nan, valid_metric 0.056176
[1357640:MainThread](2026-01-11 21:54:50,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.983811, valid_loss 0.998911, train_metric nan, valid_metric 0.058734
[1357640:MainThread](2026-01-11 21:54:50,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.984179, valid_loss 0.996570, train_metric nan, valid_metric 0.060033
[1357640:MainThread](2026-01-11 21:54:51,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.989343, valid_loss 0.997508, train_metric nan, valid_metric 0.059108
[1357640:MainThread](2026-01-11 21:54:51,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.983579, valid_loss 1.000615, train_metric nan, valid_metric 0.060981
[1357640:MainThread](2026-01-11 21:54:52,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.986719, valid_loss 0.995863, train_metric nan, valid_metric 0.062544
[1357640:MainThread](2026-01-11 21:54:52,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996147 to 0.995863, save checkpoint.
[1357640:MainThread](2026-01-11 21:54:52,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.983782, valid_loss 0.997562, train_metric nan, valid_metric 0.063380
[1357640:MainThread](2026-01-11 21:54:53,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.986283, valid_loss 0.996736, train_metric nan, valid_metric 0.062131
[1357640:MainThread](2026-01-11 21:54:54,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.984590, valid_loss 0.997391, train_metric nan, valid_metric 0.060730
[1357640:MainThread](2026-01-11 21:54:54,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.984619, valid_loss 0.997788, train_metric nan, valid_metric 0.060646
[1357640:MainThread](2026-01-11 21:54:55,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.981379, valid_loss 0.996790, train_metric nan, valid_metric 0.059949
[1357640:MainThread](2026-01-11 21:54:55,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.981154, valid_loss 1.000167, train_metric nan, valid_metric 0.060480
[1357640:MainThread](2026-01-11 21:54:56,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.981577, valid_loss 0.997781, train_metric nan, valid_metric 0.059528
[1357640:MainThread](2026-01-11 21:54:56,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.986662, valid_loss 0.998158, train_metric nan, valid_metric 0.063747
[1357640:MainThread](2026-01-11 21:54:57,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.982019, valid_loss 0.996730, train_metric nan, valid_metric 0.060591
[1357640:MainThread](2026-01-11 21:54:58,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.982857, valid_loss 0.997948, train_metric nan, valid_metric 0.063254
[1357640:MainThread](2026-01-11 21:54:58,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.981880, valid_loss 0.996603, train_metric nan, valid_metric 0.059790
[1357640:MainThread](2026-01-11 21:54:59,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.984130, valid_loss 0.998638, train_metric nan, valid_metric 0.060913
[1357640:MainThread](2026-01-11 21:54:59,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.982152, valid_loss 0.998027, train_metric nan, valid_metric 0.060600
[1357640:MainThread](2026-01-11 21:55:00,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.981861, valid_loss 0.996949, train_metric nan, valid_metric 0.060065
[1357640:MainThread](2026-01-11 21:55:00,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.981239, valid_loss 0.999740, train_metric nan, valid_metric 0.060789
[1357640:MainThread](2026-01-11 21:55:01,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.980489, valid_loss 0.998409, train_metric nan, valid_metric 0.061577
[1357640:MainThread](2026-01-11 21:55:01,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.981762, valid_loss 0.996838, train_metric nan, valid_metric 0.058797
[1357640:MainThread](2026-01-11 21:55:02,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.983141, valid_loss 0.996331, train_metric nan, valid_metric 0.061960
[1357640:MainThread](2026-01-11 21:55:02,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.980218, valid_loss 0.997759, train_metric nan, valid_metric 0.058910
[1357640:MainThread](2026-01-11 21:55:03,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.979757, valid_loss 0.999556, train_metric nan, valid_metric 0.061714
[1357640:MainThread](2026-01-11 21:55:03,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.980712, valid_loss 0.997257, train_metric nan, valid_metric 0.060718
[1357640:MainThread](2026-01-11 21:55:04,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.977482, valid_loss 0.998410, train_metric nan, valid_metric 0.058945
[1357640:MainThread](2026-01-11 21:55:04,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.983887, valid_loss 0.997335, train_metric nan, valid_metric 0.061432
[1357640:MainThread](2026-01-11 21:55:05,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.978076, valid_loss 0.998073, train_metric nan, valid_metric 0.062018
[1357640:MainThread](2026-01-11 21:55:06,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.978833, valid_loss 0.999180, train_metric nan, valid_metric 0.063547
[1357640:MainThread](2026-01-11 21:55:06,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.977143, valid_loss 0.997086, train_metric nan, valid_metric 0.064375
[1357640:MainThread](2026-01-11 21:55:07,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.981978, valid_loss 0.997039, train_metric nan, valid_metric 0.061416
[1357640:MainThread](2026-01-11 21:55:07,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.979442, valid_loss 0.996847, train_metric nan, valid_metric 0.061282
[1357640:MainThread](2026-01-11 21:55:08,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.977742, valid_loss 0.996815, train_metric nan, valid_metric 0.060832
[1357640:MainThread](2026-01-11 21:55:08,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.981900, valid_loss 0.997775, train_metric nan, valid_metric 0.062573
[1357640:MainThread](2026-01-11 21:55:09,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.974537, valid_loss 0.996620, train_metric nan, valid_metric 0.064224
[1357640:MainThread](2026-01-11 21:55:09,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.980132, valid_loss 0.996988, train_metric nan, valid_metric 0.063975
[1357640:MainThread](2026-01-11 21:55:10,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.980051, valid_loss 0.997866, train_metric nan, valid_metric 0.062947
[1357640:MainThread](2026-01-11 21:55:10,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.975653, valid_loss 0.997699, train_metric nan, valid_metric 0.063877
[1357640:MainThread](2026-01-11 21:55:11,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.978260, valid_loss 0.997393, train_metric nan, valid_metric 0.062722
[1357640:MainThread](2026-01-11 21:55:12,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.979105, valid_loss 0.997469, train_metric nan, valid_metric 0.062380
[1357640:MainThread](2026-01-11 21:55:12,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.977625, valid_loss 0.997160, train_metric nan, valid_metric 0.063758
[1357640:MainThread](2026-01-11 21:55:13,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.974503, valid_loss 0.996934, train_metric nan, valid_metric 0.063702
[1357640:MainThread](2026-01-11 21:55:13,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.978341, valid_loss 0.997522, train_metric nan, valid_metric 0.062013
[1357640:MainThread](2026-01-11 21:55:14,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.976827, valid_loss 0.997382, train_metric nan, valid_metric 0.061708
[1357640:MainThread](2026-01-11 21:55:14,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.975489, valid_loss 0.997778, train_metric nan, valid_metric 0.062119
[1357640:MainThread](2026-01-11 21:55:15,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.977182, valid_loss 0.997753, train_metric nan, valid_metric 0.062035
[1357640:MainThread](2026-01-11 21:55:15,926) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.979942, valid_loss 0.998051, train_metric nan, valid_metric 0.062026
[1357640:MainThread](2026-01-11 21:55:16,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.979139, valid_loss 0.998340, train_metric nan, valid_metric 0.061385
[1357640:MainThread](2026-01-11 21:55:17,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.980080, valid_loss 0.997227, train_metric nan, valid_metric 0.062448
[1357640:MainThread](2026-01-11 21:55:17,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.977308, valid_loss 0.997372, train_metric nan, valid_metric 0.062031
[1357640:MainThread](2026-01-11 21:55:18,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.978612, valid_loss 0.998277, train_metric nan, valid_metric 0.061278
[1357640:MainThread](2026-01-11 21:55:18,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.976842, valid_loss 0.997524, train_metric nan, valid_metric 0.061818
[1357640:MainThread](2026-01-11 21:55:19,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.979732, valid_loss 0.997056, train_metric nan, valid_metric 0.062344
[1357640:MainThread](2026-01-11 21:55:19,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.974334, valid_loss 0.998145, train_metric nan, valid_metric 0.062273
[1357640:MainThread](2026-01-11 21:55:19,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:55:19.823 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:55:21.383 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 21:55:21.383 | INFO     | __main__:train_single_fold:593 -   IC=0.0216, ICIR=0.2261, RankIC=0.0397, RankICIR=0.4248
2026-01-11 21:55:21.384 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 21:55:21,390) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:55:50,689) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:55:50,690) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:55:57,864) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684a675810>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 26.89it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 60.02it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 69.92it/s]backtest loop:  13%|█▎        | 32/244 [00:00<00:02, 75.66it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 76.91it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 75.45it/s]backtest loop:  23%|██▎       | 57/244 [00:00<00:02, 79.11it/s]backtest loop:  27%|██▋       | 65/244 [00:00<00:02, 78.69it/s]backtest loop:  30%|██▉       | 73/244 [00:00<00:02, 77.97it/s]backtest loop:  33%|███▎      | 81/244 [00:01<00:02, 77.67it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:02, 76.81it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 80.46it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 79.75it/s]backtest loop:  47%|████▋     | 115/244 [00:01<00:01, 77.38it/s]backtest loop:  50%|█████     | 123/244 [00:01<00:01, 77.03it/s]backtest loop:  54%|█████▍    | 132/244 [00:01<00:01, 80.67it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:01, 80.07it/s]backtest loop:  61%|██████▏   | 150/244 [00:01<00:01, 79.87it/s]backtest loop:  65%|██████▌   | 159/244 [00:02<00:01, 79.63it/s]backtest loop:  69%|██████▉   | 168/244 [00:02<00:00, 79.46it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 79.08it/s]backtest loop:  76%|███████▌  | 185/244 [00:02<00:00, 78.11it/s]backtest loop:  79%|███████▉  | 193/244 [00:02<00:00, 75.97it/s]backtest loop:  83%|████████▎ | 202/244 [00:02<00:00, 77.11it/s]backtest loop:  87%|████████▋ | 212/244 [00:02<00:00, 77.90it/s]backtest loop:  91%|█████████ | 222/244 [00:02<00:00, 78.65it/s]backtest loop:  95%|█████████▍| 231/244 [00:02<00:00, 80.68it/s]backtest loop:  98%|█████████▊| 240/244 [00:03<00:00, 80.16it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 77.05it/s]
2026-01-11 21:56:01.057 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1107, Sharpe(w/cost)=-1.7706, MaxDD=-0.1369
2026-01-11 21:56:04.950 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 21:56:23.001 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:56:23.069 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_3_pred.parquet
2026-01-11 21:56:23.086 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 21:56:23.086 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 21:56:24.556 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0437
2026-01-11 21:56:25.739 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0518
2026-01-11 21:56:26.944 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0445
2026-01-11 21:56:27.329 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0262, ICIR=0.2641, RankIC=0.0454
[1357640:MainThread](2026-01-11 21:56:27,335) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:56:59,099) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:56:59,100) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:57:05,866) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684bb2c650>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 24.22it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 57.89it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 69.00it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 74.04it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:02, 78.10it/s]backtest loop:  22%|██▏       | 53/244 [00:00<00:02, 79.92it/s]backtest loop:  25%|██▌       | 62/244 [00:00<00:02, 78.99it/s]backtest loop:  30%|██▉       | 72/244 [00:00<00:02, 78.68it/s]backtest loop:  33%|███▎      | 80/244 [00:01<00:02, 78.18it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 78.31it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 79.08it/s]backtest loop:  44%|████▍     | 108/244 [00:01<00:01, 80.26it/s]backtest loop:  48%|████▊     | 117/244 [00:01<00:01, 82.69it/s]backtest loop:  52%|█████▏    | 126/244 [00:01<00:01, 81.56it/s]backtest loop:  55%|█████▌    | 135/244 [00:01<00:01, 80.89it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 80.01it/s]backtest loop:  63%|██████▎   | 153/244 [00:01<00:01, 79.53it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 80.54it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 80.34it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 80.78it/s]backtest loop:  78%|███████▊  | 191/244 [00:02<00:00, 80.11it/s]backtest loop:  82%|████████▏ | 200/244 [00:02<00:00, 80.54it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 80.42it/s]backtest loop:  89%|████████▉ | 218/244 [00:02<00:00, 80.23it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 79.75it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 80.43it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 78.24it/s]
2026-01-11 21:57:09.019 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0731, Sharpe(w/cost)=-1.1959
2026-01-11 21:57:09.083 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:57:09.083 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 21:57:09.083 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:57:09.083 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 21:58:12,812) INFO - qlib.timer - [log.py:127] - Time cost: 63.726s | Loading data Done
[1357640:MainThread](2026-01-11 21:58:13,145) INFO - qlib.timer - [log.py:127] - Time cost: 0.081s | DropCol Done
[1357640:MainThread](2026-01-11 21:58:16,741) INFO - qlib.timer - [log.py:127] - Time cost: 3.593s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 21:58:18,347) INFO - qlib.timer - [log.py:127] - Time cost: 1.604s | Fillna Done
[1357640:MainThread](2026-01-11 21:58:19,152) INFO - qlib.timer - [log.py:127] - Time cost: 0.075s | DropCol Done
[1357640:MainThread](2026-01-11 21:58:19,294) INFO - qlib.timer - [log.py:127] - Time cost: 0.141s | DropnaLabel Done
[1357640:MainThread](2026-01-11 21:58:19,500) INFO - qlib.timer - [log.py:127] - Time cost: 0.206s | CSRankNorm Done
[1357640:MainThread](2026-01-11 21:58:19,502) INFO - qlib.timer - [log.py:127] - Time cost: 6.689s | fit & process data Done
[1357640:MainThread](2026-01-11 21:58:19,502) INFO - qlib.timer - [log.py:127] - Time cost: 70.418s | Init data Done
2026-01-11 21:58:19.503 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 21:58:19,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 21:58:19,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 21:58:19,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 21:58:19,508) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 21:58:19.517 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 21:58:20,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 21:58:21,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.328827, valid_loss 1.079144, train_metric nan, valid_metric 0.005306
[1357640:MainThread](2026-01-11 21:58:21,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.079144, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:22,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.102247, valid_loss 1.030203, train_metric nan, valid_metric 0.016524
[1357640:MainThread](2026-01-11 21:58:22,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.079144 to 1.030203, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:22,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.065493, valid_loss 1.015471, train_metric nan, valid_metric 0.033653
[1357640:MainThread](2026-01-11 21:58:22,973) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.030203 to 1.015471, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:23,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.042963, valid_loss 1.016185, train_metric nan, valid_metric 0.031071
[1357640:MainThread](2026-01-11 21:58:24,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.041954, valid_loss 1.011456, train_metric nan, valid_metric 0.033262
[1357640:MainThread](2026-01-11 21:58:24,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.015471 to 1.011456, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:24,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.033113, valid_loss 1.008085, train_metric nan, valid_metric 0.036608
[1357640:MainThread](2026-01-11 21:58:24,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.011456 to 1.008085, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:25,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.026045, valid_loss 1.007517, train_metric nan, valid_metric 0.040927
[1357640:MainThread](2026-01-11 21:58:25,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008085 to 1.007517, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:25,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.023310, valid_loss 1.005657, train_metric nan, valid_metric 0.038315
[1357640:MainThread](2026-01-11 21:58:25,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007517 to 1.005657, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:26,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.019388, valid_loss 1.006763, train_metric nan, valid_metric 0.038547
[1357640:MainThread](2026-01-11 21:58:26,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.016106, valid_loss 1.005136, train_metric nan, valid_metric 0.043409
[1357640:MainThread](2026-01-11 21:58:26,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005657 to 1.005136, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:27,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.006122, valid_loss 1.002766, train_metric nan, valid_metric 0.042840
[1357640:MainThread](2026-01-11 21:58:27,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005136 to 1.002766, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:27,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.009566, valid_loss 1.008054, train_metric nan, valid_metric 0.045760
[1357640:MainThread](2026-01-11 21:58:28,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.008291, valid_loss 1.009811, train_metric nan, valid_metric 0.038180
[1357640:MainThread](2026-01-11 21:58:28,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.003801, valid_loss 1.000495, train_metric nan, valid_metric 0.041796
[1357640:MainThread](2026-01-11 21:58:28,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002766 to 1.000495, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:29,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 0.998645, valid_loss 1.000604, train_metric nan, valid_metric 0.042502
[1357640:MainThread](2026-01-11 21:58:30,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.000665, valid_loss 1.001618, train_metric nan, valid_metric 0.033890
[1357640:MainThread](2026-01-11 21:58:30,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 0.999793, valid_loss 1.001763, train_metric nan, valid_metric 0.034632
[1357640:MainThread](2026-01-11 21:58:31,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.999388, valid_loss 0.999837, train_metric nan, valid_metric 0.047512
[1357640:MainThread](2026-01-11 21:58:31,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000495 to 0.999837, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:31,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.995419, valid_loss 0.999193, train_metric nan, valid_metric 0.046512
[1357640:MainThread](2026-01-11 21:58:31,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999837 to 0.999193, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:32,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.994979, valid_loss 1.001661, train_metric nan, valid_metric 0.040168
[1357640:MainThread](2026-01-11 21:58:32,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.989957, valid_loss 1.000237, train_metric nan, valid_metric 0.041713
[1357640:MainThread](2026-01-11 21:58:33,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.997019, valid_loss 0.999560, train_metric nan, valid_metric 0.045760
[1357640:MainThread](2026-01-11 21:58:33,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.992448, valid_loss 0.999645, train_metric nan, valid_metric 0.042049
[1357640:MainThread](2026-01-11 21:58:34,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.993967, valid_loss 1.000076, train_metric nan, valid_metric 0.039818
[1357640:MainThread](2026-01-11 21:58:35,127) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.988811, valid_loss 1.004206, train_metric nan, valid_metric 0.047907
[1357640:MainThread](2026-01-11 21:58:35,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.990069, valid_loss 1.001539, train_metric nan, valid_metric 0.049069
[1357640:MainThread](2026-01-11 21:58:36,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.987835, valid_loss 0.999551, train_metric nan, valid_metric 0.042581
[1357640:MainThread](2026-01-11 21:58:36,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.995940, valid_loss 0.999088, train_metric nan, valid_metric 0.042453
[1357640:MainThread](2026-01-11 21:58:36,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999193 to 0.999088, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:37,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.987747, valid_loss 0.999540, train_metric nan, valid_metric 0.043432
[1357640:MainThread](2026-01-11 21:58:37,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.987366, valid_loss 0.999878, train_metric nan, valid_metric 0.047393
[1357640:MainThread](2026-01-11 21:58:38,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.985644, valid_loss 0.999445, train_metric nan, valid_metric 0.049707
[1357640:MainThread](2026-01-11 21:58:38,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.989458, valid_loss 0.999159, train_metric nan, valid_metric 0.052693
[1357640:MainThread](2026-01-11 21:58:39,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.987771, valid_loss 0.999168, train_metric nan, valid_metric 0.046038
[1357640:MainThread](2026-01-11 21:58:39,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.985905, valid_loss 0.999301, train_metric nan, valid_metric 0.053919
[1357640:MainThread](2026-01-11 21:58:40,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.990734, valid_loss 0.999391, train_metric nan, valid_metric 0.046741
[1357640:MainThread](2026-01-11 21:58:40,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.983977, valid_loss 0.998089, train_metric nan, valid_metric 0.048236
[1357640:MainThread](2026-01-11 21:58:40,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999088 to 0.998089, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:41,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.984647, valid_loss 0.998522, train_metric nan, valid_metric 0.051083
[1357640:MainThread](2026-01-11 21:58:41,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.985893, valid_loss 0.998626, train_metric nan, valid_metric 0.050108
[1357640:MainThread](2026-01-11 21:58:42,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.985275, valid_loss 0.998947, train_metric nan, valid_metric 0.053705
[1357640:MainThread](2026-01-11 21:58:42,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.986256, valid_loss 1.000340, train_metric nan, valid_metric 0.046630
[1357640:MainThread](2026-01-11 21:58:43,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.983855, valid_loss 0.999023, train_metric nan, valid_metric 0.044559
[1357640:MainThread](2026-01-11 21:58:43,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.978947, valid_loss 1.000062, train_metric nan, valid_metric 0.045052
[1357640:MainThread](2026-01-11 21:58:44,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.984412, valid_loss 0.999431, train_metric nan, valid_metric 0.046824
[1357640:MainThread](2026-01-11 21:58:44,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.983365, valid_loss 1.000147, train_metric nan, valid_metric 0.047493
[1357640:MainThread](2026-01-11 21:58:45,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.985095, valid_loss 0.999588, train_metric nan, valid_metric 0.051675
[1357640:MainThread](2026-01-11 21:58:46,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.987035, valid_loss 1.001480, train_metric nan, valid_metric 0.049130
[1357640:MainThread](2026-01-11 21:58:46,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.985421, valid_loss 0.999770, train_metric nan, valid_metric 0.053545
[1357640:MainThread](2026-01-11 21:58:47,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.981565, valid_loss 0.999691, train_metric nan, valid_metric 0.049400
[1357640:MainThread](2026-01-11 21:58:47,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.985704, valid_loss 0.998245, train_metric nan, valid_metric 0.050332
[1357640:MainThread](2026-01-11 21:58:48,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.984396, valid_loss 0.998924, train_metric nan, valid_metric 0.048211
[1357640:MainThread](2026-01-11 21:58:48,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.983353, valid_loss 0.997922, train_metric nan, valid_metric 0.049155
[1357640:MainThread](2026-01-11 21:58:48,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998089 to 0.997922, save checkpoint.
[1357640:MainThread](2026-01-11 21:58:49,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.983812, valid_loss 0.999968, train_metric nan, valid_metric 0.052597
[1357640:MainThread](2026-01-11 21:58:49,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.983896, valid_loss 0.999613, train_metric nan, valid_metric 0.052619
[1357640:MainThread](2026-01-11 21:58:50,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.983911, valid_loss 0.998260, train_metric nan, valid_metric 0.050999
[1357640:MainThread](2026-01-11 21:58:50,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.981208, valid_loss 0.999278, train_metric nan, valid_metric 0.052282
[1357640:MainThread](2026-01-11 21:58:51,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.984028, valid_loss 0.998801, train_metric nan, valid_metric 0.050254
[1357640:MainThread](2026-01-11 21:58:51,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.979604, valid_loss 0.998749, train_metric nan, valid_metric 0.052344
[1357640:MainThread](2026-01-11 21:58:52,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.983737, valid_loss 0.999658, train_metric nan, valid_metric 0.049551
[1357640:MainThread](2026-01-11 21:58:53,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.978405, valid_loss 1.000005, train_metric nan, valid_metric 0.049272
[1357640:MainThread](2026-01-11 21:58:53,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.980560, valid_loss 1.001125, train_metric nan, valid_metric 0.044016
[1357640:MainThread](2026-01-11 21:58:54,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.980346, valid_loss 1.001080, train_metric nan, valid_metric 0.051804
[1357640:MainThread](2026-01-11 21:58:54,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.979524, valid_loss 1.000276, train_metric nan, valid_metric 0.046120
[1357640:MainThread](2026-01-11 21:58:55,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.981584, valid_loss 0.999987, train_metric nan, valid_metric 0.049581
[1357640:MainThread](2026-01-11 21:58:55,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.977906, valid_loss 0.999745, train_metric nan, valid_metric 0.049072
[1357640:MainThread](2026-01-11 21:58:56,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.977546, valid_loss 0.999231, train_metric nan, valid_metric 0.048804
[1357640:MainThread](2026-01-11 21:58:56,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.980698, valid_loss 0.999564, train_metric nan, valid_metric 0.047275
[1357640:MainThread](2026-01-11 21:58:57,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.980476, valid_loss 1.000690, train_metric nan, valid_metric 0.047337
[1357640:MainThread](2026-01-11 21:58:57,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.979405, valid_loss 0.998879, train_metric nan, valid_metric 0.050575
[1357640:MainThread](2026-01-11 21:58:58,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.981094, valid_loss 0.999209, train_metric nan, valid_metric 0.049886
[1357640:MainThread](2026-01-11 21:58:59,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.982565, valid_loss 1.000117, train_metric nan, valid_metric 0.049321
[1357640:MainThread](2026-01-11 21:58:59,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.983177, valid_loss 0.999892, train_metric nan, valid_metric 0.051017
[1357640:MainThread](2026-01-11 21:59:00,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.981351, valid_loss 1.002107, train_metric nan, valid_metric 0.051001
[1357640:MainThread](2026-01-11 21:59:00,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.982546, valid_loss 0.999082, train_metric nan, valid_metric 0.051892
[1357640:MainThread](2026-01-11 21:59:01,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.979418, valid_loss 0.999612, train_metric nan, valid_metric 0.049463
[1357640:MainThread](2026-01-11 21:59:01,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.984463, valid_loss 0.999128, train_metric nan, valid_metric 0.051515
[1357640:MainThread](2026-01-11 21:59:02,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.979325, valid_loss 0.999846, train_metric nan, valid_metric 0.048963
[1357640:MainThread](2026-01-11 21:59:03,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.981122, valid_loss 0.999573, train_metric nan, valid_metric 0.046847
[1357640:MainThread](2026-01-11 21:59:03,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.981223, valid_loss 0.999738, train_metric nan, valid_metric 0.046175
[1357640:MainThread](2026-01-11 21:59:04,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.975236, valid_loss 0.999256, train_metric nan, valid_metric 0.051296
[1357640:MainThread](2026-01-11 21:59:05,278) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.977638, valid_loss 0.999460, train_metric nan, valid_metric 0.051273
[1357640:MainThread](2026-01-11 21:59:05,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.977093, valid_loss 1.000235, train_metric nan, valid_metric 0.048985
[1357640:MainThread](2026-01-11 21:59:06,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.977928, valid_loss 0.999201, train_metric nan, valid_metric 0.049232
[1357640:MainThread](2026-01-11 21:59:06,815) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.978282, valid_loss 1.000862, train_metric nan, valid_metric 0.047597
[1357640:MainThread](2026-01-11 21:59:07,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.983546, valid_loss 1.000479, train_metric nan, valid_metric 0.049591
[1357640:MainThread](2026-01-11 21:59:07,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.980927, valid_loss 1.000425, train_metric nan, valid_metric 0.048292
[1357640:MainThread](2026-01-11 21:59:08,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.983665, valid_loss 0.999488, train_metric nan, valid_metric 0.048947
[1357640:MainThread](2026-01-11 21:59:08,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.979805, valid_loss 1.000022, train_metric nan, valid_metric 0.048716
[1357640:MainThread](2026-01-11 21:59:09,378) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.976361, valid_loss 1.000234, train_metric nan, valid_metric 0.049316
[1357640:MainThread](2026-01-11 21:59:09,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.979101, valid_loss 0.999906, train_metric nan, valid_metric 0.048518
[1357640:MainThread](2026-01-11 21:59:10,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.980529, valid_loss 1.000146, train_metric nan, valid_metric 0.049890
[1357640:MainThread](2026-01-11 21:59:10,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.976828, valid_loss 1.000060, train_metric nan, valid_metric 0.050431
[1357640:MainThread](2026-01-11 21:59:11,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.978778, valid_loss 0.999891, train_metric nan, valid_metric 0.051533
[1357640:MainThread](2026-01-11 21:59:12,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.974202, valid_loss 0.999532, train_metric nan, valid_metric 0.051280
[1357640:MainThread](2026-01-11 21:59:12,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.982579, valid_loss 0.999601, train_metric nan, valid_metric 0.050781
[1357640:MainThread](2026-01-11 21:59:13,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.978124, valid_loss 0.999780, train_metric nan, valid_metric 0.050722
[1357640:MainThread](2026-01-11 21:59:13,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.980004, valid_loss 0.999794, train_metric nan, valid_metric 0.049602
[1357640:MainThread](2026-01-11 21:59:14,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.980873, valid_loss 0.999994, train_metric nan, valid_metric 0.049453
[1357640:MainThread](2026-01-11 21:59:14,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.976806, valid_loss 0.999687, train_metric nan, valid_metric 0.050207
[1357640:MainThread](2026-01-11 21:59:15,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.980894, valid_loss 0.999572, train_metric nan, valid_metric 0.050450
[1357640:MainThread](2026-01-11 21:59:15,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.977594, valid_loss 0.999115, train_metric nan, valid_metric 0.050825
[1357640:MainThread](2026-01-11 21:59:16,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.983446, valid_loss 0.999820, train_metric nan, valid_metric 0.049897
[1357640:MainThread](2026-01-11 21:59:16,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 21:59:16.410 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:59:17.888 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 21:59:17.888 | INFO     | __main__:train_single_fold:593 -   IC=0.0317, ICIR=0.3061, RankIC=0.0446, RankICIR=0.4607
2026-01-11 21:59:17.888 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 21:59:17,896) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 21:59:45,216) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:59:45,217) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 21:59:52,933) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684bd5cb10>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.24it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 52.90it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 64.57it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 71.09it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 74.46it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 78.91it/s]backtest loop:  24%|██▍       | 58/243 [00:00<00:02, 78.02it/s]backtest loop:  27%|██▋       | 66/243 [00:00<00:02, 78.04it/s]backtest loop:  31%|███       | 75/243 [00:01<00:02, 78.98it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 78.37it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 78.63it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 80.50it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 80.65it/s]backtest loop:  50%|████▉     | 121/243 [00:01<00:01, 80.10it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 79.52it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 80.32it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 80.68it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 81.00it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 80.31it/s]backtest loop:  74%|███████▍  | 180/243 [00:02<00:00, 80.80it/s]backtest loop:  78%|███████▊  | 189/243 [00:02<00:00, 77.27it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 80.45it/s]backtest loop:  85%|████████▌ | 207/243 [00:02<00:00, 76.96it/s]backtest loop:  88%|████████▊ | 215/243 [00:02<00:00, 76.81it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 77.17it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 78.74it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.02it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.06it/s]
2026-01-11 21:59:56.111 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0135, Sharpe(w/cost)=-0.1613, MaxDD=-0.1066
2026-01-11 21:59:59.983 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 22:00:15.930 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:00:16.019 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_4_pred.parquet
2026-01-11 22:00:16.040 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 22:00:16.040 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 22:00:17.594 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0412
2026-01-11 22:00:18.912 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0450
2026-01-11 22:00:20.300 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0471
2026-01-11 22:00:21.627 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0455
2026-01-11 22:00:21.991 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0309, ICIR=0.2655, RankIC=0.0486
[1357640:MainThread](2026-01-11 22:00:21,997) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:00:50,330) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:00:50,332) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:00:57,929) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6994114d90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 22.46it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 52.77it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 63.41it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 72.71it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 71.10it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 72.34it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 77.08it/s]backtest loop:  26%|██▌       | 63/243 [00:00<00:02, 76.46it/s]backtest loop:  29%|██▉       | 71/243 [00:01<00:02, 75.57it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 75.37it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 74.88it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 76.44it/s]backtest loop:  44%|████▍     | 107/243 [00:01<00:01, 77.13it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 76.39it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 79.58it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 81.38it/s]backtest loop:  59%|█████▉    | 143/243 [00:01<00:01, 78.20it/s]backtest loop:  62%|██████▏   | 151/243 [00:02<00:01, 74.82it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 75.18it/s]backtest loop:  70%|██████▉   | 169/243 [00:02<00:00, 77.45it/s]backtest loop:  73%|███████▎  | 177/243 [00:02<00:00, 76.46it/s]backtest loop:  76%|███████▌  | 185/243 [00:02<00:00, 76.45it/s]backtest loop:  80%|████████  | 195/243 [00:02<00:00, 82.32it/s]backtest loop:  84%|████████▍ | 205/243 [00:02<00:00, 86.49it/s]backtest loop:  88%|████████▊ | 215/243 [00:02<00:00, 89.33it/s]backtest loop:  93%|█████████▎| 225/243 [00:02<00:00, 91.27it/s]backtest loop:  97%|█████████▋| 235/243 [00:03<00:00, 91.67it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.34it/s]
2026-01-11 22:01:01.051 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0233, Sharpe(w/cost)=-0.2816
2026-01-11 22:01:01.098 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:01:01.098 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 22:01:01.098 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:01:01.098 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 22:02:05,373) INFO - qlib.timer - [log.py:127] - Time cost: 64.272s | Loading data Done
[1357640:MainThread](2026-01-11 22:02:05,707) INFO - qlib.timer - [log.py:127] - Time cost: 0.081s | DropCol Done
[1357640:MainThread](2026-01-11 22:02:09,744) INFO - qlib.timer - [log.py:127] - Time cost: 4.035s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 22:02:11,334) INFO - qlib.timer - [log.py:127] - Time cost: 1.588s | Fillna Done
[1357640:MainThread](2026-01-11 22:02:12,177) INFO - qlib.timer - [log.py:127] - Time cost: 0.092s | DropCol Done
[1357640:MainThread](2026-01-11 22:02:12,339) INFO - qlib.timer - [log.py:127] - Time cost: 0.161s | DropnaLabel Done
[1357640:MainThread](2026-01-11 22:02:12,561) INFO - qlib.timer - [log.py:127] - Time cost: 0.220s | CSRankNorm Done
[1357640:MainThread](2026-01-11 22:02:12,563) INFO - qlib.timer - [log.py:127] - Time cost: 7.189s | fit & process data Done
[1357640:MainThread](2026-01-11 22:02:12,563) INFO - qlib.timer - [log.py:127] - Time cost: 71.464s | Init data Done
2026-01-11 22:02:12.564 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 22:02:12,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 22:02:12,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 22:02:12,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 22:02:12,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:02:12.580 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 22:02:14,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 22:02:16,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.606327, valid_loss 1.089623, train_metric nan, valid_metric 0.018242
[1357640:MainThread](2026-01-11 22:02:16,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.089623, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:16,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.128711, valid_loss 1.037421, train_metric nan, valid_metric 0.034810
[1357640:MainThread](2026-01-11 22:02:16,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.089623 to 1.037421, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:17,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.079827, valid_loss 1.017085, train_metric nan, valid_metric 0.036818
[1357640:MainThread](2026-01-11 22:02:17,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.037421 to 1.017085, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:17,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.060403, valid_loss 1.013032, train_metric nan, valid_metric 0.028877
[1357640:MainThread](2026-01-11 22:02:17,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.017085 to 1.013032, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:18,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.052370, valid_loss 1.010407, train_metric nan, valid_metric 0.042575
[1357640:MainThread](2026-01-11 22:02:18,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.013032 to 1.010407, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:18,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.052059, valid_loss 1.008602, train_metric nan, valid_metric 0.035838
[1357640:MainThread](2026-01-11 22:02:18,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.010407 to 1.008602, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:19,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.045849, valid_loss 1.010480, train_metric nan, valid_metric 0.027057
[1357640:MainThread](2026-01-11 22:02:19,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.039630, valid_loss 1.006746, train_metric nan, valid_metric 0.038261
[1357640:MainThread](2026-01-11 22:02:19,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008602 to 1.006746, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:20,474) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.035551, valid_loss 1.010281, train_metric nan, valid_metric 0.043254
[1357640:MainThread](2026-01-11 22:02:20,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.033057, valid_loss 1.003516, train_metric nan, valid_metric 0.037729
[1357640:MainThread](2026-01-11 22:02:20,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006746 to 1.003516, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:21,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.029506, valid_loss 1.003958, train_metric nan, valid_metric 0.036181
[1357640:MainThread](2026-01-11 22:02:22,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.027318, valid_loss 1.005903, train_metric nan, valid_metric 0.029857
[1357640:MainThread](2026-01-11 22:02:22,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.022205, valid_loss 1.005107, train_metric nan, valid_metric 0.037923
[1357640:MainThread](2026-01-11 22:02:23,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.024659, valid_loss 1.003634, train_metric nan, valid_metric 0.043971
[1357640:MainThread](2026-01-11 22:02:23,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.019629, valid_loss 1.001586, train_metric nan, valid_metric 0.048036
[1357640:MainThread](2026-01-11 22:02:23,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003516 to 1.001586, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:24,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.014712, valid_loss 1.005235, train_metric nan, valid_metric 0.047419
[1357640:MainThread](2026-01-11 22:02:24,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.012770, valid_loss 1.002426, train_metric nan, valid_metric 0.050370
[1357640:MainThread](2026-01-11 22:02:25,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.013323, valid_loss 1.002261, train_metric nan, valid_metric 0.046272
[1357640:MainThread](2026-01-11 22:02:25,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.011307, valid_loss 1.001135, train_metric nan, valid_metric 0.050306
[1357640:MainThread](2026-01-11 22:02:25,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001586 to 1.001135, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:26,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.011946, valid_loss 1.001280, train_metric nan, valid_metric 0.049737
[1357640:MainThread](2026-01-11 22:02:27,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.007170, valid_loss 1.002258, train_metric nan, valid_metric 0.048995
[1357640:MainThread](2026-01-11 22:02:27,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.007634, valid_loss 0.999984, train_metric nan, valid_metric 0.049779
[1357640:MainThread](2026-01-11 22:02:27,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001135 to 0.999984, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:28,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.005779, valid_loss 0.999673, train_metric nan, valid_metric 0.049421
[1357640:MainThread](2026-01-11 22:02:28,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999984 to 0.999673, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:28,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.003565, valid_loss 1.001213, train_metric nan, valid_metric 0.051764
[1357640:MainThread](2026-01-11 22:02:29,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.004276, valid_loss 1.000273, train_metric nan, valid_metric 0.044451
[1357640:MainThread](2026-01-11 22:02:29,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.999975, valid_loss 1.000813, train_metric nan, valid_metric 0.054168
[1357640:MainThread](2026-01-11 22:02:30,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.001340, valid_loss 0.998955, train_metric nan, valid_metric 0.051127
[1357640:MainThread](2026-01-11 22:02:30,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999673 to 0.998955, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:30,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.998015, valid_loss 0.998814, train_metric nan, valid_metric 0.053016
[1357640:MainThread](2026-01-11 22:02:30,896) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998955 to 0.998814, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:31,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.999679, valid_loss 1.000566, train_metric nan, valid_metric 0.043984
[1357640:MainThread](2026-01-11 22:02:31,985) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.998686, valid_loss 1.000334, train_metric nan, valid_metric 0.056554
[1357640:MainThread](2026-01-11 22:02:32,521) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.999130, valid_loss 0.999941, train_metric nan, valid_metric 0.050349
[1357640:MainThread](2026-01-11 22:02:33,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.991273, valid_loss 1.001745, train_metric nan, valid_metric 0.054472
[1357640:MainThread](2026-01-11 22:02:33,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.993592, valid_loss 1.000024, train_metric nan, valid_metric 0.054259
[1357640:MainThread](2026-01-11 22:02:34,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.994401, valid_loss 1.000080, train_metric nan, valid_metric 0.051402
[1357640:MainThread](2026-01-11 22:02:34,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.991223, valid_loss 0.998946, train_metric nan, valid_metric 0.046881
[1357640:MainThread](2026-01-11 22:02:35,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.990513, valid_loss 0.998652, train_metric nan, valid_metric 0.052173
[1357640:MainThread](2026-01-11 22:02:35,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998814 to 0.998652, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:35,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.991487, valid_loss 0.998830, train_metric nan, valid_metric 0.052720
[1357640:MainThread](2026-01-11 22:02:36,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.991856, valid_loss 0.998342, train_metric nan, valid_metric 0.054944
[1357640:MainThread](2026-01-11 22:02:36,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998652 to 0.998342, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:36,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.992428, valid_loss 0.999292, train_metric nan, valid_metric 0.045756
[1357640:MainThread](2026-01-11 22:02:37,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.990430, valid_loss 1.001804, train_metric nan, valid_metric 0.049006
[1357640:MainThread](2026-01-11 22:02:37,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.987614, valid_loss 0.999350, train_metric nan, valid_metric 0.052131
[1357640:MainThread](2026-01-11 22:02:38,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.985834, valid_loss 0.999636, train_metric nan, valid_metric 0.051218
[1357640:MainThread](2026-01-11 22:02:39,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.992670, valid_loss 0.998470, train_metric nan, valid_metric 0.055717
[1357640:MainThread](2026-01-11 22:02:39,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.988807, valid_loss 1.000076, train_metric nan, valid_metric 0.053229
[1357640:MainThread](2026-01-11 22:02:40,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.987376, valid_loss 0.998928, train_metric nan, valid_metric 0.052008
[1357640:MainThread](2026-01-11 22:02:40,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.987676, valid_loss 0.999125, train_metric nan, valid_metric 0.052022
[1357640:MainThread](2026-01-11 22:02:41,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.985791, valid_loss 0.998580, train_metric nan, valid_metric 0.050139
[1357640:MainThread](2026-01-11 22:02:41,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.987471, valid_loss 0.998930, train_metric nan, valid_metric 0.051763
[1357640:MainThread](2026-01-11 22:02:42,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.982813, valid_loss 0.998189, train_metric nan, valid_metric 0.054071
[1357640:MainThread](2026-01-11 22:02:42,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998342 to 0.998189, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:42,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.989177, valid_loss 0.998895, train_metric nan, valid_metric 0.051623
[1357640:MainThread](2026-01-11 22:02:43,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.985747, valid_loss 0.998897, train_metric nan, valid_metric 0.053673
[1357640:MainThread](2026-01-11 22:02:43,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.985651, valid_loss 0.998043, train_metric nan, valid_metric 0.049751
[1357640:MainThread](2026-01-11 22:02:43,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998189 to 0.998043, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:44,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.986866, valid_loss 1.000591, train_metric nan, valid_metric 0.054010
[1357640:MainThread](2026-01-11 22:02:44,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.985587, valid_loss 0.998096, train_metric nan, valid_metric 0.055689
[1357640:MainThread](2026-01-11 22:02:45,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.985848, valid_loss 0.999639, train_metric nan, valid_metric 0.047369
[1357640:MainThread](2026-01-11 22:02:45,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.988189, valid_loss 0.999514, train_metric nan, valid_metric 0.045398
[1357640:MainThread](2026-01-11 22:02:46,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.985415, valid_loss 0.998037, train_metric nan, valid_metric 0.050463
[1357640:MainThread](2026-01-11 22:02:46,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998043 to 0.998037, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:46,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.979627, valid_loss 0.998171, train_metric nan, valid_metric 0.054196
[1357640:MainThread](2026-01-11 22:02:47,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.982007, valid_loss 0.998910, train_metric nan, valid_metric 0.054075
[1357640:MainThread](2026-01-11 22:02:47,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.988513, valid_loss 0.999516, train_metric nan, valid_metric 0.053389
[1357640:MainThread](2026-01-11 22:02:48,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.984937, valid_loss 0.999483, train_metric nan, valid_metric 0.052461
[1357640:MainThread](2026-01-11 22:02:49,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.986539, valid_loss 0.999440, train_metric nan, valid_metric 0.054156
[1357640:MainThread](2026-01-11 22:02:49,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.984899, valid_loss 0.999077, train_metric nan, valid_metric 0.048227
[1357640:MainThread](2026-01-11 22:02:50,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.980593, valid_loss 0.999081, train_metric nan, valid_metric 0.054919
[1357640:MainThread](2026-01-11 22:02:50,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.985198, valid_loss 0.998447, train_metric nan, valid_metric 0.053287
[1357640:MainThread](2026-01-11 22:02:51,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.981343, valid_loss 0.998840, train_metric nan, valid_metric 0.049006
[1357640:MainThread](2026-01-11 22:02:51,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.980468, valid_loss 0.999901, train_metric nan, valid_metric 0.056222
[1357640:MainThread](2026-01-11 22:02:52,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.984022, valid_loss 0.997765, train_metric nan, valid_metric 0.052176
[1357640:MainThread](2026-01-11 22:02:52,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998037 to 0.997765, save checkpoint.
[1357640:MainThread](2026-01-11 22:02:52,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.981311, valid_loss 0.998981, train_metric nan, valid_metric 0.052915
[1357640:MainThread](2026-01-11 22:02:53,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.981691, valid_loss 0.998950, train_metric nan, valid_metric 0.054963
[1357640:MainThread](2026-01-11 22:02:53,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.977031, valid_loss 0.998625, train_metric nan, valid_metric 0.052585
[1357640:MainThread](2026-01-11 22:02:54,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.983375, valid_loss 1.000100, train_metric nan, valid_metric 0.054709
[1357640:MainThread](2026-01-11 22:02:54,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.982170, valid_loss 0.998485, train_metric nan, valid_metric 0.053765
[1357640:MainThread](2026-01-11 22:02:55,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.979671, valid_loss 0.999695, train_metric nan, valid_metric 0.052147
[1357640:MainThread](2026-01-11 22:02:55,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.984491, valid_loss 0.998847, train_metric nan, valid_metric 0.052311
[1357640:MainThread](2026-01-11 22:02:56,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.980515, valid_loss 0.999032, train_metric nan, valid_metric 0.054642
[1357640:MainThread](2026-01-11 22:02:56,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.982843, valid_loss 0.999014, train_metric nan, valid_metric 0.055080
[1357640:MainThread](2026-01-11 22:02:57,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.981753, valid_loss 0.998820, train_metric nan, valid_metric 0.051942
[1357640:MainThread](2026-01-11 22:02:58,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.979663, valid_loss 0.998370, train_metric nan, valid_metric 0.052814
[1357640:MainThread](2026-01-11 22:02:58,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.979960, valid_loss 0.999132, train_metric nan, valid_metric 0.052723
[1357640:MainThread](2026-01-11 22:02:59,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.984306, valid_loss 0.998551, train_metric nan, valid_metric 0.054044
[1357640:MainThread](2026-01-11 22:02:59,842) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.981674, valid_loss 0.999309, train_metric nan, valid_metric 0.055014
[1357640:MainThread](2026-01-11 22:03:00,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.981759, valid_loss 0.998911, train_metric nan, valid_metric 0.053566
[1357640:MainThread](2026-01-11 22:03:00,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.981192, valid_loss 0.998846, train_metric nan, valid_metric 0.052466
[1357640:MainThread](2026-01-11 22:03:01,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.978296, valid_loss 0.998854, train_metric nan, valid_metric 0.056980
[1357640:MainThread](2026-01-11 22:03:02,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.980541, valid_loss 0.999914, train_metric nan, valid_metric 0.052862
[1357640:MainThread](2026-01-11 22:03:02,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.981134, valid_loss 0.998558, train_metric nan, valid_metric 0.054160
[1357640:MainThread](2026-01-11 22:03:03,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.980008, valid_loss 0.999370, train_metric nan, valid_metric 0.056246
[1357640:MainThread](2026-01-11 22:03:03,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.982848, valid_loss 0.998585, train_metric nan, valid_metric 0.054644
[1357640:MainThread](2026-01-11 22:03:04,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.980483, valid_loss 0.999619, train_metric nan, valid_metric 0.055092
[1357640:MainThread](2026-01-11 22:03:04,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.982195, valid_loss 0.999155, train_metric nan, valid_metric 0.055674
[1357640:MainThread](2026-01-11 22:03:05,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.984602, valid_loss 0.998411, train_metric nan, valid_metric 0.053866
[1357640:MainThread](2026-01-11 22:03:05,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.983704, valid_loss 0.999207, train_metric nan, valid_metric 0.050529
[1357640:MainThread](2026-01-11 22:03:06,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.978195, valid_loss 0.998993, train_metric nan, valid_metric 0.054529
[1357640:MainThread](2026-01-11 22:03:06,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.980549, valid_loss 0.998796, train_metric nan, valid_metric 0.055183
[1357640:MainThread](2026-01-11 22:03:07,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.980762, valid_loss 0.999178, train_metric nan, valid_metric 0.054444
[1357640:MainThread](2026-01-11 22:03:08,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.981534, valid_loss 0.998894, train_metric nan, valid_metric 0.054683
[1357640:MainThread](2026-01-11 22:03:08,477) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.980694, valid_loss 0.999092, train_metric nan, valid_metric 0.056503
[1357640:MainThread](2026-01-11 22:03:08,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.981861, valid_loss 0.998884, train_metric nan, valid_metric 0.054289
[1357640:MainThread](2026-01-11 22:03:09,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.977504, valid_loss 0.999208, train_metric nan, valid_metric 0.055030
[1357640:MainThread](2026-01-11 22:03:09,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.985448, valid_loss 0.998798, train_metric nan, valid_metric 0.055162
[1357640:MainThread](2026-01-11 22:03:10,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.982456, valid_loss 0.999104, train_metric nan, valid_metric 0.054261
[1357640:MainThread](2026-01-11 22:03:11,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.977863, valid_loss 0.999207, train_metric nan, valid_metric 0.054874
[1357640:MainThread](2026-01-11 22:03:11,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.983057, valid_loss 0.998875, train_metric nan, valid_metric 0.055129
[1357640:MainThread](2026-01-11 22:03:12,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.981796, valid_loss 0.999224, train_metric nan, valid_metric 0.053554
[1357640:MainThread](2026-01-11 22:03:12,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.981751, valid_loss 0.998994, train_metric nan, valid_metric 0.055720
[1357640:MainThread](2026-01-11 22:03:13,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.976564, valid_loss 0.998610, train_metric nan, valid_metric 0.055316
[1357640:MainThread](2026-01-11 22:03:13,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.977906, valid_loss 0.999235, train_metric nan, valid_metric 0.054924
[1357640:MainThread](2026-01-11 22:03:14,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.979989, valid_loss 0.999133, train_metric nan, valid_metric 0.055493
[1357640:MainThread](2026-01-11 22:03:14,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.981360, valid_loss 0.999122, train_metric nan, valid_metric 0.054066
[1357640:MainThread](2026-01-11 22:03:15,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.979470, valid_loss 0.999824, train_metric nan, valid_metric 0.055252
[1357640:MainThread](2026-01-11 22:03:15,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.979322, valid_loss 0.998915, train_metric nan, valid_metric 0.054155
[1357640:MainThread](2026-01-11 22:03:16,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.979706, valid_loss 0.999001, train_metric nan, valid_metric 0.055703
[1357640:MainThread](2026-01-11 22:03:17,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.980964, valid_loss 0.998984, train_metric nan, valid_metric 0.055123
[1357640:MainThread](2026-01-11 22:03:17,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.978920, valid_loss 0.998954, train_metric nan, valid_metric 0.054744
[1357640:MainThread](2026-01-11 22:03:18,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.979382, valid_loss 0.998920, train_metric nan, valid_metric 0.054829
[1357640:MainThread](2026-01-11 22:03:18,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.982111, valid_loss 0.998979, train_metric nan, valid_metric 0.055912
[1357640:MainThread](2026-01-11 22:03:19,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.980014, valid_loss 0.998773, train_metric nan, valid_metric 0.056126
[1357640:MainThread](2026-01-11 22:03:19,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:03:19.139 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:03:20.612 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 22:03:20.612 | INFO     | __main__:train_single_fold:593 -   IC=0.0076, ICIR=0.0721, RankIC=0.0249, RankICIR=0.2456
2026-01-11 22:03:20.612 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 22:03:20,620) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:03:51,194) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:03:51,195) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:03:59,693) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684be08190>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 26.58it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 54.20it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 65.47it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 68.92it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 71.46it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 74.01it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 76.96it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 77.80it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 79.10it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 78.60it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 79.03it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 79.70it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 78.73it/s]backtest loop:  49%|████▉     | 119/243 [00:01<00:01, 81.61it/s]backtest loop:  53%|█████▎    | 128/243 [00:01<00:01, 79.85it/s]backtest loop:  56%|█████▋    | 137/243 [00:01<00:01, 77.97it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 76.88it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 78.37it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 79.35it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 79.63it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 76.31it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 77.85it/s]backtest loop:  83%|████████▎ | 202/243 [00:02<00:00, 79.99it/s]backtest loop:  87%|████████▋ | 211/243 [00:02<00:00, 79.93it/s]backtest loop:  91%|█████████ | 220/243 [00:02<00:00, 79.47it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 78.68it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 79.48it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.05it/s]
2026-01-11 22:04:02.870 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1661, Sharpe(w/cost)=1.7508, MaxDD=-0.0515
2026-01-11 22:04:06.537 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 22:04:22.571 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:04:22.623 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_5_pred.parquet
2026-01-11 22:04:22.639 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 22:04:22.639 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 22:04:23.938 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0247
2026-01-11 22:04:25.130 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0256
2026-01-11 22:04:26.333 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0277
2026-01-11 22:04:27.618 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0249
2026-01-11 22:04:28.920 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0248
2026-01-11 22:04:29.286 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0098, ICIR=0.0846, RankIC=0.0278
[1357640:MainThread](2026-01-11 22:04:29,293) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:05:00,201) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:05:00,202) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:05:08,908) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f68499e6a50>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.39it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:04, 47.24it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 62.60it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 66.20it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 69.01it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 71.27it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 74.30it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 75.02it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 76.47it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 75.43it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:02, 76.00it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 77.23it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 77.06it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 77.73it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 78.55it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 78.35it/s]backtest loop:  62%|██████▏   | 150/243 [00:02<00:01, 78.80it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 78.69it/s]backtest loop:  70%|██████▉   | 169/243 [00:02<00:00, 81.57it/s]backtest loop:  73%|███████▎  | 178/243 [00:02<00:00, 77.68it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 77.60it/s]backtest loop:  81%|████████  | 196/243 [00:02<00:00, 82.55it/s]backtest loop:  85%|████████▍ | 206/243 [00:02<00:00, 86.13it/s]backtest loop:  89%|████████▉ | 216/243 [00:02<00:00, 88.88it/s]backtest loop:  93%|█████████▎| 226/243 [00:02<00:00, 90.93it/s]backtest loop:  97%|█████████▋| 236/243 [00:03<00:00, 91.77it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 78.32it/s]
2026-01-11 22:05:12.031 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1052, Sharpe(w/cost)=1.0973
2026-01-11 22:05:12.102 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:05:12.102 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 22:05:12.102 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:05:12.102 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 22:06:15,833) INFO - qlib.timer - [log.py:127] - Time cost: 63.728s | Loading data Done
[1357640:MainThread](2026-01-11 22:06:16,162) INFO - qlib.timer - [log.py:127] - Time cost: 0.081s | DropCol Done
[1357640:MainThread](2026-01-11 22:06:19,693) INFO - qlib.timer - [log.py:127] - Time cost: 3.529s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 22:06:21,381) INFO - qlib.timer - [log.py:127] - Time cost: 1.687s | Fillna Done
[1357640:MainThread](2026-01-11 22:06:22,052) INFO - qlib.timer - [log.py:127] - Time cost: 0.076s | DropCol Done
[1357640:MainThread](2026-01-11 22:06:22,205) INFO - qlib.timer - [log.py:127] - Time cost: 0.152s | DropnaLabel Done
[1357640:MainThread](2026-01-11 22:06:22,415) INFO - qlib.timer - [log.py:127] - Time cost: 0.209s | CSRankNorm Done
[1357640:MainThread](2026-01-11 22:06:22,417) INFO - qlib.timer - [log.py:127] - Time cost: 6.583s | fit & process data Done
[1357640:MainThread](2026-01-11 22:06:22,418) INFO - qlib.timer - [log.py:127] - Time cost: 70.315s | Init data Done
2026-01-11 22:06:22.418 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 22:06:22,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 22:06:22,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 22:06:22,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 22:06:22,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:06:22.435 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 22:06:23,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 22:06:24,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.431815, valid_loss 1.086674, train_metric nan, valid_metric 0.014255
[1357640:MainThread](2026-01-11 22:06:24,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.086674, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:25,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.118172, valid_loss 1.035861, train_metric nan, valid_metric 0.024961
[1357640:MainThread](2026-01-11 22:06:25,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.086674 to 1.035861, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:25,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.079288, valid_loss 1.024166, train_metric nan, valid_metric 0.028995
[1357640:MainThread](2026-01-11 22:06:25,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.035861 to 1.024166, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:26,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.064053, valid_loss 1.018204, train_metric nan, valid_metric 0.030056
[1357640:MainThread](2026-01-11 22:06:26,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.024166 to 1.018204, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:27,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.055769, valid_loss 1.019299, train_metric nan, valid_metric 0.029484
[1357640:MainThread](2026-01-11 22:06:27,643) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.049661, valid_loss 1.011179, train_metric nan, valid_metric 0.029461
[1357640:MainThread](2026-01-11 22:06:27,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018204 to 1.011179, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:28,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.048862, valid_loss 1.011240, train_metric nan, valid_metric 0.032117
[1357640:MainThread](2026-01-11 22:06:28,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.039045, valid_loss 1.007319, train_metric nan, valid_metric 0.029277
[1357640:MainThread](2026-01-11 22:06:28,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.011179 to 1.007319, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:29,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.040029, valid_loss 1.008767, train_metric nan, valid_metric 0.031615
[1357640:MainThread](2026-01-11 22:06:29,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.035178, valid_loss 1.008950, train_metric nan, valid_metric 0.029934
[1357640:MainThread](2026-01-11 22:06:30,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.029715, valid_loss 1.004852, train_metric nan, valid_metric 0.034277
[1357640:MainThread](2026-01-11 22:06:30,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007319 to 1.004852, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:30,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.026196, valid_loss 1.014073, train_metric nan, valid_metric 0.029845
[1357640:MainThread](2026-01-11 22:06:31,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.024127, valid_loss 1.007858, train_metric nan, valid_metric 0.039247
[1357640:MainThread](2026-01-11 22:06:32,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.022617, valid_loss 1.003502, train_metric nan, valid_metric 0.036549
[1357640:MainThread](2026-01-11 22:06:32,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004852 to 1.003502, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:32,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.017142, valid_loss 1.006624, train_metric nan, valid_metric 0.024308
[1357640:MainThread](2026-01-11 22:06:32,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.023398, valid_loss 1.005128, train_metric nan, valid_metric 0.037540
[1357640:MainThread](2026-01-11 22:06:33,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.008945, valid_loss 1.004215, train_metric nan, valid_metric 0.044434
[1357640:MainThread](2026-01-11 22:06:33,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.013993, valid_loss 1.005221, train_metric nan, valid_metric 0.038429
[1357640:MainThread](2026-01-11 22:06:34,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.010312, valid_loss 1.002401, train_metric nan, valid_metric 0.037012
[1357640:MainThread](2026-01-11 22:06:34,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003502 to 1.002401, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:34,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.006989, valid_loss 1.005335, train_metric nan, valid_metric 0.038930
[1357640:MainThread](2026-01-11 22:06:35,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.005412, valid_loss 1.003096, train_metric nan, valid_metric 0.040952
[1357640:MainThread](2026-01-11 22:06:36,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.009817, valid_loss 1.003982, train_metric nan, valid_metric 0.034961
[1357640:MainThread](2026-01-11 22:06:36,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.007627, valid_loss 1.000674, train_metric nan, valid_metric 0.036121
[1357640:MainThread](2026-01-11 22:06:36,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002401 to 1.000674, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:37,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.999988, valid_loss 1.001166, train_metric nan, valid_metric 0.037647
[1357640:MainThread](2026-01-11 22:06:37,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.001378, valid_loss 1.002047, train_metric nan, valid_metric 0.038331
[1357640:MainThread](2026-01-11 22:06:38,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.999479, valid_loss 1.001786, train_metric nan, valid_metric 0.037330
[1357640:MainThread](2026-01-11 22:06:38,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.000629, valid_loss 1.000480, train_metric nan, valid_metric 0.040326
[1357640:MainThread](2026-01-11 22:06:38,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000674 to 1.000480, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:39,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.006069, valid_loss 1.003306, train_metric nan, valid_metric 0.040691
[1357640:MainThread](2026-01-11 22:06:39,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.001320, valid_loss 1.000875, train_metric nan, valid_metric 0.038678
[1357640:MainThread](2026-01-11 22:06:40,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.993429, valid_loss 1.002696, train_metric nan, valid_metric 0.039652
[1357640:MainThread](2026-01-11 22:06:41,063) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.998399, valid_loss 1.001430, train_metric nan, valid_metric 0.040255
[1357640:MainThread](2026-01-11 22:06:41,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.991919, valid_loss 1.005512, train_metric nan, valid_metric 0.039433
[1357640:MainThread](2026-01-11 22:06:42,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.996873, valid_loss 1.005278, train_metric nan, valid_metric 0.037386
[1357640:MainThread](2026-01-11 22:06:42,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.994312, valid_loss 1.002446, train_metric nan, valid_metric 0.038528
[1357640:MainThread](2026-01-11 22:06:43,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.992399, valid_loss 1.000878, train_metric nan, valid_metric 0.033094
[1357640:MainThread](2026-01-11 22:06:43,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.990251, valid_loss 0.999804, train_metric nan, valid_metric 0.037943
[1357640:MainThread](2026-01-11 22:06:43,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000480 to 0.999804, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:44,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.993911, valid_loss 1.000175, train_metric nan, valid_metric 0.038584
[1357640:MainThread](2026-01-11 22:06:44,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.991679, valid_loss 1.001543, train_metric nan, valid_metric 0.044363
[1357640:MainThread](2026-01-11 22:06:45,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.992463, valid_loss 1.000393, train_metric nan, valid_metric 0.040950
[1357640:MainThread](2026-01-11 22:06:45,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.995549, valid_loss 1.001829, train_metric nan, valid_metric 0.038986
[1357640:MainThread](2026-01-11 22:06:46,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.990786, valid_loss 0.999913, train_metric nan, valid_metric 0.037731
[1357640:MainThread](2026-01-11 22:06:47,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.989271, valid_loss 0.999324, train_metric nan, valid_metric 0.042373
[1357640:MainThread](2026-01-11 22:06:47,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999804 to 0.999324, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:47,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.986325, valid_loss 1.002913, train_metric nan, valid_metric 0.043267
[1357640:MainThread](2026-01-11 22:06:48,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.987724, valid_loss 1.000435, train_metric nan, valid_metric 0.041985
[1357640:MainThread](2026-01-11 22:06:48,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.987218, valid_loss 0.999876, train_metric nan, valid_metric 0.038848
[1357640:MainThread](2026-01-11 22:06:49,301) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.986651, valid_loss 0.999750, train_metric nan, valid_metric 0.039405
[1357640:MainThread](2026-01-11 22:06:49,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.990875, valid_loss 0.999767, train_metric nan, valid_metric 0.038339
[1357640:MainThread](2026-01-11 22:06:50,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.992167, valid_loss 0.999768, train_metric nan, valid_metric 0.041422
[1357640:MainThread](2026-01-11 22:06:50,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.991245, valid_loss 1.001107, train_metric nan, valid_metric 0.041648
[1357640:MainThread](2026-01-11 22:06:51,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.990851, valid_loss 1.000883, train_metric nan, valid_metric 0.043788
[1357640:MainThread](2026-01-11 22:06:52,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.985401, valid_loss 1.000288, train_metric nan, valid_metric 0.039312
[1357640:MainThread](2026-01-11 22:06:52,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.988852, valid_loss 1.000257, train_metric nan, valid_metric 0.039300
[1357640:MainThread](2026-01-11 22:06:53,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.992660, valid_loss 1.000593, train_metric nan, valid_metric 0.041883
[1357640:MainThread](2026-01-11 22:06:53,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.988399, valid_loss 0.999261, train_metric nan, valid_metric 0.042608
[1357640:MainThread](2026-01-11 22:06:53,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999324 to 0.999261, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:54,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.987086, valid_loss 0.998848, train_metric nan, valid_metric 0.040314
[1357640:MainThread](2026-01-11 22:06:54,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999261 to 0.998848, save checkpoint.
[1357640:MainThread](2026-01-11 22:06:54,789) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.984266, valid_loss 0.999161, train_metric nan, valid_metric 0.042480
[1357640:MainThread](2026-01-11 22:06:55,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.986317, valid_loss 0.998895, train_metric nan, valid_metric 0.042369
[1357640:MainThread](2026-01-11 22:06:55,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.983583, valid_loss 1.000897, train_metric nan, valid_metric 0.039469
[1357640:MainThread](2026-01-11 22:06:56,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.987528, valid_loss 1.000525, train_metric nan, valid_metric 0.041167
[1357640:MainThread](2026-01-11 22:06:56,935) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.988986, valid_loss 0.999534, train_metric nan, valid_metric 0.041862
[1357640:MainThread](2026-01-11 22:06:57,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.987347, valid_loss 0.999509, train_metric nan, valid_metric 0.042605
[1357640:MainThread](2026-01-11 22:06:58,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.987993, valid_loss 1.000545, train_metric nan, valid_metric 0.041159
[1357640:MainThread](2026-01-11 22:06:58,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.984556, valid_loss 0.999967, train_metric nan, valid_metric 0.042296
[1357640:MainThread](2026-01-11 22:06:59,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.987292, valid_loss 0.999573, train_metric nan, valid_metric 0.042564
[1357640:MainThread](2026-01-11 22:06:59,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.984926, valid_loss 1.000367, train_metric nan, valid_metric 0.042948
[1357640:MainThread](2026-01-11 22:07:00,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.987611, valid_loss 0.999993, train_metric nan, valid_metric 0.042132
[1357640:MainThread](2026-01-11 22:07:00,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.988957, valid_loss 1.000219, train_metric nan, valid_metric 0.043475
[1357640:MainThread](2026-01-11 22:07:01,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.982847, valid_loss 0.999536, train_metric nan, valid_metric 0.042374
[1357640:MainThread](2026-01-11 22:07:01,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.986668, valid_loss 0.999688, train_metric nan, valid_metric 0.041511
[1357640:MainThread](2026-01-11 22:07:02,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.984285, valid_loss 0.999277, train_metric nan, valid_metric 0.043508
[1357640:MainThread](2026-01-11 22:07:02,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.985742, valid_loss 0.999047, train_metric nan, valid_metric 0.043132
[1357640:MainThread](2026-01-11 22:07:03,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.989021, valid_loss 0.999517, train_metric nan, valid_metric 0.038001
[1357640:MainThread](2026-01-11 22:07:03,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.985366, valid_loss 0.999801, train_metric nan, valid_metric 0.043464
[1357640:MainThread](2026-01-11 22:07:04,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.982363, valid_loss 1.000543, train_metric nan, valid_metric 0.042515
[1357640:MainThread](2026-01-11 22:07:05,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.981815, valid_loss 1.000422, train_metric nan, valid_metric 0.042232
[1357640:MainThread](2026-01-11 22:07:05,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.986138, valid_loss 0.999852, train_metric nan, valid_metric 0.041001
[1357640:MainThread](2026-01-11 22:07:06,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.984629, valid_loss 1.000081, train_metric nan, valid_metric 0.043253
[1357640:MainThread](2026-01-11 22:07:06,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.982530, valid_loss 1.000553, train_metric nan, valid_metric 0.042665
[1357640:MainThread](2026-01-11 22:07:06,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.987619, valid_loss 1.000084, train_metric nan, valid_metric 0.042673
[1357640:MainThread](2026-01-11 22:07:07,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.987815, valid_loss 0.999919, train_metric nan, valid_metric 0.043077
[1357640:MainThread](2026-01-11 22:07:07,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.988650, valid_loss 0.999908, train_metric nan, valid_metric 0.042028
[1357640:MainThread](2026-01-11 22:07:08,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.985129, valid_loss 1.001063, train_metric nan, valid_metric 0.042323
[1357640:MainThread](2026-01-11 22:07:08,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.983113, valid_loss 0.999848, train_metric nan, valid_metric 0.042400
[1357640:MainThread](2026-01-11 22:07:09,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.985955, valid_loss 0.999617, train_metric nan, valid_metric 0.041565
[1357640:MainThread](2026-01-11 22:07:10,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.981638, valid_loss 1.000718, train_metric nan, valid_metric 0.043274
[1357640:MainThread](2026-01-11 22:07:10,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.983041, valid_loss 1.001054, train_metric nan, valid_metric 0.042644
[1357640:MainThread](2026-01-11 22:07:11,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.982945, valid_loss 1.000819, train_metric nan, valid_metric 0.041328
[1357640:MainThread](2026-01-11 22:07:11,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.982598, valid_loss 1.000237, train_metric nan, valid_metric 0.044004
[1357640:MainThread](2026-01-11 22:07:12,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.985278, valid_loss 0.999534, train_metric nan, valid_metric 0.041941
[1357640:MainThread](2026-01-11 22:07:12,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.986924, valid_loss 1.000119, train_metric nan, valid_metric 0.042521
[1357640:MainThread](2026-01-11 22:07:13,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.983157, valid_loss 1.000751, train_metric nan, valid_metric 0.043144
[1357640:MainThread](2026-01-11 22:07:13,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.985721, valid_loss 1.000185, train_metric nan, valid_metric 0.044052
[1357640:MainThread](2026-01-11 22:07:14,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.981040, valid_loss 1.000057, train_metric nan, valid_metric 0.042140
[1357640:MainThread](2026-01-11 22:07:14,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.983621, valid_loss 0.999693, train_metric nan, valid_metric 0.042869
[1357640:MainThread](2026-01-11 22:07:15,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.986292, valid_loss 0.999894, train_metric nan, valid_metric 0.042507
[1357640:MainThread](2026-01-11 22:07:15,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.984796, valid_loss 0.999480, train_metric nan, valid_metric 0.042668
[1357640:MainThread](2026-01-11 22:07:16,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.983285, valid_loss 1.000217, train_metric nan, valid_metric 0.042601
[1357640:MainThread](2026-01-11 22:07:17,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.989192, valid_loss 0.999999, train_metric nan, valid_metric 0.042446
[1357640:MainThread](2026-01-11 22:07:17,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.981297, valid_loss 1.000594, train_metric nan, valid_metric 0.041798
[1357640:MainThread](2026-01-11 22:07:18,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.985170, valid_loss 1.000192, train_metric nan, valid_metric 0.042504
[1357640:MainThread](2026-01-11 22:07:18,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.985786, valid_loss 1.000277, train_metric nan, valid_metric 0.043264
[1357640:MainThread](2026-01-11 22:07:19,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.990602, valid_loss 0.999961, train_metric nan, valid_metric 0.042638
[1357640:MainThread](2026-01-11 22:07:19,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.984395, valid_loss 1.000048, train_metric nan, valid_metric 0.042378
[1357640:MainThread](2026-01-11 22:07:20,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.980776, valid_loss 0.999913, train_metric nan, valid_metric 0.042592
[1357640:MainThread](2026-01-11 22:07:20,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.986769, valid_loss 0.999906, train_metric nan, valid_metric 0.043176
[1357640:MainThread](2026-01-11 22:07:20,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:07:20.920 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:07:22.354 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 22:07:22.354 | INFO     | __main__:train_single_fold:593 -   IC=0.0253, ICIR=0.2586, RankIC=0.0432, RankICIR=0.4381
2026-01-11 22:07:22.354 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 22:07:22,362) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:07:55,079) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:07:55,080) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:08:03,488) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f68502b8250>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 26.00it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 54.44it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 64.58it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 72.88it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 76.79it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 79.18it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 81.27it/s]backtest loop:  28%|██▊       | 68/242 [00:00<00:02, 79.95it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 80.93it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:01, 80.58it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 80.49it/s]backtest loop:  43%|████▎     | 104/242 [00:01<00:01, 80.99it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 81.73it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 82.79it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 82.92it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 83.50it/s]backtest loop:  63%|██████▎   | 153/242 [00:01<00:01, 83.62it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 83.38it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 82.78it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 82.83it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 82.73it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 82.82it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 82.99it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 81.98it/s]backtest loop:  96%|█████████▌| 232/242 [00:02<00:00, 82.41it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 82.47it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 80.11it/s]
2026-01-11 22:08:06.531 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1829, Sharpe(w/cost)=2.7460, MaxDD=-0.0275
2026-01-11 22:08:09.547 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 22:08:29.922 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:08:29.988 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_6_pred.parquet
2026-01-11 22:08:30.006 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 22:08:30.006 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 22:08:31.462 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0371
2026-01-11 22:08:32.777 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0382
2026-01-11 22:08:33.788 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0385
2026-01-11 22:08:35.050 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0360
2026-01-11 22:08:35.997 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0398
2026-01-11 22:08:37.173 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0406
2026-01-11 22:08:37.550 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0263, ICIR=0.2347, RankIC=0.0453
[1357640:MainThread](2026-01-11 22:08:37,556) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:09:02,059) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:09:02,060) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:09:10,806) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6982f62210>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.85it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 51.42it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 62.13it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 69.98it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 74.85it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 77.61it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 80.09it/s]backtest loop:  28%|██▊       | 68/242 [00:00<00:02, 80.07it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 77.74it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:01, 82.41it/s]backtest loop:  40%|████      | 97/242 [00:01<00:01, 85.62it/s]backtest loop:  44%|████▍     | 106/242 [00:01<00:01, 86.65it/s]backtest loop:  48%|████▊     | 116/242 [00:01<00:01, 89.18it/s]backtest loop:  52%|█████▏    | 126/242 [00:01<00:01, 91.15it/s]backtest loop:  56%|█████▌    | 136/242 [00:01<00:01, 92.38it/s]backtest loop:  60%|██████    | 146/242 [00:01<00:01, 92.97it/s]backtest loop:  64%|██████▍   | 156/242 [00:01<00:00, 93.54it/s]backtest loop:  69%|██████▊   | 166/242 [00:02<00:00, 92.80it/s]backtest loop:  73%|███████▎  | 176/242 [00:02<00:00, 91.88it/s]backtest loop:  77%|███████▋  | 186/242 [00:02<00:00, 89.07it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 85.32it/s]backtest loop:  84%|████████▍ | 204/242 [00:02<00:00, 84.28it/s]backtest loop:  88%|████████▊ | 213/242 [00:02<00:00, 83.09it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 81.90it/s]backtest loop:  96%|█████████▌| 232/242 [00:02<00:00, 81.64it/s]backtest loop: 100%|█████████▉| 241/242 [00:02<00:00, 83.79it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 82.29it/s]
2026-01-11 22:09:13.770 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1677, Sharpe(w/cost)=2.2938
2026-01-11 22:09:13.815 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:09:13.815 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 22:09:13.815 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:09:13.816 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 22:10:14,323) INFO - qlib.timer - [log.py:127] - Time cost: 60.504s | Loading data Done
[1357640:MainThread](2026-01-11 22:10:14,661) INFO - qlib.timer - [log.py:127] - Time cost: 0.089s | DropCol Done
[1357640:MainThread](2026-01-11 22:10:18,070) INFO - qlib.timer - [log.py:127] - Time cost: 3.406s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 22:10:19,863) INFO - qlib.timer - [log.py:127] - Time cost: 1.792s | Fillna Done
[1357640:MainThread](2026-01-11 22:10:20,520) INFO - qlib.timer - [log.py:127] - Time cost: 0.080s | DropCol Done
[1357640:MainThread](2026-01-11 22:10:20,673) INFO - qlib.timer - [log.py:127] - Time cost: 0.151s | DropnaLabel Done
[1357640:MainThread](2026-01-11 22:10:20,895) INFO - qlib.timer - [log.py:127] - Time cost: 0.220s | CSRankNorm Done
[1357640:MainThread](2026-01-11 22:10:20,899) INFO - qlib.timer - [log.py:127] - Time cost: 6.576s | fit & process data Done
[1357640:MainThread](2026-01-11 22:10:20,900) INFO - qlib.timer - [log.py:127] - Time cost: 67.083s | Init data Done
2026-01-11 22:10:20.900 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 22:10:20,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 22:10:20,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 22:10:20,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 22:10:20,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:10:20.915 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 22:10:22,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 22:10:23,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.277211, valid_loss 1.048435, train_metric nan, valid_metric 0.023609
[1357640:MainThread](2026-01-11 22:10:23,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.048435, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:23,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.085179, valid_loss 1.023156, train_metric nan, valid_metric 0.020265
[1357640:MainThread](2026-01-11 22:10:23,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.048435 to 1.023156, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:23,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.055243, valid_loss 1.014396, train_metric nan, valid_metric 0.025371
[1357640:MainThread](2026-01-11 22:10:23,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.023156 to 1.014396, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:24,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.045617, valid_loss 1.008523, train_metric nan, valid_metric 0.027731
[1357640:MainThread](2026-01-11 22:10:24,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.014396 to 1.008523, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:24,765) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.033494, valid_loss 1.007581, train_metric nan, valid_metric 0.026133
[1357640:MainThread](2026-01-11 22:10:24,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008523 to 1.007581, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:25,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.031236, valid_loss 1.004480, train_metric nan, valid_metric 0.033552
[1357640:MainThread](2026-01-11 22:10:25,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007581 to 1.004480, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:25,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.022828, valid_loss 1.004521, train_metric nan, valid_metric 0.033054
[1357640:MainThread](2026-01-11 22:10:26,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.021986, valid_loss 1.003978, train_metric nan, valid_metric 0.035518
[1357640:MainThread](2026-01-11 22:10:26,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004480 to 1.003978, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:26,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.015203, valid_loss 1.003206, train_metric nan, valid_metric 0.031827
[1357640:MainThread](2026-01-11 22:10:26,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003978 to 1.003206, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:27,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.016295, valid_loss 1.003836, train_metric nan, valid_metric 0.032972
[1357640:MainThread](2026-01-11 22:10:27,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.010016, valid_loss 1.001937, train_metric nan, valid_metric 0.029564
[1357640:MainThread](2026-01-11 22:10:27,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003206 to 1.001937, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:28,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.011263, valid_loss 1.000702, train_metric nan, valid_metric 0.036498
[1357640:MainThread](2026-01-11 22:10:28,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001937 to 1.000702, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:28,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.006148, valid_loss 1.002155, train_metric nan, valid_metric 0.033841
[1357640:MainThread](2026-01-11 22:10:29,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.006000, valid_loss 1.000047, train_metric nan, valid_metric 0.035336
[1357640:MainThread](2026-01-11 22:10:29,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000702 to 1.000047, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:29,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.001587, valid_loss 0.999463, train_metric nan, valid_metric 0.037131
[1357640:MainThread](2026-01-11 22:10:29,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000047 to 0.999463, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:30,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 0.998368, valid_loss 0.998552, train_metric nan, valid_metric 0.040070
[1357640:MainThread](2026-01-11 22:10:30,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999463 to 0.998552, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:30,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.000258, valid_loss 1.000232, train_metric nan, valid_metric 0.032785
[1357640:MainThread](2026-01-11 22:10:31,289) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 0.998901, valid_loss 0.999383, train_metric nan, valid_metric 0.031998
[1357640:MainThread](2026-01-11 22:10:31,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.993734, valid_loss 1.001728, train_metric nan, valid_metric 0.034800
[1357640:MainThread](2026-01-11 22:10:32,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 0.998232, valid_loss 0.999635, train_metric nan, valid_metric 0.041750
[1357640:MainThread](2026-01-11 22:10:32,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 0.999620, valid_loss 0.999562, train_metric nan, valid_metric 0.040734
[1357640:MainThread](2026-01-11 22:10:33,058) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 0.999314, valid_loss 0.998462, train_metric nan, valid_metric 0.046622
[1357640:MainThread](2026-01-11 22:10:33,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998552 to 0.998462, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:33,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.995450, valid_loss 0.999741, train_metric nan, valid_metric 0.038298
[1357640:MainThread](2026-01-11 22:10:33,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.994423, valid_loss 0.999037, train_metric nan, valid_metric 0.039761
[1357640:MainThread](2026-01-11 22:10:34,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.994742, valid_loss 0.998253, train_metric nan, valid_metric 0.043126
[1357640:MainThread](2026-01-11 22:10:34,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998462 to 0.998253, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:34,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.994760, valid_loss 0.997934, train_metric nan, valid_metric 0.042576
[1357640:MainThread](2026-01-11 22:10:34,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998253 to 0.997934, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:35,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.991485, valid_loss 0.998010, train_metric nan, valid_metric 0.044023
[1357640:MainThread](2026-01-11 22:10:35,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.993888, valid_loss 1.001482, train_metric nan, valid_metric 0.041393
[1357640:MainThread](2026-01-11 22:10:36,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.991243, valid_loss 0.999582, train_metric nan, valid_metric 0.034824
[1357640:MainThread](2026-01-11 22:10:36,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.994288, valid_loss 0.998881, train_metric nan, valid_metric 0.039090
[1357640:MainThread](2026-01-11 22:10:37,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.989421, valid_loss 0.998448, train_metric nan, valid_metric 0.041370
[1357640:MainThread](2026-01-11 22:10:38,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.990428, valid_loss 0.998637, train_metric nan, valid_metric 0.042591
[1357640:MainThread](2026-01-11 22:10:38,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.988284, valid_loss 1.000057, train_metric nan, valid_metric 0.034981
[1357640:MainThread](2026-01-11 22:10:39,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.991262, valid_loss 0.998845, train_metric nan, valid_metric 0.035198
[1357640:MainThread](2026-01-11 22:10:39,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.991769, valid_loss 0.998218, train_metric nan, valid_metric 0.036602
[1357640:MainThread](2026-01-11 22:10:40,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.989860, valid_loss 0.998640, train_metric nan, valid_metric 0.035262
[1357640:MainThread](2026-01-11 22:10:41,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.988989, valid_loss 1.000132, train_metric nan, valid_metric 0.029524
[1357640:MainThread](2026-01-11 22:10:41,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.991087, valid_loss 0.998268, train_metric nan, valid_metric 0.040357
[1357640:MainThread](2026-01-11 22:10:42,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.991166, valid_loss 0.998243, train_metric nan, valid_metric 0.041343
[1357640:MainThread](2026-01-11 22:10:42,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.988591, valid_loss 0.997929, train_metric nan, valid_metric 0.044378
[1357640:MainThread](2026-01-11 22:10:42,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997934 to 0.997929, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:43,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.990579, valid_loss 0.997769, train_metric nan, valid_metric 0.041812
[1357640:MainThread](2026-01-11 22:10:43,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997929 to 0.997769, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:43,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.990253, valid_loss 0.998935, train_metric nan, valid_metric 0.041681
[1357640:MainThread](2026-01-11 22:10:44,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.988208, valid_loss 0.997333, train_metric nan, valid_metric 0.041213
[1357640:MainThread](2026-01-11 22:10:44,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997769 to 0.997333, save checkpoint.
[1357640:MainThread](2026-01-11 22:10:44,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.989697, valid_loss 0.998081, train_metric nan, valid_metric 0.038270
[1357640:MainThread](2026-01-11 22:10:45,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.989059, valid_loss 0.999152, train_metric nan, valid_metric 0.037621
[1357640:MainThread](2026-01-11 22:10:45,825) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.991310, valid_loss 0.997697, train_metric nan, valid_metric 0.040461
[1357640:MainThread](2026-01-11 22:10:46,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.990256, valid_loss 0.998884, train_metric nan, valid_metric 0.041276
[1357640:MainThread](2026-01-11 22:10:46,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.987901, valid_loss 0.998541, train_metric nan, valid_metric 0.042068
[1357640:MainThread](2026-01-11 22:10:47,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.987584, valid_loss 0.998229, train_metric nan, valid_metric 0.043247
[1357640:MainThread](2026-01-11 22:10:47,774) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.991034, valid_loss 0.998307, train_metric nan, valid_metric 0.039150
[1357640:MainThread](2026-01-11 22:10:48,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.992340, valid_loss 0.999146, train_metric nan, valid_metric 0.040467
[1357640:MainThread](2026-01-11 22:10:48,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.991938, valid_loss 0.997974, train_metric nan, valid_metric 0.040565
[1357640:MainThread](2026-01-11 22:10:49,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.987226, valid_loss 0.998056, train_metric nan, valid_metric 0.043839
[1357640:MainThread](2026-01-11 22:10:49,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.987929, valid_loss 0.997951, train_metric nan, valid_metric 0.040537
[1357640:MainThread](2026-01-11 22:10:50,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.989617, valid_loss 0.999493, train_metric nan, valid_metric 0.036685
[1357640:MainThread](2026-01-11 22:10:50,720) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.988116, valid_loss 0.998934, train_metric nan, valid_metric 0.042015
[1357640:MainThread](2026-01-11 22:10:51,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.986122, valid_loss 0.998382, train_metric nan, valid_metric 0.039794
[1357640:MainThread](2026-01-11 22:10:51,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.988667, valid_loss 0.998460, train_metric nan, valid_metric 0.042859
[1357640:MainThread](2026-01-11 22:10:51,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.985802, valid_loss 0.998272, train_metric nan, valid_metric 0.041922
[1357640:MainThread](2026-01-11 22:10:52,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.990604, valid_loss 0.999140, train_metric nan, valid_metric 0.035428
[1357640:MainThread](2026-01-11 22:10:52,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.994210, valid_loss 0.998107, train_metric nan, valid_metric 0.040827
[1357640:MainThread](2026-01-11 22:10:53,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.987470, valid_loss 0.999286, train_metric nan, valid_metric 0.038781
[1357640:MainThread](2026-01-11 22:10:53,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.987716, valid_loss 0.998039, train_metric nan, valid_metric 0.039990
[1357640:MainThread](2026-01-11 22:10:54,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.986467, valid_loss 0.998051, train_metric nan, valid_metric 0.041127
[1357640:MainThread](2026-01-11 22:10:54,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.988453, valid_loss 0.998332, train_metric nan, valid_metric 0.040352
[1357640:MainThread](2026-01-11 22:10:55,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.987051, valid_loss 0.998287, train_metric nan, valid_metric 0.040224
[1357640:MainThread](2026-01-11 22:10:55,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.985568, valid_loss 0.998434, train_metric nan, valid_metric 0.042900
[1357640:MainThread](2026-01-11 22:10:56,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.990985, valid_loss 0.997773, train_metric nan, valid_metric 0.042337
[1357640:MainThread](2026-01-11 22:10:56,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.987313, valid_loss 0.998204, train_metric nan, valid_metric 0.042451
[1357640:MainThread](2026-01-11 22:10:57,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.983894, valid_loss 0.998264, train_metric nan, valid_metric 0.040862
[1357640:MainThread](2026-01-11 22:10:57,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.990544, valid_loss 0.998245, train_metric nan, valid_metric 0.041213
[1357640:MainThread](2026-01-11 22:10:58,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.988282, valid_loss 0.998327, train_metric nan, valid_metric 0.038959
[1357640:MainThread](2026-01-11 22:10:58,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.983692, valid_loss 0.998743, train_metric nan, valid_metric 0.040536
[1357640:MainThread](2026-01-11 22:10:59,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.985683, valid_loss 0.998277, train_metric nan, valid_metric 0.041017
[1357640:MainThread](2026-01-11 22:10:59,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.985132, valid_loss 0.998503, train_metric nan, valid_metric 0.038969
[1357640:MainThread](2026-01-11 22:11:00,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.984043, valid_loss 0.998531, train_metric nan, valid_metric 0.041235
[1357640:MainThread](2026-01-11 22:11:00,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.990039, valid_loss 0.998050, train_metric nan, valid_metric 0.041001
[1357640:MainThread](2026-01-11 22:11:01,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.988787, valid_loss 0.998482, train_metric nan, valid_metric 0.041186
[1357640:MainThread](2026-01-11 22:11:02,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.988934, valid_loss 0.998395, train_metric nan, valid_metric 0.040485
[1357640:MainThread](2026-01-11 22:11:02,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.988876, valid_loss 0.998008, train_metric nan, valid_metric 0.040476
[1357640:MainThread](2026-01-11 22:11:03,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.987994, valid_loss 0.998609, train_metric nan, valid_metric 0.040348
[1357640:MainThread](2026-01-11 22:11:03,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.989858, valid_loss 0.998659, train_metric nan, valid_metric 0.038210
[1357640:MainThread](2026-01-11 22:11:04,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.988821, valid_loss 0.998368, train_metric nan, valid_metric 0.041294
[1357640:MainThread](2026-01-11 22:11:04,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.987900, valid_loss 0.998289, train_metric nan, valid_metric 0.040533
[1357640:MainThread](2026-01-11 22:11:05,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.985413, valid_loss 0.998670, train_metric nan, valid_metric 0.040063
[1357640:MainThread](2026-01-11 22:11:05,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.990642, valid_loss 0.998400, train_metric nan, valid_metric 0.041890
[1357640:MainThread](2026-01-11 22:11:06,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.986896, valid_loss 0.998211, train_metric nan, valid_metric 0.040706
[1357640:MainThread](2026-01-11 22:11:06,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.986430, valid_loss 0.998280, train_metric nan, valid_metric 0.040891
[1357640:MainThread](2026-01-11 22:11:07,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.987117, valid_loss 0.998130, train_metric nan, valid_metric 0.041583
[1357640:MainThread](2026-01-11 22:11:07,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.987964, valid_loss 0.998226, train_metric nan, valid_metric 0.041447
[1357640:MainThread](2026-01-11 22:11:08,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.990149, valid_loss 0.998466, train_metric nan, valid_metric 0.041268
[1357640:MainThread](2026-01-11 22:11:08,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.986894, valid_loss 0.998505, train_metric nan, valid_metric 0.040420
[1357640:MainThread](2026-01-11 22:11:09,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.984992, valid_loss 0.998449, train_metric nan, valid_metric 0.039618
[1357640:MainThread](2026-01-11 22:11:09,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:11:09.207 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:11:10.665 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 22:11:10.666 | INFO     | __main__:train_single_fold:593 -   IC=0.0032, ICIR=0.0271, RankIC=0.0204, RankICIR=0.1829
2026-01-11 22:11:10.666 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 22:11:10,674) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:11:42,447) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:11:42,449) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:11:52,151) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f68498ff210>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.33it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 43.60it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 57.08it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 67.02it/s]backtest loop:  14%|█▍        | 35/242 [00:00<00:03, 66.63it/s]backtest loop:  18%|█▊        | 44/242 [00:00<00:02, 69.67it/s]backtest loop:  21%|██▏       | 52/242 [00:00<00:02, 71.25it/s]backtest loop:  25%|██▍       | 60/242 [00:00<00:02, 72.04it/s]backtest loop:  28%|██▊       | 68/242 [00:01<00:02, 66.82it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 72.73it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 69.45it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:02, 72.72it/s]backtest loop:  43%|████▎     | 104/242 [00:01<00:01, 76.37it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 74.15it/s]backtest loop:  50%|████▉     | 120/242 [00:01<00:01, 74.13it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 71.58it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 76.49it/s]backtest loop:  60%|█████▉    | 145/242 [00:02<00:01, 75.53it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 76.14it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 79.91it/s]backtest loop:  71%|███████   | 171/242 [00:02<00:00, 78.38it/s]backtest loop:  74%|███████▍  | 179/242 [00:02<00:00, 77.23it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 74.44it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 76.15it/s]backtest loop:  85%|████████▌ | 206/242 [00:02<00:00, 79.76it/s]backtest loop:  89%|████████▉ | 215/242 [00:02<00:00, 80.40it/s]backtest loop:  93%|█████████▎| 225/242 [00:03<00:00, 84.13it/s]backtest loop:  97%|█████████▋| 234/242 [00:03<00:00, 81.16it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 73.81it/s]
2026-01-11 22:11:55.451 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0049, Sharpe(w/cost)=0.0811, MaxDD=-0.0474
2026-01-11 22:11:59.807 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 22:12:15.505 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:12:15.577 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_7_pred.parquet
2026-01-11 22:12:15.594 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 22:12:15.594 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 22:12:17.112 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0258
2026-01-11 22:12:18.526 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0271
2026-01-11 22:12:19.763 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0270
2026-01-11 22:12:20.867 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0330
2026-01-11 22:12:22.223 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0340
2026-01-11 22:12:23.456 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0363
2026-01-11 22:12:24.732 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0313
2026-01-11 22:12:25.117 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0096, ICIR=0.0792, RankIC=0.0299
[1357640:MainThread](2026-01-11 22:12:25,124) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:12:59,931) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:12:59,932) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:13:09,424) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f684b738090>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 21.37it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 48.80it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 59.48it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 67.73it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 74.43it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 74.27it/s]backtest loop:  22%|██▏       | 54/242 [00:00<00:02, 74.27it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 74.42it/s]backtest loop:  29%|██▉       | 70/242 [00:01<00:02, 73.10it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 73.31it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:02, 72.74it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 74.08it/s]backtest loop:  43%|████▎     | 105/242 [00:01<00:01, 75.75it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 75.36it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 76.78it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 79.51it/s]backtest loop:  58%|█████▊    | 140/242 [00:01<00:01, 76.35it/s]backtest loop:  61%|██████    | 148/242 [00:02<00:01, 75.69it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 76.26it/s]backtest loop:  69%|██████▊   | 166/242 [00:02<00:00, 76.90it/s]backtest loop:  72%|███████▏  | 174/242 [00:02<00:00, 75.83it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 75.66it/s]backtest loop:  79%|███████▉  | 191/242 [00:02<00:00, 78.97it/s]backtest loop:  82%|████████▏ | 199/242 [00:02<00:00, 77.65it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 76.84it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 77.64it/s]backtest loop:  94%|█████████▍| 227/242 [00:03<00:00, 78.44it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 78.43it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.45it/s]
2026-01-11 22:13:12.698 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0166, Sharpe(w/cost)=0.2694
2026-01-11 22:13:12.783 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:13:12.783 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 22:13:12.783 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:13:12.783 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[1357640:MainThread](2026-01-11 22:14:24,376) INFO - qlib.timer - [log.py:127] - Time cost: 71.590s | Loading data Done
[1357640:MainThread](2026-01-11 22:14:24,730) INFO - qlib.timer - [log.py:127] - Time cost: 0.086s | DropCol Done
[1357640:MainThread](2026-01-11 22:14:28,297) INFO - qlib.timer - [log.py:127] - Time cost: 3.564s | RobustZScoreNorm Done
[1357640:MainThread](2026-01-11 22:14:29,825) INFO - qlib.timer - [log.py:127] - Time cost: 1.526s | Fillna Done
[1357640:MainThread](2026-01-11 22:14:30,491) INFO - qlib.timer - [log.py:127] - Time cost: 0.074s | DropCol Done
[1357640:MainThread](2026-01-11 22:14:30,639) INFO - qlib.timer - [log.py:127] - Time cost: 0.147s | DropnaLabel Done
[1357640:MainThread](2026-01-11 22:14:30,854) INFO - qlib.timer - [log.py:127] - Time cost: 0.213s | CSRankNorm Done
[1357640:MainThread](2026-01-11 22:14:30,856) INFO - qlib.timer - [log.py:127] - Time cost: 6.479s | fit & process data Done
[1357640:MainThread](2026-01-11 22:14:30,856) INFO - qlib.timer - [log.py:127] - Time cost: 78.072s | Init data Done
2026-01-11 22:14:30.857 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1357640:MainThread](2026-01-11 22:14:30,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1357640:MainThread](2026-01-11 22:14:30,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 8192
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 157}
[1357640:MainThread](2026-01-11 22:14:30,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=157, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1357640:MainThread](2026-01-11 22:14:30,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0393 MB
2026-01-11 22:14:30.872 | INFO     | __main__:train_single_fold:569 - Training mlp_158_robust model (GPU=0)...
[1357640:MainThread](2026-01-11 22:14:32,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1357640:MainThread](2026-01-11 22:14:33,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.293114, valid_loss 1.096408, train_metric nan, valid_metric -0.015966
[1357640:MainThread](2026-01-11 22:14:33,381) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.096408, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:33,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.100588, valid_loss 1.032332, train_metric nan, valid_metric 0.000282
[1357640:MainThread](2026-01-11 22:14:33,906) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.096408 to 1.032332, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:34,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.067970, valid_loss 1.018738, train_metric nan, valid_metric 0.013500
[1357640:MainThread](2026-01-11 22:14:34,420) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.032332 to 1.018738, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:34,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.053534, valid_loss 1.015640, train_metric nan, valid_metric 0.007632
[1357640:MainThread](2026-01-11 22:14:34,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018738 to 1.015640, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:35,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.040203, valid_loss 1.008260, train_metric nan, valid_metric 0.020432
[1357640:MainThread](2026-01-11 22:14:35,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.015640 to 1.008260, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:36,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.037958, valid_loss 1.005719, train_metric nan, valid_metric 0.026530
[1357640:MainThread](2026-01-11 22:14:36,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008260 to 1.005719, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:36,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.029668, valid_loss 1.007290, train_metric nan, valid_metric 0.014439
[1357640:MainThread](2026-01-11 22:14:37,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.027110, valid_loss 1.004468, train_metric nan, valid_metric 0.022658
[1357640:MainThread](2026-01-11 22:14:37,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005719 to 1.004468, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:37,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.022097, valid_loss 1.006146, train_metric nan, valid_metric 0.017561
[1357640:MainThread](2026-01-11 22:14:38,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.018373, valid_loss 1.002984, train_metric nan, valid_metric 0.030160
[1357640:MainThread](2026-01-11 22:14:38,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004468 to 1.002984, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:38,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.013658, valid_loss 1.001980, train_metric nan, valid_metric 0.022250
[1357640:MainThread](2026-01-11 22:14:38,876) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002984 to 1.001980, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:39,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.014643, valid_loss 1.000906, train_metric nan, valid_metric 0.032750
[1357640:MainThread](2026-01-11 22:14:39,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001980 to 1.000906, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:40,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.010822, valid_loss 1.000118, train_metric nan, valid_metric 0.030190
[1357640:MainThread](2026-01-11 22:14:40,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000906 to 1.000118, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:40,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.008903, valid_loss 1.003429, train_metric nan, valid_metric 0.019797
[1357640:MainThread](2026-01-11 22:14:41,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.014099, valid_loss 1.001321, train_metric nan, valid_metric 0.022665
[1357640:MainThread](2026-01-11 22:14:41,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.007210, valid_loss 0.999423, train_metric nan, valid_metric 0.039256
[1357640:MainThread](2026-01-11 22:14:41,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000118 to 0.999423, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:42,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.004655, valid_loss 0.999745, train_metric nan, valid_metric 0.030930
[1357640:MainThread](2026-01-11 22:14:42,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.005443, valid_loss 1.000311, train_metric nan, valid_metric 0.033047
[1357640:MainThread](2026-01-11 22:14:43,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 0.999582, valid_loss 1.000463, train_metric nan, valid_metric 0.027879
[1357640:MainThread](2026-01-11 22:14:43,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.003835, valid_loss 0.999616, train_metric nan, valid_metric 0.030389
[1357640:MainThread](2026-01-11 22:14:44,315) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.000956, valid_loss 0.999165, train_metric nan, valid_metric 0.032795
[1357640:MainThread](2026-01-11 22:14:44,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999423 to 0.999165, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:44,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.003126, valid_loss 0.999236, train_metric nan, valid_metric 0.035489
[1357640:MainThread](2026-01-11 22:14:45,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 0.997799, valid_loss 0.998687, train_metric nan, valid_metric 0.038466
[1357640:MainThread](2026-01-11 22:14:45,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999165 to 0.998687, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:45,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.997246, valid_loss 0.998685, train_metric nan, valid_metric 0.041491
[1357640:MainThread](2026-01-11 22:14:45,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998687 to 0.998685, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:46,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 0.999373, valid_loss 0.998297, train_metric nan, valid_metric 0.039349
[1357640:MainThread](2026-01-11 22:14:46,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998685 to 0.998297, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:46,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.996078, valid_loss 0.998929, train_metric nan, valid_metric 0.033392
[1357640:MainThread](2026-01-11 22:14:47,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.997609, valid_loss 0.998770, train_metric nan, valid_metric 0.028150
[1357640:MainThread](2026-01-11 22:14:48,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.995408, valid_loss 0.998338, train_metric nan, valid_metric 0.032227
[1357640:MainThread](2026-01-11 22:14:48,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.996337, valid_loss 0.998718, train_metric nan, valid_metric 0.033197
[1357640:MainThread](2026-01-11 22:14:49,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.996781, valid_loss 0.997435, train_metric nan, valid_metric 0.040975
[1357640:MainThread](2026-01-11 22:14:49,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998297 to 0.997435, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:49,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.992845, valid_loss 0.998354, train_metric nan, valid_metric 0.037833
[1357640:MainThread](2026-01-11 22:14:50,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.994213, valid_loss 1.002147, train_metric nan, valid_metric 0.029028
[1357640:MainThread](2026-01-11 22:14:50,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.996817, valid_loss 0.999789, train_metric nan, valid_metric 0.034694
[1357640:MainThread](2026-01-11 22:14:51,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.992896, valid_loss 0.998474, train_metric nan, valid_metric 0.041449
[1357640:MainThread](2026-01-11 22:14:51,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.993256, valid_loss 0.997560, train_metric nan, valid_metric 0.036877
[1357640:MainThread](2026-01-11 22:14:52,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.993566, valid_loss 0.998816, train_metric nan, valid_metric 0.037713
[1357640:MainThread](2026-01-11 22:14:53,068) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.993863, valid_loss 0.997426, train_metric nan, valid_metric 0.042885
[1357640:MainThread](2026-01-11 22:14:53,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997435 to 0.997426, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:53,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.990705, valid_loss 0.997627, train_metric nan, valid_metric 0.040173
[1357640:MainThread](2026-01-11 22:14:54,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.990419, valid_loss 0.997992, train_metric nan, valid_metric 0.036296
[1357640:MainThread](2026-01-11 22:14:54,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.995302, valid_loss 0.998667, train_metric nan, valid_metric 0.038567
[1357640:MainThread](2026-01-11 22:14:55,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.991188, valid_loss 0.998326, train_metric nan, valid_metric 0.041092
[1357640:MainThread](2026-01-11 22:14:55,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.992769, valid_loss 0.998891, train_metric nan, valid_metric 0.032242
[1357640:MainThread](2026-01-11 22:14:56,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.993656, valid_loss 0.997442, train_metric nan, valid_metric 0.036483
[1357640:MainThread](2026-01-11 22:14:56,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.990948, valid_loss 0.997600, train_metric nan, valid_metric 0.040016
[1357640:MainThread](2026-01-11 22:14:57,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.990670, valid_loss 0.997712, train_metric nan, valid_metric 0.042669
[1357640:MainThread](2026-01-11 22:14:58,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.993606, valid_loss 0.997420, train_metric nan, valid_metric 0.040578
[1357640:MainThread](2026-01-11 22:14:58,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997426 to 0.997420, save checkpoint.
[1357640:MainThread](2026-01-11 22:14:58,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.992341, valid_loss 0.998154, train_metric nan, valid_metric 0.038206
[1357640:MainThread](2026-01-11 22:14:59,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.992409, valid_loss 0.998570, train_metric nan, valid_metric 0.034187
[1357640:MainThread](2026-01-11 22:14:59,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.991321, valid_loss 0.997791, train_metric nan, valid_metric 0.039398
[1357640:MainThread](2026-01-11 22:14:59,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.993296, valid_loss 0.997244, train_metric nan, valid_metric 0.037399
[1357640:MainThread](2026-01-11 22:14:59,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997420 to 0.997244, save checkpoint.
[1357640:MainThread](2026-01-11 22:15:00,395) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.987725, valid_loss 0.998335, train_metric nan, valid_metric 0.040551
[1357640:MainThread](2026-01-11 22:15:00,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.992371, valid_loss 0.999116, train_metric nan, valid_metric 0.035971
[1357640:MainThread](2026-01-11 22:15:01,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.991585, valid_loss 0.998979, train_metric nan, valid_metric 0.037688
[1357640:MainThread](2026-01-11 22:15:01,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.990264, valid_loss 0.997619, train_metric nan, valid_metric 0.039656
[1357640:MainThread](2026-01-11 22:15:02,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.991503, valid_loss 0.998241, train_metric nan, valid_metric 0.037453
[1357640:MainThread](2026-01-11 22:15:03,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.986193, valid_loss 0.999587, train_metric nan, valid_metric 0.040548
[1357640:MainThread](2026-01-11 22:15:03,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.986021, valid_loss 0.997882, train_metric nan, valid_metric 0.034990
[1357640:MainThread](2026-01-11 22:15:04,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.991228, valid_loss 0.998664, train_metric nan, valid_metric 0.034636
[1357640:MainThread](2026-01-11 22:15:04,680) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.993231, valid_loss 0.997751, train_metric nan, valid_metric 0.043943
[1357640:MainThread](2026-01-11 22:15:05,199) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.991309, valid_loss 0.997914, train_metric nan, valid_metric 0.036205
[1357640:MainThread](2026-01-11 22:15:05,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.988618, valid_loss 0.998123, train_metric nan, valid_metric 0.032010
[1357640:MainThread](2026-01-11 22:15:06,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.990321, valid_loss 0.997955, train_metric nan, valid_metric 0.036805
[1357640:MainThread](2026-01-11 22:15:06,838) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.984897, valid_loss 0.997621, train_metric nan, valid_metric 0.040327
[1357640:MainThread](2026-01-11 22:15:07,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.989828, valid_loss 0.998352, train_metric nan, valid_metric 0.034890
[1357640:MainThread](2026-01-11 22:15:07,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.986691, valid_loss 0.998667, train_metric nan, valid_metric 0.036414
[1357640:MainThread](2026-01-11 22:15:08,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.990676, valid_loss 0.998254, train_metric nan, valid_metric 0.033968
[1357640:MainThread](2026-01-11 22:15:08,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.986337, valid_loss 0.997694, train_metric nan, valid_metric 0.041120
[1357640:MainThread](2026-01-11 22:15:09,502) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.987390, valid_loss 0.997714, train_metric nan, valid_metric 0.037364
[1357640:MainThread](2026-01-11 22:15:10,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.989310, valid_loss 0.997476, train_metric nan, valid_metric 0.039326
[1357640:MainThread](2026-01-11 22:15:10,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.990057, valid_loss 0.998452, train_metric nan, valid_metric 0.037486
[1357640:MainThread](2026-01-11 22:15:11,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.989111, valid_loss 0.997851, train_metric nan, valid_metric 0.037283
[1357640:MainThread](2026-01-11 22:15:11,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.988336, valid_loss 0.998127, train_metric nan, valid_metric 0.035645
[1357640:MainThread](2026-01-11 22:15:12,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.985596, valid_loss 0.997909, train_metric nan, valid_metric 0.038311
[1357640:MainThread](2026-01-11 22:15:12,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.989351, valid_loss 0.998038, train_metric nan, valid_metric 0.037116
[1357640:MainThread](2026-01-11 22:15:13,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.988731, valid_loss 0.998148, train_metric nan, valid_metric 0.037366
[1357640:MainThread](2026-01-11 22:15:13,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.986211, valid_loss 0.998302, train_metric nan, valid_metric 0.038017
[1357640:MainThread](2026-01-11 22:15:14,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.988756, valid_loss 0.998536, train_metric nan, valid_metric 0.038468
[1357640:MainThread](2026-01-11 22:15:14,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.989375, valid_loss 0.998071, train_metric nan, valid_metric 0.034233
[1357640:MainThread](2026-01-11 22:15:15,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.983288, valid_loss 0.998232, train_metric nan, valid_metric 0.037701
[1357640:MainThread](2026-01-11 22:15:16,072) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.984226, valid_loss 0.997631, train_metric nan, valid_metric 0.039297
[1357640:MainThread](2026-01-11 22:15:16,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.990012, valid_loss 0.998078, train_metric nan, valid_metric 0.036760
[1357640:MainThread](2026-01-11 22:15:17,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.988149, valid_loss 0.998345, train_metric nan, valid_metric 0.039714
[1357640:MainThread](2026-01-11 22:15:17,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.987150, valid_loss 0.997957, train_metric nan, valid_metric 0.040410
[1357640:MainThread](2026-01-11 22:15:18,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.992104, valid_loss 0.997818, train_metric nan, valid_metric 0.040454
[1357640:MainThread](2026-01-11 22:15:18,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.988696, valid_loss 0.997924, train_metric nan, valid_metric 0.039025
[1357640:MainThread](2026-01-11 22:15:19,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.987506, valid_loss 0.998253, train_metric nan, valid_metric 0.038080
[1357640:MainThread](2026-01-11 22:15:19,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.992130, valid_loss 0.997949, train_metric nan, valid_metric 0.040676
[1357640:MainThread](2026-01-11 22:15:20,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.989098, valid_loss 0.997859, train_metric nan, valid_metric 0.039052
[1357640:MainThread](2026-01-11 22:15:21,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.985944, valid_loss 0.998166, train_metric nan, valid_metric 0.037240
[1357640:MainThread](2026-01-11 22:15:21,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.983322, valid_loss 0.998417, train_metric nan, valid_metric 0.038398
[1357640:MainThread](2026-01-11 22:15:22,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.991950, valid_loss 0.998365, train_metric nan, valid_metric 0.036804
[1357640:MainThread](2026-01-11 22:15:22,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.990184, valid_loss 0.997890, train_metric nan, valid_metric 0.038929
[1357640:MainThread](2026-01-11 22:15:23,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.985402, valid_loss 0.998355, train_metric nan, valid_metric 0.037123
[1357640:MainThread](2026-01-11 22:15:23,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.987837, valid_loss 0.997756, train_metric nan, valid_metric 0.038711
[1357640:MainThread](2026-01-11 22:15:24,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.987724, valid_loss 0.998310, train_metric nan, valid_metric 0.037253
[1357640:MainThread](2026-01-11 22:15:24,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.986195, valid_loss 0.998249, train_metric nan, valid_metric 0.036727
[1357640:MainThread](2026-01-11 22:15:25,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.987885, valid_loss 0.997903, train_metric nan, valid_metric 0.038379
[1357640:MainThread](2026-01-11 22:15:25,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.990223, valid_loss 0.998107, train_metric nan, valid_metric 0.038519
[1357640:MainThread](2026-01-11 22:15:26,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.991858, valid_loss 0.998147, train_metric nan, valid_metric 0.037736
[1357640:MainThread](2026-01-11 22:15:26,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.989117, valid_loss 0.998312, train_metric nan, valid_metric 0.036768
[1357640:MainThread](2026-01-11 22:15:26,820) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:15:26.840 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:15:28.271 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 22:15:28.271 | INFO     | __main__:train_single_fold:593 -   IC=0.0202, ICIR=0.1271, RankIC=0.0398, RankICIR=0.2445
2026-01-11 22:15:28.271 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1357640:MainThread](2026-01-11 22:15:28,278) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:16:03,519) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:16:03,521) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:16:13,796) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f69947b4190>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.09it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 47.18it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.82it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 66.67it/s]backtest loop:  15%|█▌        | 37/242 [00:00<00:02, 74.21it/s]backtest loop:  19%|█▊        | 45/242 [00:00<00:02, 73.81it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 73.75it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 73.67it/s]backtest loop:  29%|██▉       | 70/242 [00:00<00:02, 78.26it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 73.42it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:01, 77.84it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 76.57it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 75.38it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 75.65it/s]backtest loop:  50%|█████     | 121/242 [00:01<00:01, 79.54it/s]backtest loop:  54%|█████▎    | 130/242 [00:01<00:01, 78.41it/s]backtest loop:  57%|█████▋    | 138/242 [00:01<00:01, 76.74it/s]backtest loop:  61%|██████    | 147/242 [00:02<00:01, 76.67it/s]backtest loop:  64%|██████▍   | 156/242 [00:02<00:01, 80.16it/s]backtest loop:  68%|██████▊   | 165/242 [00:02<00:00, 80.26it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 80.67it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 82.56it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 85.81it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 88.97it/s]backtest loop:  89%|████████▉ | 215/242 [00:02<00:00, 90.81it/s]backtest loop:  93%|█████████▎| 225/242 [00:02<00:00, 91.82it/s]backtest loop:  97%|█████████▋| 235/242 [00:02<00:00, 93.09it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 78.99it/s]
2026-01-11 22:16:16.882 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0400, Sharpe(w/cost)=0.4309, MaxDD=-0.1439
2026-01-11 22:16:20.878 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 22:16:46.307 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:16:46.382 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/fold_8_pred.parquet
2026-01-11 22:16:46.400 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 22:16:46.400 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 22:16:47.835 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0346
2026-01-11 22:16:48.803 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0326
2026-01-11 22:16:49.983 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0266
2026-01-11 22:16:51.188 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0325
2026-01-11 22:16:52.477 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0375
2026-01-11 22:16:53.803 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0316
2026-01-11 22:16:55.008 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0398
2026-01-11 22:16:56.213 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0343
2026-01-11 22:16:56.619 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0234, ICIR=0.1448, RankIC=0.0422
[1357640:MainThread](2026-01-11 22:16:56,625) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1357640:MainThread](2026-01-11 22:17:30,153) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:17:30,154) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:17:39,985) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f6a34cbfc90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 21.11it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 45.31it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.61it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 74.20it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 81.49it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 86.27it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 89.58it/s]backtest loop:  29%|██▊       | 69/242 [00:00<00:01, 91.62it/s]backtest loop:  33%|███▎      | 79/242 [00:00<00:01, 89.24it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:01, 91.12it/s]backtest loop:  41%|████      | 99/242 [00:01<00:01, 92.48it/s]backtest loop:  45%|████▌     | 109/242 [00:01<00:01, 93.72it/s]backtest loop:  49%|████▉     | 119/242 [00:01<00:01, 93.19it/s]backtest loop:  53%|█████▎    | 129/242 [00:01<00:01, 91.25it/s]backtest loop:  57%|█████▋    | 139/242 [00:01<00:01, 86.98it/s]backtest loop:  61%|██████    | 148/242 [00:01<00:01, 84.90it/s]backtest loop:  65%|██████▍   | 157/242 [00:01<00:01, 82.87it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 82.35it/s]backtest loop:  73%|███████▎  | 176/242 [00:02<00:00, 81.08it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 77.00it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 78.39it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 79.64it/s]backtest loop:  89%|████████▉ | 215/242 [00:02<00:00, 80.10it/s]backtest loop:  93%|█████████▎| 225/242 [00:02<00:00, 80.47it/s]backtest loop:  97%|█████████▋| 235/242 [00:02<00:00, 80.39it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 81.64it/s]
2026-01-11 22:17:42.973 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0489, Sharpe(w/cost)=0.4800
2026-01-11 22:17:43.035 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 22:17:43.035 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 22:17:43.035 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 22:17:43.042 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 22:17:43.042 | INFO     | __main__:_print_summary:827 -   IC: 0.0314
2026-01-11 22:17:43.042 | INFO     | __main__:_print_summary:828 -   ICIR: 0.2976
2026-01-11 22:17:43.042 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0475
2026-01-11 22:17:43.042 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0865
2026-01-11 22:17:43.042 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.9822
2026-01-11 22:17:43.043 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0452
2026-01-11 22:17:43.046 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/summary.csv
2026-01-11 22:17:43.046 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 22:17:43.046 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 22:17:43.046 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 22:17:43.046 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 22:17:43.049 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 22:17:43.049 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0475
2026-01-11 22:17:43.049 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0370
2026-01-11 22:17:43.049 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0370)
2026-01-11 22:17:43.050 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 22:17:43.050 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/ensemble_matrix.csv
2026-01-11 22:17:43.050 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 22:17:43.050 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 22:17:43.050 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 22:17:43.177 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 22:17:43.177 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 22:17:45.078 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0314, ICIR=0.2771, RankIC=0.0476
[1357640:MainThread](2026-01-11 22:17:45,088) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.077742 0.707507 0.102215  0.409185  3.932686 -0.032167         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.055208 0.509323 0.070678  0.079246  1.515995 -0.051494    0.073655    1.963428
    2 2018-01-01 ~ 2018-12-31 0.039816 0.444801 0.042128  0.020231  0.313992 -0.065980    0.048420    0.162179
    3 2019-01-01 ~ 2019-12-31 0.021608 0.226072 0.039681 -0.110709 -1.770645 -0.136881    0.045403   -1.195861
    4 2020-01-01 ~ 2020-12-31 0.031703 0.306144 0.044575 -0.013506 -0.161288 -0.106577    0.048556   -0.281597
    5 2021-01-01 ~ 2021-12-31 0.007650 0.072106 0.024925  0.166061  1.750818 -0.051468    0.027829    1.097278
    6 2022-01-01 ~ 2022-12-31 0.025271 0.258596 0.043226  0.182920  2.746033 -0.027469    0.045297    2.293839
    7 2023-01-01 ~ 2023-12-31 0.003215 0.027081 0.020369  0.004878  0.081109 -0.047432    0.029941    0.269378
    8 2024-01-01 ~ 2024-12-31 0.020200 0.127127 0.039778  0.039968  0.430862 -0.143892    0.042237    0.480023

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.1022     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0715  0.0707     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0523  0.0485  0.0421     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0437  0.0518  0.0445  0.0397     NaN     NaN     NaN     NaN     NaN
T4  0.0412  0.0450  0.0471  0.0455  0.0446     NaN     NaN     NaN     NaN
T5  0.0247  0.0256  0.0277  0.0249  0.0248  0.0249     NaN     NaN     NaN
T6  0.0371  0.0382  0.0385  0.0360  0.0398  0.0406  0.0432     NaN     NaN
T7  0.0258  0.0271  0.0270  0.0330  0.0340  0.0363  0.0313  0.0204     NaN
T8  0.0346  0.0326  0.0266  0.0325  0.0375  0.0316  0.0398  0.0343  0.0398
[1357640:MainThread](2026-01-11 22:18:22,158) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:18:22,161) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1357640:MainThread](2026-01-11 22:19:20,625) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f683bacf7d0>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 4/2187 [00:00<00:57, 37.68it/s]backtest loop:   1%|          | 14/2187 [00:00<00:30, 71.81it/s]backtest loop:   1%|          | 24/2187 [00:00<00:25, 84.02it/s]backtest loop:   2%|▏         | 33/2187 [00:00<00:26, 82.68it/s]backtest loop:   2%|▏         | 43/2187 [00:00<00:24, 86.51it/s]backtest loop:   2%|▏         | 52/2187 [00:00<00:25, 84.87it/s]backtest loop:   3%|▎         | 61/2187 [00:00<00:25, 84.39it/s]backtest loop:   3%|▎         | 70/2187 [00:00<00:25, 82.32it/s]backtest loop:   4%|▎         | 79/2187 [00:00<00:25, 82.10it/s]backtest loop:   4%|▍         | 88/2187 [00:01<00:26, 80.41it/s]backtest loop:   4%|▍         | 98/2187 [00:01<00:26, 79.62it/s]backtest loop:   5%|▍         | 106/2187 [00:01<00:26, 78.78it/s]backtest loop:   5%|▌         | 116/2187 [00:01<00:25, 79.96it/s]backtest loop:   6%|▌         | 126/2187 [00:01<00:25, 80.68it/s]backtest loop:   6%|▌         | 136/2187 [00:01<00:25, 81.71it/s]backtest loop:   7%|▋         | 146/2187 [00:01<00:24, 83.27it/s]backtest loop:   7%|▋         | 156/2187 [00:01<00:24, 82.89it/s]backtest loop:   8%|▊         | 166/2187 [00:02<00:24, 83.54it/s]backtest loop:   8%|▊         | 175/2187 [00:02<00:24, 82.06it/s]backtest loop:   8%|▊         | 184/2187 [00:02<00:24, 82.32it/s]backtest loop:   9%|▉         | 194/2187 [00:02<00:24, 81.60it/s]backtest loop:   9%|▉         | 204/2187 [00:02<00:24, 80.51it/s]backtest loop:  10%|▉         | 214/2187 [00:02<00:24, 80.33it/s]backtest loop:  10%|█         | 224/2187 [00:02<00:24, 81.73it/s]backtest loop:  11%|█         | 234/2187 [00:02<00:23, 82.73it/s]backtest loop:  11%|█         | 244/2187 [00:02<00:23, 84.24it/s]backtest loop:  12%|█▏        | 253/2187 [00:03<00:22, 85.15it/s]backtest loop:  12%|█▏        | 262/2187 [00:03<00:22, 84.39it/s]backtest loop:  12%|█▏        | 272/2187 [00:03<00:21, 88.30it/s]backtest loop:  13%|█▎        | 281/2187 [00:03<00:21, 88.54it/s]backtest loop:  13%|█▎        | 291/2187 [00:03<00:20, 90.81it/s]backtest loop:  14%|█▍        | 301/2187 [00:03<00:20, 91.55it/s]backtest loop:  14%|█▍        | 311/2187 [00:03<00:21, 87.35it/s]backtest loop:  15%|█▍        | 321/2187 [00:03<00:21, 87.54it/s]backtest loop:  15%|█▌        | 330/2187 [00:03<00:21, 85.82it/s]backtest loop:  16%|█▌        | 340/2187 [00:04<00:21, 86.98it/s]backtest loop:  16%|█▌        | 349/2187 [00:04<00:21, 85.90it/s]backtest loop:  16%|█▋        | 358/2187 [00:04<00:21, 85.78it/s]backtest loop:  17%|█▋        | 368/2187 [00:04<00:21, 85.33it/s]backtest loop:  17%|█▋        | 378/2187 [00:04<00:21, 84.29it/s]backtest loop:  18%|█▊        | 388/2187 [00:04<00:21, 84.07it/s]backtest loop:  18%|█▊        | 398/2187 [00:04<00:21, 83.44it/s]backtest loop:  19%|█▊        | 408/2187 [00:04<00:21, 83.17it/s]backtest loop:  19%|█▉        | 418/2187 [00:05<00:21, 83.57it/s]backtest loop:  20%|█▉        | 428/2187 [00:05<00:20, 83.85it/s]backtest loop:  20%|██        | 438/2187 [00:05<00:21, 83.19it/s]backtest loop:  20%|██        | 448/2187 [00:05<00:20, 84.31it/s]backtest loop:  21%|██        | 458/2187 [00:05<00:20, 85.97it/s]backtest loop:  21%|██▏       | 468/2187 [00:05<00:19, 87.33it/s]backtest loop:  22%|██▏       | 478/2187 [00:05<00:19, 87.95it/s]backtest loop:  22%|██▏       | 488/2187 [00:05<00:18, 90.46it/s]backtest loop:  23%|██▎       | 498/2187 [00:05<00:19, 88.71it/s]backtest loop:  23%|██▎       | 507/2187 [00:06<00:18, 88.62it/s]backtest loop:  24%|██▎       | 517/2187 [00:06<00:18, 88.82it/s]backtest loop:  24%|██▍       | 526/2187 [00:06<00:19, 87.19it/s]backtest loop:  24%|██▍       | 535/2187 [00:06<00:19, 84.23it/s]backtest loop:  25%|██▍       | 544/2187 [00:06<00:19, 82.39it/s]backtest loop:  25%|██▌       | 553/2187 [00:06<00:19, 81.82it/s]backtest loop:  26%|██▌       | 562/2187 [00:06<00:20, 80.09it/s]backtest loop:  26%|██▌       | 571/2187 [00:06<00:20, 78.95it/s]backtest loop:  26%|██▋       | 579/2187 [00:06<00:20, 77.27it/s]backtest loop:  27%|██▋       | 588/2187 [00:07<00:20, 77.29it/s]backtest loop:  27%|██▋       | 598/2187 [00:07<00:20, 78.05it/s]backtest loop:  28%|██▊       | 607/2187 [00:07<00:20, 77.56it/s]backtest loop:  28%|██▊       | 616/2187 [00:07<00:19, 80.76it/s]backtest loop:  29%|██▊       | 625/2187 [00:07<00:19, 79.09it/s]backtest loop:  29%|██▉       | 633/2187 [00:07<00:19, 77.83it/s]backtest loop:  29%|██▉       | 642/2187 [00:07<00:19, 77.74it/s]backtest loop:  30%|██▉       | 652/2187 [00:07<00:19, 77.77it/s]backtest loop:  30%|███       | 662/2187 [00:07<00:19, 79.02it/s]backtest loop:  31%|███       | 671/2187 [00:08<00:19, 78.89it/s]backtest loop:  31%|███       | 681/2187 [00:08<00:18, 80.67it/s]backtest loop:  32%|███▏      | 691/2187 [00:08<00:18, 80.02it/s]backtest loop:  32%|███▏      | 701/2187 [00:08<00:18, 79.64it/s]backtest loop:  33%|███▎      | 711/2187 [00:08<00:18, 78.90it/s]backtest loop:  33%|███▎      | 720/2187 [00:08<00:18, 80.70it/s]backtest loop:  33%|███▎      | 729/2187 [00:08<00:18, 79.33it/s]backtest loop:  34%|███▎      | 737/2187 [00:08<00:18, 78.69it/s]backtest loop:  34%|███▍      | 745/2187 [00:09<00:18, 78.55it/s]backtest loop:  34%|███▍      | 754/2187 [00:09<00:18, 78.65it/s]backtest loop:  35%|███▍      | 764/2187 [00:09<00:17, 79.99it/s]backtest loop:  35%|███▌      | 774/2187 [00:09<00:17, 82.01it/s]backtest loop:  36%|███▌      | 784/2187 [00:09<00:17, 82.30it/s]backtest loop:  36%|███▋      | 793/2187 [00:09<00:17, 81.15it/s]backtest loop:  37%|███▋      | 803/2187 [00:09<00:16, 81.77it/s]backtest loop:  37%|███▋      | 812/2187 [00:09<00:16, 81.45it/s]backtest loop:  38%|███▊      | 821/2187 [00:09<00:16, 80.77it/s]backtest loop:  38%|███▊      | 830/2187 [00:10<00:16, 80.83it/s]backtest loop:  38%|███▊      | 839/2187 [00:10<00:16, 81.24it/s]backtest loop:  39%|███▉      | 849/2187 [00:10<00:16, 82.03it/s]backtest loop:  39%|███▉      | 859/2187 [00:10<00:16, 82.28it/s]backtest loop:  40%|███▉      | 869/2187 [00:10<00:15, 82.99it/s]backtest loop:  40%|████      | 879/2187 [00:10<00:15, 82.94it/s]backtest loop:  41%|████      | 889/2187 [00:10<00:15, 82.84it/s]backtest loop:  41%|████      | 899/2187 [00:10<00:15, 83.16it/s]backtest loop:  42%|████▏     | 908/2187 [00:11<00:15, 82.35it/s]backtest loop:  42%|████▏     | 917/2187 [00:11<00:15, 81.57it/s]backtest loop:  42%|████▏     | 926/2187 [00:11<00:15, 81.38it/s]backtest loop:  43%|████▎     | 935/2187 [00:11<00:15, 81.18it/s]backtest loop:  43%|████▎     | 944/2187 [00:11<00:15, 80.86it/s]backtest loop:  44%|████▎     | 953/2187 [00:11<00:15, 80.41it/s]backtest loop:  44%|████▍     | 963/2187 [00:11<00:15, 81.23it/s]backtest loop:  44%|████▍     | 973/2187 [00:11<00:14, 81.23it/s]backtest loop:  45%|████▍     | 982/2187 [00:11<00:15, 76.86it/s]backtest loop:  45%|████▌     | 991/2187 [00:12<00:15, 77.67it/s]backtest loop:  46%|████▌     | 1001/2187 [00:12<00:14, 79.25it/s]backtest loop:  46%|████▌     | 1011/2187 [00:12<00:14, 80.45it/s]backtest loop:  47%|████▋     | 1021/2187 [00:12<00:14, 81.31it/s]backtest loop:  47%|████▋     | 1031/2187 [00:12<00:14, 81.83it/s]backtest loop:  48%|████▊     | 1040/2187 [00:12<00:14, 81.30it/s]backtest loop:  48%|████▊     | 1050/2187 [00:12<00:13, 81.64it/s]backtest loop:  48%|████▊     | 1059/2187 [00:12<00:13, 81.15it/s]backtest loop:  49%|████▉     | 1068/2187 [00:13<00:13, 80.52it/s]backtest loop:  49%|████▉     | 1077/2187 [00:13<00:13, 81.08it/s]backtest loop:  50%|████▉     | 1087/2187 [00:13<00:13, 81.59it/s]backtest loop:  50%|█████     | 1096/2187 [00:13<00:13, 80.91it/s]backtest loop:  51%|█████     | 1105/2187 [00:13<00:13, 80.83it/s]backtest loop:  51%|█████     | 1115/2187 [00:13<00:13, 81.69it/s]backtest loop:  51%|█████▏    | 1125/2187 [00:13<00:12, 82.54it/s]backtest loop:  52%|█████▏    | 1135/2187 [00:13<00:12, 82.33it/s]backtest loop:  52%|█████▏    | 1145/2187 [00:13<00:12, 82.87it/s]backtest loop:  53%|█████▎    | 1155/2187 [00:14<00:12, 82.76it/s]backtest loop:  53%|█████▎    | 1164/2187 [00:14<00:13, 77.70it/s]backtest loop:  54%|█████▎    | 1174/2187 [00:14<00:12, 79.22it/s]backtest loop:  54%|█████▍    | 1184/2187 [00:14<00:12, 80.30it/s]backtest loop:  55%|█████▍    | 1194/2187 [00:14<00:12, 80.85it/s]backtest loop:  55%|█████▌    | 1204/2187 [00:14<00:12, 80.89it/s]backtest loop:  56%|█████▌    | 1214/2187 [00:14<00:11, 81.39it/s]backtest loop:  56%|█████▌    | 1223/2187 [00:14<00:11, 80.76it/s]backtest loop:  56%|█████▋    | 1233/2187 [00:15<00:11, 81.12it/s]backtest loop:  57%|█████▋    | 1243/2187 [00:15<00:11, 81.52it/s]backtest loop:  57%|█████▋    | 1252/2187 [00:15<00:11, 81.82it/s]backtest loop:  58%|█████▊    | 1261/2187 [00:15<00:11, 81.20it/s]backtest loop:  58%|█████▊    | 1270/2187 [00:15<00:11, 81.46it/s]backtest loop:  58%|█████▊    | 1279/2187 [00:15<00:11, 80.25it/s]backtest loop:  59%|█████▉    | 1288/2187 [00:15<00:11, 79.31it/s]backtest loop:  59%|█████▉    | 1297/2187 [00:15<00:11, 78.82it/s]backtest loop:  60%|█████▉    | 1305/2187 [00:15<00:11, 77.40it/s]backtest loop:  60%|██████    | 1314/2187 [00:16<00:11, 77.70it/s]backtest loop:  61%|██████    | 1324/2187 [00:16<00:11, 78.39it/s]backtest loop:  61%|██████    | 1333/2187 [00:16<00:10, 77.86it/s]backtest loop:  61%|██████▏   | 1343/2187 [00:16<00:10, 78.65it/s]backtest loop:  62%|██████▏   | 1353/2187 [00:16<00:10, 78.98it/s]backtest loop:  62%|██████▏   | 1363/2187 [00:16<00:10, 79.32it/s]backtest loop:  63%|██████▎   | 1373/2187 [00:16<00:10, 79.25it/s]backtest loop:  63%|██████▎   | 1383/2187 [00:16<00:10, 79.48it/s]backtest loop:  64%|██████▎   | 1393/2187 [00:17<00:09, 80.00it/s]backtest loop:  64%|██████▍   | 1401/2187 [00:17<00:10, 75.69it/s]backtest loop:  65%|██████▍   | 1411/2187 [00:17<00:10, 77.16it/s]backtest loop:  65%|██████▍   | 1420/2187 [00:17<00:09, 79.95it/s]backtest loop:  65%|██████▌   | 1429/2187 [00:17<00:09, 79.13it/s]backtest loop:  66%|██████▌   | 1437/2187 [00:17<00:09, 77.73it/s]backtest loop:  66%|██████▌   | 1446/2187 [00:17<00:09, 77.81it/s]backtest loop:  67%|██████▋   | 1456/2187 [00:17<00:09, 78.76it/s]backtest loop:  67%|██████▋   | 1465/2187 [00:17<00:09, 78.52it/s]backtest loop:  67%|██████▋   | 1475/2187 [00:18<00:08, 79.28it/s]backtest loop:  68%|██████▊   | 1485/2187 [00:18<00:08, 79.65it/s]backtest loop:  68%|██████▊   | 1495/2187 [00:18<00:08, 79.90it/s]backtest loop:  69%|██████▉   | 1505/2187 [00:18<00:08, 80.00it/s]backtest loop:  69%|██████▉   | 1515/2187 [00:18<00:08, 80.13it/s]backtest loop:  70%|██████▉   | 1524/2187 [00:18<00:08, 79.11it/s]backtest loop:  70%|███████   | 1533/2187 [00:18<00:08, 78.81it/s]backtest loop:  70%|███████   | 1541/2187 [00:18<00:08, 76.47it/s]backtest loop:  71%|███████   | 1550/2187 [00:19<00:08, 76.36it/s]backtest loop:  71%|███████▏  | 1559/2187 [00:19<00:08, 76.93it/s]backtest loop:  72%|███████▏  | 1569/2187 [00:19<00:07, 78.13it/s]backtest loop:  72%|███████▏  | 1579/2187 [00:19<00:07, 79.04it/s]backtest loop:  73%|███████▎  | 1589/2187 [00:19<00:07, 79.52it/s]backtest loop:  73%|███████▎  | 1599/2187 [00:19<00:07, 79.84it/s]backtest loop:  74%|███████▎  | 1609/2187 [00:19<00:07, 79.89it/s]backtest loop:  74%|███████▍  | 1619/2187 [00:19<00:07, 79.97it/s]backtest loop:  74%|███████▍  | 1629/2187 [00:20<00:06, 79.96it/s]backtest loop:  75%|███████▍  | 1638/2187 [00:20<00:06, 79.46it/s]backtest loop:  75%|███████▌  | 1648/2187 [00:20<00:06, 79.60it/s]backtest loop:  76%|███████▌  | 1658/2187 [00:20<00:06, 80.11it/s]backtest loop:  76%|███████▋  | 1668/2187 [00:20<00:06, 80.30it/s]backtest loop:  77%|███████▋  | 1678/2187 [00:20<00:06, 80.18it/s]backtest loop:  77%|███████▋  | 1688/2187 [00:20<00:06, 80.58it/s]backtest loop:  78%|███████▊  | 1698/2187 [00:20<00:06, 80.44it/s]backtest loop:  78%|███████▊  | 1707/2187 [00:21<00:06, 79.40it/s]backtest loop:  79%|███████▊  | 1717/2187 [00:21<00:05, 79.63it/s]backtest loop:  79%|███████▉  | 1727/2187 [00:21<00:05, 79.44it/s]backtest loop:  79%|███████▉  | 1737/2187 [00:21<00:05, 79.59it/s]backtest loop:  80%|███████▉  | 1747/2187 [00:21<00:05, 79.72it/s]backtest loop:  80%|████████  | 1757/2187 [00:21<00:05, 79.77it/s]backtest loop:  81%|████████  | 1765/2187 [00:21<00:05, 78.16it/s]backtest loop:  81%|████████  | 1773/2187 [00:21<00:05, 76.94it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:21<00:05, 76.00it/s]backtest loop:  82%|████████▏ | 1789/2187 [00:22<00:05, 75.54it/s]backtest loop:  82%|████████▏ | 1798/2187 [00:22<00:05, 75.85it/s]backtest loop:  83%|████████▎ | 1808/2187 [00:22<00:04, 77.03it/s]backtest loop:  83%|████████▎ | 1816/2187 [00:22<00:04, 75.99it/s]backtest loop:  83%|████████▎ | 1826/2187 [00:22<00:04, 77.34it/s]backtest loop:  84%|████████▍ | 1836/2187 [00:22<00:04, 77.59it/s]backtest loop:  84%|████████▍ | 1846/2187 [00:22<00:04, 79.27it/s]backtest loop:  85%|████████▍ | 1856/2187 [00:22<00:04, 79.61it/s]backtest loop:  85%|████████▌ | 1866/2187 [00:23<00:04, 79.61it/s]backtest loop:  86%|████████▌ | 1876/2187 [00:23<00:03, 79.62it/s]backtest loop:  86%|████████▌ | 1885/2187 [00:23<00:03, 79.01it/s]backtest loop:  87%|████████▋ | 1895/2187 [00:23<00:03, 79.41it/s]backtest loop:  87%|████████▋ | 1905/2187 [00:23<00:03, 79.32it/s]backtest loop:  88%|████████▊ | 1915/2187 [00:23<00:03, 79.44it/s]backtest loop:  88%|████████▊ | 1925/2187 [00:23<00:03, 79.48it/s]backtest loop:  88%|████████▊ | 1935/2187 [00:23<00:03, 79.49it/s]backtest loop:  89%|████████▉ | 1945/2187 [00:24<00:03, 79.47it/s]backtest loop:  89%|████████▉ | 1954/2187 [00:24<00:02, 78.65it/s]backtest loop:  90%|████████▉ | 1964/2187 [00:24<00:02, 79.27it/s]backtest loop:  90%|█████████ | 1973/2187 [00:24<00:02, 79.13it/s]backtest loop:  91%|█████████ | 1983/2187 [00:24<00:02, 79.45it/s]backtest loop:  91%|█████████ | 1993/2187 [00:24<00:02, 79.69it/s]backtest loop:  92%|█████████▏| 2003/2187 [00:24<00:02, 79.64it/s]backtest loop:  92%|█████████▏| 2011/2187 [00:24<00:02, 78.06it/s]backtest loop:  92%|█████████▏| 2021/2187 [00:25<00:02, 78.81it/s]backtest loop:  93%|█████████▎| 2029/2187 [00:25<00:02, 77.48it/s]backtest loop:  93%|█████████▎| 2038/2187 [00:25<00:01, 77.12it/s]backtest loop:  94%|█████████▎| 2048/2187 [00:25<00:01, 77.84it/s]backtest loop:  94%|█████████▍| 2057/2187 [00:25<00:01, 77.63it/s]backtest loop:  95%|█████████▍| 2067/2187 [00:25<00:01, 78.35it/s]backtest loop:  95%|█████████▍| 2077/2187 [00:25<00:01, 79.29it/s]backtest loop:  95%|█████████▌| 2087/2187 [00:25<00:01, 79.17it/s]backtest loop:  96%|█████████▌| 2097/2187 [00:25<00:01, 79.31it/s]backtest loop:  96%|█████████▋| 2107/2187 [00:26<00:01, 78.99it/s]backtest loop:  97%|█████████▋| 2117/2187 [00:26<00:00, 79.27it/s]backtest loop:  97%|█████████▋| 2125/2187 [00:26<00:00, 77.69it/s]backtest loop:  98%|█████████▊| 2133/2187 [00:26<00:00, 77.37it/s]backtest loop:  98%|█████████▊| 2141/2187 [00:26<00:00, 76.45it/s]backtest loop:  98%|█████████▊| 2150/2187 [00:26<00:00, 77.07it/s]backtest loop:  99%|█████████▉| 2160/2187 [00:26<00:00, 78.05it/s]backtest loop:  99%|█████████▉| 2170/2187 [00:26<00:00, 78.75it/s]backtest loop: 100%|█████████▉| 2180/2187 [00:27<00:00, 79.16it/s]backtest loop: 100%|██████████| 2187/2187 [00:27<00:00, 80.55it/s]
2026-01-11 22:19:47.884 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 22:19:47.884 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0972
2026-01-11 22:19:47.884 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 1.2395
2026-01-11 22:19:47.884 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2922
2026-01-11 22:19:54.659 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pdf/full_backtest_report.pdf
2026-01-11 22:20:16.088 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:20:16.340 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_214440_mlp_158_robust_6y/pred/full_pred.parquet
[1357640:MainThread](2026-01-11 22:20:16,630) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
