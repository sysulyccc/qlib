Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[835787:MainThread](2026-01-11 17:25:22,544) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[835787:MainThread](2026-01-11 17:25:22,947) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[835787:MainThread](2026-01-11 17:25:22,948) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 17:25:22.955 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y
2026-01-11 17:25:22.955 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/log/gru_158_10_zscore_csi500_topk_20260111_172522.log
2026-01-11 17:25:22.955 | INFO     | __main__:__init__:115 - Model name: gru_158_10_zscore_csi500_topk
2026-01-11 17:25:22.957 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 17:25:22.957 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:25:22.958 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 17:25:22.958 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:25:22.958 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 17:25:42,365) INFO - qlib.timer - [log.py:127] - Time cost: 19.406s | Loading data Done
[835787:MainThread](2026-01-11 17:25:42,617) INFO - qlib.timer - [log.py:127] - Time cost: 0.013s | FilterCol Done
[835787:MainThread](2026-01-11 17:25:42,740) INFO - qlib.timer - [log.py:127] - Time cost: 0.122s | ZScoreNorm Done
[835787:MainThread](2026-01-11 17:25:42,816) INFO - qlib.timer - [log.py:127] - Time cost: 0.075s | Fillna Done
[835787:MainThread](2026-01-11 17:25:42,920) INFO - qlib.timer - [log.py:127] - Time cost: 0.024s | DropnaLabel Done
[835787:MainThread](2026-01-11 17:25:43,110) INFO - qlib.timer - [log.py:127] - Time cost: 0.189s | CSRankNorm Done
[835787:MainThread](2026-01-11 17:25:43,111) INFO - qlib.timer - [log.py:127] - Time cost: 0.745s | fit & process data Done
[835787:MainThread](2026-01-11 17:25:43,112) INFO - qlib.timer - [log.py:127] - Time cost: 20.153s | Init data Done
2026-01-11 17:25:43.112 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 17:25:43,323) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 17:25:43,324) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 17:25:43,332) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 17:25:43,332) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:25:44.684 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 17:25:46,517) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 17:25:46,523) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 17:25:46,524) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[835787:MainThread](2026-01-11 17:26:01,405) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:26:22,743) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991693, valid -0.992831
[835787:MainThread](2026-01-11 17:26:22,745) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 17:26:22,746) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:26:37,787) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:26:58,703) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990088, valid -0.992657
[835787:MainThread](2026-01-11 17:26:58,705) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 17:26:58,706) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:27:13,802) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:27:34,487) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988565, valid -0.992226
[835787:MainThread](2026-01-11 17:27:34,488) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 17:27:34,489) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:27:49,783) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:28:08,138) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987577, valid -0.993937
[835787:MainThread](2026-01-11 17:28:08,139) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 17:28:08,140) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:28:21,133) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:28:37,598) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986154, valid -0.994473
[835787:MainThread](2026-01-11 17:28:37,599) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 17:28:37,600) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:28:48,677) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:29:05,107) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984814, valid -0.993541
[835787:MainThread](2026-01-11 17:29:05,108) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 17:29:05,108) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:29:16,614) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:29:36,594) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983960, valid -0.997414
[835787:MainThread](2026-01-11 17:29:36,595) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 17:29:36,595) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:29:51,642) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:30:13,043) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983051, valid -0.995423
[835787:MainThread](2026-01-11 17:30:13,043) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 17:30:13,044) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:30:27,877) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:30:49,895) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982634, valid -0.994717
[835787:MainThread](2026-01-11 17:30:49,896) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 17:30:49,896) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:31:05,228) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:31:25,997) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981397, valid -0.995885
[835787:MainThread](2026-01-11 17:31:26,003) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 17:31:26,003) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:31:41,342) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:31:59,454) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981143, valid -0.997469
[835787:MainThread](2026-01-11 17:31:59,455) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 17:31:59,455) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:32:07,044) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:32:14,777) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980016, valid -0.996969
[835787:MainThread](2026-01-11 17:32:14,777) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835787:MainThread](2026-01-11 17:32:14,778) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:32:19,345) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:32:25,020) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980209, valid -0.996923
[835787:MainThread](2026-01-11 17:32:25,021) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 17:32:25,021) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.992226 @ 2
2026-01-11 17:32:25.047 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 17:32:27.207 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 17:32:27.208 | INFO     | __main__:train_single_fold:593 -   IC=0.0543, ICIR=0.4371, RankIC=0.0844, RankICIR=0.7115
2026-01-11 17:32:27.208 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 17:32:27,216) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 17:32:38,935) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:32:38,936) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:32:43,316) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb040feed0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▍         | 10/244 [00:00<00:02, 81.01it/s]backtest loop:   8%|▊         | 20/244 [00:00<00:02, 82.03it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:02, 85.12it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 85.92it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 84.93it/s]backtest loop:  23%|██▎       | 57/244 [00:00<00:02, 84.63it/s]backtest loop:  27%|██▋       | 66/244 [00:00<00:02, 84.38it/s]backtest loop:  31%|███       | 75/244 [00:00<00:02, 82.48it/s]backtest loop:  34%|███▍      | 84/244 [00:01<00:01, 81.54it/s]backtest loop:  38%|███▊      | 93/244 [00:01<00:01, 80.39it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 81.42it/s]backtest loop:  46%|████▌     | 112/244 [00:01<00:01, 81.64it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 82.49it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:01, 82.74it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:01, 82.49it/s]backtest loop:  62%|██████▏   | 151/244 [00:01<00:01, 82.63it/s]backtest loop:  66%|██████▌   | 160/244 [00:01<00:00, 84.27it/s]backtest loop:  69%|██████▉   | 169/244 [00:02<00:00, 82.81it/s]backtest loop:  73%|███████▎  | 178/244 [00:02<00:00, 81.62it/s]backtest loop:  77%|███████▋  | 187/244 [00:02<00:00, 80.51it/s]backtest loop:  80%|████████  | 196/244 [00:02<00:00, 80.78it/s]backtest loop:  84%|████████▍ | 205/244 [00:02<00:00, 81.95it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 82.32it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 85.21it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 87.05it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 87.55it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 83.45it/s]
2026-01-11 17:32:46.261 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3775, Sharpe(w/cost)=3.6821, MaxDD=-0.0329
2026-01-11 17:32:50.737 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 17:33:13.550 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 17:33:13.631 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_0_pred.parquet
2026-01-11 17:33:13.652 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:33:13.652 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 17:33:13.652 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:33:13.652 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 17:33:55,543) INFO - qlib.timer - [log.py:127] - Time cost: 41.888s | Loading data Done
[835787:MainThread](2026-01-11 17:33:55,846) INFO - qlib.timer - [log.py:127] - Time cost: 0.025s | FilterCol Done
[835787:MainThread](2026-01-11 17:33:56,036) INFO - qlib.timer - [log.py:127] - Time cost: 0.189s | ZScoreNorm Done
[835787:MainThread](2026-01-11 17:33:56,097) INFO - qlib.timer - [log.py:127] - Time cost: 0.060s | Fillna Done
[835787:MainThread](2026-01-11 17:33:56,199) INFO - qlib.timer - [log.py:127] - Time cost: 0.029s | DropnaLabel Done
[835787:MainThread](2026-01-11 17:33:56,404) INFO - qlib.timer - [log.py:127] - Time cost: 0.204s | CSRankNorm Done
[835787:MainThread](2026-01-11 17:33:56,405) INFO - qlib.timer - [log.py:127] - Time cost: 0.862s | fit & process data Done
[835787:MainThread](2026-01-11 17:33:56,406) INFO - qlib.timer - [log.py:127] - Time cost: 42.752s | Init data Done
2026-01-11 17:33:56.406 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 17:33:56,431) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 17:33:56,432) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 17:33:56,434) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 17:33:56,435) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:33:56.438 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 17:33:58,738) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 17:33:58,739) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 17:33:58,740) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:34:11,468) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:34:32,173) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992361, valid -0.992181
[835787:MainThread](2026-01-11 17:34:32,175) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 17:34:32,176) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:34:43,387) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:35:04,891) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991174, valid -0.991758
[835787:MainThread](2026-01-11 17:35:04,893) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 17:35:04,893) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:35:17,123) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:35:34,211) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990351, valid -0.992388
[835787:MainThread](2026-01-11 17:35:34,212) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 17:35:34,213) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:35:49,019) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:36:07,201) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988489, valid -0.991775
[835787:MainThread](2026-01-11 17:36:07,202) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 17:36:07,202) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:36:21,560) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:36:41,516) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987856, valid -0.992670
[835787:MainThread](2026-01-11 17:36:41,517) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 17:36:41,517) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:36:56,048) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:37:13,424) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986536, valid -0.993330
[835787:MainThread](2026-01-11 17:37:13,425) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 17:37:13,425) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:37:26,746) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:37:45,938) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986097, valid -0.994217
[835787:MainThread](2026-01-11 17:37:45,938) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 17:37:45,939) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:37:58,720) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:38:16,390) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985092, valid -0.994271
[835787:MainThread](2026-01-11 17:38:16,390) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 17:38:16,391) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:38:29,544) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:38:49,994) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984455, valid -0.993650
[835787:MainThread](2026-01-11 17:38:49,995) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 17:38:49,995) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:39:02,331) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:39:12,573) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983455, valid -0.994251
[835787:MainThread](2026-01-11 17:39:12,573) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 17:39:12,574) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:39:17,920) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:39:26,544) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982874, valid -0.992675
[835787:MainThread](2026-01-11 17:39:26,544) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 17:39:26,545) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:39:33,211) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:39:39,389) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983102, valid -0.996241
[835787:MainThread](2026-01-11 17:39:39,390) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 17:39:39,390) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.991758 @ 1
2026-01-11 17:39:39.417 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 17:39:41.944 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 17:39:41.944 | INFO     | __main__:train_single_fold:593 -   IC=0.0344, ICIR=0.2694, RankIC=0.0614, RankICIR=0.5614
2026-01-11 17:39:41.944 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 17:39:41,951) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 17:39:57,642) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:39:57,643) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:40:02,455) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7ef935ba6190>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/244 [00:00<00:05, 47.25it/s]backtest loop:   6%|▌         | 15/244 [00:00<00:03, 76.29it/s]backtest loop:  10%|▉         | 24/244 [00:00<00:02, 78.30it/s]backtest loop:  14%|█▍        | 34/244 [00:00<00:02, 84.92it/s]backtest loop:  18%|█▊        | 44/244 [00:00<00:02, 86.26it/s]backtest loop:  22%|██▏       | 54/244 [00:00<00:02, 86.51it/s]backtest loop:  26%|██▌       | 63/244 [00:00<00:02, 85.90it/s]backtest loop:  30%|██▉       | 72/244 [00:00<00:01, 86.78it/s]backtest loop:  33%|███▎      | 81/244 [00:00<00:01, 84.84it/s]backtest loop:  37%|███▋      | 91/244 [00:01<00:01, 87.36it/s]backtest loop:  41%|████      | 100/244 [00:01<00:01, 87.63it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 87.35it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 86.97it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 86.11it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 87.51it/s]backtest loop:  61%|██████    | 149/244 [00:01<00:01, 85.81it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:00, 85.88it/s]backtest loop:  69%|██████▉   | 169/244 [00:01<00:00, 85.77it/s]backtest loop:  73%|███████▎  | 178/244 [00:02<00:00, 86.76it/s]backtest loop:  77%|███████▋  | 187/244 [00:02<00:00, 85.61it/s]backtest loop:  80%|████████  | 196/244 [00:02<00:00, 82.91it/s]backtest loop:  84%|████████▍ | 205/244 [00:02<00:00, 81.54it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 80.41it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 81.69it/s]backtest loop:  95%|█████████▌| 233/244 [00:02<00:00, 83.00it/s]backtest loop:  99%|█████████▉| 242/244 [00:02<00:00, 82.30it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 83.92it/s]
2026-01-11 17:40:05.383 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0269, Sharpe(w/cost)=0.4878, MaxDD=-0.0309
2026-01-11 17:40:08.775 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 17:40:28.050 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 17:40:28.102 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_1_pred.parquet
2026-01-11 17:40:28.114 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 17:40:28.115 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 17:40:30.863 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0585
2026-01-11 17:40:31.141 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0348, ICIR=0.2659, RankIC=0.0616
[835787:MainThread](2026-01-11 17:40:31,148) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 17:40:50,009) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:40:50,010) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:40:55,066) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9a346190>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/244 [00:00<00:05, 46.10it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 70.85it/s]backtest loop:  10%|▉         | 24/244 [00:00<00:02, 77.18it/s]backtest loop:  14%|█▍        | 34/244 [00:00<00:02, 82.78it/s]backtest loop:  18%|█▊        | 44/244 [00:00<00:02, 86.04it/s]backtest loop:  22%|██▏       | 54/244 [00:00<00:02, 86.50it/s]backtest loop:  26%|██▌       | 63/244 [00:00<00:02, 87.18it/s]backtest loop:  30%|██▉       | 72/244 [00:00<00:01, 86.81it/s]backtest loop:  34%|███▎      | 82/244 [00:00<00:01, 88.64it/s]backtest loop:  38%|███▊      | 92/244 [00:01<00:01, 90.12it/s]backtest loop:  42%|████▏     | 102/244 [00:01<00:01, 92.00it/s]backtest loop:  46%|████▌     | 112/244 [00:01<00:01, 93.14it/s]backtest loop:  50%|█████     | 122/244 [00:01<00:01, 93.58it/s]backtest loop:  54%|█████▍    | 132/244 [00:01<00:01, 93.18it/s]backtest loop:  58%|█████▊    | 142/244 [00:01<00:01, 92.29it/s]backtest loop:  62%|██████▏   | 152/244 [00:01<00:00, 92.32it/s]backtest loop:  66%|██████▋   | 162/244 [00:01<00:00, 91.37it/s]backtest loop:  70%|███████   | 172/244 [00:01<00:00, 90.73it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 89.83it/s]backtest loop:  78%|███████▊  | 191/244 [00:02<00:00, 89.17it/s]backtest loop:  82%|████████▏ | 200/244 [00:02<00:00, 89.36it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 88.92it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 90.96it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 91.30it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 92.38it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 89.11it/s]
2026-01-11 17:40:57.822 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0683, Sharpe(w/cost)=1.2439
2026-01-11 17:40:57.858 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:40:57.858 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 17:40:57.858 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:40:57.858 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 17:41:47,836) INFO - qlib.timer - [log.py:127] - Time cost: 49.976s | Loading data Done
[835787:MainThread](2026-01-11 17:41:48,141) INFO - qlib.timer - [log.py:127] - Time cost: 0.027s | FilterCol Done
[835787:MainThread](2026-01-11 17:41:48,323) INFO - qlib.timer - [log.py:127] - Time cost: 0.181s | ZScoreNorm Done
[835787:MainThread](2026-01-11 17:41:48,403) INFO - qlib.timer - [log.py:127] - Time cost: 0.079s | Fillna Done
[835787:MainThread](2026-01-11 17:41:48,484) INFO - qlib.timer - [log.py:127] - Time cost: 0.030s | DropnaLabel Done
[835787:MainThread](2026-01-11 17:41:48,691) INFO - qlib.timer - [log.py:127] - Time cost: 0.207s | CSRankNorm Done
[835787:MainThread](2026-01-11 17:41:48,693) INFO - qlib.timer - [log.py:127] - Time cost: 0.856s | fit & process data Done
[835787:MainThread](2026-01-11 17:41:48,693) INFO - qlib.timer - [log.py:127] - Time cost: 50.834s | Init data Done
2026-01-11 17:41:48.693 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 17:41:48,716) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 17:41:48,717) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 17:41:48,719) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 17:41:48,720) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:41:48.725 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 17:41:51,396) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 17:41:51,397) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 17:41:51,398) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:42:03,441) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:42:22,735) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992255, valid -0.994485
[835787:MainThread](2026-01-11 17:42:22,736) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 17:42:22,737) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:42:35,615) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:42:54,342) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990538, valid -0.992978
[835787:MainThread](2026-01-11 17:42:54,344) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 17:42:54,344) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:43:06,771) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:43:25,522) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989479, valid -0.993277
[835787:MainThread](2026-01-11 17:43:25,523) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 17:43:25,523) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:43:38,492) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:43:54,360) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988249, valid -0.992326
[835787:MainThread](2026-01-11 17:43:54,362) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 17:43:54,362) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:44:08,267) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:44:25,264) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986993, valid -0.991767
[835787:MainThread](2026-01-11 17:44:25,266) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 17:44:25,266) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:44:39,664) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:44:57,960) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985601, valid -0.992213
[835787:MainThread](2026-01-11 17:44:57,961) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 17:44:57,961) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:45:06,778) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:45:27,301) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984868, valid -0.992722
[835787:MainThread](2026-01-11 17:45:27,302) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 17:45:27,302) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:45:42,471) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:46:03,370) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984136, valid -0.991351
[835787:MainThread](2026-01-11 17:46:03,372) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 17:46:03,372) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:46:17,167) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:46:30,989) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983218, valid -0.991323
[835787:MainThread](2026-01-11 17:46:30,991) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 17:46:30,991) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:46:41,714) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:47:04,552) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981762, valid -0.991329
[835787:MainThread](2026-01-11 17:47:04,553) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 17:47:04,553) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:47:15,849) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:47:36,476) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980680, valid -0.991178
[835787:MainThread](2026-01-11 17:47:36,478) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 17:47:36,479) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:47:48,203) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:48:04,460) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980222, valid -0.991182
[835787:MainThread](2026-01-11 17:48:04,461) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835787:MainThread](2026-01-11 17:48:04,461) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:48:17,452) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:48:37,547) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.979526, valid -0.991483
[835787:MainThread](2026-01-11 17:48:37,548) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch13:
[835787:MainThread](2026-01-11 17:48:37,549) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:48:50,729) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:49:10,113) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.978896, valid -0.991946
[835787:MainThread](2026-01-11 17:49:10,114) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch14:
[835787:MainThread](2026-01-11 17:49:10,115) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:49:20,461) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:49:36,792) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.978296, valid -0.992265
[835787:MainThread](2026-01-11 17:49:36,793) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch15:
[835787:MainThread](2026-01-11 17:49:36,793) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:49:51,810) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:50:14,809) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.977402, valid -0.990898
[835787:MainThread](2026-01-11 17:50:14,810) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch16:
[835787:MainThread](2026-01-11 17:50:14,811) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:50:28,992) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:50:49,764) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.976784, valid -0.993104
[835787:MainThread](2026-01-11 17:50:49,765) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch17:
[835787:MainThread](2026-01-11 17:50:49,766) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:51:04,487) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:51:27,397) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.975779, valid -0.992697
[835787:MainThread](2026-01-11 17:51:27,398) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch18:
[835787:MainThread](2026-01-11 17:51:27,398) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:51:39,259) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:51:53,646) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.975787, valid -0.992511
[835787:MainThread](2026-01-11 17:51:53,647) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch19:
[835787:MainThread](2026-01-11 17:51:53,647) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:52:05,190) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:52:19,046) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.975502, valid -0.992797
[835787:MainThread](2026-01-11 17:52:19,047) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch20:
[835787:MainThread](2026-01-11 17:52:19,047) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:52:30,496) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:52:46,974) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.974378, valid -0.993199
[835787:MainThread](2026-01-11 17:52:46,975) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch21:
[835787:MainThread](2026-01-11 17:52:46,975) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:52:58,397) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:53:12,604) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.974661, valid -0.993536
[835787:MainThread](2026-01-11 17:53:12,605) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch22:
[835787:MainThread](2026-01-11 17:53:12,606) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:53:23,772) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:53:35,557) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.973203, valid -0.992248
[835787:MainThread](2026-01-11 17:53:35,558) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch23:
[835787:MainThread](2026-01-11 17:53:35,558) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:53:42,916) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:53:53,486) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.972576, valid -0.992556
[835787:MainThread](2026-01-11 17:53:53,487) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch24:
[835787:MainThread](2026-01-11 17:53:53,488) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:53:59,440) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:54:06,144) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.971472, valid -0.993115
[835787:MainThread](2026-01-11 17:54:06,145) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch25:
[835787:MainThread](2026-01-11 17:54:06,145) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:54:10,958) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:54:18,875) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.971348, valid -0.993078
[835787:MainThread](2026-01-11 17:54:18,876) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 17:54:18,876) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.990898 @ 15
2026-01-11 17:54:18.907 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 17:54:22.304 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 17:54:22.304 | INFO     | __main__:train_single_fold:593 -   IC=0.0378, ICIR=0.4122, RankIC=0.0396, RankICIR=0.4684
2026-01-11 17:54:22.304 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 17:54:22,311) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 17:54:42,480) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:54:42,481) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:54:47,636) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9e32e190>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 32.45it/s]backtest loop:   5%|▌         | 13/243 [00:00<00:03, 62.36it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 68.59it/s]backtest loop:  12%|█▏        | 29/243 [00:00<00:02, 72.61it/s]backtest loop:  15%|█▌        | 37/243 [00:00<00:02, 74.43it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 67.04it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:02, 63.86it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:03, 58.94it/s]backtest loop:  27%|██▋       | 66/243 [00:01<00:02, 59.24it/s]backtest loop:  30%|███       | 73/243 [00:01<00:02, 57.22it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 57.43it/s]backtest loop:  35%|███▍      | 85/243 [00:01<00:02, 55.71it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:02, 55.84it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:02, 56.50it/s]backtest loop:  42%|████▏     | 103/243 [00:01<00:02, 55.77it/s]backtest loop:  45%|████▍     | 109/243 [00:01<00:02, 55.36it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:02, 53.05it/s]backtest loop:  50%|█████     | 122/243 [00:02<00:02, 55.78it/s]backtest loop:  53%|█████▎    | 128/243 [00:02<00:02, 55.10it/s]backtest loop:  55%|█████▌    | 134/243 [00:02<00:02, 51.85it/s]backtest loop:  58%|█████▊    | 140/243 [00:02<00:01, 52.29it/s]backtest loop:  60%|██████    | 147/243 [00:02<00:01, 56.71it/s]backtest loop:  63%|██████▎   | 154/243 [00:02<00:01, 60.30it/s]backtest loop:  67%|██████▋   | 163/243 [00:02<00:01, 67.88it/s]backtest loop:  70%|███████   | 171/243 [00:02<00:01, 69.95it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 72.22it/s]backtest loop:  77%|███████▋  | 188/243 [00:03<00:00, 73.56it/s]backtest loop:  81%|████████  | 197/243 [00:03<00:00, 78.18it/s]backtest loop:  84%|████████▍ | 205/243 [00:03<00:00, 73.37it/s]backtest loop:  88%|████████▊ | 213/243 [00:03<00:00, 69.71it/s]backtest loop:  91%|█████████▏| 222/243 [00:03<00:00, 75.12it/s]backtest loop:  95%|█████████▍| 230/243 [00:03<00:00, 75.33it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 75.46it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 63.85it/s]
2026-01-11 17:54:51.461 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0272, Sharpe(w/cost)=-0.4531, MaxDD=-0.0933
2026-01-11 17:54:55.632 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 17:55:15.617 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 17:55:15.681 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_2_pred.parquet
2026-01-11 17:55:15.700 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 17:55:15.700 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 17:55:19.441 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0373
2026-01-11 17:55:22.870 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0384
2026-01-11 17:55:23.170 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0373, ICIR=0.3658, RankIC=0.0437
[835787:MainThread](2026-01-11 17:55:23,176) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 17:55:43,479) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:55:43,480) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 17:55:50,179) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9d8d2b50>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 29.70it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:04, 52.99it/s]backtest loop:   8%|▊         | 19/243 [00:00<00:03, 65.51it/s]backtest loop:  12%|█▏        | 29/243 [00:00<00:02, 73.95it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 76.96it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 75.98it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 76.19it/s]backtest loop:  26%|██▌       | 62/243 [00:00<00:02, 76.30it/s]backtest loop:  29%|██▉       | 71/243 [00:00<00:02, 79.57it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 79.14it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:01, 78.28it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 78.21it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 80.71it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 81.21it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 82.29it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 83.11it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 83.07it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 84.31it/s]backtest loop:  67%|██████▋   | 164/243 [00:02<00:00, 84.41it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 86.31it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 89.13it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 90.35it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 90.55it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 90.79it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 91.76it/s]backtest loop:  96%|█████████▋| 234/243 [00:02<00:00, 91.65it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 82.44it/s]
2026-01-11 17:55:53.146 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0931, Sharpe(w/cost)=-1.5235
2026-01-11 17:55:53.181 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:55:53.181 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 17:55:53.181 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:55:53.181 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 17:56:53,444) INFO - qlib.timer - [log.py:127] - Time cost: 60.261s | Loading data Done
[835787:MainThread](2026-01-11 17:56:53,720) INFO - qlib.timer - [log.py:127] - Time cost: 0.019s | FilterCol Done
[835787:MainThread](2026-01-11 17:56:53,887) INFO - qlib.timer - [log.py:127] - Time cost: 0.166s | ZScoreNorm Done
[835787:MainThread](2026-01-11 17:56:53,987) INFO - qlib.timer - [log.py:127] - Time cost: 0.098s | Fillna Done
[835787:MainThread](2026-01-11 17:56:54,072) INFO - qlib.timer - [log.py:127] - Time cost: 0.028s | DropnaLabel Done
[835787:MainThread](2026-01-11 17:56:54,279) INFO - qlib.timer - [log.py:127] - Time cost: 0.206s | CSRankNorm Done
[835787:MainThread](2026-01-11 17:56:54,280) INFO - qlib.timer - [log.py:127] - Time cost: 0.835s | fit & process data Done
[835787:MainThread](2026-01-11 17:56:54,281) INFO - qlib.timer - [log.py:127] - Time cost: 61.098s | Init data Done
2026-01-11 17:56:54.281 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 17:56:54,301) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 17:56:54,302) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 17:56:54,304) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 17:56:54,305) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:56:54.309 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 17:56:56,813) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 17:56:56,813) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 17:56:56,814) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:57:08,862) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:57:27,101) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991994, valid -0.998020
[835787:MainThread](2026-01-11 17:57:27,102) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 17:57:27,103) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:57:40,729) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:57:54,522) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990766, valid -0.996539
[835787:MainThread](2026-01-11 17:57:54,524) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 17:57:54,525) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:58:04,557) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:58:16,849) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989152, valid -0.997776
[835787:MainThread](2026-01-11 17:58:16,850) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 17:58:16,851) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:58:27,388) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:58:39,146) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988079, valid -0.997324
[835787:MainThread](2026-01-11 17:58:39,147) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 17:58:39,148) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:58:47,962) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:59:04,236) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986555, valid -0.996478
[835787:MainThread](2026-01-11 17:59:04,238) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 17:59:04,239) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:59:15,600) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:59:30,569) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985540, valid -0.999618
[835787:MainThread](2026-01-11 17:59:30,569) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 17:59:30,570) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 17:59:42,081) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 17:59:57,225) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983606, valid -0.996867
[835787:MainThread](2026-01-11 17:59:57,225) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 17:59:57,226) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:00:06,548) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:00:25,439) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982834, valid -0.996820
[835787:MainThread](2026-01-11 18:00:25,440) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 18:00:25,441) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:00:35,583) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:00:52,186) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982063, valid -0.997336
[835787:MainThread](2026-01-11 18:00:52,186) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 18:00:52,187) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:01:07,530) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:01:30,351) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981293, valid -0.997087
[835787:MainThread](2026-01-11 18:01:30,352) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 18:01:30,353) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:01:45,813) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:02:06,929) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980547, valid -0.999343
[835787:MainThread](2026-01-11 18:02:06,929) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 18:02:06,930) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:02:18,143) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:02:33,660) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980257, valid -0.998915
[835787:MainThread](2026-01-11 18:02:33,661) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835787:MainThread](2026-01-11 18:02:33,662) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:02:44,505) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:02:57,690) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.979110, valid -0.997347
[835787:MainThread](2026-01-11 18:02:57,690) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch13:
[835787:MainThread](2026-01-11 18:02:57,691) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:03:09,634) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:03:30,414) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.978846, valid -1.000668
[835787:MainThread](2026-01-11 18:03:30,414) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch14:
[835787:MainThread](2026-01-11 18:03:30,415) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:03:41,922) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:03:59,886) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.977499, valid -0.998123
[835787:MainThread](2026-01-11 18:03:59,887) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 18:03:59,887) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.996478 @ 4
2026-01-11 18:03:59.918 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:04:04.975 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 18:04:04.976 | INFO     | __main__:train_single_fold:593 -   IC=0.0114, ICIR=0.1096, RankIC=0.0456, RankICIR=0.4825
2026-01-11 18:04:04.976 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 18:04:04,988) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:04:30,600) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:04:30,602) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:04:37,355) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9f2d9450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:13, 18.52it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:04, 52.10it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 66.43it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 75.24it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:02, 81.16it/s]backtest loop:  22%|██▏       | 53/244 [00:00<00:02, 83.11it/s]backtest loop:  26%|██▌       | 63/244 [00:00<00:02, 86.60it/s]backtest loop:  30%|██▉       | 73/244 [00:00<00:01, 88.46it/s]backtest loop:  34%|███▎      | 82/244 [00:01<00:01, 87.51it/s]backtest loop:  37%|███▋      | 91/244 [00:01<00:01, 87.71it/s]backtest loop:  41%|████      | 100/244 [00:01<00:01, 85.68it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 85.18it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 85.65it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 87.51it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 87.96it/s]backtest loop:  61%|██████    | 148/244 [00:01<00:01, 86.53it/s]backtest loop:  64%|██████▍   | 157/244 [00:01<00:00, 87.45it/s]backtest loop:  68%|██████▊   | 166/244 [00:02<00:00, 84.97it/s]backtest loop:  72%|███████▏  | 175/244 [00:02<00:00, 83.19it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 78.37it/s]backtest loop:  79%|███████▊  | 192/244 [00:02<00:00, 77.91it/s]backtest loop:  82%|████████▏ | 201/244 [00:02<00:00, 80.62it/s]backtest loop:  86%|████████▌ | 210/244 [00:02<00:00, 79.70it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 77.76it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 76.75it/s]backtest loop:  97%|█████████▋| 236/244 [00:02<00:00, 79.81it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 80.09it/s]
2026-01-11 18:04:40.422 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0220, Sharpe(w/cost)=0.3484, MaxDD=-0.0737
2026-01-11 18:04:43.836 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 18:05:01.975 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:05:02.033 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_3_pred.parquet
2026-01-11 18:05:02.049 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 18:05:02.049 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 18:05:07.407 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0406
2026-01-11 18:05:13.421 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0471
2026-01-11 18:05:16.926 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0380
2026-01-11 18:05:17.234 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0159, ICIR=0.1452, RankIC=0.0466
[835787:MainThread](2026-01-11 18:05:17,241) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:05:42,858) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:05:42,859) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:05:49,120) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9d886190>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 25.41it/s]backtest loop:   3%|▎         | 8/244 [00:00<00:06, 38.65it/s]backtest loop:   7%|▋         | 16/244 [00:00<00:04, 54.82it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 60.21it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:03, 58.33it/s]backtest loop:  15%|█▍        | 36/244 [00:00<00:03, 54.92it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:03, 57.90it/s]backtest loop:  21%|██▏       | 52/244 [00:00<00:02, 66.28it/s]backtest loop:  25%|██▍       | 60/244 [00:01<00:02, 67.26it/s]backtest loop:  27%|██▋       | 67/244 [00:01<00:02, 67.56it/s]backtest loop:  31%|███       | 76/244 [00:01<00:02, 72.22it/s]backtest loop:  34%|███▍      | 84/244 [00:01<00:02, 65.04it/s]backtest loop:  38%|███▊      | 93/244 [00:01<00:02, 70.78it/s]backtest loop:  41%|████▏     | 101/244 [00:01<00:01, 71.90it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 73.85it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 77.30it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 80.61it/s]backtest loop:  57%|█████▋    | 138/244 [00:02<00:01, 82.22it/s]backtest loop:  61%|██████    | 148/244 [00:02<00:01, 83.38it/s]backtest loop:  65%|██████▍   | 158/244 [00:02<00:01, 85.16it/s]backtest loop:  69%|██████▉   | 168/244 [00:02<00:00, 85.40it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 85.19it/s]backtest loop:  76%|███████▌  | 186/244 [00:02<00:00, 83.64it/s]backtest loop:  80%|███████▉  | 195/244 [00:02<00:00, 84.12it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 84.20it/s]backtest loop:  87%|████████▋ | 213/244 [00:02<00:00, 83.32it/s]backtest loop:  91%|█████████ | 222/244 [00:03<00:00, 82.60it/s]backtest loop:  95%|█████████▌| 232/244 [00:03<00:00, 82.27it/s]backtest loop:  99%|█████████▉| 241/244 [00:03<00:00, 83.53it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 73.96it/s]
2026-01-11 18:05:52.439 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0411, Sharpe(w/cost)=0.6767
2026-01-11 18:05:52.483 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:05:52.483 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 18:05:52.483 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:05:52.484 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 18:06:53,560) INFO - qlib.timer - [log.py:127] - Time cost: 61.073s | Loading data Done
[835787:MainThread](2026-01-11 18:06:53,832) INFO - qlib.timer - [log.py:127] - Time cost: 0.020s | FilterCol Done
[835787:MainThread](2026-01-11 18:06:54,009) INFO - qlib.timer - [log.py:127] - Time cost: 0.176s | ZScoreNorm Done
[835787:MainThread](2026-01-11 18:06:54,152) INFO - qlib.timer - [log.py:127] - Time cost: 0.141s | Fillna Done
[835787:MainThread](2026-01-11 18:06:54,251) INFO - qlib.timer - [log.py:127] - Time cost: 0.028s | DropnaLabel Done
[835787:MainThread](2026-01-11 18:06:54,461) INFO - qlib.timer - [log.py:127] - Time cost: 0.209s | CSRankNorm Done
[835787:MainThread](2026-01-11 18:06:54,462) INFO - qlib.timer - [log.py:127] - Time cost: 0.901s | fit & process data Done
[835787:MainThread](2026-01-11 18:06:54,463) INFO - qlib.timer - [log.py:127] - Time cost: 61.978s | Init data Done
2026-01-11 18:06:54.463 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 18:06:54,477) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 18:06:54,478) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 18:06:54,480) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 18:06:54,480) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:06:54.485 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 18:06:57,003) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 18:06:57,004) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 18:06:57,004) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:07:07,077) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:07:20,950) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992809, valid -0.995477
[835787:MainThread](2026-01-11 18:07:20,952) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 18:07:20,952) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:07:32,267) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:07:47,221) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990997, valid -0.995293
[835787:MainThread](2026-01-11 18:07:47,223) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 18:07:47,223) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:07:57,218) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:08:11,832) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990346, valid -0.996258
[835787:MainThread](2026-01-11 18:08:11,833) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 18:08:11,833) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:08:25,353) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:08:41,149) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989242, valid -0.997452
[835787:MainThread](2026-01-11 18:08:41,149) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 18:08:41,150) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:08:50,382) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:09:03,719) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988529, valid -0.997071
[835787:MainThread](2026-01-11 18:09:03,719) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 18:09:03,720) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:09:13,634) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:09:25,513) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987170, valid -0.997449
[835787:MainThread](2026-01-11 18:09:25,513) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 18:09:25,514) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:09:35,090) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:09:51,273) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985855, valid -0.997924
[835787:MainThread](2026-01-11 18:09:51,274) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 18:09:51,275) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:10:03,679) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:10:19,653) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984415, valid -0.997700
[835787:MainThread](2026-01-11 18:10:19,654) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 18:10:19,654) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:10:30,799) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:10:46,655) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984140, valid -0.999298
[835787:MainThread](2026-01-11 18:10:46,656) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 18:10:46,656) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:10:57,610) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:11:12,604) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982904, valid -0.999235
[835787:MainThread](2026-01-11 18:11:12,605) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 18:11:12,606) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:11:22,574) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:11:32,217) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982378, valid -0.999358
[835787:MainThread](2026-01-11 18:11:32,218) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 18:11:32,218) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:11:38,212) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:11:46,454) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981449, valid -0.999400
[835787:MainThread](2026-01-11 18:11:46,455) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 18:11:46,455) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.995293 @ 1
2026-01-11 18:11:46.480 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:11:50.680 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 18:11:50.681 | INFO     | __main__:train_single_fold:593 -   IC=0.0010, ICIR=0.0069, RankIC=0.0376, RankICIR=0.2855
2026-01-11 18:11:50.681 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 18:11:50,688) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:12:22,909) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:12:22,910) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:12:29,105) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9ee24510>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:13, 17.25it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:05, 45.97it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 58.45it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:03, 68.31it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 68.41it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 66.15it/s]backtest loop:  22%|██▏       | 53/243 [00:00<00:02, 66.38it/s]backtest loop:  25%|██▍       | 60/243 [00:00<00:02, 65.53it/s]backtest loop:  28%|██▊       | 67/243 [00:01<00:02, 62.32it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 64.30it/s]backtest loop:  33%|███▎      | 81/243 [00:01<00:02, 62.51it/s]backtest loop:  36%|███▌      | 88/243 [00:01<00:02, 61.39it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:02, 63.62it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:02, 62.39it/s]backtest loop:  45%|████▍     | 109/243 [00:01<00:02, 64.30it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:02, 62.53it/s]backtest loop:  51%|█████     | 123/243 [00:01<00:01, 64.29it/s]backtest loop:  53%|█████▎    | 130/243 [00:02<00:01, 62.43it/s]backtest loop:  57%|█████▋    | 138/243 [00:02<00:01, 65.69it/s]backtest loop:  60%|█████▉    | 145/243 [00:02<00:01, 66.51it/s]backtest loop:  63%|██████▎   | 154/243 [00:02<00:01, 72.50it/s]backtest loop:  67%|██████▋   | 162/243 [00:02<00:01, 73.30it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 73.42it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 77.67it/s]backtest loop:  77%|███████▋  | 187/243 [00:02<00:00, 73.86it/s]backtest loop:  80%|████████  | 195/243 [00:02<00:00, 73.71it/s]backtest loop:  84%|████████▍ | 204/243 [00:03<00:00, 74.63it/s]backtest loop:  88%|████████▊ | 213/243 [00:03<00:00, 78.29it/s]backtest loop:  91%|█████████ | 221/243 [00:03<00:00, 76.83it/s]backtest loop:  94%|█████████▍| 229/243 [00:03<00:00, 76.24it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 79.36it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 67.83it/s]
2026-01-11 18:12:32.710 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1329, Sharpe(w/cost)=-1.2792, MaxDD=-0.1495
2026-01-11 18:12:36.045 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 18:12:52.601 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:12:52.666 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_4_pred.parquet
2026-01-11 18:12:52.680 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 18:12:52.680 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 18:12:56.511 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0381
2026-01-11 18:13:00.365 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0391
2026-01-11 18:13:04.450 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0370
2026-01-11 18:13:09.476 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0401
2026-01-11 18:13:09.801 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0051, ICIR=0.0356, RankIC=0.0418
[835787:MainThread](2026-01-11 18:13:09,809) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:13:35,411) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:13:35,411) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:13:42,537) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9f5e8810>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 24.38it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 53.64it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 63.46it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 71.81it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 71.68it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 72.43it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 76.59it/s]backtest loop:  26%|██▌       | 63/243 [00:00<00:02, 75.51it/s]backtest loop:  29%|██▉       | 71/243 [00:01<00:02, 74.77it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 74.25it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 73.86it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:01, 76.58it/s]backtest loop:  43%|████▎     | 104/243 [00:01<00:01, 75.67it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 74.14it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 73.59it/s]backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 77.05it/s]backtest loop:  56%|█████▋    | 137/243 [00:01<00:01, 75.25it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 74.66it/s]backtest loop:  63%|██████▎   | 153/243 [00:02<00:01, 75.52it/s]backtest loop:  66%|██████▋   | 161/243 [00:02<00:01, 70.95it/s]backtest loop:  70%|██████▉   | 169/243 [00:02<00:01, 70.81it/s]backtest loop:  73%|███████▎  | 177/243 [00:02<00:00, 67.13it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 62.38it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 64.05it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 65.10it/s]backtest loop:  84%|████████▍ | 205/243 [00:02<00:00, 62.27it/s]backtest loop:  87%|████████▋ | 212/243 [00:03<00:00, 64.13it/s]backtest loop:  90%|█████████ | 219/243 [00:03<00:00, 62.30it/s]backtest loop:  93%|█████████▎| 226/243 [00:03<00:00, 63.93it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 63.32it/s]backtest loop:  99%|█████████▉| 241/243 [00:03<00:00, 64.41it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 68.68it/s]
2026-01-11 18:13:46.099 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0572, Sharpe(w/cost)=-0.6107
2026-01-11 18:13:46.139 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:13:46.139 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 18:13:46.139 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:13:46.140 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 18:14:51,032) INFO - qlib.timer - [log.py:127] - Time cost: 64.890s | Loading data Done
[835787:MainThread](2026-01-11 18:14:51,304) INFO - qlib.timer - [log.py:127] - Time cost: 0.019s | FilterCol Done
[835787:MainThread](2026-01-11 18:14:51,485) INFO - qlib.timer - [log.py:127] - Time cost: 0.181s | ZScoreNorm Done
[835787:MainThread](2026-01-11 18:14:51,571) INFO - qlib.timer - [log.py:127] - Time cost: 0.084s | Fillna Done
[835787:MainThread](2026-01-11 18:14:51,658) INFO - qlib.timer - [log.py:127] - Time cost: 0.036s | DropnaLabel Done
[835787:MainThread](2026-01-11 18:14:51,857) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[835787:MainThread](2026-01-11 18:14:51,858) INFO - qlib.timer - [log.py:127] - Time cost: 0.825s | fit & process data Done
[835787:MainThread](2026-01-11 18:14:51,859) INFO - qlib.timer - [log.py:127] - Time cost: 65.718s | Init data Done
2026-01-11 18:14:51.859 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 18:14:51,871) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 18:14:51,872) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 18:14:51,874) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 18:14:51,874) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:14:51.880 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 18:14:54,345) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 18:14:54,346) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 18:14:54,347) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:15:07,098) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:15:24,428) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993307, valid -0.995222
[835787:MainThread](2026-01-11 18:15:24,429) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 18:15:24,430) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:15:36,501) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:15:50,317) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991817, valid -0.994899
[835787:MainThread](2026-01-11 18:15:50,319) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 18:15:50,319) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:15:59,657) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:16:10,969) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991326, valid -0.995463
[835787:MainThread](2026-01-11 18:16:10,969) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 18:16:10,970) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:16:20,627) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:16:31,522) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989858, valid -0.995921
[835787:MainThread](2026-01-11 18:16:31,522) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 18:16:31,523) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:16:39,845) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:16:53,583) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988956, valid -0.995759
[835787:MainThread](2026-01-11 18:16:53,583) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 18:16:53,584) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:17:04,247) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:17:24,216) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988381, valid -0.997043
[835787:MainThread](2026-01-11 18:17:24,217) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 18:17:24,217) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:17:34,183) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:17:50,303) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987771, valid -0.997835
[835787:MainThread](2026-01-11 18:17:50,304) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 18:17:50,305) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:18:01,408) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:18:18,195) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986580, valid -0.996557
[835787:MainThread](2026-01-11 18:18:18,196) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 18:18:18,196) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:18:28,163) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:18:43,422) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985864, valid -0.997893
[835787:MainThread](2026-01-11 18:18:43,423) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 18:18:43,424) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:18:55,170) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:19:09,739) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984642, valid -0.997464
[835787:MainThread](2026-01-11 18:19:09,742) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 18:19:09,743) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:19:19,030) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:19:33,591) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984329, valid -0.998092
[835787:MainThread](2026-01-11 18:19:33,592) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 18:19:33,593) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:19:43,873) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:19:55,663) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983623, valid -0.998257
[835787:MainThread](2026-01-11 18:19:55,664) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 18:19:55,664) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.994899 @ 1
2026-01-11 18:19:55.690 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:20:01.217 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 18:20:01.218 | INFO     | __main__:train_single_fold:593 -   IC=0.0018, ICIR=0.0141, RankIC=0.0298, RankICIR=0.2279
2026-01-11 18:20:01.218 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 18:20:01,228) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:20:34,809) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:20:34,810) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:20:42,267) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9cb12c90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 29.48it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:03, 58.69it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 70.90it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:02, 73.91it/s]backtest loop:  15%|█▌        | 37/243 [00:00<00:02, 77.24it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 79.52it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 80.92it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 82.48it/s]backtest loop:  30%|███       | 74/243 [00:00<00:02, 83.21it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:01, 83.54it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 82.64it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 80.72it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 79.76it/s]backtest loop:  49%|████▉     | 119/243 [00:01<00:01, 81.22it/s]backtest loop:  53%|█████▎    | 128/243 [00:01<00:01, 80.40it/s]backtest loop:  56%|█████▋    | 137/243 [00:01<00:01, 79.20it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 76.50it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 79.33it/s]backtest loop:  67%|██████▋   | 162/243 [00:02<00:01, 77.84it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 76.46it/s]backtest loop:  73%|███████▎  | 178/243 [00:02<00:00, 75.82it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 75.73it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 75.53it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 75.49it/s]backtest loop:  87%|████████▋ | 212/243 [00:02<00:00, 78.95it/s]backtest loop:  91%|█████████ | 220/243 [00:02<00:00, 77.54it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 76.58it/s]backtest loop:  98%|█████████▊| 237/243 [00:03<00:00, 79.41it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.60it/s]
2026-01-11 18:20:45.419 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1057, Sharpe(w/cost)=-0.9917, MaxDD=-0.1964
2026-01-11 18:20:48.548 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 18:21:07.685 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:21:07.778 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_5_pred.parquet
2026-01-11 18:21:07.791 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 18:21:07.791 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 18:21:12.176 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0246
2026-01-11 18:21:15.879 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0252
2026-01-11 18:21:19.715 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0240
2026-01-11 18:21:24.026 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0271
2026-01-11 18:21:28.025 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0310
2026-01-11 18:21:28.354 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0019, ICIR=0.0142, RankIC=0.0302
[835787:MainThread](2026-01-11 18:21:28,361) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:22:00,484) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:22:00,485) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:22:07,015) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9e678cd0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 27.45it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 54.92it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 69.52it/s]backtest loop:  12%|█▏        | 29/243 [00:00<00:02, 76.37it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 80.80it/s]backtest loop:  19%|█▉        | 47/243 [00:00<00:02, 81.51it/s]backtest loop:  23%|██▎       | 56/243 [00:00<00:02, 83.29it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:02, 84.05it/s]backtest loop:  30%|███       | 74/243 [00:00<00:01, 84.98it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:01, 83.23it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 80.95it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 79.73it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 78.93it/s]backtest loop:  49%|████▉     | 119/243 [00:01<00:01, 81.34it/s]backtest loop:  53%|█████▎    | 128/243 [00:01<00:01, 80.57it/s]backtest loop:  56%|█████▋    | 137/243 [00:01<00:01, 79.50it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 78.02it/s]backtest loop:  63%|██████▎   | 153/243 [00:01<00:01, 78.42it/s]backtest loop:  66%|██████▋   | 161/243 [00:02<00:01, 75.89it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 74.89it/s]backtest loop:  73%|███████▎  | 178/243 [00:02<00:00, 73.27it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 72.75it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 71.92it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 73.35it/s]backtest loop:  87%|████████▋ | 212/243 [00:02<00:00, 77.07it/s]backtest loop:  91%|█████████ | 220/243 [00:02<00:00, 75.74it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 75.59it/s]backtest loop:  98%|█████████▊| 237/243 [00:03<00:00, 78.61it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.09it/s]
2026-01-11 18:22:10.186 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0197, Sharpe(w/cost)=-0.1888
2026-01-11 18:22:10.253 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:22:10.253 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 18:22:10.253 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:22:10.253 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 18:23:16,713) INFO - qlib.timer - [log.py:127] - Time cost: 66.456s | Loading data Done
[835787:MainThread](2026-01-11 18:23:16,955) INFO - qlib.timer - [log.py:127] - Time cost: 0.015s | FilterCol Done
[835787:MainThread](2026-01-11 18:23:17,118) INFO - qlib.timer - [log.py:127] - Time cost: 0.161s | ZScoreNorm Done
[835787:MainThread](2026-01-11 18:23:17,179) INFO - qlib.timer - [log.py:127] - Time cost: 0.061s | Fillna Done
[835787:MainThread](2026-01-11 18:23:17,265) INFO - qlib.timer - [log.py:127] - Time cost: 0.029s | DropnaLabel Done
[835787:MainThread](2026-01-11 18:23:17,527) INFO - qlib.timer - [log.py:127] - Time cost: 0.260s | CSRankNorm Done
[835787:MainThread](2026-01-11 18:23:17,530) INFO - qlib.timer - [log.py:127] - Time cost: 0.816s | fit & process data Done
[835787:MainThread](2026-01-11 18:23:17,530) INFO - qlib.timer - [log.py:127] - Time cost: 67.274s | Init data Done
2026-01-11 18:23:17.531 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 18:23:17,542) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 18:23:17,543) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 18:23:17,545) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 18:23:17,545) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:23:17.550 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 18:23:19,959) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 18:23:19,960) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 18:23:19,961) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:23:26,856) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:23:36,398) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993662, valid -0.996497
[835787:MainThread](2026-01-11 18:23:36,399) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 18:23:36,400) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:23:43,274) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:23:52,582) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992496, valid -0.997386
[835787:MainThread](2026-01-11 18:23:52,582) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 18:23:52,583) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:24:00,272) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:24:17,549) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991993, valid -0.996628
[835787:MainThread](2026-01-11 18:24:17,550) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 18:24:17,550) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:24:27,715) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:24:45,630) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991435, valid -0.998370
[835787:MainThread](2026-01-11 18:24:45,631) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 18:24:45,631) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:24:53,653) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:25:05,607) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990805, valid -0.998983
[835787:MainThread](2026-01-11 18:25:05,608) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 18:25:05,609) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:25:15,195) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:25:29,466) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990439, valid -0.998063
[835787:MainThread](2026-01-11 18:25:29,467) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 18:25:29,467) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:25:40,809) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:25:54,306) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989818, valid -0.998143
[835787:MainThread](2026-01-11 18:25:54,306) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 18:25:54,307) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:26:05,312) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:26:22,009) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989031, valid -0.998499
[835787:MainThread](2026-01-11 18:26:22,010) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 18:26:22,010) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:26:31,257) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:26:45,247) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988901, valid -1.000224
[835787:MainThread](2026-01-11 18:26:45,247) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 18:26:45,248) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:26:55,179) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:27:13,427) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988322, valid -1.000547
[835787:MainThread](2026-01-11 18:27:13,428) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 18:27:13,428) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:27:25,178) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:27:39,088) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987965, valid -0.999283
[835787:MainThread](2026-01-11 18:27:39,089) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 18:27:39,089) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.996497 @ 0
2026-01-11 18:27:39.108 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:27:44.748 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 18:27:44.749 | INFO     | __main__:train_single_fold:593 -   IC=0.0201, ICIR=0.1700, RankIC=0.0504, RankICIR=0.4504
2026-01-11 18:27:44.749 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 18:27:44,758) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:28:20,263) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:28:20,264) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:28:28,422) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9f5943d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 21.35it/s]backtest loop:   4%|▎         | 9/242 [00:00<00:06, 38.38it/s]backtest loop:   7%|▋         | 16/242 [00:00<00:04, 50.49it/s]backtest loop:  10%|▉         | 23/242 [00:00<00:03, 57.39it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 56.76it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:03, 60.91it/s]backtest loop:  18%|█▊        | 43/242 [00:00<00:03, 60.09it/s]backtest loop:  21%|██        | 50/242 [00:00<00:03, 59.62it/s]backtest loop:  24%|██▍       | 58/242 [00:01<00:02, 63.39it/s]backtest loop:  27%|██▋       | 65/242 [00:01<00:02, 61.88it/s]backtest loop:  30%|██▉       | 72/242 [00:01<00:02, 59.54it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:02, 59.00it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:02, 61.62it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:02, 63.54it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:02, 61.94it/s]backtest loop:  44%|████▍     | 107/242 [00:01<00:02, 64.14it/s]backtest loop:  47%|████▋     | 114/242 [00:01<00:01, 64.84it/s]backtest loop:  51%|█████     | 123/242 [00:02<00:01, 69.00it/s]backtest loop:  55%|█████▍    | 132/242 [00:02<00:01, 74.59it/s]backtest loop:  58%|█████▊    | 140/242 [00:02<00:01, 74.40it/s]backtest loop:  61%|██████    | 148/242 [00:02<00:01, 74.42it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 77.80it/s]backtest loop:  68%|██████▊   | 165/242 [00:02<00:01, 76.81it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 76.22it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 77.23it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 80.19it/s]backtest loop:  83%|████████▎ | 202/242 [00:03<00:00, 81.87it/s]backtest loop:  88%|████████▊ | 212/242 [00:03<00:00, 82.86it/s]backtest loop:  92%|█████████▏| 222/242 [00:03<00:00, 84.03it/s]backtest loop:  96%|█████████▌| 232/242 [00:03<00:00, 85.92it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 87.42it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 69.88it/s]
2026-01-11 18:28:31.904 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1131, Sharpe(w/cost)=1.3823, MaxDD=-0.1053
2026-01-11 18:28:35.680 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 18:28:51.582 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:28:51.639 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_6_pred.parquet
2026-01-11 18:28:51.654 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 18:28:51.654 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 18:28:55.986 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0376
2026-01-11 18:29:00.111 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0436
2026-01-11 18:29:04.528 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0397
2026-01-11 18:29:08.629 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0414
2026-01-11 18:29:13.065 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0442
2026-01-11 18:29:17.529 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0445
2026-01-11 18:29:17.858 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0207, ICIR=0.1684, RankIC=0.0503
[835787:MainThread](2026-01-11 18:29:17,863) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:29:48,946) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:29:48,947) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:29:56,084) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7ef9b28e8810>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 25.52it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 49.75it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 62.61it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:02, 72.03it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:02, 73.45it/s]backtest loop:  18%|█▊        | 44/242 [00:00<00:02, 74.20it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 78.49it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 77.22it/s]backtest loop:  29%|██▊       | 69/242 [00:00<00:02, 76.35it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 74.91it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 74.88it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 75.41it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 75.82it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 78.21it/s]backtest loop:  50%|████▉     | 120/242 [00:01<00:01, 77.07it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 76.16it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 79.47it/s]backtest loop:  60%|█████▉    | 145/242 [00:01<00:01, 77.84it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 78.35it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 81.59it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 83.22it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 85.40it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 85.52it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 86.60it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 87.55it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 88.19it/s]backtest loop:  96%|█████████▌| 232/242 [00:02<00:00, 88.82it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 89.07it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 79.22it/s]
2026-01-11 18:29:59.157 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1042, Sharpe(w/cost)=1.4080
2026-01-11 18:29:59.199 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:29:59.199 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 18:29:59.200 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:29:59.200 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 18:31:08,411) INFO - qlib.timer - [log.py:127] - Time cost: 69.210s | Loading data Done
[835787:MainThread](2026-01-11 18:31:08,658) INFO - qlib.timer - [log.py:127] - Time cost: 0.013s | FilterCol Done
[835787:MainThread](2026-01-11 18:31:08,784) INFO - qlib.timer - [log.py:127] - Time cost: 0.125s | ZScoreNorm Done
[835787:MainThread](2026-01-11 18:31:08,847) INFO - qlib.timer - [log.py:127] - Time cost: 0.063s | Fillna Done
[835787:MainThread](2026-01-11 18:31:08,931) INFO - qlib.timer - [log.py:127] - Time cost: 0.023s | DropnaLabel Done
[835787:MainThread](2026-01-11 18:31:09,110) INFO - qlib.timer - [log.py:127] - Time cost: 0.178s | CSRankNorm Done
[835787:MainThread](2026-01-11 18:31:09,111) INFO - qlib.timer - [log.py:127] - Time cost: 0.698s | fit & process data Done
[835787:MainThread](2026-01-11 18:31:09,111) INFO - qlib.timer - [log.py:127] - Time cost: 69.910s | Init data Done
2026-01-11 18:31:09.111 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 18:31:09,120) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 18:31:09,121) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 18:31:09,122) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 18:31:09,122) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:31:09.127 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 18:31:10,803) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 18:31:10,804) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 18:31:10,804) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:31:18,016) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:31:28,952) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994417, valid -0.995577
[835787:MainThread](2026-01-11 18:31:28,954) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 18:31:28,954) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:31:36,092) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:31:46,371) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993988, valid -0.995755
[835787:MainThread](2026-01-11 18:31:46,371) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 18:31:46,372) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:31:54,803) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:32:06,360) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993299, valid -0.996631
[835787:MainThread](2026-01-11 18:32:06,361) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 18:32:06,361) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:32:16,359) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:32:28,907) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992887, valid -0.996321
[835787:MainThread](2026-01-11 18:32:28,908) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 18:32:28,908) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:32:36,775) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:32:56,002) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992210, valid -0.995567
[835787:MainThread](2026-01-11 18:32:56,003) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 18:32:56,004) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:33:05,734) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:33:23,967) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992220, valid -0.997597
[835787:MainThread](2026-01-11 18:33:23,967) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 18:33:23,968) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:33:33,641) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:33:50,500) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991566, valid -0.996257
[835787:MainThread](2026-01-11 18:33:50,500) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 18:33:50,501) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:33:59,364) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:34:12,417) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990957, valid -0.996886
[835787:MainThread](2026-01-11 18:34:12,417) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 18:34:12,418) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:34:27,762) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:34:48,749) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991020, valid -0.996597
[835787:MainThread](2026-01-11 18:34:48,749) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 18:34:48,750) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:35:05,131) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:35:26,970) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990538, valid -0.998356
[835787:MainThread](2026-01-11 18:35:26,970) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 18:35:26,971) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:35:43,650) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:36:06,137) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990046, valid -0.997771
[835787:MainThread](2026-01-11 18:36:06,137) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 18:36:06,138) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:36:22,384) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:36:41,647) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989846, valid -0.998784
[835787:MainThread](2026-01-11 18:36:41,648) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835787:MainThread](2026-01-11 18:36:41,649) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:36:53,113) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:37:11,013) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989207, valid -0.998590
[835787:MainThread](2026-01-11 18:37:11,013) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch13:
[835787:MainThread](2026-01-11 18:37:11,014) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:37:23,774) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:37:41,353) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988952, valid -0.998454
[835787:MainThread](2026-01-11 18:37:41,354) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch14:
[835787:MainThread](2026-01-11 18:37:41,354) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:37:55,317) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:38:13,813) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988289, valid -0.998674
[835787:MainThread](2026-01-11 18:38:13,813) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 18:38:13,814) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.995567 @ 4
2026-01-11 18:38:13.838 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:38:19.805 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 18:38:19.805 | INFO     | __main__:train_single_fold:593 -   IC=0.0132, ICIR=0.0905, RankIC=0.0438, RankICIR=0.3946
2026-01-11 18:38:19.806 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 18:38:19,814) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:38:54,677) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:38:54,678) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:39:02,767) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7ef9d37fc3d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:12, 18.75it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 42.72it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:04, 55.44it/s]backtest loop:  11%|█         | 27/242 [00:00<00:03, 63.46it/s]backtest loop:  14%|█▍        | 34/242 [00:00<00:03, 63.58it/s]backtest loop:  18%|█▊        | 43/242 [00:00<00:02, 69.51it/s]backtest loop:  21%|██        | 51/242 [00:00<00:02, 69.79it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 69.77it/s]backtest loop:  28%|██▊       | 67/242 [00:01<00:02, 70.42it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 70.35it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 72.25it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:02, 69.81it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 71.70it/s]backtest loop:  45%|████▌     | 109/242 [00:01<00:01, 75.31it/s]backtest loop:  48%|████▊     | 117/242 [00:01<00:01, 74.74it/s]backtest loop:  52%|█████▏    | 125/242 [00:01<00:01, 74.44it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 74.35it/s]backtest loop:  59%|█████▊    | 142/242 [00:02<00:01, 77.81it/s]backtest loop:  62%|██████▏   | 150/242 [00:02<00:01, 76.70it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 73.89it/s]backtest loop:  69%|██████▊   | 166/242 [00:02<00:01, 70.72it/s]backtest loop:  72%|███████▏  | 174/242 [00:02<00:01, 64.99it/s]backtest loop:  75%|███████▍  | 181/242 [00:02<00:00, 63.44it/s]backtest loop:  78%|███████▊  | 188/242 [00:02<00:00, 58.82it/s]backtest loop:  80%|████████  | 194/242 [00:02<00:00, 57.84it/s]backtest loop:  83%|████████▎ | 200/242 [00:03<00:00, 57.13it/s]backtest loop:  85%|████████▌ | 206/242 [00:03<00:00, 57.66it/s]backtest loop:  88%|████████▊ | 213/242 [00:03<00:00, 60.45it/s]backtest loop:  92%|█████████▏| 222/242 [00:03<00:00, 64.82it/s]backtest loop:  95%|█████████▌| 231/242 [00:03<00:00, 70.88it/s]backtest loop:  99%|█████████▉| 239/242 [00:03<00:00, 71.65it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 67.14it/s]
2026-01-11 18:39:06.393 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0314, Sharpe(w/cost)=0.5040, MaxDD=-0.0500
2026-01-11 18:39:09.383 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 18:39:25.041 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:39:25.136 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_7_pred.parquet
2026-01-11 18:39:25.149 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 18:39:25.149 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 18:39:29.398 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0251
2026-01-11 18:39:33.327 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0301
2026-01-11 18:39:37.370 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0290
2026-01-11 18:39:42.080 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0385
2026-01-11 18:39:46.651 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0358
2026-01-11 18:39:50.662 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0376
2026-01-11 18:39:54.862 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0374
2026-01-11 18:39:55.192 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0127, ICIR=0.0848, RankIC=0.0443
[835787:MainThread](2026-01-11 18:39:55,197) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:40:29,511) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:40:29,512) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:40:37,138) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9df9c3d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.66it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 50.85it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 62.41it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 71.07it/s]backtest loop:  15%|█▌        | 37/242 [00:00<00:02, 73.50it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 76.75it/s]backtest loop:  23%|██▎       | 55/242 [00:00<00:02, 79.62it/s]backtest loop:  26%|██▋       | 64/242 [00:00<00:02, 78.65it/s]backtest loop:  30%|███       | 73/242 [00:00<00:02, 80.74it/s]backtest loop:  34%|███▍      | 82/242 [00:01<00:01, 80.62it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:01, 80.07it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 79.00it/s]backtest loop:  45%|████▌     | 109/242 [00:01<00:01, 81.19it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 75.31it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 77.70it/s]backtest loop:  56%|█████▌    | 135/242 [00:01<00:01, 76.22it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 69.49it/s]backtest loop:  63%|██████▎   | 152/242 [00:02<00:01, 73.42it/s]backtest loop:  66%|██████▌   | 160/242 [00:02<00:01, 73.37it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:01, 73.51it/s]backtest loop:  73%|███████▎  | 177/242 [00:02<00:00, 77.29it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 76.54it/s]backtest loop:  80%|███████▉  | 193/242 [00:02<00:00, 75.45it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 75.65it/s]backtest loop:  87%|████████▋ | 211/242 [00:02<00:00, 78.36it/s]backtest loop:  90%|█████████ | 219/242 [00:02<00:00, 76.81it/s]backtest loop:  94%|█████████▍| 227/242 [00:03<00:00, 75.45it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 78.33it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.84it/s]
2026-01-11 18:40:40.392 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0101, Sharpe(w/cost)=0.1724
2026-01-11 18:40:40.426 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:40:40.426 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 18:40:40.427 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:40:40.427 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835787:MainThread](2026-01-11 18:41:54,817) INFO - qlib.timer - [log.py:127] - Time cost: 74.388s | Loading data Done
[835787:MainThread](2026-01-11 18:41:55,081) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[835787:MainThread](2026-01-11 18:41:55,222) INFO - qlib.timer - [log.py:127] - Time cost: 0.140s | ZScoreNorm Done
[835787:MainThread](2026-01-11 18:41:55,304) INFO - qlib.timer - [log.py:127] - Time cost: 0.081s | Fillna Done
[835787:MainThread](2026-01-11 18:41:55,376) INFO - qlib.timer - [log.py:127] - Time cost: 0.028s | DropnaLabel Done
[835787:MainThread](2026-01-11 18:41:55,600) INFO - qlib.timer - [log.py:127] - Time cost: 0.224s | CSRankNorm Done
[835787:MainThread](2026-01-11 18:41:55,629) INFO - qlib.timer - [log.py:127] - Time cost: 0.810s | fit & process data Done
[835787:MainThread](2026-01-11 18:41:55,629) INFO - qlib.timer - [log.py:127] - Time cost: 75.201s | Init data Done
2026-01-11 18:41:55.629 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835787:MainThread](2026-01-11 18:41:55,769) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835787:MainThread](2026-01-11 18:41:55,770) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835787:MainThread](2026-01-11 18:41:55,773) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835787:MainThread](2026-01-11 18:41:55,773) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:41:55.779 | INFO     | __main__:train_single_fold:569 - Training gru_158_10_zscore model (GPU=0)...
[835787:MainThread](2026-01-11 18:41:57,972) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835787:MainThread](2026-01-11 18:41:57,972) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835787:MainThread](2026-01-11 18:41:57,973) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:42:04,633) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:42:14,906) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994752, valid -0.995109
[835787:MainThread](2026-01-11 18:42:14,910) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835787:MainThread](2026-01-11 18:42:14,910) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:42:21,834) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:42:31,679) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994196, valid -0.995102
[835787:MainThread](2026-01-11 18:42:31,681) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835787:MainThread](2026-01-11 18:42:31,682) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:42:39,162) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:42:49,388) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993698, valid -0.995030
[835787:MainThread](2026-01-11 18:42:49,390) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835787:MainThread](2026-01-11 18:42:49,390) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:42:55,808) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:43:08,108) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993826, valid -0.995979
[835787:MainThread](2026-01-11 18:43:08,109) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835787:MainThread](2026-01-11 18:43:08,109) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:43:15,335) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:43:27,615) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992859, valid -0.996116
[835787:MainThread](2026-01-11 18:43:27,615) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835787:MainThread](2026-01-11 18:43:27,616) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:43:35,192) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:43:48,076) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992723, valid -0.995545
[835787:MainThread](2026-01-11 18:43:48,077) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835787:MainThread](2026-01-11 18:43:48,077) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:43:56,219) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:44:15,182) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992190, valid -0.995652
[835787:MainThread](2026-01-11 18:44:15,183) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835787:MainThread](2026-01-11 18:44:15,183) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:44:25,220) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:44:37,898) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991846, valid -0.996741
[835787:MainThread](2026-01-11 18:44:37,899) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835787:MainThread](2026-01-11 18:44:37,899) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:44:48,097) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:44:59,848) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991490, valid -0.996185
[835787:MainThread](2026-01-11 18:44:59,849) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835787:MainThread](2026-01-11 18:44:59,849) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:45:11,857) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:45:29,188) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991091, valid -0.996089
[835787:MainThread](2026-01-11 18:45:29,189) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835787:MainThread](2026-01-11 18:45:29,189) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:45:40,142) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:45:59,963) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990769, valid -0.996641
[835787:MainThread](2026-01-11 18:45:59,964) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835787:MainThread](2026-01-11 18:45:59,965) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:46:12,127) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:46:31,499) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990366, valid -0.996905
[835787:MainThread](2026-01-11 18:46:31,500) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835787:MainThread](2026-01-11 18:46:31,500) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835787:MainThread](2026-01-11 18:46:43,172) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835787:MainThread](2026-01-11 18:47:01,740) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990096, valid -0.997277
[835787:MainThread](2026-01-11 18:47:01,740) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835787:MainThread](2026-01-11 18:47:01,741) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.995030 @ 2
2026-01-11 18:47:01.761 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:47:07.139 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 18:47:07.140 | INFO     | __main__:train_single_fold:593 -   IC=0.0231, ICIR=0.1197, RankIC=0.0564, RankICIR=0.2810
2026-01-11 18:47:07.140 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835787:MainThread](2026-01-11 18:47:07,147) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:47:46,951) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:47:46,952) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:47:54,429) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9d2e2c90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.30it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 47.78it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.24it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 67.20it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:02, 71.02it/s]backtest loop:  18%|█▊        | 44/242 [00:00<00:02, 68.28it/s]backtest loop:  21%|██▏       | 52/242 [00:00<00:02, 70.00it/s]backtest loop:  25%|██▍       | 60/242 [00:00<00:02, 67.93it/s]backtest loop:  28%|██▊       | 67/242 [00:01<00:02, 65.12it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 68.58it/s]backtest loop:  34%|███▍      | 82/242 [00:01<00:02, 65.47it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:02, 66.65it/s]backtest loop:  40%|████      | 98/242 [00:01<00:02, 68.48it/s]backtest loop:  44%|████▍     | 106/242 [00:01<00:01, 70.64it/s]backtest loop:  47%|████▋     | 114/242 [00:01<00:01, 67.05it/s]backtest loop:  50%|█████     | 121/242 [00:01<00:01, 65.63it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 62.24it/s]backtest loop:  57%|█████▋    | 137/242 [00:02<00:01, 66.08it/s]backtest loop:  60%|██████    | 146/242 [00:02<00:01, 72.04it/s]backtest loop:  64%|██████▎   | 154/242 [00:02<00:01, 73.14it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 74.62it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 77.86it/s]backtest loop:  75%|███████▍  | 181/242 [00:02<00:00, 77.10it/s]backtest loop:  79%|███████▊  | 190/242 [00:02<00:00, 78.52it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 80.45it/s]backtest loop:  87%|████████▋ | 210/242 [00:02<00:00, 83.06it/s]backtest loop:  90%|█████████ | 219/242 [00:03<00:00, 84.60it/s]backtest loop:  94%|█████████▍| 228/242 [00:03<00:00, 82.51it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 76.32it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 70.93it/s]
2026-01-11 18:47:57.862 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0287, Sharpe(w/cost)=-0.2577, MaxDD=-0.1658
2026-01-11 18:48:03.095 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 18:48:17.627 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:48:17.690 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/fold_8_pred.parquet
2026-01-11 18:48:17.706 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 18:48:17.707 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 18:48:22.996 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0307
2026-01-11 18:48:27.719 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0300
2026-01-11 18:48:32.812 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0222
2026-01-11 18:48:37.360 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0258
2026-01-11 18:48:42.409 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0351
2026-01-11 18:48:46.595 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0359
2026-01-11 18:48:51.403 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0435
2026-01-11 18:48:56.225 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0465
2026-01-11 18:48:56.569 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0210, ICIR=0.1139, RankIC=0.0509
[835787:MainThread](2026-01-11 18:48:56,575) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835787:MainThread](2026-01-11 18:49:31,959) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:49:31,960) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:49:39,732) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9cd79450>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.74it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 47.58it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.06it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 67.50it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 72.63it/s]backtest loop:  20%|█▉        | 48/242 [00:00<00:02, 76.69it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 79.56it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 80.85it/s]backtest loop:  31%|███▏      | 76/242 [00:01<00:02, 81.50it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:01, 81.95it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 82.49it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 82.75it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 81.18it/s]backtest loop:  50%|█████     | 122/242 [00:01<00:01, 81.29it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 81.49it/s]backtest loop:  59%|█████▊    | 142/242 [00:01<00:01, 81.57it/s]backtest loop:  63%|██████▎   | 152/242 [00:01<00:01, 81.62it/s]backtest loop:  67%|██████▋   | 161/242 [00:02<00:00, 83.25it/s]backtest loop:  70%|███████   | 170/242 [00:02<00:00, 81.40it/s]backtest loop:  74%|███████▍  | 179/242 [00:02<00:00, 79.78it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 76.37it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 76.04it/s]backtest loop:  84%|████████▍ | 204/242 [00:02<00:00, 78.96it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 77.64it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 76.82it/s]backtest loop:  95%|█████████▍| 229/242 [00:02<00:00, 79.94it/s]backtest loop:  98%|█████████▊| 238/242 [00:03<00:00, 79.08it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 77.22it/s]
2026-01-11 18:49:42.885 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0431, Sharpe(w/cost)=-0.3903
2026-01-11 18:49:42.922 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 18:49:42.922 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 18:49:42.922 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 18:49:42.928 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 18:49:42.928 | INFO     | __main__:_print_summary:827 -   IC: 0.0219
2026-01-11 18:49:42.929 | INFO     | __main__:_print_summary:828 -   ICIR: 0.1810
2026-01-11 18:49:42.929 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0499
2026-01-11 18:49:42.929 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0307
2026-01-11 18:49:42.929 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.3803
2026-01-11 18:49:42.929 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0462
2026-01-11 18:49:42.932 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/summary.csv
2026-01-11 18:49:42.932 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 18:49:42.932 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 18:49:42.933 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 18:49:42.933 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 18:49:42.935 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 18:49:42.935 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0499
2026-01-11 18:49:42.936 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0361
2026-01-11 18:49:42.936 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0361)
2026-01-11 18:49:42.936 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 18:49:42.936 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/ensemble_matrix.csv
2026-01-11 18:49:42.937 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 18:49:42.937 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 18:49:42.937 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 18:49:43.067 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 18:49:43.067 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 18:49:44.667 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0219, ICIR=0.1629, RankIC=0.0499
[835787:MainThread](2026-01-11 18:49:44,677) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.054293 0.437124 0.084450  0.377499  3.682053 -0.032925         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.034413 0.269351 0.061362  0.026929  0.487842 -0.030912    0.061559    1.243893
    2 2018-01-01 ~ 2018-12-31 0.037828 0.412160 0.039584 -0.027153 -0.453069 -0.093301    0.043724   -1.523472
    3 2019-01-01 ~ 2019-12-31 0.011394 0.109559 0.045640  0.022042  0.348390 -0.073692    0.046632    0.676747
    4 2020-01-01 ~ 2020-12-31 0.001005 0.006903 0.037645 -0.132880 -1.279176 -0.149499    0.041815   -0.610749
    5 2021-01-01 ~ 2021-12-31 0.001800 0.014052 0.029778 -0.105679 -0.991699 -0.196380    0.030202   -0.188804
    6 2022-01-01 ~ 2022-12-31 0.020102 0.170034 0.050403  0.113141  1.382255 -0.105279    0.050256    1.407958
    7 2023-01-01 ~ 2023-12-31 0.013235 0.090542 0.043814  0.031380  0.503951 -0.049971    0.044261    0.172368
    8 2024-01-01 ~ 2024-12-31 0.023119 0.119679 0.056417 -0.028746 -0.257729 -0.165783    0.050870   -0.390290

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.0844     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0585  0.0614     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0373  0.0384  0.0396     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0406  0.0471  0.0380  0.0456     NaN     NaN     NaN     NaN     NaN
T4  0.0381  0.0391  0.0370  0.0401  0.0376     NaN     NaN     NaN     NaN
T5  0.0246  0.0252  0.0240  0.0271  0.0310  0.0298     NaN     NaN     NaN
T6  0.0376  0.0436  0.0397  0.0414  0.0442  0.0445  0.0504     NaN     NaN
T7  0.0251  0.0301  0.0290  0.0385  0.0358  0.0376  0.0374  0.0438     NaN
T8  0.0307  0.0300  0.0222  0.0258  0.0351  0.0359  0.0435  0.0465  0.0564
[835787:MainThread](2026-01-11 18:50:23,398) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:50:23,402) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835787:MainThread](2026-01-11 18:51:15,513) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7efb9cb08cd0>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 3/2187 [00:00<01:29, 24.40it/s]backtest loop:   0%|          | 10/2187 [00:00<00:45, 47.74it/s]backtest loop:   1%|          | 20/2187 [00:00<00:34, 62.75it/s]backtest loop:   1%|▏         | 30/2187 [00:00<00:30, 70.04it/s]backtest loop:   2%|▏         | 40/2187 [00:00<00:28, 75.09it/s]backtest loop:   2%|▏         | 50/2187 [00:00<00:27, 76.82it/s]backtest loop:   3%|▎         | 60/2187 [00:00<00:26, 79.68it/s]backtest loop:   3%|▎         | 70/2187 [00:00<00:25, 83.80it/s]backtest loop:   4%|▎         | 80/2187 [00:01<00:24, 86.60it/s]backtest loop:   4%|▍         | 89/2187 [00:01<00:24, 87.40it/s]backtest loop:   4%|▍         | 98/2187 [00:01<00:23, 87.90it/s]backtest loop:   5%|▍         | 107/2187 [00:01<00:23, 88.44it/s]backtest loop:   5%|▌         | 117/2187 [00:01<00:22, 90.10it/s]backtest loop:   6%|▌         | 127/2187 [00:01<00:22, 91.37it/s]backtest loop:   6%|▋         | 137/2187 [00:01<00:22, 92.95it/s]backtest loop:   7%|▋         | 147/2187 [00:01<00:21, 93.84it/s]backtest loop:   7%|▋         | 157/2187 [00:01<00:21, 93.14it/s]backtest loop:   8%|▊         | 167/2187 [00:01<00:21, 92.64it/s]backtest loop:   8%|▊         | 177/2187 [00:02<00:21, 91.65it/s]backtest loop:   9%|▊         | 187/2187 [00:02<00:21, 91.66it/s]backtest loop:   9%|▉         | 197/2187 [00:02<00:21, 92.06it/s]backtest loop:   9%|▉         | 207/2187 [00:02<00:22, 89.37it/s]backtest loop:  10%|▉         | 216/2187 [00:02<00:23, 84.79it/s]backtest loop:  10%|█         | 225/2187 [00:02<00:23, 84.13it/s]backtest loop:  11%|█         | 234/2187 [00:02<00:23, 83.49it/s]backtest loop:  11%|█         | 244/2187 [00:02<00:23, 83.39it/s]backtest loop:  12%|█▏        | 253/2187 [00:03<00:23, 83.12it/s]backtest loop:  12%|█▏        | 262/2187 [00:03<00:23, 83.54it/s]backtest loop:  12%|█▏        | 271/2187 [00:03<00:23, 83.03it/s]backtest loop:  13%|█▎        | 280/2187 [00:03<00:23, 82.82it/s]backtest loop:  13%|█▎        | 289/2187 [00:03<00:22, 83.10it/s]backtest loop:  14%|█▎        | 298/2187 [00:03<00:22, 82.16it/s]backtest loop:  14%|█▍        | 307/2187 [00:03<00:22, 81.80it/s]backtest loop:  14%|█▍        | 316/2187 [00:03<00:22, 81.66it/s]backtest loop:  15%|█▍        | 325/2187 [00:03<00:23, 80.67it/s]backtest loop:  15%|█▌        | 335/2187 [00:04<00:22, 81.47it/s]backtest loop:  16%|█▌        | 344/2187 [00:04<00:22, 81.10it/s]backtest loop:  16%|█▌        | 353/2187 [00:04<00:22, 81.46it/s]backtest loop:  17%|█▋        | 363/2187 [00:04<00:22, 82.23it/s]backtest loop:  17%|█▋        | 373/2187 [00:04<00:22, 81.25it/s]backtest loop:  18%|█▊        | 383/2187 [00:04<00:22, 81.41it/s]backtest loop:  18%|█▊        | 393/2187 [00:04<00:21, 81.87it/s]backtest loop:  18%|█▊        | 403/2187 [00:04<00:20, 85.10it/s]backtest loop:  19%|█▉        | 413/2187 [00:04<00:20, 87.31it/s]backtest loop:  19%|█▉        | 423/2187 [00:05<00:19, 88.83it/s]backtest loop:  20%|█▉        | 433/2187 [00:05<00:19, 89.90it/s]backtest loop:  20%|██        | 443/2187 [00:05<00:19, 90.56it/s]backtest loop:  21%|██        | 453/2187 [00:05<00:18, 91.51it/s]backtest loop:  21%|██        | 463/2187 [00:05<00:18, 92.87it/s]backtest loop:  22%|██▏       | 473/2187 [00:05<00:18, 93.65it/s]backtest loop:  22%|██▏       | 483/2187 [00:05<00:18, 94.62it/s]backtest loop:  23%|██▎       | 493/2187 [00:05<00:17, 94.52it/s]backtest loop:  23%|██▎       | 504/2187 [00:05<00:17, 98.98it/s]backtest loop:  24%|██▎       | 516/2187 [00:05<00:16, 103.33it/s]backtest loop:  24%|██▍       | 527/2187 [00:06<00:17, 96.21it/s] backtest loop:  25%|██▍       | 538/2187 [00:06<00:16, 99.82it/s]backtest loop:  25%|██▌       | 549/2187 [00:06<00:16, 101.37it/s]backtest loop:  26%|██▌       | 560/2187 [00:06<00:16, 97.97it/s] backtest loop:  26%|██▌       | 570/2187 [00:06<00:16, 96.94it/s]backtest loop:  27%|██▋       | 580/2187 [00:06<00:17, 94.03it/s]backtest loop:  27%|██▋       | 590/2187 [00:06<00:17, 91.29it/s]backtest loop:  27%|██▋       | 600/2187 [00:06<00:17, 89.74it/s]backtest loop:  28%|██▊       | 610/2187 [00:07<00:17, 88.15it/s]backtest loop:  28%|██▊       | 619/2187 [00:07<00:18, 86.44it/s]backtest loop:  29%|██▊       | 628/2187 [00:07<00:18, 85.29it/s]backtest loop:  29%|██▉       | 637/2187 [00:07<00:18, 84.35it/s]backtest loop:  30%|██▉       | 647/2187 [00:07<00:18, 83.71it/s]backtest loop:  30%|███       | 657/2187 [00:07<00:18, 82.47it/s]backtest loop:  30%|███       | 667/2187 [00:07<00:18, 81.67it/s]backtest loop:  31%|███       | 676/2187 [00:07<00:18, 80.00it/s]backtest loop:  31%|███▏      | 686/2187 [00:07<00:18, 79.85it/s]backtest loop:  32%|███▏      | 695/2187 [00:08<00:18, 82.29it/s]backtest loop:  32%|███▏      | 704/2187 [00:08<00:18, 80.50it/s]backtest loop:  33%|███▎      | 713/2187 [00:08<00:18, 79.66it/s]backtest loop:  33%|███▎      | 721/2187 [00:08<00:18, 77.80it/s]backtest loop:  33%|███▎      | 731/2187 [00:08<00:18, 78.51it/s]backtest loop:  34%|███▍      | 740/2187 [00:08<00:18, 79.86it/s]backtest loop:  34%|███▍      | 749/2187 [00:08<00:17, 81.24it/s]backtest loop:  35%|███▍      | 759/2187 [00:08<00:17, 82.62it/s]backtest loop:  35%|███▌      | 769/2187 [00:08<00:16, 84.24it/s]backtest loop:  36%|███▌      | 779/2187 [00:09<00:16, 84.14it/s]backtest loop:  36%|███▌      | 789/2187 [00:09<00:16, 84.55it/s]backtest loop:  36%|███▋      | 798/2187 [00:09<00:16, 84.40it/s]backtest loop:  37%|███▋      | 808/2187 [00:09<00:16, 84.59it/s]backtest loop:  37%|███▋      | 817/2187 [00:09<00:16, 83.44it/s]backtest loop:  38%|███▊      | 826/2187 [00:09<00:16, 82.98it/s]backtest loop:  38%|███▊      | 835/2187 [00:09<00:16, 82.29it/s]backtest loop:  39%|███▊      | 844/2187 [00:09<00:16, 82.55it/s]backtest loop:  39%|███▉      | 854/2187 [00:10<00:16, 82.56it/s]backtest loop:  40%|███▉      | 864/2187 [00:10<00:16, 82.64it/s]backtest loop:  40%|███▉      | 874/2187 [00:10<00:16, 81.67it/s]backtest loop:  40%|████      | 884/2187 [00:10<00:15, 82.46it/s]backtest loop:  41%|████      | 894/2187 [00:10<00:15, 84.13it/s]backtest loop:  41%|████▏     | 903/2187 [00:10<00:15, 84.36it/s]backtest loop:  42%|████▏     | 913/2187 [00:10<00:15, 84.59it/s]backtest loop:  42%|████▏     | 922/2187 [00:10<00:15, 83.77it/s]backtest loop:  43%|████▎     | 931/2187 [00:10<00:15, 83.14it/s]backtest loop:  43%|████▎     | 940/2187 [00:11<00:15, 82.21it/s]backtest loop:  43%|████▎     | 949/2187 [00:11<00:15, 81.94it/s]backtest loop:  44%|████▍     | 958/2187 [00:11<00:15, 81.61it/s]backtest loop:  44%|████▍     | 969/2187 [00:11<00:13, 87.91it/s]backtest loop:  45%|████▍     | 978/2187 [00:11<00:14, 86.02it/s]backtest loop:  45%|████▌     | 989/2187 [00:11<00:13, 91.45it/s]backtest loop:  46%|████▌     | 1000/2187 [00:11<00:12, 95.36it/s]backtest loop:  46%|████▌     | 1011/2187 [00:11<00:12, 94.18it/s]backtest loop:  47%|████▋     | 1022/2187 [00:11<00:11, 97.12it/s]backtest loop:  47%|████▋     | 1033/2187 [00:12<00:11, 99.49it/s]backtest loop:  48%|████▊     | 1044/2187 [00:12<00:11, 101.03it/s]backtest loop:  48%|████▊     | 1055/2187 [00:12<00:11, 98.07it/s] backtest loop:  49%|████▊     | 1066/2187 [00:12<00:11, 100.32it/s]backtest loop:  49%|████▉     | 1077/2187 [00:12<00:11, 98.30it/s] backtest loop:  50%|████▉     | 1088/2187 [00:12<00:10, 100.33it/s]backtest loop:  50%|█████     | 1099/2187 [00:12<00:10, 101.65it/s]backtest loop:  51%|█████     | 1110/2187 [00:12<00:10, 98.34it/s] backtest loop:  51%|█████▏    | 1121/2187 [00:12<00:10, 100.19it/s]backtest loop:  52%|█████▏    | 1132/2187 [00:13<00:10, 101.54it/s]backtest loop:  52%|█████▏    | 1143/2187 [00:13<00:10, 102.71it/s]backtest loop:  53%|█████▎    | 1154/2187 [00:13<00:09, 104.32it/s]backtest loop:  53%|█████▎    | 1165/2187 [00:13<00:10, 99.17it/s] backtest loop:  54%|█████▎    | 1175/2187 [00:13<00:10, 98.98it/s]backtest loop:  54%|█████▍    | 1185/2187 [00:14<00:24, 41.23it/s]backtest loop:  55%|█████▍    | 1194/2187 [00:14<00:20, 47.40it/s]backtest loop:  55%|█████▌    | 1204/2187 [00:14<00:17, 54.75it/s]backtest loop:  56%|█████▌    | 1214/2187 [00:14<00:15, 62.38it/s]backtest loop:  56%|█████▌    | 1224/2187 [00:14<00:13, 70.16it/s]backtest loop:  56%|█████▋    | 1234/2187 [00:14<00:12, 75.97it/s]backtest loop:  57%|█████▋    | 1243/2187 [00:14<00:12, 78.20it/s]backtest loop:  57%|█████▋    | 1252/2187 [00:14<00:11, 79.07it/s]backtest loop:  58%|█████▊    | 1261/2187 [00:14<00:11, 80.00it/s]backtest loop:  58%|█████▊    | 1270/2187 [00:15<00:11, 80.28it/s]backtest loop:  58%|█████▊    | 1279/2187 [00:15<00:11, 80.61it/s]backtest loop:  59%|█████▉    | 1288/2187 [00:15<00:11, 80.49it/s]backtest loop:  59%|█████▉    | 1297/2187 [00:15<00:11, 80.80it/s]backtest loop:  60%|█████▉    | 1306/2187 [00:15<00:10, 81.09it/s]backtest loop:  60%|██████    | 1315/2187 [00:15<00:10, 81.40it/s]backtest loop:  61%|██████    | 1324/2187 [00:15<00:10, 81.26it/s]backtest loop:  61%|██████    | 1333/2187 [00:15<00:10, 82.44it/s]backtest loop:  61%|██████▏   | 1344/2187 [00:15<00:09, 88.73it/s]backtest loop:  62%|██████▏   | 1355/2187 [00:15<00:08, 93.38it/s]backtest loop:  62%|██████▏   | 1366/2187 [00:16<00:08, 95.96it/s]backtest loop:  63%|██████▎   | 1377/2187 [00:16<00:08, 98.46it/s]backtest loop:  63%|██████▎   | 1388/2187 [00:16<00:08, 95.80it/s]backtest loop:  64%|██████▍   | 1399/2187 [00:16<00:07, 99.27it/s]backtest loop:  64%|██████▍   | 1409/2187 [00:16<00:08, 96.02it/s]backtest loop:  65%|██████▍   | 1419/2187 [00:16<00:07, 96.96it/s]backtest loop:  65%|██████▌   | 1430/2187 [00:16<00:07, 98.83it/s]backtest loop:  66%|██████▌   | 1440/2187 [00:16<00:07, 97.17it/s]backtest loop:  66%|██████▋   | 1450/2187 [00:16<00:07, 93.51it/s]backtest loop:  67%|██████▋   | 1460/2187 [00:17<00:07, 92.34it/s]backtest loop:  67%|██████▋   | 1470/2187 [00:17<00:08, 85.18it/s]backtest loop:  68%|██████▊   | 1480/2187 [00:17<00:08, 85.76it/s]backtest loop:  68%|██████▊   | 1490/2187 [00:17<00:08, 85.32it/s]backtest loop:  69%|██████▊   | 1500/2187 [00:17<00:08, 85.47it/s]backtest loop:  69%|██████▉   | 1510/2187 [00:17<00:07, 85.27it/s]backtest loop:  70%|██████▉   | 1520/2187 [00:17<00:07, 84.95it/s]backtest loop:  70%|██████▉   | 1529/2187 [00:17<00:07, 84.43it/s]backtest loop:  70%|███████   | 1538/2187 [00:18<00:07, 84.00it/s]backtest loop:  71%|███████   | 1547/2187 [00:18<00:07, 83.44it/s]backtest loop:  71%|███████   | 1556/2187 [00:18<00:07, 84.74it/s]backtest loop:  72%|███████▏  | 1567/2187 [00:18<00:06, 90.18it/s]backtest loop:  72%|███████▏  | 1577/2187 [00:18<00:06, 92.25it/s]backtest loop:  73%|███████▎  | 1588/2187 [00:18<00:06, 95.63it/s]backtest loop:  73%|███████▎  | 1598/2187 [00:18<00:06, 94.97it/s]backtest loop:  74%|███████▎  | 1609/2187 [00:18<00:06, 93.39it/s]backtest loop:  74%|███████▍  | 1620/2187 [00:18<00:05, 96.09it/s]backtest loop:  75%|███████▍  | 1630/2187 [00:18<00:05, 97.18it/s]backtest loop:  75%|███████▌  | 1641/2187 [00:19<00:05, 99.08it/s]backtest loop:  75%|███████▌  | 1651/2187 [00:19<00:05, 97.86it/s]backtest loop:  76%|███████▌  | 1661/2187 [00:19<00:05, 95.46it/s]backtest loop:  76%|███████▋  | 1671/2187 [00:19<00:05, 91.52it/s]backtest loop:  77%|███████▋  | 1681/2187 [00:19<00:05, 89.29it/s]backtest loop:  77%|███████▋  | 1690/2187 [00:19<00:05, 87.24it/s]backtest loop:  78%|███████▊  | 1699/2187 [00:19<00:05, 85.48it/s]backtest loop:  78%|███████▊  | 1709/2187 [00:19<00:05, 88.11it/s]backtest loop:  79%|███████▊  | 1718/2187 [00:19<00:05, 83.78it/s]backtest loop:  79%|███████▉  | 1727/2187 [00:20<00:05, 81.76it/s]backtest loop:  79%|███████▉  | 1737/2187 [00:20<00:05, 83.03it/s]backtest loop:  80%|███████▉  | 1747/2187 [00:20<00:05, 84.55it/s]backtest loop:  80%|████████  | 1757/2187 [00:20<00:05, 83.91it/s]backtest loop:  81%|████████  | 1766/2187 [00:20<00:05, 80.61it/s]backtest loop:  81%|████████  | 1776/2187 [00:20<00:05, 81.67it/s]backtest loop:  82%|████████▏ | 1785/2187 [00:20<00:04, 82.06it/s]backtest loop:  82%|████████▏ | 1794/2187 [00:20<00:04, 81.76it/s]backtest loop:  82%|████████▏ | 1803/2187 [00:21<00:04, 82.26it/s]backtest loop:  83%|████████▎ | 1813/2187 [00:21<00:04, 83.04it/s]backtest loop:  83%|████████▎ | 1822/2187 [00:21<00:04, 82.11it/s]backtest loop:  84%|████████▎ | 1831/2187 [00:21<00:04, 82.24it/s]backtest loop:  84%|████████▍ | 1841/2187 [00:21<00:04, 83.25it/s]backtest loop:  85%|████████▍ | 1851/2187 [00:21<00:04, 83.54it/s]backtest loop:  85%|████████▌ | 1861/2187 [00:21<00:03, 84.14it/s]backtest loop:  86%|████████▌ | 1871/2187 [00:21<00:03, 84.28it/s]backtest loop:  86%|████████▌ | 1881/2187 [00:21<00:03, 84.09it/s]backtest loop:  86%|████████▋ | 1890/2187 [00:22<00:03, 83.32it/s]backtest loop:  87%|████████▋ | 1900/2187 [00:22<00:03, 83.80it/s]backtest loop:  87%|████████▋ | 1910/2187 [00:22<00:03, 84.18it/s]backtest loop:  88%|████████▊ | 1920/2187 [00:22<00:03, 84.33it/s]backtest loop:  88%|████████▊ | 1931/2187 [00:22<00:02, 89.92it/s]backtest loop:  89%|████████▉ | 1942/2187 [00:22<00:02, 94.20it/s]backtest loop:  89%|████████▉ | 1953/2187 [00:22<00:02, 96.08it/s]backtest loop:  90%|████████▉ | 1964/2187 [00:22<00:02, 96.01it/s]backtest loop:  90%|█████████ | 1976/2187 [00:22<00:02, 102.34it/s]backtest loop:  91%|█████████ | 1988/2187 [00:23<00:01, 103.69it/s]backtest loop:  91%|█████████▏| 2001/2187 [00:23<00:01, 109.05it/s]backtest loop:  92%|█████████▏| 2012/2187 [00:23<00:01, 105.84it/s]backtest loop:  93%|█████████▎| 2023/2187 [00:23<00:01, 104.32it/s]backtest loop:  93%|█████████▎| 2035/2187 [00:23<00:01, 107.72it/s]backtest loop:  94%|█████████▎| 2048/2187 [00:23<00:01, 108.08it/s]backtest loop:  94%|█████████▍| 2060/2187 [00:23<00:01, 111.34it/s]backtest loop:  95%|█████████▍| 2072/2187 [00:23<00:01, 109.72it/s]backtest loop:  95%|█████████▌| 2085/2187 [00:23<00:00, 113.55it/s]backtest loop:  96%|█████████▌| 2097/2187 [00:24<00:00, 104.96it/s]backtest loop:  96%|█████████▋| 2108/2187 [00:24<00:00, 102.91it/s]backtest loop:  97%|█████████▋| 2119/2187 [00:24<00:00, 98.44it/s] backtest loop:  97%|█████████▋| 2129/2187 [00:24<00:00, 92.64it/s]backtest loop:  98%|█████████▊| 2139/2187 [00:24<00:00, 91.00it/s]backtest loop:  98%|█████████▊| 2149/2187 [00:24<00:00, 88.36it/s]backtest loop:  99%|█████████▊| 2158/2187 [00:24<00:00, 86.37it/s]backtest loop:  99%|█████████▉| 2167/2187 [00:24<00:00, 85.31it/s]backtest loop:  99%|█████████▉| 2176/2187 [00:25<00:00, 84.58it/s]backtest loop: 100%|█████████▉| 2185/2187 [00:25<00:00, 83.72it/s]backtest loop: 100%|██████████| 2187/2187 [00:25<00:00, 86.96it/s]
2026-01-11 18:51:40.767 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 18:51:40.767 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0630
2026-01-11 18:51:40.767 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.7337
2026-01-11 18:51:40.767 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2633
2026-01-11 18:51:46.240 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pdf/full_backtest_report.pdf
2026-01-11 18:52:04.770 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:52:04.978 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_10_zscore_6y/pred/full_pred.parquet
