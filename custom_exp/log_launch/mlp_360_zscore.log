Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1421653:MainThread](2026-01-11 22:27:00,116) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1421653:MainThread](2026-01-11 22:27:00,566) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1421653:MainThread](2026-01-11 22:27:00,566) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 22:27:00.575 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y
2026-01-11 22:27:00.575 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/log/mlp_360_zscore_csi500_topk_20260111_222700.log
2026-01-11 22:27:00.575 | INFO     | __main__:__init__:115 - Model name: mlp_360_zscore_csi500_topk
2026-01-11 22:27:00.577 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 22:27:00.578 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:27:00.578 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 22:27:00.578 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:27:00.578 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:27:31,958) INFO - qlib.timer - [log.py:127] - Time cost: 31.379s | Loading data Done
[1421653:MainThread](2026-01-11 22:27:34,950) INFO - qlib.timer - [log.py:127] - Time cost: 2.426s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:27:36,897) INFO - qlib.timer - [log.py:127] - Time cost: 1.946s | Fillna Done
[1421653:MainThread](2026-01-11 22:27:38,482) INFO - qlib.timer - [log.py:127] - Time cost: 0.313s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:27:38,708) INFO - qlib.timer - [log.py:127] - Time cost: 0.225s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:27:38,711) INFO - qlib.timer - [log.py:127] - Time cost: 6.747s | fit & process data Done
[1421653:MainThread](2026-01-11 22:27:38,711) INFO - qlib.timer - [log.py:127] - Time cost: 38.133s | Init data Done
2026-01-11 22:27:38.712 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:27:38,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:27:38,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:27:38,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:27:38,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:27:40.650 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:27:42,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:27:42,520) INFO - qlib.workflow - [exp.py:258] - Experiment 528155627018642494 starts running ...
[1421653:MainThread](2026-01-11 22:27:42,622) INFO - qlib.workflow - [recorder.py:345] - Recorder 2d3f9500acf44394811d2418481b5253 starts running under Experiment 528155627018642494 ...
[1421653:MainThread](2026-01-11 22:27:43,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.688567, valid_loss 1.264455, train_metric nan, valid_metric 0.038253
[1421653:MainThread](2026-01-11 22:27:43,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.264455, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:43,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.110135, valid_loss 1.048927, train_metric nan, valid_metric 0.064801
[1421653:MainThread](2026-01-11 22:27:43,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.264455 to 1.048927, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:44,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.063415, valid_loss 1.016365, train_metric nan, valid_metric 0.058743
[1421653:MainThread](2026-01-11 22:27:44,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.048927 to 1.016365, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:44,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.051356, valid_loss 1.012049, train_metric nan, valid_metric 0.051416
[1421653:MainThread](2026-01-11 22:27:44,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.016365 to 1.012049, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:45,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.053795, valid_loss 1.011029, train_metric nan, valid_metric 0.063815
[1421653:MainThread](2026-01-11 22:27:45,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012049 to 1.011029, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:45,579) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.046394, valid_loss 1.006606, train_metric nan, valid_metric 0.069943
[1421653:MainThread](2026-01-11 22:27:45,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.011029 to 1.006606, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:45,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.042638, valid_loss 1.009529, train_metric nan, valid_metric 0.069131
[1421653:MainThread](2026-01-11 22:27:46,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.034701, valid_loss 1.004969, train_metric nan, valid_metric 0.061032
[1421653:MainThread](2026-01-11 22:27:46,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006606 to 1.004969, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:46,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.036591, valid_loss 1.002432, train_metric nan, valid_metric 0.074445
[1421653:MainThread](2026-01-11 22:27:46,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004969 to 1.002432, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:47,151) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.036178, valid_loss 1.006905, train_metric nan, valid_metric 0.074129
[1421653:MainThread](2026-01-11 22:27:47,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.034347, valid_loss 1.002615, train_metric nan, valid_metric 0.079159
[1421653:MainThread](2026-01-11 22:27:48,073) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.025027, valid_loss 1.004519, train_metric nan, valid_metric 0.080324
[1421653:MainThread](2026-01-11 22:27:48,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.031451, valid_loss 1.005532, train_metric nan, valid_metric 0.079914
[1421653:MainThread](2026-01-11 22:27:48,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.025447, valid_loss 1.005064, train_metric nan, valid_metric 0.068735
[1421653:MainThread](2026-01-11 22:27:49,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.026245, valid_loss 1.001666, train_metric nan, valid_metric 0.065926
[1421653:MainThread](2026-01-11 22:27:49,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002432 to 1.001666, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:49,726) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.027976, valid_loss 1.007524, train_metric nan, valid_metric 0.084301
[1421653:MainThread](2026-01-11 22:27:50,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.019975, valid_loss 1.013381, train_metric nan, valid_metric 0.077098
[1421653:MainThread](2026-01-11 22:27:50,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.024822, valid_loss 1.012723, train_metric nan, valid_metric 0.064852
[1421653:MainThread](2026-01-11 22:27:51,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.024425, valid_loss 1.004308, train_metric nan, valid_metric 0.079683
[1421653:MainThread](2026-01-11 22:27:51,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.017091, valid_loss 1.007915, train_metric nan, valid_metric 0.086900
[1421653:MainThread](2026-01-11 22:27:52,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.014992, valid_loss 1.004630, train_metric nan, valid_metric 0.085607
[1421653:MainThread](2026-01-11 22:27:52,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.015918, valid_loss 0.999091, train_metric nan, valid_metric 0.084247
[1421653:MainThread](2026-01-11 22:27:52,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001666 to 0.999091, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:52,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.017961, valid_loss 1.005075, train_metric nan, valid_metric 0.092253
[1421653:MainThread](2026-01-11 22:27:53,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.016924, valid_loss 1.002343, train_metric nan, valid_metric 0.089200
[1421653:MainThread](2026-01-11 22:27:53,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.009317, valid_loss 0.999444, train_metric nan, valid_metric 0.085288
[1421653:MainThread](2026-01-11 22:27:54,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.008368, valid_loss 1.002627, train_metric nan, valid_metric 0.070392
[1421653:MainThread](2026-01-11 22:27:54,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.006493, valid_loss 0.999861, train_metric nan, valid_metric 0.070275
[1421653:MainThread](2026-01-11 22:27:54,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.007996, valid_loss 0.999297, train_metric nan, valid_metric 0.084953
[1421653:MainThread](2026-01-11 22:27:55,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 0.998190, valid_loss 1.001077, train_metric nan, valid_metric 0.075683
[1421653:MainThread](2026-01-11 22:27:55,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.004515, valid_loss 0.999920, train_metric nan, valid_metric 0.089759
[1421653:MainThread](2026-01-11 22:27:55,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.008360, valid_loss 1.000040, train_metric nan, valid_metric 0.086463
[1421653:MainThread](2026-01-11 22:27:56,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.007411, valid_loss 0.999754, train_metric nan, valid_metric 0.086493
[1421653:MainThread](2026-01-11 22:27:56,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.005000, valid_loss 0.998664, train_metric nan, valid_metric 0.082819
[1421653:MainThread](2026-01-11 22:27:56,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999091 to 0.998664, save checkpoint.
[1421653:MainThread](2026-01-11 22:27:57,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.012890, valid_loss 0.999978, train_metric nan, valid_metric 0.094041
[1421653:MainThread](2026-01-11 22:27:57,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.001230, valid_loss 1.006387, train_metric nan, valid_metric 0.091298
[1421653:MainThread](2026-01-11 22:27:57,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.002754, valid_loss 1.003071, train_metric nan, valid_metric 0.092254
[1421653:MainThread](2026-01-11 22:27:58,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.003769, valid_loss 1.003038, train_metric nan, valid_metric 0.095433
[1421653:MainThread](2026-01-11 22:27:58,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.999079, valid_loss 1.013506, train_metric nan, valid_metric 0.092915
[1421653:MainThread](2026-01-11 22:27:59,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.997518, valid_loss 1.001124, train_metric nan, valid_metric 0.093497
[1421653:MainThread](2026-01-11 22:27:59,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.001599, valid_loss 1.004064, train_metric nan, valid_metric 0.091406
[1421653:MainThread](2026-01-11 22:27:59,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.998424, valid_loss 0.999699, train_metric nan, valid_metric 0.090144
[1421653:MainThread](2026-01-11 22:27:59,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.000459, valid_loss 1.000418, train_metric nan, valid_metric 0.093013
[1421653:MainThread](2026-01-11 22:28:00,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.996788, valid_loss 1.001381, train_metric nan, valid_metric 0.091834
[1421653:MainThread](2026-01-11 22:28:00,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.993578, valid_loss 0.998991, train_metric nan, valid_metric 0.090783
[1421653:MainThread](2026-01-11 22:28:01,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.997600, valid_loss 1.002142, train_metric nan, valid_metric 0.096607
[1421653:MainThread](2026-01-11 22:28:01,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.994812, valid_loss 0.998117, train_metric nan, valid_metric 0.092114
[1421653:MainThread](2026-01-11 22:28:01,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998664 to 0.998117, save checkpoint.
[1421653:MainThread](2026-01-11 22:28:01,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.995661, valid_loss 0.998150, train_metric nan, valid_metric 0.090446
[1421653:MainThread](2026-01-11 22:28:02,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.994415, valid_loss 0.997106, train_metric nan, valid_metric 0.090768
[1421653:MainThread](2026-01-11 22:28:02,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998117 to 0.997106, save checkpoint.
[1421653:MainThread](2026-01-11 22:28:02,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.995382, valid_loss 1.000272, train_metric nan, valid_metric 0.097617
[1421653:MainThread](2026-01-11 22:28:02,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 1.001096, valid_loss 1.004402, train_metric nan, valid_metric 0.059995
[1421653:MainThread](2026-01-11 22:28:03,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.999812, valid_loss 0.999281, train_metric nan, valid_metric 0.089965
[1421653:MainThread](2026-01-11 22:28:03,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.993704, valid_loss 1.001347, train_metric nan, valid_metric 0.092643
[1421653:MainThread](2026-01-11 22:28:04,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.992020, valid_loss 1.000192, train_metric nan, valid_metric 0.096262
[1421653:MainThread](2026-01-11 22:28:04,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.997699, valid_loss 1.000077, train_metric nan, valid_metric 0.094221
[1421653:MainThread](2026-01-11 22:28:04,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.994614, valid_loss 1.001334, train_metric nan, valid_metric 0.084916
[1421653:MainThread](2026-01-11 22:28:05,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.993725, valid_loss 0.998461, train_metric nan, valid_metric 0.097329
[1421653:MainThread](2026-01-11 22:28:05,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.991777, valid_loss 0.997746, train_metric nan, valid_metric 0.084076
[1421653:MainThread](2026-01-11 22:28:06,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.991103, valid_loss 0.997415, train_metric nan, valid_metric 0.085743
[1421653:MainThread](2026-01-11 22:28:06,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.994977, valid_loss 0.997507, train_metric nan, valid_metric 0.093335
[1421653:MainThread](2026-01-11 22:28:06,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 1.000011, valid_loss 1.001095, train_metric nan, valid_metric 0.093113
[1421653:MainThread](2026-01-11 22:28:07,291) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.985926, valid_loss 0.996104, train_metric nan, valid_metric 0.091895
[1421653:MainThread](2026-01-11 22:28:07,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997106 to 0.996104, save checkpoint.
[1421653:MainThread](2026-01-11 22:28:07,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.989132, valid_loss 0.995163, train_metric nan, valid_metric 0.090063
[1421653:MainThread](2026-01-11 22:28:07,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996104 to 0.995163, save checkpoint.
[1421653:MainThread](2026-01-11 22:28:08,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.990703, valid_loss 1.000590, train_metric nan, valid_metric 0.096919
[1421653:MainThread](2026-01-11 22:28:08,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.986779, valid_loss 0.995702, train_metric nan, valid_metric 0.094242
[1421653:MainThread](2026-01-11 22:28:08,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.993211, valid_loss 0.998711, train_metric nan, valid_metric 0.091892
[1421653:MainThread](2026-01-11 22:28:09,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.987548, valid_loss 0.998839, train_metric nan, valid_metric 0.084927
[1421653:MainThread](2026-01-11 22:28:09,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.989801, valid_loss 0.998737, train_metric nan, valid_metric 0.091552
[1421653:MainThread](2026-01-11 22:28:09,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.990011, valid_loss 0.999831, train_metric nan, valid_metric 0.095528
[1421653:MainThread](2026-01-11 22:28:10,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.988062, valid_loss 0.996987, train_metric nan, valid_metric 0.095059
[1421653:MainThread](2026-01-11 22:28:10,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.993565, valid_loss 0.999770, train_metric nan, valid_metric 0.089660
[1421653:MainThread](2026-01-11 22:28:11,157) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.983771, valid_loss 0.998760, train_metric nan, valid_metric 0.095187
[1421653:MainThread](2026-01-11 22:28:11,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.987842, valid_loss 0.998388, train_metric nan, valid_metric 0.078903
[1421653:MainThread](2026-01-11 22:28:11,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.991602, valid_loss 0.996937, train_metric nan, valid_metric 0.093565
[1421653:MainThread](2026-01-11 22:28:12,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.989333, valid_loss 0.997076, train_metric nan, valid_metric 0.094190
[1421653:MainThread](2026-01-11 22:28:12,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.993842, valid_loss 0.997233, train_metric nan, valid_metric 0.091219
[1421653:MainThread](2026-01-11 22:28:13,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.990464, valid_loss 0.997214, train_metric nan, valid_metric 0.095434
[1421653:MainThread](2026-01-11 22:28:13,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.988493, valid_loss 0.997661, train_metric nan, valid_metric 0.096177
[1421653:MainThread](2026-01-11 22:28:13,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.989586, valid_loss 0.997039, train_metric nan, valid_metric 0.093181
[1421653:MainThread](2026-01-11 22:28:14,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.992399, valid_loss 0.997082, train_metric nan, valid_metric 0.095558
[1421653:MainThread](2026-01-11 22:28:14,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.989950, valid_loss 0.997384, train_metric nan, valid_metric 0.091605
[1421653:MainThread](2026-01-11 22:28:15,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.990140, valid_loss 0.996433, train_metric nan, valid_metric 0.093740
[1421653:MainThread](2026-01-11 22:28:15,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.995192, valid_loss 0.998224, train_metric nan, valid_metric 0.093253
[1421653:MainThread](2026-01-11 22:28:15,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.994660, valid_loss 0.996432, train_metric nan, valid_metric 0.093846
[1421653:MainThread](2026-01-11 22:28:16,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.988354, valid_loss 0.996559, train_metric nan, valid_metric 0.097340
[1421653:MainThread](2026-01-11 22:28:16,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.993413, valid_loss 0.997090, train_metric nan, valid_metric 0.093233
[1421653:MainThread](2026-01-11 22:28:16,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.998127, valid_loss 0.996491, train_metric nan, valid_metric 0.093220
[1421653:MainThread](2026-01-11 22:28:17,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.989674, valid_loss 0.997070, train_metric nan, valid_metric 0.097647
[1421653:MainThread](2026-01-11 22:28:17,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.993913, valid_loss 0.997578, train_metric nan, valid_metric 0.093420
[1421653:MainThread](2026-01-11 22:28:18,142) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.984685, valid_loss 0.998718, train_metric nan, valid_metric 0.098508
[1421653:MainThread](2026-01-11 22:28:18,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.990123, valid_loss 0.996702, train_metric nan, valid_metric 0.088078
[1421653:MainThread](2026-01-11 22:28:19,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.988431, valid_loss 0.998729, train_metric nan, valid_metric 0.098017
[1421653:MainThread](2026-01-11 22:28:19,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.992986, valid_loss 0.996810, train_metric nan, valid_metric 0.095592
[1421653:MainThread](2026-01-11 22:28:19,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.986163, valid_loss 0.997693, train_metric nan, valid_metric 0.091632
[1421653:MainThread](2026-01-11 22:28:20,434) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.990870, valid_loss 0.997064, train_metric nan, valid_metric 0.095815
[1421653:MainThread](2026-01-11 22:28:20,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.993533, valid_loss 0.996655, train_metric nan, valid_metric 0.092165
[1421653:MainThread](2026-01-11 22:28:21,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.987117, valid_loss 0.997723, train_metric nan, valid_metric 0.096751
[1421653:MainThread](2026-01-11 22:28:21,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.990404, valid_loss 0.997198, train_metric nan, valid_metric 0.094661
[1421653:MainThread](2026-01-11 22:28:22,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.989958, valid_loss 0.998433, train_metric nan, valid_metric 0.097222
[1421653:MainThread](2026-01-11 22:28:22,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.987685, valid_loss 0.997206, train_metric nan, valid_metric 0.095048
[1421653:MainThread](2026-01-11 22:28:22,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.988305, valid_loss 0.997371, train_metric nan, valid_metric 0.094473
[1421653:MainThread](2026-01-11 22:28:22,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.990121, valid_loss 0.997514, train_metric nan, valid_metric 0.096849
[1421653:MainThread](2026-01-11 22:28:23,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.992675, valid_loss 0.997260, train_metric nan, valid_metric 0.097069
[1421653:MainThread](2026-01-11 22:28:23,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.985171, valid_loss 0.997123, train_metric nan, valid_metric 0.097922
[1421653:MainThread](2026-01-11 22:28:23,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.990181, valid_loss 0.996800, train_metric nan, valid_metric 0.096872
[1421653:MainThread](2026-01-11 22:28:24,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.985632, valid_loss 0.996944, train_metric nan, valid_metric 0.093257
[1421653:MainThread](2026-01-11 22:28:24,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.986300, valid_loss 0.997485, train_metric nan, valid_metric 0.097190
[1421653:MainThread](2026-01-11 22:28:24,796) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.989843, valid_loss 0.996635, train_metric nan, valid_metric 0.094357
[1421653:MainThread](2026-01-11 22:28:25,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.990284, valid_loss 0.996567, train_metric nan, valid_metric 0.093115
[1421653:MainThread](2026-01-11 22:28:25,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.984366, valid_loss 0.997104, train_metric nan, valid_metric 0.096233
[1421653:MainThread](2026-01-11 22:28:25,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.986505, valid_loss 0.997141, train_metric nan, valid_metric 0.096965
[1421653:MainThread](2026-01-11 22:28:26,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.991167, valid_loss 0.997327, train_metric nan, valid_metric 0.097349
[1421653:MainThread](2026-01-11 22:28:26,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.986508, valid_loss 0.997225, train_metric nan, valid_metric 0.095670
[1421653:MainThread](2026-01-11 22:28:26,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:28:26.833 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:28:29.975 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 22:28:29.976 | INFO     | __main__:train_single_fold:593 -   IC=0.0673, ICIR=0.6037, RankIC=0.0845, RankICIR=0.7964
2026-01-11 22:28:29.976 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:28:29,983) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1421653:MainThread](2026-01-11 22:28:47,070) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:28:47,071) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:28:51,366) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0f6440be90>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   5%|▍         | 11/244 [00:00<00:02, 102.98it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:02, 103.00it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 102.44it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:01, 101.89it/s]backtest loop:  23%|██▎       | 56/244 [00:00<00:01, 103.83it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:01, 104.95it/s]backtest loop:  32%|███▏      | 78/244 [00:00<00:01, 105.08it/s]backtest loop:  36%|███▋      | 89/244 [00:00<00:01, 98.84it/s] backtest loop:  41%|████      | 99/244 [00:00<00:01, 98.49it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 97.52it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 95.64it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 95.56it/s]backtest loop:  57%|█████▋    | 140/244 [00:01<00:01, 97.81it/s]backtest loop:  61%|██████▏   | 150/244 [00:01<00:00, 98.39it/s]backtest loop:  66%|██████▌   | 161/244 [00:01<00:00, 95.91it/s]backtest loop:  70%|███████   | 171/244 [00:01<00:00, 96.88it/s]backtest loop:  75%|███████▍  | 182/244 [00:01<00:00, 99.13it/s]backtest loop:  79%|███████▉  | 193/244 [00:01<00:00, 100.99it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 99.87it/s] backtest loop:  89%|████████▊ | 216/244 [00:02<00:00, 105.25it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 106.58it/s]backtest loop:  98%|█████████▊| 238/244 [00:02<00:00, 106.93it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 100.83it/s]
2026-01-11 22:28:53.804 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3061, Sharpe(w/cost)=2.9289, MaxDD=-0.0410
2026-01-11 22:28:59.101 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 22:29:11.678 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:29:11.736 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_0_pred.parquet
2026-01-11 22:29:11.756 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:29:11.756 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 22:29:11.756 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:29:11.757 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:30:09,791) INFO - qlib.timer - [log.py:127] - Time cost: 58.033s | Loading data Done
[1421653:MainThread](2026-01-11 22:30:12,586) INFO - qlib.timer - [log.py:127] - Time cost: 2.241s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:30:14,165) INFO - qlib.timer - [log.py:127] - Time cost: 1.577s | Fillna Done
[1421653:MainThread](2026-01-11 22:30:16,398) INFO - qlib.timer - [log.py:127] - Time cost: 0.330s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:30:16,613) INFO - qlib.timer - [log.py:127] - Time cost: 0.214s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:30:16,616) INFO - qlib.timer - [log.py:127] - Time cost: 6.824s | fit & process data Done
[1421653:MainThread](2026-01-11 22:30:16,617) INFO - qlib.timer - [log.py:127] - Time cost: 64.859s | Init data Done
2026-01-11 22:30:16.617 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:30:16,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:30:16,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:30:16,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:30:16,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:30:16.632 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:30:19,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:30:19,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.946627, valid_loss 1.322290, train_metric nan, valid_metric -0.032131
[1421653:MainThread](2026-01-11 22:30:19,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.322290, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:20,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.110466, valid_loss 1.053217, train_metric nan, valid_metric 0.043251
[1421653:MainThread](2026-01-11 22:30:20,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.322290 to 1.053217, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:20,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.069039, valid_loss 1.023256, train_metric nan, valid_metric 0.040870
[1421653:MainThread](2026-01-11 22:30:20,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.053217 to 1.023256, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:20,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.058476, valid_loss 1.017507, train_metric nan, valid_metric 0.056084
[1421653:MainThread](2026-01-11 22:30:20,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.023256 to 1.017507, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:21,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.055006, valid_loss 1.014501, train_metric nan, valid_metric 0.069435
[1421653:MainThread](2026-01-11 22:30:21,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.017507 to 1.014501, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:21,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.047204, valid_loss 1.012706, train_metric nan, valid_metric 0.069206
[1421653:MainThread](2026-01-11 22:30:21,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.014501 to 1.012706, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:21,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.051027, valid_loss 1.008312, train_metric nan, valid_metric 0.062525
[1421653:MainThread](2026-01-11 22:30:21,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.012706 to 1.008312, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:22,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.041876, valid_loss 1.014197, train_metric nan, valid_metric 0.074160
[1421653:MainThread](2026-01-11 22:30:22,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.037324, valid_loss 1.007861, train_metric nan, valid_metric 0.072634
[1421653:MainThread](2026-01-11 22:30:22,447) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008312 to 1.007861, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:22,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.039803, valid_loss 1.012324, train_metric nan, valid_metric 0.055374
[1421653:MainThread](2026-01-11 22:30:23,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.040157, valid_loss 1.003952, train_metric nan, valid_metric 0.067209
[1421653:MainThread](2026-01-11 22:30:23,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007861 to 1.003952, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:23,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.037488, valid_loss 1.013130, train_metric nan, valid_metric 0.072609
[1421653:MainThread](2026-01-11 22:30:23,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.037200, valid_loss 1.005593, train_metric nan, valid_metric 0.069633
[1421653:MainThread](2026-01-11 22:30:23,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.037572, valid_loss 1.005986, train_metric nan, valid_metric 0.077287
[1421653:MainThread](2026-01-11 22:30:24,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.027811, valid_loss 1.003016, train_metric nan, valid_metric 0.077210
[1421653:MainThread](2026-01-11 22:30:24,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003952 to 1.003016, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:24,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.027123, valid_loss 1.004454, train_metric nan, valid_metric 0.081673
[1421653:MainThread](2026-01-11 22:30:24,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.035882, valid_loss 1.003730, train_metric nan, valid_metric 0.088774
[1421653:MainThread](2026-01-11 22:30:25,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.028846, valid_loss 1.000185, train_metric nan, valid_metric 0.078418
[1421653:MainThread](2026-01-11 22:30:25,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003016 to 1.000185, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:25,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.031014, valid_loss 0.999804, train_metric nan, valid_metric 0.090810
[1421653:MainThread](2026-01-11 22:30:25,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000185 to 0.999804, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:25,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.023043, valid_loss 0.998742, train_metric nan, valid_metric 0.086342
[1421653:MainThread](2026-01-11 22:30:25,891) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999804 to 0.998742, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:26,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.019445, valid_loss 0.999816, train_metric nan, valid_metric 0.087963
[1421653:MainThread](2026-01-11 22:30:26,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.024159, valid_loss 0.999061, train_metric nan, valid_metric 0.073953
[1421653:MainThread](2026-01-11 22:30:26,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.019527, valid_loss 1.011796, train_metric nan, valid_metric 0.096589
[1421653:MainThread](2026-01-11 22:30:27,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.022438, valid_loss 0.998652, train_metric nan, valid_metric 0.091691
[1421653:MainThread](2026-01-11 22:30:27,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998742 to 0.998652, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:27,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.017135, valid_loss 0.996595, train_metric nan, valid_metric 0.089562
[1421653:MainThread](2026-01-11 22:30:27,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998652 to 0.996595, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:27,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.016227, valid_loss 0.999062, train_metric nan, valid_metric 0.087782
[1421653:MainThread](2026-01-11 22:30:28,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.019969, valid_loss 1.003458, train_metric nan, valid_metric 0.092133
[1421653:MainThread](2026-01-11 22:30:28,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.018955, valid_loss 0.998587, train_metric nan, valid_metric 0.092960
[1421653:MainThread](2026-01-11 22:30:28,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.014579, valid_loss 1.000968, train_metric nan, valid_metric 0.084712
[1421653:MainThread](2026-01-11 22:30:28,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.006937, valid_loss 0.999214, train_metric nan, valid_metric 0.071344
[1421653:MainThread](2026-01-11 22:30:29,299) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.010259, valid_loss 1.003490, train_metric nan, valid_metric 0.090288
[1421653:MainThread](2026-01-11 22:30:29,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.009641, valid_loss 1.004568, train_metric nan, valid_metric 0.078953
[1421653:MainThread](2026-01-11 22:30:29,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.009995, valid_loss 1.000407, train_metric nan, valid_metric 0.084618
[1421653:MainThread](2026-01-11 22:30:30,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.004025, valid_loss 1.002707, train_metric nan, valid_metric 0.078725
[1421653:MainThread](2026-01-11 22:30:30,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.007791, valid_loss 1.009466, train_metric nan, valid_metric 0.097742
[1421653:MainThread](2026-01-11 22:30:30,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.005227, valid_loss 1.003266, train_metric nan, valid_metric 0.095782
[1421653:MainThread](2026-01-11 22:30:31,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.008951, valid_loss 0.997985, train_metric nan, valid_metric 0.089442
[1421653:MainThread](2026-01-11 22:30:31,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.004573, valid_loss 1.000090, train_metric nan, valid_metric 0.087846
[1421653:MainThread](2026-01-11 22:30:31,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.998911, valid_loss 1.000779, train_metric nan, valid_metric 0.091641
[1421653:MainThread](2026-01-11 22:30:32,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.996354, valid_loss 0.999962, train_metric nan, valid_metric 0.090622
[1421653:MainThread](2026-01-11 22:30:32,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.999079, valid_loss 0.998395, train_metric nan, valid_metric 0.094104
[1421653:MainThread](2026-01-11 22:30:32,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.002490, valid_loss 1.000548, train_metric nan, valid_metric 0.076711
[1421653:MainThread](2026-01-11 22:30:32,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.005498, valid_loss 0.999002, train_metric nan, valid_metric 0.094881
[1421653:MainThread](2026-01-11 22:30:33,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.007408, valid_loss 1.001288, train_metric nan, valid_metric 0.079151
[1421653:MainThread](2026-01-11 22:30:33,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.002872, valid_loss 0.995755, train_metric nan, valid_metric 0.092195
[1421653:MainThread](2026-01-11 22:30:33,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996595 to 0.995755, save checkpoint.
[1421653:MainThread](2026-01-11 22:30:33,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.006058, valid_loss 0.998315, train_metric nan, valid_metric 0.083028
[1421653:MainThread](2026-01-11 22:30:34,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 1.002052, valid_loss 0.998164, train_metric nan, valid_metric 0.097503
[1421653:MainThread](2026-01-11 22:30:34,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.999581, valid_loss 0.997093, train_metric nan, valid_metric 0.085665
[1421653:MainThread](2026-01-11 22:30:34,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 1.006514, valid_loss 0.997288, train_metric nan, valid_metric 0.090316
[1421653:MainThread](2026-01-11 22:30:35,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.998842, valid_loss 1.000965, train_metric nan, valid_metric 0.096021
[1421653:MainThread](2026-01-11 22:30:35,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 1.003661, valid_loss 1.000102, train_metric nan, valid_metric 0.092911
[1421653:MainThread](2026-01-11 22:30:35,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 1.002159, valid_loss 0.998454, train_metric nan, valid_metric 0.086534
[1421653:MainThread](2026-01-11 22:30:35,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 1.001937, valid_loss 0.998148, train_metric nan, valid_metric 0.093218
[1421653:MainThread](2026-01-11 22:30:36,260) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.002794, valid_loss 0.998062, train_metric nan, valid_metric 0.090707
[1421653:MainThread](2026-01-11 22:30:36,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.999316, valid_loss 0.998690, train_metric nan, valid_metric 0.092272
[1421653:MainThread](2026-01-11 22:30:36,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 1.002326, valid_loss 0.999632, train_metric nan, valid_metric 0.094169
[1421653:MainThread](2026-01-11 22:30:37,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.994620, valid_loss 0.996128, train_metric nan, valid_metric 0.088504
[1421653:MainThread](2026-01-11 22:30:37,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.996499, valid_loss 0.999478, train_metric nan, valid_metric 0.098020
[1421653:MainThread](2026-01-11 22:30:37,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.994897, valid_loss 0.999690, train_metric nan, valid_metric 0.097043
[1421653:MainThread](2026-01-11 22:30:38,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.994488, valid_loss 0.998932, train_metric nan, valid_metric 0.098338
[1421653:MainThread](2026-01-11 22:30:38,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 1.001835, valid_loss 0.996665, train_metric nan, valid_metric 0.094073
[1421653:MainThread](2026-01-11 22:30:38,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.995090, valid_loss 0.996950, train_metric nan, valid_metric 0.088623
[1421653:MainThread](2026-01-11 22:30:38,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.993548, valid_loss 0.995891, train_metric nan, valid_metric 0.099586
[1421653:MainThread](2026-01-11 22:30:39,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.992861, valid_loss 0.997049, train_metric nan, valid_metric 0.095195
[1421653:MainThread](2026-01-11 22:30:39,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 1.003885, valid_loss 1.000627, train_metric nan, valid_metric 0.099852
[1421653:MainThread](2026-01-11 22:30:39,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.994764, valid_loss 0.996927, train_metric nan, valid_metric 0.092238
[1421653:MainThread](2026-01-11 22:30:40,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.997051, valid_loss 0.997857, train_metric nan, valid_metric 0.093465
[1421653:MainThread](2026-01-11 22:30:40,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.999964, valid_loss 0.997735, train_metric nan, valid_metric 0.093649
[1421653:MainThread](2026-01-11 22:30:40,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.993184, valid_loss 0.998049, train_metric nan, valid_metric 0.094952
[1421653:MainThread](2026-01-11 22:30:41,059) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.994559, valid_loss 0.997987, train_metric nan, valid_metric 0.093697
[1421653:MainThread](2026-01-11 22:30:41,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.993548, valid_loss 0.998945, train_metric nan, valid_metric 0.092908
[1421653:MainThread](2026-01-11 22:30:41,652) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.991368, valid_loss 0.999700, train_metric nan, valid_metric 0.090258
[1421653:MainThread](2026-01-11 22:30:41,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.998415, valid_loss 0.997401, train_metric nan, valid_metric 0.092338
[1421653:MainThread](2026-01-11 22:30:42,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.994501, valid_loss 0.997429, train_metric nan, valid_metric 0.088517
[1421653:MainThread](2026-01-11 22:30:42,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.997518, valid_loss 0.996022, train_metric nan, valid_metric 0.095779
[1421653:MainThread](2026-01-11 22:30:42,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.993301, valid_loss 0.997365, train_metric nan, valid_metric 0.092377
[1421653:MainThread](2026-01-11 22:30:43,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.996516, valid_loss 0.998600, train_metric nan, valid_metric 0.094339
[1421653:MainThread](2026-01-11 22:30:43,492) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.993974, valid_loss 0.997697, train_metric nan, valid_metric 0.090456
[1421653:MainThread](2026-01-11 22:30:43,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.995743, valid_loss 0.998529, train_metric nan, valid_metric 0.092483
[1421653:MainThread](2026-01-11 22:30:44,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.993753, valid_loss 0.997094, train_metric nan, valid_metric 0.095672
[1421653:MainThread](2026-01-11 22:30:44,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.996606, valid_loss 0.998575, train_metric nan, valid_metric 0.095825
[1421653:MainThread](2026-01-11 22:30:44,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.994977, valid_loss 0.997959, train_metric nan, valid_metric 0.093752
[1421653:MainThread](2026-01-11 22:30:44,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.988644, valid_loss 0.997041, train_metric nan, valid_metric 0.097657
[1421653:MainThread](2026-01-11 22:30:45,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 1.001999, valid_loss 0.998143, train_metric nan, valid_metric 0.089114
[1421653:MainThread](2026-01-11 22:30:45,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.997808, valid_loss 0.997717, train_metric nan, valid_metric 0.098920
[1421653:MainThread](2026-01-11 22:30:45,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.997998, valid_loss 0.997729, train_metric nan, valid_metric 0.095488
[1421653:MainThread](2026-01-11 22:30:46,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.997283, valid_loss 0.996905, train_metric nan, valid_metric 0.091920
[1421653:MainThread](2026-01-11 22:30:46,499) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.999154, valid_loss 0.995831, train_metric nan, valid_metric 0.096928
[1421653:MainThread](2026-01-11 22:30:46,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.995410, valid_loss 0.996806, train_metric nan, valid_metric 0.092165
[1421653:MainThread](2026-01-11 22:30:47,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.997611, valid_loss 0.997322, train_metric nan, valid_metric 0.096179
[1421653:MainThread](2026-01-11 22:30:47,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.999704, valid_loss 0.996906, train_metric nan, valid_metric 0.096896
[1421653:MainThread](2026-01-11 22:30:47,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.993743, valid_loss 0.996261, train_metric nan, valid_metric 0.096467
[1421653:MainThread](2026-01-11 22:30:48,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.994367, valid_loss 0.996629, train_metric nan, valid_metric 0.097542
[1421653:MainThread](2026-01-11 22:30:48,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.996282, valid_loss 0.997015, train_metric nan, valid_metric 0.098874
[1421653:MainThread](2026-01-11 22:30:48,619) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.994812, valid_loss 0.996732, train_metric nan, valid_metric 0.093870
[1421653:MainThread](2026-01-11 22:30:48,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:30:48.637 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:30:51.062 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 22:30:51.063 | INFO     | __main__:train_single_fold:593 -   IC=0.0398, ICIR=0.3014, RankIC=0.0586, RankICIR=0.5727
2026-01-11 22:30:51.063 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:30:51,073) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:31:23,257) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:31:23,257) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:31:28,275) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df74a9510>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/244 [00:00<00:04, 49.31it/s]backtest loop:   7%|▋         | 16/244 [00:00<00:02, 81.86it/s]backtest loop:  10%|█         | 25/244 [00:00<00:02, 82.00it/s]backtest loop:  14%|█▍        | 35/244 [00:00<00:02, 88.61it/s]backtest loop:  19%|█▉        | 46/244 [00:00<00:02, 94.04it/s]backtest loop:  23%|██▎       | 57/244 [00:00<00:01, 97.49it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:01, 95.79it/s]backtest loop:  32%|███▏      | 78/244 [00:00<00:01, 99.06it/s]backtest loop:  37%|███▋      | 90/244 [00:00<00:01, 103.29it/s]backtest loop:  41%|████▏     | 101/244 [00:01<00:01, 101.37it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 105.17it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 102.23it/s]backtest loop:  55%|█████▌    | 135/244 [00:01<00:01, 104.24it/s]backtest loop:  60%|██████    | 147/244 [00:01<00:00, 105.94it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:00, 104.02it/s]backtest loop:  70%|██████▉   | 170/244 [00:01<00:00, 104.08it/s]backtest loop:  75%|███████▍  | 182/244 [00:01<00:00, 107.50it/s]backtest loop:  80%|███████▉  | 194/244 [00:01<00:00, 107.74it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 112.10it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 110.07it/s]backtest loop:  95%|█████████▍| 231/244 [00:02<00:00, 112.17it/s]backtest loop: 100%|█████████▉| 243/244 [00:02<00:00, 113.78it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 102.79it/s]
2026-01-11 22:31:30.668 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0207, Sharpe(w/cost)=0.4154, MaxDD=-0.0729
2026-01-11 22:31:35.821 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 22:31:58.207 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:31:58.292 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_1_pred.parquet
2026-01-11 22:31:58.309 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 22:31:58.309 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 22:32:01.135 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0604
2026-01-11 22:32:01.467 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0437, ICIR=0.3253, RankIC=0.0624
[1421653:MainThread](2026-01-11 22:32:01,473) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:32:41,287) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:32:41,288) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:32:47,294) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0f647af450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 35.60it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 63.98it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 68.86it/s]backtest loop:  13%|█▎        | 31/244 [00:00<00:02, 75.00it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 79.08it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 81.82it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 83.71it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 85.05it/s]backtest loop:  32%|███▏      | 77/244 [00:00<00:01, 85.32it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 86.40it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 86.32it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 87.07it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 87.84it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 88.15it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 89.36it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 89.80it/s]backtest loop:  63%|██████▎   | 154/244 [00:01<00:01, 89.48it/s]backtest loop:  67%|██████▋   | 164/244 [00:01<00:00, 89.59it/s]backtest loop:  71%|███████▏  | 174/244 [00:02<00:00, 86.89it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 86.90it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 84.53it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 84.52it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 84.30it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 84.74it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 84.61it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 85.92it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 84.22it/s]
2026-01-11 22:32:50.214 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0856, Sharpe(w/cost)=1.7102
2026-01-11 22:32:50.290 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:32:50.290 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 22:32:50.290 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:32:50.290 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:34:24,144) INFO - qlib.timer - [log.py:127] - Time cost: 93.851s | Loading data Done
[1421653:MainThread](2026-01-11 22:34:27,769) INFO - qlib.timer - [log.py:127] - Time cost: 3.076s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:34:29,207) INFO - qlib.timer - [log.py:127] - Time cost: 1.437s | Fillna Done
[1421653:MainThread](2026-01-11 22:34:30,941) INFO - qlib.timer - [log.py:127] - Time cost: 0.330s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:34:31,150) INFO - qlib.timer - [log.py:127] - Time cost: 0.208s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:34:31,153) INFO - qlib.timer - [log.py:127] - Time cost: 7.008s | fit & process data Done
[1421653:MainThread](2026-01-11 22:34:31,154) INFO - qlib.timer - [log.py:127] - Time cost: 100.862s | Init data Done
2026-01-11 22:34:31.154 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:34:31,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:34:31,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:34:31,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:34:31,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:34:31.170 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:34:32,866) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:34:33,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 2.099251, valid_loss 1.235698, train_metric nan, valid_metric -0.027827
[1421653:MainThread](2026-01-11 22:34:33,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.235698, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:34,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.121059, valid_loss 1.016303, train_metric nan, valid_metric 0.008043
[1421653:MainThread](2026-01-11 22:34:34,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.235698 to 1.016303, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:34,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.066315, valid_loss 1.005171, train_metric nan, valid_metric 0.030959
[1421653:MainThread](2026-01-11 22:34:34,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.016303 to 1.005171, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:34,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.050125, valid_loss 1.000985, train_metric nan, valid_metric 0.039437
[1421653:MainThread](2026-01-11 22:34:34,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005171 to 1.000985, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:35,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.051172, valid_loss 1.000386, train_metric nan, valid_metric 0.035334
[1421653:MainThread](2026-01-11 22:34:35,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000985 to 1.000386, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:35,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.046186, valid_loss 0.999111, train_metric nan, valid_metric 0.044660
[1421653:MainThread](2026-01-11 22:34:35,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000386 to 0.999111, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:35,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.044758, valid_loss 0.999225, train_metric nan, valid_metric 0.049062
[1421653:MainThread](2026-01-11 22:34:36,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.045938, valid_loss 1.000608, train_metric nan, valid_metric 0.045382
[1421653:MainThread](2026-01-11 22:34:36,677) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.044428, valid_loss 0.999004, train_metric nan, valid_metric 0.053672
[1421653:MainThread](2026-01-11 22:34:36,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999111 to 0.999004, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:37,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.033345, valid_loss 0.999185, train_metric nan, valid_metric 0.046701
[1421653:MainThread](2026-01-11 22:34:37,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.035546, valid_loss 0.997391, train_metric nan, valid_metric 0.048259
[1421653:MainThread](2026-01-11 22:34:37,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999004 to 0.997391, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:37,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.037574, valid_loss 0.996772, train_metric nan, valid_metric 0.046670
[1421653:MainThread](2026-01-11 22:34:37,918) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997391 to 0.996772, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:38,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.045658, valid_loss 1.010729, train_metric nan, valid_metric 0.040763
[1421653:MainThread](2026-01-11 22:34:38,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.038920, valid_loss 0.998992, train_metric nan, valid_metric 0.038606
[1421653:MainThread](2026-01-11 22:34:39,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.029870, valid_loss 0.996126, train_metric nan, valid_metric 0.053048
[1421653:MainThread](2026-01-11 22:34:39,163) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996772 to 0.996126, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:39,551) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.031984, valid_loss 0.996951, train_metric nan, valid_metric 0.047062
[1421653:MainThread](2026-01-11 22:34:39,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.030213, valid_loss 0.996936, train_metric nan, valid_metric 0.050167
[1421653:MainThread](2026-01-11 22:34:40,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.023951, valid_loss 0.994899, train_metric nan, valid_metric 0.060319
[1421653:MainThread](2026-01-11 22:34:40,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996126 to 0.994899, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:40,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.029718, valid_loss 0.995651, train_metric nan, valid_metric 0.061437
[1421653:MainThread](2026-01-11 22:34:41,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.021147, valid_loss 0.994785, train_metric nan, valid_metric 0.061098
[1421653:MainThread](2026-01-11 22:34:41,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994899 to 0.994785, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:41,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.024956, valid_loss 1.001717, train_metric nan, valid_metric 0.049037
[1421653:MainThread](2026-01-11 22:34:41,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.024353, valid_loss 0.996730, train_metric nan, valid_metric 0.056529
[1421653:MainThread](2026-01-11 22:34:42,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.019827, valid_loss 0.997651, train_metric nan, valid_metric 0.054282
[1421653:MainThread](2026-01-11 22:34:42,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.016515, valid_loss 0.997988, train_metric nan, valid_metric 0.053036
[1421653:MainThread](2026-01-11 22:34:43,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.016125, valid_loss 0.995416, train_metric nan, valid_metric 0.058977
[1421653:MainThread](2026-01-11 22:34:43,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.010882, valid_loss 0.995065, train_metric nan, valid_metric 0.063610
[1421653:MainThread](2026-01-11 22:34:44,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.011922, valid_loss 0.994723, train_metric nan, valid_metric 0.062357
[1421653:MainThread](2026-01-11 22:34:44,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994785 to 0.994723, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:44,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.018122, valid_loss 0.994701, train_metric nan, valid_metric 0.064781
[1421653:MainThread](2026-01-11 22:34:44,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994723 to 0.994701, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:44,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.008052, valid_loss 0.994637, train_metric nan, valid_metric 0.063462
[1421653:MainThread](2026-01-11 22:34:44,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994701 to 0.994637, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:45,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.003848, valid_loss 0.994571, train_metric nan, valid_metric 0.065538
[1421653:MainThread](2026-01-11 22:34:45,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994637 to 0.994571, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:45,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.004452, valid_loss 0.996026, train_metric nan, valid_metric 0.050201
[1421653:MainThread](2026-01-11 22:34:46,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.007149, valid_loss 0.994837, train_metric nan, valid_metric 0.066298
[1421653:MainThread](2026-01-11 22:34:46,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.005524, valid_loss 0.995802, train_metric nan, valid_metric 0.065860
[1421653:MainThread](2026-01-11 22:34:46,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.012695, valid_loss 0.994551, train_metric nan, valid_metric 0.067719
[1421653:MainThread](2026-01-11 22:34:46,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994571 to 0.994551, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:47,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.005262, valid_loss 0.995500, train_metric nan, valid_metric 0.053860
[1421653:MainThread](2026-01-11 22:34:47,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.001587, valid_loss 0.995774, train_metric nan, valid_metric 0.066870
[1421653:MainThread](2026-01-11 22:34:48,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.008066, valid_loss 0.994491, train_metric nan, valid_metric 0.060573
[1421653:MainThread](2026-01-11 22:34:48,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994551 to 0.994491, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:48,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.003926, valid_loss 0.993850, train_metric nan, valid_metric 0.069057
[1421653:MainThread](2026-01-11 22:34:48,561) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994491 to 0.993850, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:48,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.998013, valid_loss 0.994618, train_metric nan, valid_metric 0.064067
[1421653:MainThread](2026-01-11 22:34:49,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.002216, valid_loss 0.994179, train_metric nan, valid_metric 0.068808
[1421653:MainThread](2026-01-11 22:34:49,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.001874, valid_loss 0.994599, train_metric nan, valid_metric 0.065605
[1421653:MainThread](2026-01-11 22:34:50,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.005079, valid_loss 0.993672, train_metric nan, valid_metric 0.066752
[1421653:MainThread](2026-01-11 22:34:50,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993850 to 0.993672, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:50,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.999486, valid_loss 0.994360, train_metric nan, valid_metric 0.070102
[1421653:MainThread](2026-01-11 22:34:50,970) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.999979, valid_loss 0.993882, train_metric nan, valid_metric 0.067081
[1421653:MainThread](2026-01-11 22:34:51,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.999215, valid_loss 0.995596, train_metric nan, valid_metric 0.055620
[1421653:MainThread](2026-01-11 22:34:51,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.997842, valid_loss 0.994111, train_metric nan, valid_metric 0.073079
[1421653:MainThread](2026-01-11 22:34:52,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.995337, valid_loss 0.993167, train_metric nan, valid_metric 0.070749
[1421653:MainThread](2026-01-11 22:34:52,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993672 to 0.993167, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:52,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.000798, valid_loss 0.993454, train_metric nan, valid_metric 0.071777
[1421653:MainThread](2026-01-11 22:34:52,963) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 1.001954, valid_loss 0.993113, train_metric nan, valid_metric 0.072875
[1421653:MainThread](2026-01-11 22:34:52,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993167 to 0.993113, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:53,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 1.001192, valid_loss 0.994156, train_metric nan, valid_metric 0.071648
[1421653:MainThread](2026-01-11 22:34:53,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.990611, valid_loss 0.995178, train_metric nan, valid_metric 0.058226
[1421653:MainThread](2026-01-11 22:34:54,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.997152, valid_loss 0.993731, train_metric nan, valid_metric 0.070130
[1421653:MainThread](2026-01-11 22:34:54,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 1.002077, valid_loss 0.995955, train_metric nan, valid_metric 0.068903
[1421653:MainThread](2026-01-11 22:34:54,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.991093, valid_loss 0.994365, train_metric nan, valid_metric 0.071961
[1421653:MainThread](2026-01-11 22:34:55,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 1.001296, valid_loss 0.993692, train_metric nan, valid_metric 0.069593
[1421653:MainThread](2026-01-11 22:34:55,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.993886, valid_loss 0.993773, train_metric nan, valid_metric 0.072002
[1421653:MainThread](2026-01-11 22:34:56,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.997134, valid_loss 0.993064, train_metric nan, valid_metric 0.072155
[1421653:MainThread](2026-01-11 22:34:56,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993113 to 0.993064, save checkpoint.
[1421653:MainThread](2026-01-11 22:34:56,598) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.992364, valid_loss 0.994528, train_metric nan, valid_metric 0.063197
[1421653:MainThread](2026-01-11 22:34:56,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.991011, valid_loss 0.993155, train_metric nan, valid_metric 0.072694
[1421653:MainThread](2026-01-11 22:34:57,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.995361, valid_loss 0.993155, train_metric nan, valid_metric 0.071908
[1421653:MainThread](2026-01-11 22:34:57,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.991065, valid_loss 0.993479, train_metric nan, valid_metric 0.072559
[1421653:MainThread](2026-01-11 22:34:58,176) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.993139, valid_loss 0.993515, train_metric nan, valid_metric 0.068411
[1421653:MainThread](2026-01-11 22:34:58,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.998517, valid_loss 0.999574, train_metric nan, valid_metric 0.069011
[1421653:MainThread](2026-01-11 22:34:59,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.989970, valid_loss 0.993512, train_metric nan, valid_metric 0.068979
[1421653:MainThread](2026-01-11 22:34:59,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.991749, valid_loss 0.994215, train_metric nan, valid_metric 0.072146
[1421653:MainThread](2026-01-11 22:34:59,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.991241, valid_loss 0.993071, train_metric nan, valid_metric 0.074272
[1421653:MainThread](2026-01-11 22:35:00,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.991573, valid_loss 0.993316, train_metric nan, valid_metric 0.072324
[1421653:MainThread](2026-01-11 22:35:00,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.995652, valid_loss 0.994115, train_metric nan, valid_metric 0.070180
[1421653:MainThread](2026-01-11 22:35:01,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.993907, valid_loss 0.993536, train_metric nan, valid_metric 0.073745
[1421653:MainThread](2026-01-11 22:35:01,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.989992, valid_loss 0.993528, train_metric nan, valid_metric 0.075811
[1421653:MainThread](2026-01-11 22:35:01,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.995502, valid_loss 0.993539, train_metric nan, valid_metric 0.074244
[1421653:MainThread](2026-01-11 22:35:02,236) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.995305, valid_loss 0.994539, train_metric nan, valid_metric 0.065191
[1421653:MainThread](2026-01-11 22:35:02,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.989030, valid_loss 0.993064, train_metric nan, valid_metric 0.074999
[1421653:MainThread](2026-01-11 22:35:02,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993064 to 0.993064, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:02,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.992435, valid_loss 0.993739, train_metric nan, valid_metric 0.074900
[1421653:MainThread](2026-01-11 22:35:03,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.994389, valid_loss 0.993577, train_metric nan, valid_metric 0.073060
[1421653:MainThread](2026-01-11 22:35:03,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.987248, valid_loss 0.992953, train_metric nan, valid_metric 0.077528
[1421653:MainThread](2026-01-11 22:35:03,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993064 to 0.992953, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:04,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.993918, valid_loss 0.992776, train_metric nan, valid_metric 0.077524
[1421653:MainThread](2026-01-11 22:35:04,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992953 to 0.992776, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:04,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.991698, valid_loss 0.993521, train_metric nan, valid_metric 0.074550
[1421653:MainThread](2026-01-11 22:35:05,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.990444, valid_loss 0.993058, train_metric nan, valid_metric 0.073348
[1421653:MainThread](2026-01-11 22:35:05,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.990723, valid_loss 0.993281, train_metric nan, valid_metric 0.076680
[1421653:MainThread](2026-01-11 22:35:05,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.990615, valid_loss 0.993301, train_metric nan, valid_metric 0.075713
[1421653:MainThread](2026-01-11 22:35:06,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.988591, valid_loss 0.994245, train_metric nan, valid_metric 0.069821
[1421653:MainThread](2026-01-11 22:35:06,732) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.995173, valid_loss 0.993690, train_metric nan, valid_metric 0.077444
[1421653:MainThread](2026-01-11 22:35:07,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.991220, valid_loss 0.994188, train_metric nan, valid_metric 0.070004
[1421653:MainThread](2026-01-11 22:35:07,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.987412, valid_loss 0.992587, train_metric nan, valid_metric 0.077566
[1421653:MainThread](2026-01-11 22:35:07,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992776 to 0.992587, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:07,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.989537, valid_loss 0.994444, train_metric nan, valid_metric 0.070222
[1421653:MainThread](2026-01-11 22:35:08,344) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.987456, valid_loss 0.992880, train_metric nan, valid_metric 0.076337
[1421653:MainThread](2026-01-11 22:35:08,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.987258, valid_loss 0.993290, train_metric nan, valid_metric 0.076563
[1421653:MainThread](2026-01-11 22:35:09,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.985367, valid_loss 0.993430, train_metric nan, valid_metric 0.071590
[1421653:MainThread](2026-01-11 22:35:09,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.989919, valid_loss 0.992442, train_metric nan, valid_metric 0.077464
[1421653:MainThread](2026-01-11 22:35:09,630) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992587 to 0.992442, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:10,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.988671, valid_loss 0.993246, train_metric nan, valid_metric 0.072599
[1421653:MainThread](2026-01-11 22:35:10,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.987204, valid_loss 0.992552, train_metric nan, valid_metric 0.076679
[1421653:MainThread](2026-01-11 22:35:10,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.993445, valid_loss 0.993789, train_metric nan, valid_metric 0.078472
[1421653:MainThread](2026-01-11 22:35:11,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.987298, valid_loss 0.994407, train_metric nan, valid_metric 0.070177
[1421653:MainThread](2026-01-11 22:35:11,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.988490, valid_loss 0.994423, train_metric nan, valid_metric 0.076168
[1421653:MainThread](2026-01-11 22:35:12,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.990603, valid_loss 0.992614, train_metric nan, valid_metric 0.075924
[1421653:MainThread](2026-01-11 22:35:12,614) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.991648, valid_loss 0.992065, train_metric nan, valid_metric 0.080483
[1421653:MainThread](2026-01-11 22:35:12,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992442 to 0.992065, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:13,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.989586, valid_loss 0.994090, train_metric nan, valid_metric 0.076464
[1421653:MainThread](2026-01-11 22:35:13,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.988939, valid_loss 0.992253, train_metric nan, valid_metric 0.079667
[1421653:MainThread](2026-01-11 22:35:13,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.989402, valid_loss 0.992348, train_metric nan, valid_metric 0.076866
[1421653:MainThread](2026-01-11 22:35:14,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.985986, valid_loss 0.992552, train_metric nan, valid_metric 0.076938
[1421653:MainThread](2026-01-11 22:35:14,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.989994, valid_loss 0.993312, train_metric nan, valid_metric 0.076613
[1421653:MainThread](2026-01-11 22:35:15,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.987692, valid_loss 0.993830, train_metric nan, valid_metric 0.073153
[1421653:MainThread](2026-01-11 22:35:15,504) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.982368, valid_loss 0.992367, train_metric nan, valid_metric 0.078671
[1421653:MainThread](2026-01-11 22:35:15,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.987497, valid_loss 0.993267, train_metric nan, valid_metric 0.075926
[1421653:MainThread](2026-01-11 22:35:16,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.989257, valid_loss 0.992614, train_metric nan, valid_metric 0.075962
[1421653:MainThread](2026-01-11 22:35:16,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.992622, valid_loss 0.992916, train_metric nan, valid_metric 0.076966
[1421653:MainThread](2026-01-11 22:35:17,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.991124, valid_loss 0.993620, train_metric nan, valid_metric 0.073981
[1421653:MainThread](2026-01-11 22:35:17,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.990021, valid_loss 0.992689, train_metric nan, valid_metric 0.079466
[1421653:MainThread](2026-01-11 22:35:18,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.989203, valid_loss 0.992553, train_metric nan, valid_metric 0.078773
[1421653:MainThread](2026-01-11 22:35:18,416) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.986577, valid_loss 0.993023, train_metric nan, valid_metric 0.080198
[1421653:MainThread](2026-01-11 22:35:18,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.992362, valid_loss 0.992824, train_metric nan, valid_metric 0.079655
[1421653:MainThread](2026-01-11 22:35:19,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.992258, valid_loss 0.993150, train_metric nan, valid_metric 0.080032
[1421653:MainThread](2026-01-11 22:35:19,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.986444, valid_loss 0.992363, train_metric nan, valid_metric 0.080719
[1421653:MainThread](2026-01-11 22:35:20,067) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.992439, valid_loss 0.992058, train_metric nan, valid_metric 0.080785
[1421653:MainThread](2026-01-11 22:35:20,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992065 to 0.992058, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:20,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.989342, valid_loss 0.992821, train_metric nan, valid_metric 0.079661
[1421653:MainThread](2026-01-11 22:35:20,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.992528, valid_loss 0.992373, train_metric nan, valid_metric 0.079496
[1421653:MainThread](2026-01-11 22:35:21,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.987599, valid_loss 0.992310, train_metric nan, valid_metric 0.080645
[1421653:MainThread](2026-01-11 22:35:21,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.991992, valid_loss 0.992159, train_metric nan, valid_metric 0.080930
[1421653:MainThread](2026-01-11 22:35:22,097) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.987995, valid_loss 0.992150, train_metric nan, valid_metric 0.080525
[1421653:MainThread](2026-01-11 22:35:22,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.991106, valid_loss 0.992196, train_metric nan, valid_metric 0.080722
[1421653:MainThread](2026-01-11 22:35:22,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.988668, valid_loss 0.992254, train_metric nan, valid_metric 0.081004
[1421653:MainThread](2026-01-11 22:35:23,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2460]: train_loss 0.985230, valid_loss 0.992661, train_metric nan, valid_metric 0.079536
[1421653:MainThread](2026-01-11 22:35:23,710) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2480]: train_loss 0.990251, valid_loss 0.992472, train_metric nan, valid_metric 0.081046
[1421653:MainThread](2026-01-11 22:35:24,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2500]: train_loss 0.990534, valid_loss 0.992157, train_metric nan, valid_metric 0.082501
[1421653:MainThread](2026-01-11 22:35:24,536) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2520]: train_loss 0.992255, valid_loss 0.992355, train_metric nan, valid_metric 0.082444
[1421653:MainThread](2026-01-11 22:35:24,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2540]: train_loss 0.989604, valid_loss 0.991952, train_metric nan, valid_metric 0.083184
[1421653:MainThread](2026-01-11 22:35:24,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992058 to 0.991952, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:25,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2560]: train_loss 0.983027, valid_loss 0.992344, train_metric nan, valid_metric 0.082876
[1421653:MainThread](2026-01-11 22:35:25,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2580]: train_loss 0.986319, valid_loss 0.992141, train_metric nan, valid_metric 0.082023
[1421653:MainThread](2026-01-11 22:35:26,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2600]: train_loss 0.988420, valid_loss 0.992305, train_metric nan, valid_metric 0.080290
[1421653:MainThread](2026-01-11 22:35:26,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2620]: train_loss 0.994068, valid_loss 0.992384, train_metric nan, valid_metric 0.081742
[1421653:MainThread](2026-01-11 22:35:27,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2640]: train_loss 0.986081, valid_loss 0.992331, train_metric nan, valid_metric 0.081368
[1421653:MainThread](2026-01-11 22:35:27,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2660]: train_loss 0.983955, valid_loss 0.993070, train_metric nan, valid_metric 0.081404
[1421653:MainThread](2026-01-11 22:35:28,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2680]: train_loss 0.991883, valid_loss 0.992299, train_metric nan, valid_metric 0.081948
[1421653:MainThread](2026-01-11 22:35:28,487) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2700]: train_loss 0.990396, valid_loss 0.992391, train_metric nan, valid_metric 0.081450
[1421653:MainThread](2026-01-11 22:35:28,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2720]: train_loss 0.986673, valid_loss 0.992346, train_metric nan, valid_metric 0.081685
[1421653:MainThread](2026-01-11 22:35:29,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2740]: train_loss 0.988493, valid_loss 0.993589, train_metric nan, valid_metric 0.080184
[1421653:MainThread](2026-01-11 22:35:29,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2760]: train_loss 0.987943, valid_loss 0.992179, train_metric nan, valid_metric 0.081536
[1421653:MainThread](2026-01-11 22:35:30,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2780]: train_loss 0.984963, valid_loss 0.992274, train_metric nan, valid_metric 0.081901
[1421653:MainThread](2026-01-11 22:35:30,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2800]: train_loss 0.987139, valid_loss 0.992154, train_metric nan, valid_metric 0.082381
[1421653:MainThread](2026-01-11 22:35:30,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2820]: train_loss 0.993297, valid_loss 0.992078, train_metric nan, valid_metric 0.081904
[1421653:MainThread](2026-01-11 22:35:31,312) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2840]: train_loss 0.986928, valid_loss 0.992633, train_metric nan, valid_metric 0.080922
[1421653:MainThread](2026-01-11 22:35:31,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2860]: train_loss 0.988197, valid_loss 0.992396, train_metric nan, valid_metric 0.081798
[1421653:MainThread](2026-01-11 22:35:32,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2880]: train_loss 0.985398, valid_loss 0.992557, train_metric nan, valid_metric 0.082857
[1421653:MainThread](2026-01-11 22:35:32,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2900]: train_loss 0.987320, valid_loss 0.992538, train_metric nan, valid_metric 0.081724
[1421653:MainThread](2026-01-11 22:35:32,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2920]: train_loss 0.992608, valid_loss 0.992333, train_metric nan, valid_metric 0.082410
[1421653:MainThread](2026-01-11 22:35:33,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2940]: train_loss 0.990974, valid_loss 0.991973, train_metric nan, valid_metric 0.083052
[1421653:MainThread](2026-01-11 22:35:33,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2960]: train_loss 0.989290, valid_loss 0.992294, train_metric nan, valid_metric 0.081597
[1421653:MainThread](2026-01-11 22:35:34,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2980]: train_loss 0.982412, valid_loss 0.992552, train_metric nan, valid_metric 0.082089
[1421653:MainThread](2026-01-11 22:35:34,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3000]: train_loss 0.988411, valid_loss 0.992448, train_metric nan, valid_metric 0.081863
[1421653:MainThread](2026-01-11 22:35:34,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3020]: train_loss 0.985400, valid_loss 0.992502, train_metric nan, valid_metric 0.081766
[1421653:MainThread](2026-01-11 22:35:35,342) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3040]: train_loss 0.988187, valid_loss 0.992354, train_metric nan, valid_metric 0.081259
[1421653:MainThread](2026-01-11 22:35:35,743) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3060]: train_loss 0.987566, valid_loss 0.992317, train_metric nan, valid_metric 0.081315
[1421653:MainThread](2026-01-11 22:35:36,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3080]: train_loss 0.984442, valid_loss 0.992410, train_metric nan, valid_metric 0.082097
[1421653:MainThread](2026-01-11 22:35:36,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3100]: train_loss 0.989894, valid_loss 0.992319, train_metric nan, valid_metric 0.082961
[1421653:MainThread](2026-01-11 22:35:36,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3120]: train_loss 0.988556, valid_loss 0.992430, train_metric nan, valid_metric 0.082387
[1421653:MainThread](2026-01-11 22:35:37,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3140]: train_loss 0.981149, valid_loss 0.992212, train_metric nan, valid_metric 0.082644
[1421653:MainThread](2026-01-11 22:35:37,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3160]: train_loss 0.990749, valid_loss 0.992260, train_metric nan, valid_metric 0.082674
[1421653:MainThread](2026-01-11 22:35:38,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3180]: train_loss 0.985298, valid_loss 0.992028, train_metric nan, valid_metric 0.082294
[1421653:MainThread](2026-01-11 22:35:38,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3200]: train_loss 0.984856, valid_loss 0.992341, train_metric nan, valid_metric 0.082094
[1421653:MainThread](2026-01-11 22:35:38,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3220]: train_loss 0.990736, valid_loss 0.992247, train_metric nan, valid_metric 0.082356
[1421653:MainThread](2026-01-11 22:35:39,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3240]: train_loss 0.987861, valid_loss 0.992242, train_metric nan, valid_metric 0.082478
[1421653:MainThread](2026-01-11 22:35:39,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3260]: train_loss 0.982302, valid_loss 0.992287, train_metric nan, valid_metric 0.082556
[1421653:MainThread](2026-01-11 22:35:40,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3280]: train_loss 0.991021, valid_loss 0.992440, train_metric nan, valid_metric 0.082898
[1421653:MainThread](2026-01-11 22:35:40,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3300]: train_loss 0.980539, valid_loss 0.992289, train_metric nan, valid_metric 0.082886
[1421653:MainThread](2026-01-11 22:35:40,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3320]: train_loss 0.981348, valid_loss 0.992163, train_metric nan, valid_metric 0.082595
[1421653:MainThread](2026-01-11 22:35:41,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3340]: train_loss 0.987136, valid_loss 0.992073, train_metric nan, valid_metric 0.082554
[1421653:MainThread](2026-01-11 22:35:41,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3360]: train_loss 0.988003, valid_loss 0.991948, train_metric nan, valid_metric 0.082373
[1421653:MainThread](2026-01-11 22:35:41,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.991952 to 0.991948, save checkpoint.
[1421653:MainThread](2026-01-11 22:35:42,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3380]: train_loss 0.983550, valid_loss 0.992202, train_metric nan, valid_metric 0.082711
[1421653:MainThread](2026-01-11 22:35:42,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3400]: train_loss 0.987300, valid_loss 0.992127, train_metric nan, valid_metric 0.082630
[1421653:MainThread](2026-01-11 22:35:42,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3420]: train_loss 0.989418, valid_loss 0.992097, train_metric nan, valid_metric 0.082903
[1421653:MainThread](2026-01-11 22:35:43,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3440]: train_loss 0.984044, valid_loss 0.992174, train_metric nan, valid_metric 0.083103
[1421653:MainThread](2026-01-11 22:35:43,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3460]: train_loss 0.985896, valid_loss 0.992281, train_metric nan, valid_metric 0.082930
[1421653:MainThread](2026-01-11 22:35:44,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3480]: train_loss 0.980377, valid_loss 0.992131, train_metric nan, valid_metric 0.082801
[1421653:MainThread](2026-01-11 22:35:44,494) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3500]: train_loss 0.993128, valid_loss 0.992311, train_metric nan, valid_metric 0.082662
[1421653:MainThread](2026-01-11 22:35:44,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3520]: train_loss 0.983031, valid_loss 0.992349, train_metric nan, valid_metric 0.082805
[1421653:MainThread](2026-01-11 22:35:45,304) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3540]: train_loss 0.985971, valid_loss 0.992357, train_metric nan, valid_metric 0.082686
[1421653:MainThread](2026-01-11 22:35:45,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3560]: train_loss 0.981625, valid_loss 0.992193, train_metric nan, valid_metric 0.082648
[1421653:MainThread](2026-01-11 22:35:46,130) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3580]: train_loss 0.978617, valid_loss 0.992277, train_metric nan, valid_metric 0.082608
[1421653:MainThread](2026-01-11 22:35:46,538) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3600]: train_loss 0.986289, valid_loss 0.992295, train_metric nan, valid_metric 0.082733
[1421653:MainThread](2026-01-11 22:35:46,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3620]: train_loss 0.986968, valid_loss 0.992165, train_metric nan, valid_metric 0.082617
[1421653:MainThread](2026-01-11 22:35:47,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3640]: train_loss 0.986749, valid_loss 0.992111, train_metric nan, valid_metric 0.082868
[1421653:MainThread](2026-01-11 22:35:47,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3660]: train_loss 0.983910, valid_loss 0.992070, train_metric nan, valid_metric 0.082791
[1421653:MainThread](2026-01-11 22:35:48,150) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3680]: train_loss 0.983289, valid_loss 0.992135, train_metric nan, valid_metric 0.082775
[1421653:MainThread](2026-01-11 22:35:48,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3700]: train_loss 0.985844, valid_loss 0.992163, train_metric nan, valid_metric 0.082626
[1421653:MainThread](2026-01-11 22:35:48,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3720]: train_loss 0.987414, valid_loss 0.992277, train_metric nan, valid_metric 0.082663
[1421653:MainThread](2026-01-11 22:35:49,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3740]: train_loss 0.983647, valid_loss 0.992113, train_metric nan, valid_metric 0.082603
[1421653:MainThread](2026-01-11 22:35:49,518) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3760]: train_loss 0.986508, valid_loss 0.992229, train_metric nan, valid_metric 0.082530
[1421653:MainThread](2026-01-11 22:35:49,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3780]: train_loss 0.989329, valid_loss 0.992215, train_metric nan, valid_metric 0.082708
[1421653:MainThread](2026-01-11 22:35:50,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3800]: train_loss 0.987285, valid_loss 0.992210, train_metric nan, valid_metric 0.082679
[1421653:MainThread](2026-01-11 22:35:50,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3820]: train_loss 0.992340, valid_loss 0.992095, train_metric nan, valid_metric 0.082627
[1421653:MainThread](2026-01-11 22:35:51,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3840]: train_loss 0.990660, valid_loss 0.992252, train_metric nan, valid_metric 0.082693
[1421653:MainThread](2026-01-11 22:35:51,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3860]: train_loss 0.989139, valid_loss 0.992405, train_metric nan, valid_metric 0.082655
[1421653:MainThread](2026-01-11 22:35:51,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3880]: train_loss 0.985548, valid_loss 0.992380, train_metric nan, valid_metric 0.082853
[1421653:MainThread](2026-01-11 22:35:52,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3900]: train_loss 0.990713, valid_loss 0.992303, train_metric nan, valid_metric 0.082738
[1421653:MainThread](2026-01-11 22:35:52,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3920]: train_loss 0.986597, valid_loss 0.992174, train_metric nan, valid_metric 0.082867
[1421653:MainThread](2026-01-11 22:35:53,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3940]: train_loss 0.989289, valid_loss 0.992200, train_metric nan, valid_metric 0.082857
[1421653:MainThread](2026-01-11 22:35:53,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3960]: train_loss 0.985556, valid_loss 0.992186, train_metric nan, valid_metric 0.082928
[1421653:MainThread](2026-01-11 22:35:53,863) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 3980]: train_loss 0.989443, valid_loss 0.992093, train_metric nan, valid_metric 0.082910
[1421653:MainThread](2026-01-11 22:35:54,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4000]: train_loss 0.987205, valid_loss 0.992131, train_metric nan, valid_metric 0.082879
[1421653:MainThread](2026-01-11 22:35:54,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4020]: train_loss 0.980980, valid_loss 0.992220, train_metric nan, valid_metric 0.083010
[1421653:MainThread](2026-01-11 22:35:55,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4040]: train_loss 0.990123, valid_loss 0.992219, train_metric nan, valid_metric 0.083108
[1421653:MainThread](2026-01-11 22:35:55,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4060]: train_loss 0.982828, valid_loss 0.992166, train_metric nan, valid_metric 0.082903
[1421653:MainThread](2026-01-11 22:35:55,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4080]: train_loss 0.985988, valid_loss 0.992186, train_metric nan, valid_metric 0.082895
[1421653:MainThread](2026-01-11 22:35:56,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4100]: train_loss 0.985159, valid_loss 0.992068, train_metric nan, valid_metric 0.082996
[1421653:MainThread](2026-01-11 22:35:56,713) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4120]: train_loss 0.987738, valid_loss 0.992094, train_metric nan, valid_metric 0.082726
[1421653:MainThread](2026-01-11 22:35:57,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4140]: train_loss 0.985871, valid_loss 0.992249, train_metric nan, valid_metric 0.082679
[1421653:MainThread](2026-01-11 22:35:57,533) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4160]: train_loss 0.982902, valid_loss 0.992208, train_metric nan, valid_metric 0.082861
[1421653:MainThread](2026-01-11 22:35:57,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4180]: train_loss 0.986632, valid_loss 0.992301, train_metric nan, valid_metric 0.083008
[1421653:MainThread](2026-01-11 22:35:58,303) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4200]: train_loss 0.986772, valid_loss 0.992174, train_metric nan, valid_metric 0.082822
[1421653:MainThread](2026-01-11 22:35:58,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4220]: train_loss 0.986276, valid_loss 0.992168, train_metric nan, valid_metric 0.082956
[1421653:MainThread](2026-01-11 22:35:59,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4240]: train_loss 0.990330, valid_loss 0.992148, train_metric nan, valid_metric 0.082934
[1421653:MainThread](2026-01-11 22:35:59,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4260]: train_loss 0.983825, valid_loss 0.992258, train_metric nan, valid_metric 0.083025
[1421653:MainThread](2026-01-11 22:35:59,889) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4280]: train_loss 0.990606, valid_loss 0.992366, train_metric nan, valid_metric 0.082731
[1421653:MainThread](2026-01-11 22:36:00,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4300]: train_loss 0.986167, valid_loss 0.992294, train_metric nan, valid_metric 0.082823
[1421653:MainThread](2026-01-11 22:36:00,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4320]: train_loss 0.984529, valid_loss 0.992212, train_metric nan, valid_metric 0.082841
[1421653:MainThread](2026-01-11 22:36:01,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4340]: train_loss 0.987784, valid_loss 0.992247, train_metric nan, valid_metric 0.082846
[1421653:MainThread](2026-01-11 22:36:01,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 4360]: train_loss 0.989933, valid_loss 0.992252, train_metric nan, valid_metric 0.082713
[1421653:MainThread](2026-01-11 22:36:01,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:36:01.692 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:36:04.605 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 22:36:04.605 | INFO     | __main__:train_single_fold:593 -   IC=0.0324, ICIR=0.2718, RankIC=0.0408, RankICIR=0.3771
2026-01-11 22:36:04.605 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:36:04,613) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:36:52,053) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:36:52,054) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:36:58,442) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df55b3e90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 33.25it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 62.50it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 74.33it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:02, 76.17it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:02, 76.43it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 78.02it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 79.12it/s]backtest loop:  28%|██▊       | 67/243 [00:00<00:02, 78.44it/s]backtest loop:  32%|███▏      | 77/243 [00:01<00:02, 79.89it/s]backtest loop:  35%|███▍      | 85/243 [00:01<00:01, 79.78it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 80.64it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 82.07it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 81.73it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 83.20it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 85.41it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 85.89it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 84.31it/s]backtest loop:  67%|██████▋   | 164/243 [00:02<00:00, 84.29it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 83.51it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 82.99it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 85.09it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 83.76it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 83.50it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 82.71it/s]backtest loop:  96%|█████████▌| 233/243 [00:02<00:00, 82.64it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.50it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 81.01it/s]
2026-01-11 22:37:01.463 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0390, Sharpe(w/cost)=0.5265, MaxDD=-0.0483
2026-01-11 22:37:06.849 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 22:37:24.797 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:37:24.870 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_2_pred.parquet
2026-01-11 22:37:24.889 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 22:37:24.889 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 22:37:27.425 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0329
2026-01-11 22:37:30.339 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0380
2026-01-11 22:37:30.679 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0319, ICIR=0.2715, RankIC=0.0418
[1421653:MainThread](2026-01-11 22:37:30,685) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:38:15,236) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:38:15,237) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:38:21,541) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df7a5be90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 29.25it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 56.65it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 71.19it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 81.81it/s]backtest loop:  16%|█▌        | 39/243 [00:00<00:02, 77.76it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 81.89it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 82.91it/s]backtest loop:  28%|██▊       | 68/243 [00:00<00:02, 82.76it/s]backtest loop:  32%|███▏      | 77/243 [00:00<00:02, 82.71it/s]backtest loop:  35%|███▌      | 86/243 [00:01<00:01, 83.68it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 84.08it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 86.52it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 86.57it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 87.28it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 88.04it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 88.23it/s]backtest loop:  63%|██████▎   | 154/243 [00:01<00:01, 87.43it/s]backtest loop:  67%|██████▋   | 163/243 [00:01<00:00, 87.40it/s]backtest loop:  71%|███████   | 172/243 [00:02<00:00, 86.57it/s]backtest loop:  74%|███████▍  | 181/243 [00:02<00:00, 86.85it/s]backtest loop:  78%|███████▊  | 190/243 [00:02<00:00, 86.34it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 86.39it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 84.71it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 83.29it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 82.96it/s]backtest loop:  98%|█████████▊| 238/243 [00:02<00:00, 82.62it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.13it/s]
2026-01-11 22:38:24.487 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0063, Sharpe(w/cost)=-0.0920
2026-01-11 22:38:24.555 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:38:24.555 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 22:38:24.555 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:38:24.555 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:40:03,897) INFO - qlib.timer - [log.py:127] - Time cost: 99.339s | Loading data Done
[1421653:MainThread](2026-01-11 22:40:07,712) INFO - qlib.timer - [log.py:127] - Time cost: 3.236s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:40:09,117) INFO - qlib.timer - [log.py:127] - Time cost: 1.404s | Fillna Done
[1421653:MainThread](2026-01-11 22:40:10,902) INFO - qlib.timer - [log.py:127] - Time cost: 0.314s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:40:11,102) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:40:11,104) INFO - qlib.timer - [log.py:127] - Time cost: 7.207s | fit & process data Done
[1421653:MainThread](2026-01-11 22:40:11,105) INFO - qlib.timer - [log.py:127] - Time cost: 106.548s | Init data Done
2026-01-11 22:40:11.105 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:40:11,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:40:11,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:40:11,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:40:11,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:40:11.121 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:40:12,790) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:40:13,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.437731, valid_loss 1.101115, train_metric nan, valid_metric 0.007048
[1421653:MainThread](2026-01-11 22:40:13,635) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.101115, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:14,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.093629, valid_loss 1.019548, train_metric nan, valid_metric 0.004127
[1421653:MainThread](2026-01-11 22:40:14,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.101115 to 1.019548, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:14,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.063568, valid_loss 1.016564, train_metric nan, valid_metric 0.011869
[1421653:MainThread](2026-01-11 22:40:14,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.019548 to 1.016564, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:14,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.057833, valid_loss 1.006541, train_metric nan, valid_metric 0.019775
[1421653:MainThread](2026-01-11 22:40:14,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.016564 to 1.006541, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:15,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.041339, valid_loss 1.004319, train_metric nan, valid_metric 0.019375
[1421653:MainThread](2026-01-11 22:40:15,172) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006541 to 1.004319, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:15,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.036700, valid_loss 1.003334, train_metric nan, valid_metric 0.017477
[1421653:MainThread](2026-01-11 22:40:15,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004319 to 1.003334, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:15,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.038334, valid_loss 1.003208, train_metric nan, valid_metric 0.021835
[1421653:MainThread](2026-01-11 22:40:15,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003334 to 1.003208, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:16,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.034568, valid_loss 1.004086, train_metric nan, valid_metric 0.028619
[1421653:MainThread](2026-01-11 22:40:16,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.035269, valid_loss 1.002387, train_metric nan, valid_metric 0.026548
[1421653:MainThread](2026-01-11 22:40:16,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003208 to 1.002387, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:17,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.031077, valid_loss 1.009752, train_metric nan, valid_metric 0.028157
[1421653:MainThread](2026-01-11 22:40:17,570) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.020330, valid_loss 1.001326, train_metric nan, valid_metric 0.029254
[1421653:MainThread](2026-01-11 22:40:17,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002387 to 1.001326, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:17,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.021158, valid_loss 0.999827, train_metric nan, valid_metric 0.031076
[1421653:MainThread](2026-01-11 22:40:17,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001326 to 0.999827, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:18,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.026087, valid_loss 1.000699, train_metric nan, valid_metric 0.029138
[1421653:MainThread](2026-01-11 22:40:18,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.015192, valid_loss 1.000890, train_metric nan, valid_metric 0.028405
[1421653:MainThread](2026-01-11 22:40:19,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.018066, valid_loss 0.999853, train_metric nan, valid_metric 0.026808
[1421653:MainThread](2026-01-11 22:40:19,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.015158, valid_loss 1.000625, train_metric nan, valid_metric 0.033037
[1421653:MainThread](2026-01-11 22:40:20,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.014033, valid_loss 1.002074, train_metric nan, valid_metric 0.031733
[1421653:MainThread](2026-01-11 22:40:20,452) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.014624, valid_loss 1.000112, train_metric nan, valid_metric 0.027848
[1421653:MainThread](2026-01-11 22:40:20,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.011930, valid_loss 0.999868, train_metric nan, valid_metric 0.032412
[1421653:MainThread](2026-01-11 22:40:21,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.011671, valid_loss 1.001273, train_metric nan, valid_metric 0.028997
[1421653:MainThread](2026-01-11 22:40:21,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.007512, valid_loss 0.998969, train_metric nan, valid_metric 0.032762
[1421653:MainThread](2026-01-11 22:40:21,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999827 to 0.998969, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:22,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.008301, valid_loss 0.998622, train_metric nan, valid_metric 0.036407
[1421653:MainThread](2026-01-11 22:40:22,153) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998969 to 0.998622, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:22,583) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.013081, valid_loss 1.001713, train_metric nan, valid_metric 0.032821
[1421653:MainThread](2026-01-11 22:40:22,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.001057, valid_loss 0.998849, train_metric nan, valid_metric 0.034850
[1421653:MainThread](2026-01-11 22:40:23,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.001246, valid_loss 0.999278, train_metric nan, valid_metric 0.034243
[1421653:MainThread](2026-01-11 22:40:23,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.999268, valid_loss 0.998863, train_metric nan, valid_metric 0.028575
[1421653:MainThread](2026-01-11 22:40:24,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 0.999748, valid_loss 0.999330, train_metric nan, valid_metric 0.035273
[1421653:MainThread](2026-01-11 22:40:25,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.997986, valid_loss 0.998075, train_metric nan, valid_metric 0.035807
[1421653:MainThread](2026-01-11 22:40:25,185) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998622 to 0.998075, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:25,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.004432, valid_loss 0.997786, train_metric nan, valid_metric 0.035437
[1421653:MainThread](2026-01-11 22:40:25,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998075 to 0.997786, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:26,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.005247, valid_loss 1.001370, train_metric nan, valid_metric 0.032430
[1421653:MainThread](2026-01-11 22:40:26,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.002163, valid_loss 1.002329, train_metric nan, valid_metric 0.029716
[1421653:MainThread](2026-01-11 22:40:26,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.996983, valid_loss 0.998716, train_metric nan, valid_metric 0.036082
[1421653:MainThread](2026-01-11 22:40:27,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.001368, valid_loss 0.997764, train_metric nan, valid_metric 0.038142
[1421653:MainThread](2026-01-11 22:40:27,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997786 to 0.997764, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:27,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.995738, valid_loss 0.999103, train_metric nan, valid_metric 0.035449
[1421653:MainThread](2026-01-11 22:40:28,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.997311, valid_loss 1.005047, train_metric nan, valid_metric 0.032765
[1421653:MainThread](2026-01-11 22:40:28,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.995619, valid_loss 0.998915, train_metric nan, valid_metric 0.038226
[1421653:MainThread](2026-01-11 22:40:28,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.995417, valid_loss 0.998505, train_metric nan, valid_metric 0.037566
[1421653:MainThread](2026-01-11 22:40:29,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.994513, valid_loss 0.998404, train_metric nan, valid_metric 0.030495
[1421653:MainThread](2026-01-11 22:40:29,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.991224, valid_loss 0.997875, train_metric nan, valid_metric 0.033461
[1421653:MainThread](2026-01-11 22:40:29,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.997750, valid_loss 0.997483, train_metric nan, valid_metric 0.038469
[1421653:MainThread](2026-01-11 22:40:29,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997764 to 0.997483, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:30,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.995441, valid_loss 0.999481, train_metric nan, valid_metric 0.034273
[1421653:MainThread](2026-01-11 22:40:30,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.992160, valid_loss 0.998657, train_metric nan, valid_metric 0.040108
[1421653:MainThread](2026-01-11 22:40:31,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.993113, valid_loss 0.998031, train_metric nan, valid_metric 0.036008
[1421653:MainThread](2026-01-11 22:40:31,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.001036, valid_loss 1.000314, train_metric nan, valid_metric 0.033838
[1421653:MainThread](2026-01-11 22:40:31,881) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.991313, valid_loss 0.997922, train_metric nan, valid_metric 0.041737
[1421653:MainThread](2026-01-11 22:40:32,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.994411, valid_loss 0.997109, train_metric nan, valid_metric 0.042389
[1421653:MainThread](2026-01-11 22:40:32,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997483 to 0.997109, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:32,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.991957, valid_loss 0.997043, train_metric nan, valid_metric 0.038829
[1421653:MainThread](2026-01-11 22:40:32,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997109 to 0.997043, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:33,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.993025, valid_loss 1.001732, train_metric nan, valid_metric 0.035975
[1421653:MainThread](2026-01-11 22:40:33,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.986381, valid_loss 0.998613, train_metric nan, valid_metric 0.040551
[1421653:MainThread](2026-01-11 22:40:33,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.990465, valid_loss 0.997684, train_metric nan, valid_metric 0.042965
[1421653:MainThread](2026-01-11 22:40:34,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.991460, valid_loss 0.999056, train_metric nan, valid_metric 0.041484
[1421653:MainThread](2026-01-11 22:40:34,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.998596, valid_loss 0.996593, train_metric nan, valid_metric 0.045908
[1421653:MainThread](2026-01-11 22:40:34,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997043 to 0.996593, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:35,009) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.988677, valid_loss 0.996788, train_metric nan, valid_metric 0.040975
[1421653:MainThread](2026-01-11 22:40:35,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.991438, valid_loss 1.003402, train_metric nan, valid_metric 0.031588
[1421653:MainThread](2026-01-11 22:40:35,784) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.995011, valid_loss 0.997147, train_metric nan, valid_metric 0.041679
[1421653:MainThread](2026-01-11 22:40:36,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.989732, valid_loss 1.000213, train_metric nan, valid_metric 0.040839
[1421653:MainThread](2026-01-11 22:40:36,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.989596, valid_loss 0.998478, train_metric nan, valid_metric 0.039870
[1421653:MainThread](2026-01-11 22:40:36,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.989473, valid_loss 0.998312, train_metric nan, valid_metric 0.043542
[1421653:MainThread](2026-01-11 22:40:37,327) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.993355, valid_loss 0.999865, train_metric nan, valid_metric 0.040918
[1421653:MainThread](2026-01-11 22:40:37,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.995805, valid_loss 0.997325, train_metric nan, valid_metric 0.043366
[1421653:MainThread](2026-01-11 22:40:38,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.990184, valid_loss 0.999035, train_metric nan, valid_metric 0.041797
[1421653:MainThread](2026-01-11 22:40:38,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.991365, valid_loss 0.998258, train_metric nan, valid_metric 0.042608
[1421653:MainThread](2026-01-11 22:40:38,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.994077, valid_loss 0.996717, train_metric nan, valid_metric 0.045058
[1421653:MainThread](2026-01-11 22:40:39,234) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.988525, valid_loss 0.998633, train_metric nan, valid_metric 0.041242
[1421653:MainThread](2026-01-11 22:40:39,627) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.985846, valid_loss 0.997480, train_metric nan, valid_metric 0.045265
[1421653:MainThread](2026-01-11 22:40:39,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.986562, valid_loss 0.997677, train_metric nan, valid_metric 0.045204
[1421653:MainThread](2026-01-11 22:40:40,273) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.993306, valid_loss 0.998005, train_metric nan, valid_metric 0.047126
[1421653:MainThread](2026-01-11 22:40:40,580) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.986234, valid_loss 0.997259, train_metric nan, valid_metric 0.046703
[1421653:MainThread](2026-01-11 22:40:40,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.988949, valid_loss 0.997048, train_metric nan, valid_metric 0.046142
[1421653:MainThread](2026-01-11 22:40:41,209) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.990863, valid_loss 0.996536, train_metric nan, valid_metric 0.047334
[1421653:MainThread](2026-01-11 22:40:41,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996593 to 0.996536, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:41,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.992622, valid_loss 0.998222, train_metric nan, valid_metric 0.043451
[1421653:MainThread](2026-01-11 22:40:42,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.984973, valid_loss 0.997074, train_metric nan, valid_metric 0.048063
[1421653:MainThread](2026-01-11 22:40:42,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.984462, valid_loss 0.997727, train_metric nan, valid_metric 0.048177
[1421653:MainThread](2026-01-11 22:40:42,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.986826, valid_loss 0.996795, train_metric nan, valid_metric 0.047403
[1421653:MainThread](2026-01-11 22:40:43,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.991027, valid_loss 0.997395, train_metric nan, valid_metric 0.045451
[1421653:MainThread](2026-01-11 22:40:43,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.988860, valid_loss 0.997306, train_metric nan, valid_metric 0.047709
[1421653:MainThread](2026-01-11 22:40:44,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.986667, valid_loss 0.996667, train_metric nan, valid_metric 0.049048
[1421653:MainThread](2026-01-11 22:40:44,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.986212, valid_loss 0.997591, train_metric nan, valid_metric 0.047515
[1421653:MainThread](2026-01-11 22:40:44,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.985806, valid_loss 0.997314, train_metric nan, valid_metric 0.047337
[1421653:MainThread](2026-01-11 22:40:45,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.988106, valid_loss 0.996792, train_metric nan, valid_metric 0.050024
[1421653:MainThread](2026-01-11 22:40:45,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.986563, valid_loss 0.999027, train_metric nan, valid_metric 0.045312
[1421653:MainThread](2026-01-11 22:40:45,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.986727, valid_loss 0.997265, train_metric nan, valid_metric 0.048547
[1421653:MainThread](2026-01-11 22:40:46,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.993201, valid_loss 0.997598, train_metric nan, valid_metric 0.047598
[1421653:MainThread](2026-01-11 22:40:46,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.987890, valid_loss 1.000158, train_metric nan, valid_metric 0.043492
[1421653:MainThread](2026-01-11 22:40:47,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.982602, valid_loss 0.997468, train_metric nan, valid_metric 0.049011
[1421653:MainThread](2026-01-11 22:40:47,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.988647, valid_loss 0.996616, train_metric nan, valid_metric 0.050201
[1421653:MainThread](2026-01-11 22:40:48,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.986440, valid_loss 0.996462, train_metric nan, valid_metric 0.050605
[1421653:MainThread](2026-01-11 22:40:48,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996536 to 0.996462, save checkpoint.
[1421653:MainThread](2026-01-11 22:40:48,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.989779, valid_loss 0.996836, train_metric nan, valid_metric 0.049226
[1421653:MainThread](2026-01-11 22:40:48,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.990326, valid_loss 0.999551, train_metric nan, valid_metric 0.044113
[1421653:MainThread](2026-01-11 22:40:49,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.990569, valid_loss 0.998737, train_metric nan, valid_metric 0.047096
[1421653:MainThread](2026-01-11 22:40:49,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.983279, valid_loss 0.998080, train_metric nan, valid_metric 0.047862
[1421653:MainThread](2026-01-11 22:40:50,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.984494, valid_loss 0.996674, train_metric nan, valid_metric 0.050822
[1421653:MainThread](2026-01-11 22:40:50,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.990123, valid_loss 0.997858, train_metric nan, valid_metric 0.048196
[1421653:MainThread](2026-01-11 22:40:50,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.985634, valid_loss 0.997953, train_metric nan, valid_metric 0.047714
[1421653:MainThread](2026-01-11 22:40:51,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.988841, valid_loss 0.996818, train_metric nan, valid_metric 0.050380
[1421653:MainThread](2026-01-11 22:40:51,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.988527, valid_loss 0.996571, train_metric nan, valid_metric 0.049910
[1421653:MainThread](2026-01-11 22:40:52,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.988445, valid_loss 0.997348, train_metric nan, valid_metric 0.049298
[1421653:MainThread](2026-01-11 22:40:52,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.980247, valid_loss 0.999197, train_metric nan, valid_metric 0.047902
[1421653:MainThread](2026-01-11 22:40:52,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.989313, valid_loss 0.997113, train_metric nan, valid_metric 0.050602
[1421653:MainThread](2026-01-11 22:40:53,183) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.985091, valid_loss 0.997714, train_metric nan, valid_metric 0.050426
[1421653:MainThread](2026-01-11 22:40:53,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.992102, valid_loss 0.997543, train_metric nan, valid_metric 0.049078
[1421653:MainThread](2026-01-11 22:40:53,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.988145, valid_loss 0.997371, train_metric nan, valid_metric 0.048629
[1421653:MainThread](2026-01-11 22:40:54,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.981018, valid_loss 0.998233, train_metric nan, valid_metric 0.047759
[1421653:MainThread](2026-01-11 22:40:54,868) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.983061, valid_loss 0.997606, train_metric nan, valid_metric 0.048573
[1421653:MainThread](2026-01-11 22:40:55,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.989236, valid_loss 0.997311, train_metric nan, valid_metric 0.050209
[1421653:MainThread](2026-01-11 22:40:55,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.984769, valid_loss 0.996872, train_metric nan, valid_metric 0.051190
[1421653:MainThread](2026-01-11 22:40:56,050) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.985189, valid_loss 0.997969, train_metric nan, valid_metric 0.047975
[1421653:MainThread](2026-01-11 22:40:56,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.983790, valid_loss 0.997673, train_metric nan, valid_metric 0.048256
[1421653:MainThread](2026-01-11 22:40:56,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.983922, valid_loss 0.997085, train_metric nan, valid_metric 0.049668
[1421653:MainThread](2026-01-11 22:40:57,268) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.993124, valid_loss 0.997478, train_metric nan, valid_metric 0.048854
[1421653:MainThread](2026-01-11 22:40:57,675) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.985590, valid_loss 0.997351, train_metric nan, valid_metric 0.049559
[1421653:MainThread](2026-01-11 22:40:58,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.988539, valid_loss 0.997550, train_metric nan, valid_metric 0.049513
[1421653:MainThread](2026-01-11 22:40:58,481) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.988205, valid_loss 0.996939, train_metric nan, valid_metric 0.050536
[1421653:MainThread](2026-01-11 22:40:58,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.979335, valid_loss 0.997789, train_metric nan, valid_metric 0.048312
[1421653:MainThread](2026-01-11 22:40:59,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.982276, valid_loss 0.997295, train_metric nan, valid_metric 0.049806
[1421653:MainThread](2026-01-11 22:40:59,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.982584, valid_loss 0.997057, train_metric nan, valid_metric 0.050792
[1421653:MainThread](2026-01-11 22:41:00,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.985686, valid_loss 0.997028, train_metric nan, valid_metric 0.050931
[1421653:MainThread](2026-01-11 22:41:00,606) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.983090, valid_loss 0.997599, train_metric nan, valid_metric 0.049666
[1421653:MainThread](2026-01-11 22:41:01,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.984972, valid_loss 0.997002, train_metric nan, valid_metric 0.050367
[1421653:MainThread](2026-01-11 22:41:01,419) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.977596, valid_loss 0.998213, train_metric nan, valid_metric 0.048644
[1421653:MainThread](2026-01-11 22:41:01,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.987386, valid_loss 0.997223, train_metric nan, valid_metric 0.049827
[1421653:MainThread](2026-01-11 22:41:02,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.984079, valid_loss 0.997401, train_metric nan, valid_metric 0.049824
[1421653:MainThread](2026-01-11 22:41:02,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2460]: train_loss 0.984948, valid_loss 0.997130, train_metric nan, valid_metric 0.050368
[1421653:MainThread](2026-01-11 22:41:03,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2480]: train_loss 0.988958, valid_loss 0.997727, train_metric nan, valid_metric 0.049149
[1421653:MainThread](2026-01-11 22:41:03,448) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2500]: train_loss 0.988405, valid_loss 0.996999, train_metric nan, valid_metric 0.050512
[1421653:MainThread](2026-01-11 22:41:03,855) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2520]: train_loss 0.987310, valid_loss 0.997069, train_metric nan, valid_metric 0.050226
[1421653:MainThread](2026-01-11 22:41:04,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2540]: train_loss 0.987112, valid_loss 0.997420, train_metric nan, valid_metric 0.049685
[1421653:MainThread](2026-01-11 22:41:04,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2560]: train_loss 0.983552, valid_loss 0.997567, train_metric nan, valid_metric 0.049754
[1421653:MainThread](2026-01-11 22:41:04,817) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2580]: train_loss 0.988122, valid_loss 0.997621, train_metric nan, valid_metric 0.049651
[1421653:MainThread](2026-01-11 22:41:05,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2600]: train_loss 0.985396, valid_loss 0.997253, train_metric nan, valid_metric 0.050370
[1421653:MainThread](2026-01-11 22:41:05,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2620]: train_loss 0.983087, valid_loss 0.997120, train_metric nan, valid_metric 0.050541
[1421653:MainThread](2026-01-11 22:41:05,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2640]: train_loss 0.987005, valid_loss 0.997318, train_metric nan, valid_metric 0.050099
[1421653:MainThread](2026-01-11 22:41:06,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2660]: train_loss 0.988195, valid_loss 0.997131, train_metric nan, valid_metric 0.050505
[1421653:MainThread](2026-01-11 22:41:06,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2680]: train_loss 0.983437, valid_loss 0.996944, train_metric nan, valid_metric 0.051106
[1421653:MainThread](2026-01-11 22:41:07,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2700]: train_loss 0.983440, valid_loss 0.997154, train_metric nan, valid_metric 0.050619
[1421653:MainThread](2026-01-11 22:41:07,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2720]: train_loss 0.984508, valid_loss 0.997274, train_metric nan, valid_metric 0.050335
[1421653:MainThread](2026-01-11 22:41:08,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2740]: train_loss 0.981176, valid_loss 0.997254, train_metric nan, valid_metric 0.049946
[1421653:MainThread](2026-01-11 22:41:08,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:41:08.052 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:41:10.922 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 22:41:10.923 | INFO     | __main__:train_single_fold:593 -   IC=0.0077, ICIR=0.0642, RankIC=0.0266, RankICIR=0.2471
2026-01-11 22:41:10.923 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:41:10,930) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:41:58,912) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:41:58,913) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:42:06,234) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df51fe690>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 24.89it/s]backtest loop:   5%|▍         | 12/244 [00:00<00:03, 59.72it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:03, 63.13it/s]backtest loop:  11%|█▏        | 28/244 [00:00<00:03, 69.19it/s]backtest loop:  15%|█▌        | 37/244 [00:00<00:02, 75.63it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:02, 74.74it/s]backtest loop:  22%|██▏       | 53/244 [00:00<00:02, 74.56it/s]backtest loop:  25%|██▌       | 62/244 [00:00<00:02, 75.21it/s]backtest loop:  30%|██▉       | 72/244 [00:01<00:02, 77.37it/s]backtest loop:  33%|███▎      | 80/244 [00:01<00:02, 76.47it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:02, 76.66it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 79.70it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 81.34it/s]backtest loop:  48%|████▊     | 117/244 [00:01<00:01, 85.34it/s]backtest loop:  52%|█████▏    | 127/244 [00:01<00:01, 87.84it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 89.14it/s]backtest loop:  61%|██████    | 148/244 [00:01<00:01, 90.58it/s]backtest loop:  65%|██████▍   | 158/244 [00:01<00:00, 91.30it/s]backtest loop:  69%|██████▉   | 168/244 [00:02<00:00, 90.17it/s]backtest loop:  73%|███████▎  | 178/244 [00:02<00:00, 91.35it/s]backtest loop:  77%|███████▋  | 188/244 [00:02<00:00, 88.61it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 90.82it/s]backtest loop:  85%|████████▌ | 208/244 [00:02<00:00, 90.76it/s]backtest loop:  89%|████████▉ | 218/244 [00:02<00:00, 88.13it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 82.93it/s]backtest loop:  97%|█████████▋| 237/244 [00:02<00:00, 82.11it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 81.12it/s]
2026-01-11 22:42:09.266 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1502, Sharpe(w/cost)=-1.8983, MaxDD=-0.1846
2026-01-11 22:42:13.943 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 22:42:30.020 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:42:30.087 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_3_pred.parquet
2026-01-11 22:42:30.105 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 22:42:30.105 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 22:42:33.017 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0273
2026-01-11 22:42:35.287 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0309
2026-01-11 22:42:37.670 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0322
2026-01-11 22:42:38.024 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0117, ICIR=0.0965, RankIC=0.0293
[1421653:MainThread](2026-01-11 22:42:38,030) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:43:18,432) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:43:18,434) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:43:25,558) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df59cbe90>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 28.13it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 65.60it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:02, 74.50it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 77.17it/s]backtest loop:  18%|█▊        | 43/244 [00:00<00:02, 78.44it/s]backtest loop:  22%|██▏       | 53/244 [00:00<00:02, 79.83it/s]backtest loop:  25%|██▌       | 62/244 [00:00<00:02, 79.18it/s]backtest loop:  30%|██▉       | 72/244 [00:00<00:02, 80.65it/s]backtest loop:  33%|███▎      | 81/244 [00:01<00:02, 80.24it/s]backtest loop:  37%|███▋      | 90/244 [00:01<00:01, 79.81it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 79.74it/s]backtest loop:  44%|████▍     | 108/244 [00:01<00:01, 80.07it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 81.02it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 79.73it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 79.81it/s]backtest loop:  60%|██████    | 147/244 [00:01<00:01, 82.42it/s]backtest loop:  64%|██████▍   | 156/244 [00:01<00:01, 80.81it/s]backtest loop:  68%|██████▊   | 165/244 [00:02<00:00, 80.89it/s]backtest loop:  71%|███████▏  | 174/244 [00:02<00:00, 79.74it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 78.37it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 78.54it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 78.76it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 78.49it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 79.75it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 79.95it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 80.22it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 78.65it/s]
2026-01-11 22:43:28.684 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.1211, Sharpe(w/cost)=-1.6071
2026-01-11 22:43:28.749 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:43:28.749 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 22:43:28.749 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:43:28.749 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:45:06,292) INFO - qlib.timer - [log.py:127] - Time cost: 97.541s | Loading data Done
[1421653:MainThread](2026-01-11 22:45:10,383) INFO - qlib.timer - [log.py:127] - Time cost: 3.534s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:45:11,742) INFO - qlib.timer - [log.py:127] - Time cost: 1.358s | Fillna Done
[1421653:MainThread](2026-01-11 22:45:13,007) INFO - qlib.timer - [log.py:127] - Time cost: 0.229s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:45:13,214) INFO - qlib.timer - [log.py:127] - Time cost: 0.206s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:45:13,217) INFO - qlib.timer - [log.py:127] - Time cost: 6.924s | fit & process data Done
[1421653:MainThread](2026-01-11 22:45:13,218) INFO - qlib.timer - [log.py:127] - Time cost: 104.467s | Init data Done
2026-01-11 22:45:13.218 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:45:13,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:45:13,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:45:13,223) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:45:13,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:45:13.239 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:45:15,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:45:16,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.509878, valid_loss 1.234554, train_metric nan, valid_metric 0.018569
[1421653:MainThread](2026-01-11 22:45:16,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.234554, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:16,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.101368, valid_loss 1.151006, train_metric nan, valid_metric 0.014037
[1421653:MainThread](2026-01-11 22:45:16,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.234554 to 1.151006, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:16,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.063001, valid_loss 1.247971, train_metric nan, valid_metric 0.017058
[1421653:MainThread](2026-01-11 22:45:16,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.057227, valid_loss 1.043953, train_metric nan, valid_metric 0.017294
[1421653:MainThread](2026-01-11 22:45:16,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.151006 to 1.043953, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:17,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.054441, valid_loss 1.028226, train_metric nan, valid_metric 0.015813
[1421653:MainThread](2026-01-11 22:45:17,382) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.043953 to 1.028226, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:17,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.041544, valid_loss 1.034433, train_metric nan, valid_metric 0.021643
[1421653:MainThread](2026-01-11 22:45:18,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.036820, valid_loss 1.009771, train_metric nan, valid_metric 0.025601
[1421653:MainThread](2026-01-11 22:45:18,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.028226 to 1.009771, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:18,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.039157, valid_loss 1.080470, train_metric nan, valid_metric 0.023031
[1421653:MainThread](2026-01-11 22:45:18,983) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.032201, valid_loss 1.020410, train_metric nan, valid_metric 0.024041
[1421653:MainThread](2026-01-11 22:45:19,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.030304, valid_loss 1.052889, train_metric nan, valid_metric 0.018221
[1421653:MainThread](2026-01-11 22:45:19,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.025551, valid_loss 1.052246, train_metric nan, valid_metric 0.022671
[1421653:MainThread](2026-01-11 22:45:20,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.024492, valid_loss 1.018672, train_metric nan, valid_metric 0.026892
[1421653:MainThread](2026-01-11 22:45:20,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.023919, valid_loss 1.018075, train_metric nan, valid_metric 0.020928
[1421653:MainThread](2026-01-11 22:45:21,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.016973, valid_loss 1.010192, train_metric nan, valid_metric 0.026670
[1421653:MainThread](2026-01-11 22:45:21,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.025149, valid_loss 1.005707, train_metric nan, valid_metric 0.022377
[1421653:MainThread](2026-01-11 22:45:21,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009771 to 1.005707, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:21,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.015033, valid_loss 1.012473, train_metric nan, valid_metric 0.022757
[1421653:MainThread](2026-01-11 22:45:22,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.016464, valid_loss 1.006500, train_metric nan, valid_metric 0.025464
[1421653:MainThread](2026-01-11 22:45:22,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.009766, valid_loss 1.011287, train_metric nan, valid_metric 0.028214
[1421653:MainThread](2026-01-11 22:45:23,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.012812, valid_loss 1.005867, train_metric nan, valid_metric 0.033836
[1421653:MainThread](2026-01-11 22:45:23,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.010247, valid_loss 1.014043, train_metric nan, valid_metric 0.026508
[1421653:MainThread](2026-01-11 22:45:23,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.005940, valid_loss 1.004252, train_metric nan, valid_metric 0.023840
[1421653:MainThread](2026-01-11 22:45:23,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005707 to 1.004252, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:24,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.010385, valid_loss 1.002041, train_metric nan, valid_metric 0.035013
[1421653:MainThread](2026-01-11 22:45:24,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004252 to 1.002041, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:24,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.005678, valid_loss 1.002462, train_metric nan, valid_metric 0.030074
[1421653:MainThread](2026-01-11 22:45:25,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.006739, valid_loss 1.003968, train_metric nan, valid_metric 0.033036
[1421653:MainThread](2026-01-11 22:45:25,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.007194, valid_loss 1.016198, train_metric nan, valid_metric 0.028720
[1421653:MainThread](2026-01-11 22:45:25,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 0.999328, valid_loss 1.003357, train_metric nan, valid_metric 0.032958
[1421653:MainThread](2026-01-11 22:45:26,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.001476, valid_loss 1.003364, train_metric nan, valid_metric 0.025263
[1421653:MainThread](2026-01-11 22:45:26,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.002492, valid_loss 1.003363, train_metric nan, valid_metric 0.029031
[1421653:MainThread](2026-01-11 22:45:27,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.004879, valid_loss 1.002552, train_metric nan, valid_metric 0.033916
[1421653:MainThread](2026-01-11 22:45:27,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.999111, valid_loss 1.003433, train_metric nan, valid_metric 0.030169
[1421653:MainThread](2026-01-11 22:45:27,892) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.000944, valid_loss 1.010254, train_metric nan, valid_metric 0.020677
[1421653:MainThread](2026-01-11 22:45:28,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.002366, valid_loss 1.027554, train_metric nan, valid_metric 0.031382
[1421653:MainThread](2026-01-11 22:45:28,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.997857, valid_loss 1.018499, train_metric nan, valid_metric 0.029280
[1421653:MainThread](2026-01-11 22:45:29,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.993520, valid_loss 0.999357, train_metric nan, valid_metric 0.034473
[1421653:MainThread](2026-01-11 22:45:29,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002041 to 0.999357, save checkpoint.
[1421653:MainThread](2026-01-11 22:45:29,639) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.999453, valid_loss 1.000936, train_metric nan, valid_metric 0.032616
[1421653:MainThread](2026-01-11 22:45:30,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.003105, valid_loss 1.009657, train_metric nan, valid_metric 0.031680
[1421653:MainThread](2026-01-11 22:45:30,458) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.999527, valid_loss 1.006126, train_metric nan, valid_metric 0.031288
[1421653:MainThread](2026-01-11 22:45:30,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.993880, valid_loss 1.001405, train_metric nan, valid_metric 0.030329
[1421653:MainThread](2026-01-11 22:45:31,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.997028, valid_loss 1.001808, train_metric nan, valid_metric 0.026451
[1421653:MainThread](2026-01-11 22:45:31,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.995859, valid_loss 1.018562, train_metric nan, valid_metric 0.027493
[1421653:MainThread](2026-01-11 22:45:32,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.992550, valid_loss 1.004325, train_metric nan, valid_metric 0.028475
[1421653:MainThread](2026-01-11 22:45:32,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.999413, valid_loss 1.010779, train_metric nan, valid_metric 0.029172
[1421653:MainThread](2026-01-11 22:45:33,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.992970, valid_loss 1.005881, train_metric nan, valid_metric 0.030715
[1421653:MainThread](2026-01-11 22:45:33,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.005105, valid_loss 1.002618, train_metric nan, valid_metric 0.030348
[1421653:MainThread](2026-01-11 22:45:34,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.997395, valid_loss 1.009367, train_metric nan, valid_metric 0.024088
[1421653:MainThread](2026-01-11 22:45:34,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.989327, valid_loss 1.007391, train_metric nan, valid_metric 0.030988
[1421653:MainThread](2026-01-11 22:45:35,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.992999, valid_loss 1.001301, train_metric nan, valid_metric 0.034351
[1421653:MainThread](2026-01-11 22:45:35,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.996724, valid_loss 0.999832, train_metric nan, valid_metric 0.033977
[1421653:MainThread](2026-01-11 22:45:35,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.992405, valid_loss 1.003072, train_metric nan, valid_metric 0.036839
[1421653:MainThread](2026-01-11 22:45:36,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.993207, valid_loss 1.001464, train_metric nan, valid_metric 0.033706
[1421653:MainThread](2026-01-11 22:45:36,706) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.994633, valid_loss 1.001784, train_metric nan, valid_metric 0.032521
[1421653:MainThread](2026-01-11 22:45:37,122) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.995910, valid_loss 1.000860, train_metric nan, valid_metric 0.034843
[1421653:MainThread](2026-01-11 22:45:37,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.994666, valid_loss 1.009920, train_metric nan, valid_metric 0.028821
[1421653:MainThread](2026-01-11 22:45:37,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.994560, valid_loss 1.002872, train_metric nan, valid_metric 0.033466
[1421653:MainThread](2026-01-11 22:45:38,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.992243, valid_loss 1.006883, train_metric nan, valid_metric 0.033510
[1421653:MainThread](2026-01-11 22:45:38,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.994340, valid_loss 1.003854, train_metric nan, valid_metric 0.033217
[1421653:MainThread](2026-01-11 22:45:39,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.991055, valid_loss 1.003055, train_metric nan, valid_metric 0.036126
[1421653:MainThread](2026-01-11 22:45:39,636) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.998956, valid_loss 1.000943, train_metric nan, valid_metric 0.033808
[1421653:MainThread](2026-01-11 22:45:40,060) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.993966, valid_loss 1.001332, train_metric nan, valid_metric 0.035842
[1421653:MainThread](2026-01-11 22:45:40,440) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.992384, valid_loss 1.003934, train_metric nan, valid_metric 0.034259
[1421653:MainThread](2026-01-11 22:45:40,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.995053, valid_loss 1.000056, train_metric nan, valid_metric 0.035616
[1421653:MainThread](2026-01-11 22:45:41,078) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.995072, valid_loss 1.001620, train_metric nan, valid_metric 0.033054
[1421653:MainThread](2026-01-11 22:45:41,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.994804, valid_loss 1.002123, train_metric nan, valid_metric 0.034078
[1421653:MainThread](2026-01-11 22:45:41,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.994337, valid_loss 1.001030, train_metric nan, valid_metric 0.033924
[1421653:MainThread](2026-01-11 22:45:42,248) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.992023, valid_loss 1.001832, train_metric nan, valid_metric 0.035875
[1421653:MainThread](2026-01-11 22:45:42,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.990644, valid_loss 1.002302, train_metric nan, valid_metric 0.034733
[1421653:MainThread](2026-01-11 22:45:43,095) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.986768, valid_loss 1.001747, train_metric nan, valid_metric 0.035853
[1421653:MainThread](2026-01-11 22:45:43,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.994765, valid_loss 1.004562, train_metric nan, valid_metric 0.031224
[1421653:MainThread](2026-01-11 22:45:43,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.995764, valid_loss 1.003475, train_metric nan, valid_metric 0.034022
[1421653:MainThread](2026-01-11 22:45:44,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.992319, valid_loss 1.000998, train_metric nan, valid_metric 0.033622
[1421653:MainThread](2026-01-11 22:45:44,714) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.990620, valid_loss 1.003022, train_metric nan, valid_metric 0.032167
[1421653:MainThread](2026-01-11 22:45:45,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.996359, valid_loss 1.001926, train_metric nan, valid_metric 0.033721
[1421653:MainThread](2026-01-11 22:45:45,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.993784, valid_loss 1.003894, train_metric nan, valid_metric 0.034511
[1421653:MainThread](2026-01-11 22:45:46,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.996032, valid_loss 1.002971, train_metric nan, valid_metric 0.033302
[1421653:MainThread](2026-01-11 22:45:46,423) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.988924, valid_loss 1.003452, train_metric nan, valid_metric 0.031937
[1421653:MainThread](2026-01-11 22:45:46,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.987234, valid_loss 1.001641, train_metric nan, valid_metric 0.037461
[1421653:MainThread](2026-01-11 22:45:47,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.993310, valid_loss 1.004386, train_metric nan, valid_metric 0.034359
[1421653:MainThread](2026-01-11 22:45:47,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.993992, valid_loss 1.002517, train_metric nan, valid_metric 0.034323
[1421653:MainThread](2026-01-11 22:45:48,180) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.990162, valid_loss 1.002069, train_metric nan, valid_metric 0.034915
[1421653:MainThread](2026-01-11 22:45:48,584) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.994412, valid_loss 1.002569, train_metric nan, valid_metric 0.033532
[1421653:MainThread](2026-01-11 22:45:49,026) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.994895, valid_loss 1.001222, train_metric nan, valid_metric 0.034439
[1421653:MainThread](2026-01-11 22:45:49,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.991860, valid_loss 1.001379, train_metric nan, valid_metric 0.034449
[1421653:MainThread](2026-01-11 22:45:49,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.990802, valid_loss 1.001359, train_metric nan, valid_metric 0.034503
[1421653:MainThread](2026-01-11 22:45:50,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.994856, valid_loss 1.001238, train_metric nan, valid_metric 0.034156
[1421653:MainThread](2026-01-11 22:45:50,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:45:50.258 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:45:53.154 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 22:45:53.154 | INFO     | __main__:train_single_fold:593 -   IC=0.0109, ICIR=0.0863, RankIC=0.0246, RankICIR=0.2163
2026-01-11 22:45:53.154 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:45:53,162) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:46:38,758) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:46:38,759) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:46:45,615) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0dfbd93e90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.96it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 54.90it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 66.02it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 71.92it/s]backtest loop:  16%|█▌        | 39/243 [00:00<00:02, 72.63it/s]backtest loop:  19%|█▉        | 47/243 [00:00<00:02, 73.74it/s]backtest loop:  23%|██▎       | 56/243 [00:00<00:02, 75.96it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:02, 76.09it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 79.89it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 73.22it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:02, 74.93it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 78.92it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 78.07it/s]backtest loop:  49%|████▊     | 118/243 [00:01<00:01, 77.59it/s]backtest loop:  52%|█████▏    | 127/243 [00:01<00:01, 79.19it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 78.47it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 78.88it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 79.23it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 79.92it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 80.69it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 76.65it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 79.75it/s]backtest loop:  83%|████████▎ | 202/243 [00:02<00:00, 78.39it/s]backtest loop:  86%|████████▋ | 210/243 [00:02<00:00, 76.87it/s]backtest loop:  90%|█████████ | 219/243 [00:02<00:00, 77.53it/s]backtest loop:  94%|█████████▍| 229/243 [00:03<00:00, 78.56it/s]backtest loop:  98%|█████████▊| 239/243 [00:03<00:00, 79.66it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.31it/s]
2026-01-11 22:46:48.823 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0478, Sharpe(w/cost)=-0.5604, MaxDD=-0.1279
2026-01-11 22:46:52.719 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 22:47:14.845 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:47:15.106 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_4_pred.parquet
2026-01-11 22:47:15.198 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 22:47:15.198 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 22:47:18.663 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0312
2026-01-11 22:47:21.574 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0304
2026-01-11 22:47:24.463 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0393
2026-01-11 22:47:26.867 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0347
2026-01-11 22:47:27.220 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0126, ICIR=0.0909, RankIC=0.0312
[1421653:MainThread](2026-01-11 22:47:27,226) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:48:05,292) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:48:05,293) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:48:12,805) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0dfaad3e90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 22.96it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 54.09it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 66.40it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 72.37it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 74.97it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 78.14it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:02, 79.29it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:02, 78.64it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 77.34it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 77.17it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 79.64it/s]backtest loop:  44%|████▍     | 107/243 [00:01<00:01, 80.57it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 79.64it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 79.34it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 80.41it/s]backtest loop:  60%|█████▉    | 145/243 [00:01<00:01, 80.50it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 80.48it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 80.64it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 81.34it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 77.25it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 78.30it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 78.75it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 79.88it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 79.93it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 80.74it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 80.23it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.65it/s]
2026-01-11 22:48:15.957 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0101, Sharpe(w/cost)=0.1171
2026-01-11 22:48:16.060 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:48:16.060 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 22:48:16.060 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:48:16.060 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:49:53,808) INFO - qlib.timer - [log.py:127] - Time cost: 97.745s | Loading data Done
[1421653:MainThread](2026-01-11 22:49:57,770) INFO - qlib.timer - [log.py:127] - Time cost: 3.377s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:49:59,207) INFO - qlib.timer - [log.py:127] - Time cost: 1.436s | Fillna Done
[1421653:MainThread](2026-01-11 22:50:00,276) INFO - qlib.timer - [log.py:127] - Time cost: 0.228s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:50:00,491) INFO - qlib.timer - [log.py:127] - Time cost: 0.214s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:50:00,494) INFO - qlib.timer - [log.py:127] - Time cost: 6.685s | fit & process data Done
[1421653:MainThread](2026-01-11 22:50:00,495) INFO - qlib.timer - [log.py:127] - Time cost: 104.433s | Init data Done
2026-01-11 22:50:00.495 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:50:00,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:50:00,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:50:00,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:50:00,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:50:00.511 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:50:02,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:50:03,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.984102, valid_loss 2.645332, train_metric nan, valid_metric -0.017026
[1421653:MainThread](2026-01-11 22:50:03,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 2.645332, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:03,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.118878, valid_loss 1.060339, train_metric nan, valid_metric -0.004469
[1421653:MainThread](2026-01-11 22:50:03,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 2.645332 to 1.060339, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:04,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.069214, valid_loss 1.072696, train_metric nan, valid_metric 0.014274
[1421653:MainThread](2026-01-11 22:50:04,804) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.048767, valid_loss 1.054065, train_metric nan, valid_metric 0.017613
[1421653:MainThread](2026-01-11 22:50:04,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.060339 to 1.054065, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:05,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.050263, valid_loss 1.030200, train_metric nan, valid_metric 0.016392
[1421653:MainThread](2026-01-11 22:50:05,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.054065 to 1.030200, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:05,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.048926, valid_loss 1.041742, train_metric nan, valid_metric 0.020173
[1421653:MainThread](2026-01-11 22:50:06,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.051304, valid_loss 1.106925, train_metric nan, valid_metric 0.021809
[1421653:MainThread](2026-01-11 22:50:06,403) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.040963, valid_loss 1.069361, train_metric nan, valid_metric 0.024097
[1421653:MainThread](2026-01-11 22:50:06,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.049144, valid_loss 1.136258, train_metric nan, valid_metric 0.021021
[1421653:MainThread](2026-01-11 22:50:07,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.043737, valid_loss 1.049830, train_metric nan, valid_metric 0.017014
[1421653:MainThread](2026-01-11 22:50:07,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.028728, valid_loss 1.020419, train_metric nan, valid_metric 0.031024
[1421653:MainThread](2026-01-11 22:50:07,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.030200 to 1.020419, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:08,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.026045, valid_loss 1.028599, train_metric nan, valid_metric 0.031636
[1421653:MainThread](2026-01-11 22:50:08,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.024897, valid_loss 1.030891, train_metric nan, valid_metric 0.029015
[1421653:MainThread](2026-01-11 22:50:08,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.032581, valid_loss 1.010294, train_metric nan, valid_metric 0.027270
[1421653:MainThread](2026-01-11 22:50:08,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.020419 to 1.010294, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:09,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.025816, valid_loss 1.009897, train_metric nan, valid_metric 0.029541
[1421653:MainThread](2026-01-11 22:50:09,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.010294 to 1.009897, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:09,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.023444, valid_loss 1.006274, train_metric nan, valid_metric 0.028435
[1421653:MainThread](2026-01-11 22:50:09,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.009897 to 1.006274, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:10,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.025299, valid_loss 1.024542, train_metric nan, valid_metric 0.027416
[1421653:MainThread](2026-01-11 22:50:10,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.018784, valid_loss 1.086360, train_metric nan, valid_metric 0.029668
[1421653:MainThread](2026-01-11 22:50:11,143) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.023478, valid_loss 1.051842, train_metric nan, valid_metric 0.028700
[1421653:MainThread](2026-01-11 22:50:11,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.017212, valid_loss 1.014264, train_metric nan, valid_metric 0.030917
[1421653:MainThread](2026-01-11 22:50:11,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.011480, valid_loss 1.007591, train_metric nan, valid_metric 0.031131
[1421653:MainThread](2026-01-11 22:50:12,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.019214, valid_loss 1.004428, train_metric nan, valid_metric 0.036410
[1421653:MainThread](2026-01-11 22:50:12,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006274 to 1.004428, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:12,753) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.014923, valid_loss 1.017205, train_metric nan, valid_metric 0.031098
[1421653:MainThread](2026-01-11 22:50:13,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.012115, valid_loss 1.013664, train_metric nan, valid_metric 0.030429
[1421653:MainThread](2026-01-11 22:50:13,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.014010, valid_loss 1.025713, train_metric nan, valid_metric 0.034890
[1421653:MainThread](2026-01-11 22:50:14,075) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.017298, valid_loss 1.004095, train_metric nan, valid_metric 0.030826
[1421653:MainThread](2026-01-11 22:50:14,077) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004428 to 1.004095, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:14,488) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.012671, valid_loss 1.003619, train_metric nan, valid_metric 0.033431
[1421653:MainThread](2026-01-11 22:50:14,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004095 to 1.003619, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:14,895) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.014582, valid_loss 1.008177, train_metric nan, valid_metric 0.025536
[1421653:MainThread](2026-01-11 22:50:15,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.009989, valid_loss 1.007150, train_metric nan, valid_metric 0.032025
[1421653:MainThread](2026-01-11 22:50:15,682) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.006677, valid_loss 1.002614, train_metric nan, valid_metric 0.030945
[1421653:MainThread](2026-01-11 22:50:15,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003619 to 1.002614, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:16,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.010866, valid_loss 1.003315, train_metric nan, valid_metric 0.029811
[1421653:MainThread](2026-01-11 22:50:16,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.006686, valid_loss 1.008018, train_metric nan, valid_metric 0.031113
[1421653:MainThread](2026-01-11 22:50:16,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.007141, valid_loss 1.004252, train_metric nan, valid_metric 0.029698
[1421653:MainThread](2026-01-11 22:50:17,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.008178, valid_loss 1.002830, train_metric nan, valid_metric 0.039437
[1421653:MainThread](2026-01-11 22:50:17,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.008958, valid_loss 1.005604, train_metric nan, valid_metric 0.041243
[1421653:MainThread](2026-01-11 22:50:17,788) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.007250, valid_loss 1.019068, train_metric nan, valid_metric 0.030367
[1421653:MainThread](2026-01-11 22:50:18,202) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.997315, valid_loss 1.003591, train_metric nan, valid_metric 0.022431
[1421653:MainThread](2026-01-11 22:50:18,620) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.003843, valid_loss 1.001973, train_metric nan, valid_metric 0.037273
[1421653:MainThread](2026-01-11 22:50:18,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002614 to 1.001973, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:19,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.000615, valid_loss 1.001540, train_metric nan, valid_metric 0.037501
[1421653:MainThread](2026-01-11 22:50:19,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001973 to 1.001540, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:19,401) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.002621, valid_loss 1.002344, train_metric nan, valid_metric 0.034792
[1421653:MainThread](2026-01-11 22:50:19,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.006559, valid_loss 1.003703, train_metric nan, valid_metric 0.028934
[1421653:MainThread](2026-01-11 22:50:20,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.001433, valid_loss 1.002357, train_metric nan, valid_metric 0.040156
[1421653:MainThread](2026-01-11 22:50:20,649) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.001389, valid_loss 1.005014, train_metric nan, valid_metric 0.030576
[1421653:MainThread](2026-01-11 22:50:21,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.001648, valid_loss 1.001426, train_metric nan, valid_metric 0.037854
[1421653:MainThread](2026-01-11 22:50:21,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001540 to 1.001426, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:21,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.995729, valid_loss 1.008239, train_metric nan, valid_metric 0.036958
[1421653:MainThread](2026-01-11 22:50:21,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.001839, valid_loss 1.000253, train_metric nan, valid_metric 0.036000
[1421653:MainThread](2026-01-11 22:50:21,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001426 to 1.000253, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:22,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.997887, valid_loss 1.006921, train_metric nan, valid_metric 0.026691
[1421653:MainThread](2026-01-11 22:50:22,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.003014, valid_loss 1.001827, train_metric nan, valid_metric 0.037322
[1421653:MainThread](2026-01-11 22:50:23,051) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.998385, valid_loss 1.003706, train_metric nan, valid_metric 0.033200
[1421653:MainThread](2026-01-11 22:50:23,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 1.001312, valid_loss 1.005147, train_metric nan, valid_metric 0.031867
[1421653:MainThread](2026-01-11 22:50:23,928) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.992478, valid_loss 1.002492, train_metric nan, valid_metric 0.031510
[1421653:MainThread](2026-01-11 22:50:24,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.995946, valid_loss 1.005502, train_metric nan, valid_metric 0.035707
[1421653:MainThread](2026-01-11 22:50:24,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 1.002891, valid_loss 1.003236, train_metric nan, valid_metric 0.033077
[1421653:MainThread](2026-01-11 22:50:25,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.990885, valid_loss 1.005596, train_metric nan, valid_metric 0.020171
[1421653:MainThread](2026-01-11 22:50:25,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.998243, valid_loss 1.012607, train_metric nan, valid_metric 0.032441
[1421653:MainThread](2026-01-11 22:50:25,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 1.000395, valid_loss 1.000106, train_metric nan, valid_metric 0.042957
[1421653:MainThread](2026-01-11 22:50:25,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000253 to 1.000106, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:26,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.989856, valid_loss 1.007616, train_metric nan, valid_metric 0.031897
[1421653:MainThread](2026-01-11 22:50:26,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.993898, valid_loss 1.000246, train_metric nan, valid_metric 0.035454
[1421653:MainThread](2026-01-11 22:50:27,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.997143, valid_loss 1.001577, train_metric nan, valid_metric 0.035424
[1421653:MainThread](2026-01-11 22:50:27,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.996467, valid_loss 1.001106, train_metric nan, valid_metric 0.027071
[1421653:MainThread](2026-01-11 22:50:28,016) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.988399, valid_loss 1.002744, train_metric nan, valid_metric 0.039966
[1421653:MainThread](2026-01-11 22:50:28,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.995068, valid_loss 1.002882, train_metric nan, valid_metric 0.032141
[1421653:MainThread](2026-01-11 22:50:28,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.996660, valid_loss 1.003200, train_metric nan, valid_metric 0.026888
[1421653:MainThread](2026-01-11 22:50:29,242) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.992753, valid_loss 1.000748, train_metric nan, valid_metric 0.041103
[1421653:MainThread](2026-01-11 22:50:29,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.995446, valid_loss 1.003757, train_metric nan, valid_metric 0.028994
[1421653:MainThread](2026-01-11 22:50:30,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.994556, valid_loss 1.002553, train_metric nan, valid_metric 0.022098
[1421653:MainThread](2026-01-11 22:50:30,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.992832, valid_loss 1.000244, train_metric nan, valid_metric 0.034640
[1421653:MainThread](2026-01-11 22:50:30,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.988205, valid_loss 1.000027, train_metric nan, valid_metric 0.039100
[1421653:MainThread](2026-01-11 22:50:30,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000106 to 1.000027, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:31,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.994518, valid_loss 0.999397, train_metric nan, valid_metric 0.036394
[1421653:MainThread](2026-01-11 22:50:31,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000027 to 0.999397, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:31,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.988084, valid_loss 0.998494, train_metric nan, valid_metric 0.040324
[1421653:MainThread](2026-01-11 22:50:31,667) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999397 to 0.998494, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:32,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.991213, valid_loss 0.999640, train_metric nan, valid_metric 0.038435
[1421653:MainThread](2026-01-11 22:50:32,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.991090, valid_loss 0.998339, train_metric nan, valid_metric 0.038300
[1421653:MainThread](2026-01-11 22:50:32,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998494 to 0.998339, save checkpoint.
[1421653:MainThread](2026-01-11 22:50:32,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.998770, valid_loss 0.999583, train_metric nan, valid_metric 0.035940
[1421653:MainThread](2026-01-11 22:50:33,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.994339, valid_loss 1.000590, train_metric nan, valid_metric 0.036487
[1421653:MainThread](2026-01-11 22:50:34,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.995351, valid_loss 0.998387, train_metric nan, valid_metric 0.039527
[1421653:MainThread](2026-01-11 22:50:34,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.991081, valid_loss 0.999620, train_metric nan, valid_metric 0.038286
[1421653:MainThread](2026-01-11 22:50:35,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.991400, valid_loss 1.001151, train_metric nan, valid_metric 0.036020
[1421653:MainThread](2026-01-11 22:50:35,453) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.993832, valid_loss 1.002082, train_metric nan, valid_metric 0.036251
[1421653:MainThread](2026-01-11 22:50:35,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.994662, valid_loss 1.000645, train_metric nan, valid_metric 0.035618
[1421653:MainThread](2026-01-11 22:50:36,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.988958, valid_loss 1.000122, train_metric nan, valid_metric 0.037762
[1421653:MainThread](2026-01-11 22:50:36,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.990596, valid_loss 0.999527, train_metric nan, valid_metric 0.040838
[1421653:MainThread](2026-01-11 22:50:37,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.998441, valid_loss 0.998724, train_metric nan, valid_metric 0.039451
[1421653:MainThread](2026-01-11 22:50:37,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.987665, valid_loss 1.001330, train_metric nan, valid_metric 0.030070
[1421653:MainThread](2026-01-11 22:50:37,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.997666, valid_loss 1.000321, train_metric nan, valid_metric 0.039403
[1421653:MainThread](2026-01-11 22:50:38,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.991627, valid_loss 1.005378, train_metric nan, valid_metric 0.036542
[1421653:MainThread](2026-01-11 22:50:38,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.994270, valid_loss 1.002043, train_metric nan, valid_metric 0.032828
[1421653:MainThread](2026-01-11 22:50:39,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.996559, valid_loss 1.002862, train_metric nan, valid_metric 0.037047
[1421653:MainThread](2026-01-11 22:50:39,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.990437, valid_loss 0.998984, train_metric nan, valid_metric 0.039389
[1421653:MainThread](2026-01-11 22:50:39,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.986147, valid_loss 1.000328, train_metric nan, valid_metric 0.035906
[1421653:MainThread](2026-01-11 22:50:40,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.994581, valid_loss 0.999180, train_metric nan, valid_metric 0.037779
[1421653:MainThread](2026-01-11 22:50:40,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.996882, valid_loss 0.998570, train_metric nan, valid_metric 0.041016
[1421653:MainThread](2026-01-11 22:50:41,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.983968, valid_loss 1.001371, train_metric nan, valid_metric 0.036550
[1421653:MainThread](2026-01-11 22:50:41,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.997338, valid_loss 1.000478, train_metric nan, valid_metric 0.039317
[1421653:MainThread](2026-01-11 22:50:41,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.988269, valid_loss 1.002281, train_metric nan, valid_metric 0.038615
[1421653:MainThread](2026-01-11 22:50:42,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.992223, valid_loss 1.000281, train_metric nan, valid_metric 0.036858
[1421653:MainThread](2026-01-11 22:50:42,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.986742, valid_loss 0.999331, train_metric nan, valid_metric 0.037329
[1421653:MainThread](2026-01-11 22:50:43,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.990342, valid_loss 0.999408, train_metric nan, valid_metric 0.036755
[1421653:MainThread](2026-01-11 22:50:43,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.992961, valid_loss 1.000569, train_metric nan, valid_metric 0.038909
[1421653:MainThread](2026-01-11 22:50:43,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.994949, valid_loss 0.999940, train_metric nan, valid_metric 0.039882
[1421653:MainThread](2026-01-11 22:50:44,231) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.998162, valid_loss 0.998827, train_metric nan, valid_metric 0.039942
[1421653:MainThread](2026-01-11 22:50:44,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.990305, valid_loss 0.999646, train_metric nan, valid_metric 0.040795
[1421653:MainThread](2026-01-11 22:50:45,021) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.993891, valid_loss 1.001685, train_metric nan, valid_metric 0.036486
[1421653:MainThread](2026-01-11 22:50:45,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.987030, valid_loss 1.000682, train_metric nan, valid_metric 0.038132
[1421653:MainThread](2026-01-11 22:50:45,819) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.993750, valid_loss 0.999896, train_metric nan, valid_metric 0.039325
[1421653:MainThread](2026-01-11 22:50:46,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.988527, valid_loss 0.999194, train_metric nan, valid_metric 0.040732
[1421653:MainThread](2026-01-11 22:50:46,711) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.982178, valid_loss 0.999568, train_metric nan, valid_metric 0.038986
[1421653:MainThread](2026-01-11 22:50:47,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.988681, valid_loss 0.999693, train_metric nan, valid_metric 0.038360
[1421653:MainThread](2026-01-11 22:50:47,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.990410, valid_loss 0.999915, train_metric nan, valid_metric 0.037408
[1421653:MainThread](2026-01-11 22:50:47,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.995279, valid_loss 0.999437, train_metric nan, valid_metric 0.039838
[1421653:MainThread](2026-01-11 22:50:48,251) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.990854, valid_loss 1.000091, train_metric nan, valid_metric 0.040365
[1421653:MainThread](2026-01-11 22:50:48,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.994552, valid_loss 1.000686, train_metric nan, valid_metric 0.036949
[1421653:MainThread](2026-01-11 22:50:49,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.996602, valid_loss 1.001576, train_metric nan, valid_metric 0.038455
[1421653:MainThread](2026-01-11 22:50:49,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.990160, valid_loss 1.000024, train_metric nan, valid_metric 0.041161
[1421653:MainThread](2026-01-11 22:50:50,015) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.985588, valid_loss 1.001196, train_metric nan, valid_metric 0.038311
[1421653:MainThread](2026-01-11 22:50:50,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.986511, valid_loss 1.001916, train_metric nan, valid_metric 0.038902
[1421653:MainThread](2026-01-11 22:50:50,943) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.986060, valid_loss 1.000507, train_metric nan, valid_metric 0.040749
[1421653:MainThread](2026-01-11 22:50:51,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.985360, valid_loss 0.999177, train_metric nan, valid_metric 0.040174
[1421653:MainThread](2026-01-11 22:50:51,800) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.989631, valid_loss 0.999944, train_metric nan, valid_metric 0.038446
[1421653:MainThread](2026-01-11 22:50:52,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.987689, valid_loss 0.999594, train_metric nan, valid_metric 0.040122
[1421653:MainThread](2026-01-11 22:50:52,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.992385, valid_loss 0.999611, train_metric nan, valid_metric 0.039583
[1421653:MainThread](2026-01-11 22:50:53,098) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.989505, valid_loss 0.999220, train_metric nan, valid_metric 0.039251
[1421653:MainThread](2026-01-11 22:50:53,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.983900, valid_loss 0.998570, train_metric nan, valid_metric 0.040895
[1421653:MainThread](2026-01-11 22:50:53,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:50:53.541 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:50:56.471 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 22:50:56.471 | INFO     | __main__:train_single_fold:593 -   IC=0.0102, ICIR=0.0844, RankIC=0.0275, RankICIR=0.2457
2026-01-11 22:50:56.471 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:50:56,478) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:51:41,689) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:51:41,690) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:51:50,021) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0dfbcc6bd0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 27.27it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 54.61it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 65.45it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 68.40it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 70.77it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 73.50it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 75.98it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 76.61it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 77.76it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 77.60it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 77.60it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 78.32it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 78.50it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 78.94it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 79.47it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 82.10it/s]backtest loop:  61%|██████    | 148/243 [00:01<00:01, 81.19it/s]backtest loop:  65%|██████▍   | 157/243 [00:02<00:01, 78.84it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:01, 77.92it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 81.09it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 73.34it/s]backtest loop:  79%|███████▉  | 192/243 [00:02<00:00, 76.84it/s]backtest loop:  82%|████████▏ | 200/243 [00:02<00:00, 76.29it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 75.75it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 77.43it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 78.33it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 78.64it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.30it/s]
2026-01-11 22:51:53.229 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0273, Sharpe(w/cost)=-0.2666, MaxDD=-0.1087
2026-01-11 22:51:57.209 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 22:52:19.233 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:52:19.328 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_5_pred.parquet
2026-01-11 22:52:19.344 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 22:52:19.344 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 22:52:22.324 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0249
2026-01-11 22:52:24.872 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0229
2026-01-11 22:52:27.408 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0331
2026-01-11 22:52:29.489 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0296
2026-01-11 22:52:32.284 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0270
2026-01-11 22:52:32.639 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0085, ICIR=0.0669, RankIC=0.0291
[1421653:MainThread](2026-01-11 22:52:32,645) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:53:16,770) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:53:16,771) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:53:25,397) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0dfbdbbe90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.39it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:04, 48.68it/s]backtest loop:   8%|▊         | 19/243 [00:00<00:03, 66.39it/s]backtest loop:  11%|█         | 26/243 [00:00<00:03, 67.40it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:02, 69.90it/s]backtest loop:  17%|█▋        | 42/243 [00:00<00:02, 70.35it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 71.09it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 75.76it/s]backtest loop:  28%|██▊       | 67/243 [00:00<00:02, 74.74it/s]backtest loop:  31%|███       | 75/243 [00:01<00:02, 73.06it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 72.44it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:02, 71.76it/s]backtest loop:  41%|████      | 100/243 [00:01<00:01, 76.63it/s]backtest loop:  44%|████▍     | 108/243 [00:01<00:01, 75.46it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 74.32it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 75.34it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 78.83it/s]backtest loop:  58%|█████▊    | 142/243 [00:01<00:01, 76.32it/s]backtest loop:  62%|██████▏   | 150/243 [00:02<00:01, 75.13it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 76.29it/s]backtest loop:  70%|██████▉   | 169/243 [00:02<00:00, 78.77it/s]backtest loop:  73%|███████▎  | 177/243 [00:02<00:00, 76.47it/s]backtest loop:  76%|███████▌  | 185/243 [00:02<00:00, 71.89it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 71.96it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 77.03it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 81.45it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 85.38it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 90.68it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.22it/s]
2026-01-11 22:53:28.606 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.1008, Sharpe(w/cost)=-1.0412
2026-01-11 22:53:28.648 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:53:28.648 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 22:53:28.648 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:53:28.648 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 22:55:09,859) INFO - qlib.timer - [log.py:127] - Time cost: 101.209s | Loading data Done
[1421653:MainThread](2026-01-11 22:55:13,752) INFO - qlib.timer - [log.py:127] - Time cost: 3.327s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 22:55:15,193) INFO - qlib.timer - [log.py:127] - Time cost: 1.440s | Fillna Done
[1421653:MainThread](2026-01-11 22:55:16,379) INFO - qlib.timer - [log.py:127] - Time cost: 0.343s | DropnaLabel Done
[1421653:MainThread](2026-01-11 22:55:16,595) INFO - qlib.timer - [log.py:127] - Time cost: 0.215s | CSRankNorm Done
[1421653:MainThread](2026-01-11 22:55:16,598) INFO - qlib.timer - [log.py:127] - Time cost: 6.738s | fit & process data Done
[1421653:MainThread](2026-01-11 22:55:16,598) INFO - qlib.timer - [log.py:127] - Time cost: 107.949s | Init data Done
2026-01-11 22:55:16.599 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 22:55:16,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 22:55:16,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 22:55:16,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 22:55:16,605) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:55:16.615 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 22:55:18,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 22:55:19,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.625966, valid_loss 1.064599, train_metric nan, valid_metric 0.005037
[1421653:MainThread](2026-01-11 22:55:19,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.064599, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:19,582) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.166930, valid_loss 1.038061, train_metric nan, valid_metric -0.000530
[1421653:MainThread](2026-01-11 22:55:19,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.064599 to 1.038061, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:19,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.064127, valid_loss 1.007389, train_metric nan, valid_metric 0.024619
[1421653:MainThread](2026-01-11 22:55:19,995) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.038061 to 1.007389, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:20,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.048543, valid_loss 1.005986, train_metric nan, valid_metric 0.021745
[1421653:MainThread](2026-01-11 22:55:20,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007389 to 1.005986, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:20,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.048820, valid_loss 1.003256, train_metric nan, valid_metric 0.023122
[1421653:MainThread](2026-01-11 22:55:20,920) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005986 to 1.003256, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:21,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.106668, valid_loss 1.029608, train_metric nan, valid_metric 0.027444
[1421653:MainThread](2026-01-11 22:55:21,725) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.042166, valid_loss 1.002885, train_metric nan, valid_metric 0.026010
[1421653:MainThread](2026-01-11 22:55:21,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003256 to 1.002885, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:22,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.029809, valid_loss 1.001564, train_metric nan, valid_metric 0.017822
[1421653:MainThread](2026-01-11 22:55:22,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002885 to 1.001564, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:22,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.030443, valid_loss 1.002608, train_metric nan, valid_metric 0.026633
[1421653:MainThread](2026-01-11 22:55:22,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.031878, valid_loss 1.003258, train_metric nan, valid_metric 0.013327
[1421653:MainThread](2026-01-11 22:55:23,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.041445, valid_loss 1.003248, train_metric nan, valid_metric 0.027056
[1421653:MainThread](2026-01-11 22:55:23,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.025115, valid_loss 1.011087, train_metric nan, valid_metric 0.028744
[1421653:MainThread](2026-01-11 22:55:24,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.030470, valid_loss 1.000544, train_metric nan, valid_metric 0.026253
[1421653:MainThread](2026-01-11 22:55:24,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001564 to 1.000544, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:24,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.029241, valid_loss 1.007346, train_metric nan, valid_metric 0.028852
[1421653:MainThread](2026-01-11 22:55:24,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.022185, valid_loss 1.003376, train_metric nan, valid_metric 0.030251
[1421653:MainThread](2026-01-11 22:55:25,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.018037, valid_loss 1.000879, train_metric nan, valid_metric 0.028721
[1421653:MainThread](2026-01-11 22:55:25,750) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.022599, valid_loss 1.003540, train_metric nan, valid_metric 0.029528
[1421653:MainThread](2026-01-11 22:55:26,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.021521, valid_loss 1.001076, train_metric nan, valid_metric 0.029755
[1421653:MainThread](2026-01-11 22:55:26,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.017089, valid_loss 1.002971, train_metric nan, valid_metric 0.025623
[1421653:MainThread](2026-01-11 22:55:26,956) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.020055, valid_loss 1.000141, train_metric nan, valid_metric 0.022442
[1421653:MainThread](2026-01-11 22:55:26,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000544 to 1.000141, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:27,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.041531, valid_loss 1.001495, train_metric nan, valid_metric 0.021501
[1421653:MainThread](2026-01-11 22:55:27,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.028211, valid_loss 1.004751, train_metric nan, valid_metric 0.027204
[1421653:MainThread](2026-01-11 22:55:28,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.014488, valid_loss 1.003768, train_metric nan, valid_metric 0.031572
[1421653:MainThread](2026-01-11 22:55:28,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.012900, valid_loss 0.998826, train_metric nan, valid_metric 0.027311
[1421653:MainThread](2026-01-11 22:55:28,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000141 to 0.998826, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:29,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.016704, valid_loss 1.002584, train_metric nan, valid_metric 0.028645
[1421653:MainThread](2026-01-11 22:55:29,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.008010, valid_loss 1.002639, train_metric nan, valid_metric 0.028472
[1421653:MainThread](2026-01-11 22:55:29,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.011765, valid_loss 1.003880, train_metric nan, valid_metric 0.030503
[1421653:MainThread](2026-01-11 22:55:30,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.003450, valid_loss 1.000791, train_metric nan, valid_metric 0.031779
[1421653:MainThread](2026-01-11 22:55:30,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.004160, valid_loss 1.003482, train_metric nan, valid_metric 0.029704
[1421653:MainThread](2026-01-11 22:55:31,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.004843, valid_loss 0.998431, train_metric nan, valid_metric 0.025173
[1421653:MainThread](2026-01-11 22:55:31,140) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998826 to 0.998431, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:31,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.999795, valid_loss 0.999795, train_metric nan, valid_metric 0.024633
[1421653:MainThread](2026-01-11 22:55:31,952) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.010923, valid_loss 0.997914, train_metric nan, valid_metric 0.032060
[1421653:MainThread](2026-01-11 22:55:31,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998431 to 0.997914, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:32,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.000447, valid_loss 0.998981, train_metric nan, valid_metric 0.030038
[1421653:MainThread](2026-01-11 22:55:32,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.000009, valid_loss 0.999443, train_metric nan, valid_metric 0.028284
[1421653:MainThread](2026-01-11 22:55:33,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.999975, valid_loss 1.002843, train_metric nan, valid_metric 0.026542
[1421653:MainThread](2026-01-11 22:55:33,611) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.002757, valid_loss 1.002369, train_metric nan, valid_metric 0.028216
[1421653:MainThread](2026-01-11 22:55:34,005) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.006484, valid_loss 0.998591, train_metric nan, valid_metric 0.027020
[1421653:MainThread](2026-01-11 22:55:34,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.000382, valid_loss 1.002613, train_metric nan, valid_metric 0.030286
[1421653:MainThread](2026-01-11 22:55:34,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.002338, valid_loss 0.998354, train_metric nan, valid_metric 0.033365
[1421653:MainThread](2026-01-11 22:55:35,198) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.999078, valid_loss 0.997376, train_metric nan, valid_metric 0.032132
[1421653:MainThread](2026-01-11 22:55:35,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997914 to 0.997376, save checkpoint.
[1421653:MainThread](2026-01-11 22:55:35,593) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.998018, valid_loss 0.998501, train_metric nan, valid_metric 0.028646
[1421653:MainThread](2026-01-11 22:55:35,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.002315, valid_loss 1.005142, train_metric nan, valid_metric 0.029566
[1421653:MainThread](2026-01-11 22:55:36,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.999260, valid_loss 0.999731, train_metric nan, valid_metric 0.031528
[1421653:MainThread](2026-01-11 22:55:36,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.997236, valid_loss 1.000249, train_metric nan, valid_metric 0.030983
[1421653:MainThread](2026-01-11 22:55:37,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.000964, valid_loss 0.997683, train_metric nan, valid_metric 0.032430
[1421653:MainThread](2026-01-11 22:55:37,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.000577, valid_loss 0.997721, train_metric nan, valid_metric 0.030170
[1421653:MainThread](2026-01-11 22:55:37,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.998361, valid_loss 1.002082, train_metric nan, valid_metric 0.021954
[1421653:MainThread](2026-01-11 22:55:38,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.994914, valid_loss 1.001968, train_metric nan, valid_metric 0.030102
[1421653:MainThread](2026-01-11 22:55:38,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.996931, valid_loss 0.999200, train_metric nan, valid_metric 0.029656
[1421653:MainThread](2026-01-11 22:55:39,259) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.995688, valid_loss 0.998553, train_metric nan, valid_metric 0.024187
[1421653:MainThread](2026-01-11 22:55:39,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.998832, valid_loss 1.004711, train_metric nan, valid_metric 0.004597
[1421653:MainThread](2026-01-11 22:55:40,100) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.992514, valid_loss 1.002469, train_metric nan, valid_metric 0.028270
[1421653:MainThread](2026-01-11 22:55:40,514) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.998404, valid_loss 0.998911, train_metric nan, valid_metric 0.031403
[1421653:MainThread](2026-01-11 22:55:40,957) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.995204, valid_loss 0.998494, train_metric nan, valid_metric 0.030900
[1421653:MainThread](2026-01-11 22:55:41,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.999993, valid_loss 0.998775, train_metric nan, valid_metric 0.032526
[1421653:MainThread](2026-01-11 22:55:41,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.994213, valid_loss 0.998237, train_metric nan, valid_metric 0.030916
[1421653:MainThread](2026-01-11 22:55:42,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.996627, valid_loss 1.001375, train_metric nan, valid_metric 0.031890
[1421653:MainThread](2026-01-11 22:55:42,621) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.996669, valid_loss 0.997734, train_metric nan, valid_metric 0.028840
[1421653:MainThread](2026-01-11 22:55:43,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.998584, valid_loss 0.998465, train_metric nan, valid_metric 0.032131
[1421653:MainThread](2026-01-11 22:55:43,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.997457, valid_loss 0.998705, train_metric nan, valid_metric 0.026201
[1421653:MainThread](2026-01-11 22:55:44,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.991667, valid_loss 0.999099, train_metric nan, valid_metric 0.032113
[1421653:MainThread](2026-01-11 22:55:44,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.993059, valid_loss 0.999003, train_metric nan, valid_metric 0.026244
[1421653:MainThread](2026-01-11 22:55:44,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.990876, valid_loss 0.997785, train_metric nan, valid_metric 0.031632
[1421653:MainThread](2026-01-11 22:55:45,976) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.993308, valid_loss 0.997894, train_metric nan, valid_metric 0.030673
[1421653:MainThread](2026-01-11 22:55:46,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.994496, valid_loss 0.998263, train_metric nan, valid_metric 0.031655
[1421653:MainThread](2026-01-11 22:55:46,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.994179, valid_loss 0.997772, train_metric nan, valid_metric 0.031474
[1421653:MainThread](2026-01-11 22:55:47,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 1.001113, valid_loss 0.997837, train_metric nan, valid_metric 0.032872
[1421653:MainThread](2026-01-11 22:55:47,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.999409, valid_loss 1.001422, train_metric nan, valid_metric 0.033133
[1421653:MainThread](2026-01-11 22:55:47,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.997722, valid_loss 0.998208, train_metric nan, valid_metric 0.031807
[1421653:MainThread](2026-01-11 22:55:48,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.996125, valid_loss 1.001020, train_metric nan, valid_metric 0.032556
[1421653:MainThread](2026-01-11 22:55:48,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.995839, valid_loss 0.998406, train_metric nan, valid_metric 0.032614
[1421653:MainThread](2026-01-11 22:55:48,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.990154, valid_loss 0.997835, train_metric nan, valid_metric 0.030971
[1421653:MainThread](2026-01-11 22:55:49,411) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.989321, valid_loss 0.998336, train_metric nan, valid_metric 0.032024
[1421653:MainThread](2026-01-11 22:55:49,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.996472, valid_loss 0.998408, train_metric nan, valid_metric 0.032828
[1421653:MainThread](2026-01-11 22:55:50,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.991590, valid_loss 0.998881, train_metric nan, valid_metric 0.032896
[1421653:MainThread](2026-01-11 22:55:50,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.995767, valid_loss 0.999091, train_metric nan, valid_metric 0.032918
[1421653:MainThread](2026-01-11 22:55:50,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.991993, valid_loss 0.998379, train_metric nan, valid_metric 0.032014
[1421653:MainThread](2026-01-11 22:55:51,385) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.992025, valid_loss 0.998546, train_metric nan, valid_metric 0.032282
[1421653:MainThread](2026-01-11 22:55:51,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.994621, valid_loss 0.999056, train_metric nan, valid_metric 0.033064
[1421653:MainThread](2026-01-11 22:55:52,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.992502, valid_loss 0.998158, train_metric nan, valid_metric 0.031145
[1421653:MainThread](2026-01-11 22:55:52,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.993400, valid_loss 0.999591, train_metric nan, valid_metric 0.032847
[1421653:MainThread](2026-01-11 22:55:52,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.992027, valid_loss 0.998263, train_metric nan, valid_metric 0.032281
[1421653:MainThread](2026-01-11 22:55:53,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.995188, valid_loss 0.999408, train_metric nan, valid_metric 0.033904
[1421653:MainThread](2026-01-11 22:55:53,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.998645, valid_loss 0.999427, train_metric nan, valid_metric 0.032337
[1421653:MainThread](2026-01-11 22:55:54,394) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.995744, valid_loss 0.998095, train_metric nan, valid_metric 0.032676
[1421653:MainThread](2026-01-11 22:55:54,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.996066, valid_loss 0.998072, train_metric nan, valid_metric 0.032779
[1421653:MainThread](2026-01-11 22:55:55,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.992668, valid_loss 1.000344, train_metric nan, valid_metric 0.033042
[1421653:MainThread](2026-01-11 22:55:55,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.988905, valid_loss 0.997819, train_metric nan, valid_metric 0.032896
[1421653:MainThread](2026-01-11 22:55:55,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.995979, valid_loss 0.999179, train_metric nan, valid_metric 0.032937
[1421653:MainThread](2026-01-11 22:55:56,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.989521, valid_loss 0.998676, train_metric nan, valid_metric 0.033569
[1421653:MainThread](2026-01-11 22:55:56,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:55:56.381 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:55:58.873 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 22:55:58.874 | INFO     | __main__:train_single_fold:593 -   IC=0.0210, ICIR=0.1632, RankIC=0.0379, RankICIR=0.2992
2026-01-11 22:55:58.874 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 22:55:58,881) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:56:48,897) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:56:48,898) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:56:57,809) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df4ec3e90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 26.54it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 54.48it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 65.45it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 71.85it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 75.33it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 77.46it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 79.53it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 78.23it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 79.46it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 78.13it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 78.27it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 78.60it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 79.43it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 80.11it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 80.02it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 79.63it/s]backtest loop:  63%|██████▎   | 153/242 [00:01<00:01, 80.28it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 80.16it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 80.06it/s]backtest loop:  75%|███████▍  | 181/242 [00:02<00:00, 82.18it/s]backtest loop:  79%|███████▊  | 190/242 [00:02<00:00, 81.18it/s]backtest loop:  82%|████████▏ | 199/242 [00:02<00:00, 80.94it/s]backtest loop:  86%|████████▌ | 208/242 [00:02<00:00, 80.09it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 79.52it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 81.03it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 81.83it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 78.39it/s]
2026-01-11 22:57:00.918 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1015, Sharpe(w/cost)=1.1011, MaxDD=-0.0805
2026-01-11 22:57:04.842 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 22:57:23.923 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:57:24.022 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_6_pred.parquet
2026-01-11 22:57:24.041 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 22:57:24.041 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 22:57:26.811 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0426
2026-01-11 22:57:28.683 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0361
2026-01-11 22:57:30.854 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0413
2026-01-11 22:57:32.931 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0406
2026-01-11 22:57:35.730 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0311
2026-01-11 22:57:37.963 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0321
2026-01-11 22:57:38.340 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0245, ICIR=0.1783, RankIC=0.0426
[1421653:MainThread](2026-01-11 22:57:38,346) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 22:58:26,369) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:58:26,370) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 22:58:35,343) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1017c63e90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.06it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 52.08it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 62.00it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 70.04it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 74.19it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 76.84it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 78.68it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 77.54it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 78.84it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 77.29it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 77.82it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 77.91it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 78.83it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 79.49it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 79.93it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 80.05it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 80.54it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 80.75it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 79.37it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 80.04it/s]backtest loop:  79%|███████▉  | 191/242 [00:02<00:00, 81.60it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 80.67it/s]backtest loop:  86%|████████▋ | 209/242 [00:02<00:00, 79.48it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 78.45it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 78.95it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 79.54it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 77.31it/s]
2026-01-11 22:58:38.496 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0888, Sharpe(w/cost)=1.0096
2026-01-11 22:58:38.575 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:58:38.575 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 22:58:38.575 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:58:38.575 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 23:00:23,323) INFO - qlib.timer - [log.py:127] - Time cost: 104.745s | Loading data Done
[1421653:MainThread](2026-01-11 23:00:27,002) INFO - qlib.timer - [log.py:127] - Time cost: 3.111s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 23:00:28,122) INFO - qlib.timer - [log.py:127] - Time cost: 1.118s | Fillna Done
[1421653:MainThread](2026-01-11 23:00:29,116) INFO - qlib.timer - [log.py:127] - Time cost: 0.338s | DropnaLabel Done
[1421653:MainThread](2026-01-11 23:00:29,331) INFO - qlib.timer - [log.py:127] - Time cost: 0.213s | CSRankNorm Done
[1421653:MainThread](2026-01-11 23:00:29,334) INFO - qlib.timer - [log.py:127] - Time cost: 6.010s | fit & process data Done
[1421653:MainThread](2026-01-11 23:00:29,334) INFO - qlib.timer - [log.py:127] - Time cost: 110.757s | Init data Done
2026-01-11 23:00:29.335 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 23:00:29,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 23:00:29,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 23:00:29,340) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 23:00:29,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 23:00:29.351 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 23:00:31,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 23:00:32,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.730079, valid_loss 1.297231, train_metric nan, valid_metric 0.015419
[1421653:MainThread](2026-01-11 23:00:32,112) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.297231, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:32,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.193876, valid_loss 1.034375, train_metric nan, valid_metric 0.021268
[1421653:MainThread](2026-01-11 23:00:32,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.297231 to 1.034375, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:32,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.127903, valid_loss 1.019565, train_metric nan, valid_metric -0.010561
[1421653:MainThread](2026-01-11 23:00:32,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.034375 to 1.019565, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:33,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.071432, valid_loss 1.006137, train_metric nan, valid_metric 0.020320
[1421653:MainThread](2026-01-11 23:00:33,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.019565 to 1.006137, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:33,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.086001, valid_loss 1.026350, train_metric nan, valid_metric -0.013920
[1421653:MainThread](2026-01-11 23:00:34,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.122188, valid_loss 1.011876, train_metric nan, valid_metric 0.032102
[1421653:MainThread](2026-01-11 23:00:34,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.085033, valid_loss 1.005354, train_metric nan, valid_metric 0.025140
[1421653:MainThread](2026-01-11 23:00:34,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006137 to 1.005354, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:34,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.045932, valid_loss 1.000879, train_metric nan, valid_metric 0.023292
[1421653:MainThread](2026-01-11 23:00:34,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005354 to 1.000879, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:35,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.062467, valid_loss 1.000970, train_metric nan, valid_metric 0.025364
[1421653:MainThread](2026-01-11 23:00:35,746) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.052606, valid_loss 1.002884, train_metric nan, valid_metric 0.006998
[1421653:MainThread](2026-01-11 23:00:36,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.030842, valid_loss 0.998081, train_metric nan, valid_metric 0.032132
[1421653:MainThread](2026-01-11 23:00:36,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000879 to 0.998081, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:36,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.039804, valid_loss 0.999972, train_metric nan, valid_metric 0.026742
[1421653:MainThread](2026-01-11 23:00:36,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.037542, valid_loss 1.000132, train_metric nan, valid_metric 0.018880
[1421653:MainThread](2026-01-11 23:00:37,335) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.031871, valid_loss 0.997700, train_metric nan, valid_metric 0.032756
[1421653:MainThread](2026-01-11 23:00:37,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998081 to 0.997700, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:37,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.025359, valid_loss 0.998924, train_metric nan, valid_metric 0.021262
[1421653:MainThread](2026-01-11 23:00:38,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.029901, valid_loss 0.998598, train_metric nan, valid_metric 0.029397
[1421653:MainThread](2026-01-11 23:00:38,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.026125, valid_loss 0.998912, train_metric nan, valid_metric 0.029615
[1421653:MainThread](2026-01-11 23:00:38,894) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.026921, valid_loss 0.999306, train_metric nan, valid_metric 0.024923
[1421653:MainThread](2026-01-11 23:00:39,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.021485, valid_loss 0.998011, train_metric nan, valid_metric 0.025231
[1421653:MainThread](2026-01-11 23:00:39,717) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.021658, valid_loss 0.998110, train_metric nan, valid_metric 0.031731
[1421653:MainThread](2026-01-11 23:00:40,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.015964, valid_loss 0.999334, train_metric nan, valid_metric 0.020585
[1421653:MainThread](2026-01-11 23:00:40,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.020938, valid_loss 0.997321, train_metric nan, valid_metric 0.036347
[1421653:MainThread](2026-01-11 23:00:40,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997700 to 0.997321, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:40,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.016026, valid_loss 1.000289, train_metric nan, valid_metric 0.025699
[1421653:MainThread](2026-01-11 23:00:41,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.021166, valid_loss 1.002040, train_metric nan, valid_metric 0.031252
[1421653:MainThread](2026-01-11 23:00:41,762) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.021157, valid_loss 0.998112, train_metric nan, valid_metric 0.033136
[1421653:MainThread](2026-01-11 23:00:42,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.015566, valid_loss 0.997831, train_metric nan, valid_metric 0.033350
[1421653:MainThread](2026-01-11 23:00:42,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.010976, valid_loss 0.998630, train_metric nan, valid_metric 0.022063
[1421653:MainThread](2026-01-11 23:00:43,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.014281, valid_loss 0.998102, train_metric nan, valid_metric 0.034331
[1421653:MainThread](2026-01-11 23:00:43,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.015780, valid_loss 1.002969, train_metric nan, valid_metric 0.031592
[1421653:MainThread](2026-01-11 23:00:43,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.020978, valid_loss 0.997687, train_metric nan, valid_metric 0.026711
[1421653:MainThread](2026-01-11 23:00:44,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.007978, valid_loss 0.998510, train_metric nan, valid_metric 0.032061
[1421653:MainThread](2026-01-11 23:00:44,683) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.007670, valid_loss 0.998211, train_metric nan, valid_metric 0.036686
[1421653:MainThread](2026-01-11 23:00:45,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.009090, valid_loss 0.998501, train_metric nan, valid_metric 0.028043
[1421653:MainThread](2026-01-11 23:00:45,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.007025, valid_loss 0.997481, train_metric nan, valid_metric 0.034858
[1421653:MainThread](2026-01-11 23:00:45,880) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.010310, valid_loss 0.997917, train_metric nan, valid_metric 0.033522
[1421653:MainThread](2026-01-11 23:00:46,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.007550, valid_loss 0.998017, train_metric nan, valid_metric 0.025057
[1421653:MainThread](2026-01-11 23:00:46,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.002085, valid_loss 0.997227, train_metric nan, valid_metric 0.035324
[1421653:MainThread](2026-01-11 23:00:46,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997321 to 0.997227, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:47,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.006383, valid_loss 0.997422, train_metric nan, valid_metric 0.032190
[1421653:MainThread](2026-01-11 23:00:47,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.000997, valid_loss 0.999106, train_metric nan, valid_metric 0.034288
[1421653:MainThread](2026-01-11 23:00:47,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.008274, valid_loss 0.997737, train_metric nan, valid_metric 0.035404
[1421653:MainThread](2026-01-11 23:00:48,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.008553, valid_loss 0.997185, train_metric nan, valid_metric 0.031387
[1421653:MainThread](2026-01-11 23:00:48,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997227 to 0.997185, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:48,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.003092, valid_loss 0.997177, train_metric nan, valid_metric 0.031968
[1421653:MainThread](2026-01-11 23:00:48,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997185 to 0.997177, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:49,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.005142, valid_loss 0.997176, train_metric nan, valid_metric 0.034309
[1421653:MainThread](2026-01-11 23:00:49,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997177 to 0.997176, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:49,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.006958, valid_loss 0.997506, train_metric nan, valid_metric 0.030796
[1421653:MainThread](2026-01-11 23:00:49,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.010510, valid_loss 0.997254, train_metric nan, valid_metric 0.037875
[1421653:MainThread](2026-01-11 23:00:50,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.003825, valid_loss 0.997336, train_metric nan, valid_metric 0.033754
[1421653:MainThread](2026-01-11 23:00:50,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 1.000801, valid_loss 0.999006, train_metric nan, valid_metric 0.037208
[1421653:MainThread](2026-01-11 23:00:51,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.004047, valid_loss 0.997482, train_metric nan, valid_metric 0.037335
[1421653:MainThread](2026-01-11 23:00:51,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 1.008130, valid_loss 0.998505, train_metric nan, valid_metric 0.024280
[1421653:MainThread](2026-01-11 23:00:52,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 1.002585, valid_loss 0.997316, train_metric nan, valid_metric 0.033864
[1421653:MainThread](2026-01-11 23:00:52,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.997915, valid_loss 0.998622, train_metric nan, valid_metric 0.033038
[1421653:MainThread](2026-01-11 23:00:52,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 1.005703, valid_loss 0.998416, train_metric nan, valid_metric 0.033373
[1421653:MainThread](2026-01-11 23:00:53,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 1.001886, valid_loss 0.996508, train_metric nan, valid_metric 0.036849
[1421653:MainThread](2026-01-11 23:00:53,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997176 to 0.996508, save checkpoint.
[1421653:MainThread](2026-01-11 23:00:53,632) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.005235, valid_loss 0.997302, train_metric nan, valid_metric 0.036524
[1421653:MainThread](2026-01-11 23:00:53,950) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 1.004362, valid_loss 0.997009, train_metric nan, valid_metric 0.033496
[1421653:MainThread](2026-01-11 23:00:54,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 1.003162, valid_loss 0.998846, train_metric nan, valid_metric 0.018368
[1421653:MainThread](2026-01-11 23:00:54,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 1.008862, valid_loss 0.997208, train_metric nan, valid_metric 0.034735
[1421653:MainThread](2026-01-11 23:00:55,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 1.004139, valid_loss 0.998167, train_metric nan, valid_metric 0.026781
[1421653:MainThread](2026-01-11 23:00:55,425) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 1.000236, valid_loss 0.997216, train_metric nan, valid_metric 0.034754
[1421653:MainThread](2026-01-11 23:00:55,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 1.003685, valid_loss 0.997110, train_metric nan, valid_metric 0.032802
[1421653:MainThread](2026-01-11 23:00:56,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 1.001768, valid_loss 0.997055, train_metric nan, valid_metric 0.036467
[1421653:MainThread](2026-01-11 23:00:56,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 1.005823, valid_loss 0.996826, train_metric nan, valid_metric 0.036253
[1421653:MainThread](2026-01-11 23:00:57,117) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 1.003741, valid_loss 0.998293, train_metric nan, valid_metric 0.035954
[1421653:MainThread](2026-01-11 23:00:57,501) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 1.000612, valid_loss 0.996639, train_metric nan, valid_metric 0.037612
[1421653:MainThread](2026-01-11 23:00:57,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 1.000461, valid_loss 0.997148, train_metric nan, valid_metric 0.034656
[1421653:MainThread](2026-01-11 23:00:58,325) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 1.001615, valid_loss 0.997160, train_metric nan, valid_metric 0.036172
[1421653:MainThread](2026-01-11 23:00:58,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 1.002332, valid_loss 0.997031, train_metric nan, valid_metric 0.036877
[1421653:MainThread](2026-01-11 23:00:59,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.998739, valid_loss 0.996975, train_metric nan, valid_metric 0.037838
[1421653:MainThread](2026-01-11 23:00:59,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 1.002486, valid_loss 0.997393, train_metric nan, valid_metric 0.035069
[1421653:MainThread](2026-01-11 23:00:59,937) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 1.001917, valid_loss 0.997409, train_metric nan, valid_metric 0.036485
[1421653:MainThread](2026-01-11 23:01:00,329) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 1.003959, valid_loss 0.997844, train_metric nan, valid_metric 0.036079
[1421653:MainThread](2026-01-11 23:01:00,718) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 1.003801, valid_loss 0.996577, train_metric nan, valid_metric 0.038197
[1421653:MainThread](2026-01-11 23:01:01,166) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 1.000039, valid_loss 0.997093, train_metric nan, valid_metric 0.037055
[1421653:MainThread](2026-01-11 23:01:01,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.996966, valid_loss 0.996708, train_metric nan, valid_metric 0.038442
[1421653:MainThread](2026-01-11 23:01:02,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 1.008867, valid_loss 0.996465, train_metric nan, valid_metric 0.039373
[1421653:MainThread](2026-01-11 23:01:02,003) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996508 to 0.996465, save checkpoint.
[1421653:MainThread](2026-01-11 23:01:02,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 1.003402, valid_loss 0.996541, train_metric nan, valid_metric 0.038535
[1421653:MainThread](2026-01-11 23:01:02,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.998581, valid_loss 0.997012, train_metric nan, valid_metric 0.036383
[1421653:MainThread](2026-01-11 23:01:03,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 1.000844, valid_loss 0.996744, train_metric nan, valid_metric 0.038742
[1421653:MainThread](2026-01-11 23:01:03,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 1.001485, valid_loss 0.997051, train_metric nan, valid_metric 0.037574
[1421653:MainThread](2026-01-11 23:01:04,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.998129, valid_loss 0.996732, train_metric nan, valid_metric 0.039447
[1421653:MainThread](2026-01-11 23:01:04,503) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.999784, valid_loss 0.996549, train_metric nan, valid_metric 0.038406
[1421653:MainThread](2026-01-11 23:01:04,899) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 1.002015, valid_loss 0.996716, train_metric nan, valid_metric 0.038255
[1421653:MainThread](2026-01-11 23:01:05,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 1.001881, valid_loss 0.997208, train_metric nan, valid_metric 0.034250
[1421653:MainThread](2026-01-11 23:01:05,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.999766, valid_loss 0.997111, train_metric nan, valid_metric 0.036405
[1421653:MainThread](2026-01-11 23:01:06,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.998878, valid_loss 0.996755, train_metric nan, valid_metric 0.039496
[1421653:MainThread](2026-01-11 23:01:06,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 1.000059, valid_loss 0.996576, train_metric nan, valid_metric 0.039650
[1421653:MainThread](2026-01-11 23:01:07,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.998771, valid_loss 0.996757, train_metric nan, valid_metric 0.038239
[1421653:MainThread](2026-01-11 23:01:07,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.999872, valid_loss 0.996955, train_metric nan, valid_metric 0.036632
[1421653:MainThread](2026-01-11 23:01:07,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 1.001868, valid_loss 0.996835, train_metric nan, valid_metric 0.037434
[1421653:MainThread](2026-01-11 23:01:08,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.998365, valid_loss 0.996737, train_metric nan, valid_metric 0.037246
[1421653:MainThread](2026-01-11 23:01:08,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.996990, valid_loss 0.996714, train_metric nan, valid_metric 0.036576
[1421653:MainThread](2026-01-11 23:01:09,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.996033, valid_loss 0.996770, train_metric nan, valid_metric 0.036075
[1421653:MainThread](2026-01-11 23:01:09,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 1.007842, valid_loss 0.996752, train_metric nan, valid_metric 0.038525
[1421653:MainThread](2026-01-11 23:01:10,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.998910, valid_loss 0.997363, train_metric nan, valid_metric 0.038274
[1421653:MainThread](2026-01-11 23:01:10,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 1.002070, valid_loss 0.996949, train_metric nan, valid_metric 0.037491
[1421653:MainThread](2026-01-11 23:01:10,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 1.001274, valid_loss 0.996711, train_metric nan, valid_metric 0.037038
[1421653:MainThread](2026-01-11 23:01:11,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.999373, valid_loss 0.996785, train_metric nan, valid_metric 0.036682
[1421653:MainThread](2026-01-11 23:01:11,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 1.002469, valid_loss 0.996793, train_metric nan, valid_metric 0.037812
[1421653:MainThread](2026-01-11 23:01:12,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 1.000587, valid_loss 0.996743, train_metric nan, valid_metric 0.038537
[1421653:MainThread](2026-01-11 23:01:12,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.998682, valid_loss 0.996866, train_metric nan, valid_metric 0.036872
[1421653:MainThread](2026-01-11 23:01:12,903) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 1.004498, valid_loss 0.996788, train_metric nan, valid_metric 0.037631
[1421653:MainThread](2026-01-11 23:01:13,311) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.998540, valid_loss 0.996876, train_metric nan, valid_metric 0.037053
[1421653:MainThread](2026-01-11 23:01:13,740) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 1.001241, valid_loss 0.996866, train_metric nan, valid_metric 0.037713
[1421653:MainThread](2026-01-11 23:01:14,152) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 1.002130, valid_loss 0.996977, train_metric nan, valid_metric 0.036751
[1421653:MainThread](2026-01-11 23:01:14,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.999189, valid_loss 0.996700, train_metric nan, valid_metric 0.038794
[1421653:MainThread](2026-01-11 23:01:14,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 1.003566, valid_loss 0.996674, train_metric nan, valid_metric 0.037507
[1421653:MainThread](2026-01-11 23:01:15,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.998850, valid_loss 0.996883, train_metric nan, valid_metric 0.036875
[1421653:MainThread](2026-01-11 23:01:15,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.999581, valid_loss 0.996849, train_metric nan, valid_metric 0.036605
[1421653:MainThread](2026-01-11 23:01:16,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.996512, valid_loss 0.996950, train_metric nan, valid_metric 0.037338
[1421653:MainThread](2026-01-11 23:01:16,574) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.994342, valid_loss 0.997002, train_metric nan, valid_metric 0.036736
[1421653:MainThread](2026-01-11 23:01:16,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.996635, valid_loss 0.996987, train_metric nan, valid_metric 0.036866
[1421653:MainThread](2026-01-11 23:01:17,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.998215, valid_loss 0.996794, train_metric nan, valid_metric 0.036470
[1421653:MainThread](2026-01-11 23:01:17,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.999858, valid_loss 0.996890, train_metric nan, valid_metric 0.036539
[1421653:MainThread](2026-01-11 23:01:18,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 1.001557, valid_loss 0.996820, train_metric nan, valid_metric 0.036972
[1421653:MainThread](2026-01-11 23:01:19,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.997578, valid_loss 0.996712, train_metric nan, valid_metric 0.037057
[1421653:MainThread](2026-01-11 23:01:19,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.993277, valid_loss 0.996776, train_metric nan, valid_metric 0.037464
[1421653:MainThread](2026-01-11 23:01:19,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.995686, valid_loss 0.996842, train_metric nan, valid_metric 0.037356
[1421653:MainThread](2026-01-11 23:01:20,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 1.001065, valid_loss 0.996811, train_metric nan, valid_metric 0.036518
[1421653:MainThread](2026-01-11 23:01:20,770) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.997772, valid_loss 0.996921, train_metric nan, valid_metric 0.035745
[1421653:MainThread](2026-01-11 23:01:21,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.997393, valid_loss 0.996902, train_metric nan, valid_metric 0.036004
[1421653:MainThread](2026-01-11 23:01:21,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.996886, valid_loss 0.996892, train_metric nan, valid_metric 0.036030
[1421653:MainThread](2026-01-11 23:01:21,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.995556, valid_loss 0.996877, train_metric nan, valid_metric 0.035224
[1421653:MainThread](2026-01-11 23:01:22,080) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2460]: train_loss 1.001496, valid_loss 0.996955, train_metric nan, valid_metric 0.037001
[1421653:MainThread](2026-01-11 23:01:22,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2480]: train_loss 0.995121, valid_loss 0.996992, train_metric nan, valid_metric 0.036232
[1421653:MainThread](2026-01-11 23:01:22,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2500]: train_loss 0.995092, valid_loss 0.996930, train_metric nan, valid_metric 0.035149
[1421653:MainThread](2026-01-11 23:01:22,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 23:01:22.894 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 23:01:25.420 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 23:01:25.421 | INFO     | __main__:train_single_fold:593 -   IC=0.0201, ICIR=0.1239, RankIC=0.0440, RankICIR=0.3071
2026-01-11 23:01:25.421 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 23:01:25,427) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 23:02:15,301) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:02:15,302) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:02:25,129) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df752be90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.95it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 47.05it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.67it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 69.67it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 73.84it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 75.93it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 77.60it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 76.85it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 76.62it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 75.15it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:02, 75.17it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 73.91it/s]backtest loop:  45%|████▌     | 110/242 [00:01<00:01, 75.76it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 74.96it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 76.39it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 79.70it/s]backtest loop:  60%|██████    | 146/242 [00:01<00:01, 79.24it/s]backtest loop:  64%|██████▎   | 154/242 [00:02<00:01, 77.99it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:01, 77.89it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 78.62it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 78.26it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 78.92it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 79.35it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 79.72it/s]backtest loop:  91%|█████████▏| 221/242 [00:02<00:00, 81.38it/s]backtest loop:  95%|█████████▌| 230/242 [00:03<00:00, 80.43it/s]backtest loop:  99%|█████████▉| 239/242 [00:03<00:00, 79.52it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.80it/s]
2026-01-11 23:02:28.345 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0366, Sharpe(w/cost)=0.4531, MaxDD=-0.0588
2026-01-11 23:02:31.986 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 23:02:48.131 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 23:02:48.202 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_7_pred.parquet
2026-01-11 23:02:48.220 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 23:02:48.221 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 23:02:50.867 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0245
2026-01-11 23:02:52.446 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0317
2026-01-11 23:02:54.115 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0392
2026-01-11 23:02:55.951 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0395
2026-01-11 23:02:57.955 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0334
2026-01-11 23:02:59.773 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0358
2026-01-11 23:03:01.567 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0406
2026-01-11 23:03:01.951 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0231, ICIR=0.1458, RankIC=0.0474
[1421653:MainThread](2026-01-11 23:03:01,957) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 23:03:48,889) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:03:48,922) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:03:58,433) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0dfbc13e90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.00it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 44.47it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.80it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 70.37it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 76.58it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 74.24it/s]backtest loop:  22%|██▏       | 54/242 [00:00<00:02, 73.28it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 73.28it/s]backtest loop:  29%|██▉       | 70/242 [00:01<00:02, 73.02it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 72.02it/s]backtest loop:  36%|███▌      | 86/242 [00:01<00:02, 73.12it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 74.83it/s]backtest loop:  43%|████▎     | 105/242 [00:01<00:01, 77.14it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 76.90it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 79.16it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 80.07it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 80.82it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 81.22it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 80.82it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 81.25it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 81.05it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 81.55it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 82.12it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 84.24it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 88.34it/s]backtest loop:  96%|█████████▋| 233/242 [00:02<00:00, 92.50it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 78.63it/s]
2026-01-11 23:04:01.531 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0911, Sharpe(w/cost)=1.0959
2026-01-11 23:04:01.576 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 23:04:01.576 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 23:04:01.576 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 23:04:01.576 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1421653:MainThread](2026-01-11 23:05:48,091) INFO - qlib.timer - [log.py:127] - Time cost: 106.512s | Loading data Done
[1421653:MainThread](2026-01-11 23:05:51,878) INFO - qlib.timer - [log.py:127] - Time cost: 3.205s | ZScoreNorm Done
[1421653:MainThread](2026-01-11 23:05:53,237) INFO - qlib.timer - [log.py:127] - Time cost: 1.358s | Fillna Done
[1421653:MainThread](2026-01-11 23:05:54,306) INFO - qlib.timer - [log.py:127] - Time cost: 0.354s | DropnaLabel Done
[1421653:MainThread](2026-01-11 23:05:54,510) INFO - qlib.timer - [log.py:127] - Time cost: 0.203s | CSRankNorm Done
[1421653:MainThread](2026-01-11 23:05:54,513) INFO - qlib.timer - [log.py:127] - Time cost: 6.422s | fit & process data Done
[1421653:MainThread](2026-01-11 23:05:54,514) INFO - qlib.timer - [log.py:127] - Time cost: 112.936s | Init data Done
2026-01-11 23:05:54.514 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1421653:MainThread](2026-01-11 23:05:54,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1421653:MainThread](2026-01-11 23:05:54,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1421653:MainThread](2026-01-11 23:05:54,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1421653:MainThread](2026-01-11 23:05:54,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 23:05:54.533 | INFO     | __main__:train_single_fold:569 - Training mlp_360_zscore model (GPU=0)...
[1421653:MainThread](2026-01-11 23:05:56,133) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1421653:MainThread](2026-01-11 23:05:57,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.583194, valid_loss 1.033566, train_metric nan, valid_metric 0.021639
[1421653:MainThread](2026-01-11 23:05:57,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.033566, save checkpoint.
[1421653:MainThread](2026-01-11 23:05:57,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.100248, valid_loss 1.004708, train_metric nan, valid_metric 0.023657
[1421653:MainThread](2026-01-11 23:05:57,432) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.033566 to 1.004708, save checkpoint.
[1421653:MainThread](2026-01-11 23:05:57,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.076764, valid_loss 1.008471, train_metric nan, valid_metric 0.019494
[1421653:MainThread](2026-01-11 23:05:58,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.074050, valid_loss 1.000279, train_metric nan, valid_metric 0.030857
[1421653:MainThread](2026-01-11 23:05:58,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004708 to 1.000279, save checkpoint.
[1421653:MainThread](2026-01-11 23:05:58,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.049516, valid_loss 0.998822, train_metric nan, valid_metric 0.032561
[1421653:MainThread](2026-01-11 23:05:58,624) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000279 to 0.998822, save checkpoint.
[1421653:MainThread](2026-01-11 23:05:59,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.071170, valid_loss 0.998641, train_metric nan, valid_metric 0.033582
[1421653:MainThread](2026-01-11 23:05:59,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998822 to 0.998641, save checkpoint.
[1421653:MainThread](2026-01-11 23:05:59,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.066085, valid_loss 1.008787, train_metric nan, valid_metric 0.027527
[1421653:MainThread](2026-01-11 23:05:59,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.045904, valid_loss 1.000899, train_metric nan, valid_metric 0.030742
[1421653:MainThread](2026-01-11 23:06:00,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.036975, valid_loss 0.996816, train_metric nan, valid_metric 0.039984
[1421653:MainThread](2026-01-11 23:06:00,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998641 to 0.996816, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:00,661) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.051380, valid_loss 0.997745, train_metric nan, valid_metric 0.037391
[1421653:MainThread](2026-01-11 23:06:01,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.042081, valid_loss 0.998818, train_metric nan, valid_metric 0.029235
[1421653:MainThread](2026-01-11 23:06:01,421) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.033029, valid_loss 0.997613, train_metric nan, valid_metric 0.036540
[1421653:MainThread](2026-01-11 23:06:01,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.038870, valid_loss 0.997282, train_metric nan, valid_metric 0.038807
[1421653:MainThread](2026-01-11 23:06:02,218) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.029540, valid_loss 0.996599, train_metric nan, valid_metric 0.038369
[1421653:MainThread](2026-01-11 23:06:02,221) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996816 to 0.996599, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:02,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.023981, valid_loss 0.998493, train_metric nan, valid_metric 0.025129
[1421653:MainThread](2026-01-11 23:06:03,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.024071, valid_loss 0.996939, train_metric nan, valid_metric 0.038917
[1421653:MainThread](2026-01-11 23:06:03,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.020171, valid_loss 0.996891, train_metric nan, valid_metric 0.040262
[1421653:MainThread](2026-01-11 23:06:03,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.021161, valid_loss 0.997353, train_metric nan, valid_metric 0.040607
[1421653:MainThread](2026-01-11 23:06:04,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.018785, valid_loss 0.999541, train_metric nan, valid_metric 0.025715
[1421653:MainThread](2026-01-11 23:06:04,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.020033, valid_loss 0.996941, train_metric nan, valid_metric 0.041568
[1421653:MainThread](2026-01-11 23:06:05,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.012420, valid_loss 0.996076, train_metric nan, valid_metric 0.043561
[1421653:MainThread](2026-01-11 23:06:05,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996599 to 0.996076, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:05,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.017432, valid_loss 0.998116, train_metric nan, valid_metric 0.026422
[1421653:MainThread](2026-01-11 23:06:05,897) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.010105, valid_loss 0.996893, train_metric nan, valid_metric 0.040516
[1421653:MainThread](2026-01-11 23:06:06,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.013154, valid_loss 0.995819, train_metric nan, valid_metric 0.044063
[1421653:MainThread](2026-01-11 23:06:06,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996076 to 0.995819, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:06,757) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.019836, valid_loss 0.996169, train_metric nan, valid_metric 0.045046
[1421653:MainThread](2026-01-11 23:06:07,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.009870, valid_loss 0.995939, train_metric nan, valid_metric 0.046858
[1421653:MainThread](2026-01-11 23:06:07,631) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.012741, valid_loss 0.996332, train_metric nan, valid_metric 0.042516
[1421653:MainThread](2026-01-11 23:06:08,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.011126, valid_loss 0.996187, train_metric nan, valid_metric 0.042022
[1421653:MainThread](2026-01-11 23:06:08,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.010085, valid_loss 0.996195, train_metric nan, valid_metric 0.043089
[1421653:MainThread](2026-01-11 23:06:08,878) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.013761, valid_loss 0.997322, train_metric nan, valid_metric 0.032985
[1421653:MainThread](2026-01-11 23:06:09,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.013852, valid_loss 0.997604, train_metric nan, valid_metric 0.038623
[1421653:MainThread](2026-01-11 23:06:09,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.011477, valid_loss 0.996034, train_metric nan, valid_metric 0.042594
[1421653:MainThread](2026-01-11 23:06:10,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.006160, valid_loss 0.996023, train_metric nan, valid_metric 0.045061
[1421653:MainThread](2026-01-11 23:06:10,517) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.008335, valid_loss 0.996990, train_metric nan, valid_metric 0.038283
[1421653:MainThread](2026-01-11 23:06:10,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.001651, valid_loss 0.998510, train_metric nan, valid_metric 0.030184
[1421653:MainThread](2026-01-11 23:06:11,361) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.008135, valid_loss 0.995969, train_metric nan, valid_metric 0.043883
[1421653:MainThread](2026-01-11 23:06:11,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.002642, valid_loss 0.995942, train_metric nan, valid_metric 0.045628
[1421653:MainThread](2026-01-11 23:06:12,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.002789, valid_loss 0.995941, train_metric nan, valid_metric 0.045089
[1421653:MainThread](2026-01-11 23:06:12,700) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.007525, valid_loss 0.996538, train_metric nan, valid_metric 0.040382
[1421653:MainThread](2026-01-11 23:06:13,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.998621, valid_loss 0.995859, train_metric nan, valid_metric 0.041835
[1421653:MainThread](2026-01-11 23:06:13,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.001495, valid_loss 0.996326, train_metric nan, valid_metric 0.041757
[1421653:MainThread](2026-01-11 23:06:13,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.000659, valid_loss 0.996041, train_metric nan, valid_metric 0.044988
[1421653:MainThread](2026-01-11 23:06:14,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.005299, valid_loss 0.995608, train_metric nan, valid_metric 0.044772
[1421653:MainThread](2026-01-11 23:06:14,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995819 to 0.995608, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:14,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.000364, valid_loss 0.996164, train_metric nan, valid_metric 0.044920
[1421653:MainThread](2026-01-11 23:06:15,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.999784, valid_loss 0.995577, train_metric nan, valid_metric 0.048612
[1421653:MainThread](2026-01-11 23:06:15,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995608 to 0.995577, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:15,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.998793, valid_loss 0.996610, train_metric nan, valid_metric 0.041277
[1421653:MainThread](2026-01-11 23:06:16,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 1.001086, valid_loss 0.995291, train_metric nan, valid_metric 0.050225
[1421653:MainThread](2026-01-11 23:06:16,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995577 to 0.995291, save checkpoint.
[1421653:MainThread](2026-01-11 23:06:16,527) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.003819, valid_loss 0.995771, train_metric nan, valid_metric 0.045297
[1421653:MainThread](2026-01-11 23:06:16,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 1.003410, valid_loss 0.997311, train_metric nan, valid_metric 0.032860
[1421653:MainThread](2026-01-11 23:06:17,243) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 1.003484, valid_loss 0.995599, train_metric nan, valid_metric 0.045378
[1421653:MainThread](2026-01-11 23:06:17,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 1.001363, valid_loss 0.995786, train_metric nan, valid_metric 0.046708
[1421653:MainThread](2026-01-11 23:06:17,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 1.005074, valid_loss 0.997157, train_metric nan, valid_metric 0.040504
[1421653:MainThread](2026-01-11 23:06:18,365) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 1.001051, valid_loss 0.997346, train_metric nan, valid_metric 0.041181
[1421653:MainThread](2026-01-11 23:06:18,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.003065, valid_loss 0.996733, train_metric nan, valid_metric 0.039128
[1421653:MainThread](2026-01-11 23:06:19,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.999550, valid_loss 0.996078, train_metric nan, valid_metric 0.044554
[1421653:MainThread](2026-01-11 23:06:19,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 1.001346, valid_loss 0.996326, train_metric nan, valid_metric 0.040474
[1421653:MainThread](2026-01-11 23:06:20,053) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 1.000414, valid_loss 0.995934, train_metric nan, valid_metric 0.044190
[1421653:MainThread](2026-01-11 23:06:20,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 1.001556, valid_loss 0.996255, train_metric nan, valid_metric 0.038144
[1421653:MainThread](2026-01-11 23:06:20,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.998385, valid_loss 0.996365, train_metric nan, valid_metric 0.043027
[1421653:MainThread](2026-01-11 23:06:21,276) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 1.001167, valid_loss 0.996947, train_metric nan, valid_metric 0.041909
[1421653:MainThread](2026-01-11 23:06:21,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 1.003804, valid_loss 0.995810, train_metric nan, valid_metric 0.044851
[1421653:MainThread](2026-01-11 23:06:22,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.995866, valid_loss 0.995843, train_metric nan, valid_metric 0.046436
[1421653:MainThread](2026-01-11 23:06:22,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.999764, valid_loss 0.996257, train_metric nan, valid_metric 0.044716
[1421653:MainThread](2026-01-11 23:06:22,905) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 1.000391, valid_loss 0.997000, train_metric nan, valid_metric 0.035235
[1421653:MainThread](2026-01-11 23:06:23,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 1.000245, valid_loss 0.995900, train_metric nan, valid_metric 0.043726
[1421653:MainThread](2026-01-11 23:06:23,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.992425, valid_loss 0.995605, train_metric nan, valid_metric 0.045422
[1421653:MainThread](2026-01-11 23:06:24,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 1.001379, valid_loss 0.996365, train_metric nan, valid_metric 0.044623
[1421653:MainThread](2026-01-11 23:06:24,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 1.000093, valid_loss 0.996128, train_metric nan, valid_metric 0.043798
[1421653:MainThread](2026-01-11 23:06:24,921) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 1.001770, valid_loss 0.995804, train_metric nan, valid_metric 0.047876
[1421653:MainThread](2026-01-11 23:06:25,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.992498, valid_loss 0.995650, train_metric nan, valid_metric 0.047151
[1421653:MainThread](2026-01-11 23:06:25,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 1.000270, valid_loss 0.995838, train_metric nan, valid_metric 0.048087
[1421653:MainThread](2026-01-11 23:06:26,110) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.997490, valid_loss 0.995885, train_metric nan, valid_metric 0.047784
[1421653:MainThread](2026-01-11 23:06:26,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.998384, valid_loss 0.995658, train_metric nan, valid_metric 0.046955
[1421653:MainThread](2026-01-11 23:06:26,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.995717, valid_loss 0.995781, train_metric nan, valid_metric 0.047245
[1421653:MainThread](2026-01-11 23:06:27,317) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.999979, valid_loss 0.996193, train_metric nan, valid_metric 0.045829
[1421653:MainThread](2026-01-11 23:06:27,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 1.000654, valid_loss 0.995845, train_metric nan, valid_metric 0.047570
[1421653:MainThread](2026-01-11 23:06:28,161) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 1.000738, valid_loss 0.995692, train_metric nan, valid_metric 0.048245
[1421653:MainThread](2026-01-11 23:06:28,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.995600, valid_loss 0.995789, train_metric nan, valid_metric 0.046937
[1421653:MainThread](2026-01-11 23:06:28,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 1.000850, valid_loss 0.996300, train_metric nan, valid_metric 0.046778
[1421653:MainThread](2026-01-11 23:06:29,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.999331, valid_loss 0.995665, train_metric nan, valid_metric 0.048886
[1421653:MainThread](2026-01-11 23:06:29,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.992325, valid_loss 0.995826, train_metric nan, valid_metric 0.048058
[1421653:MainThread](2026-01-11 23:06:30,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.997594, valid_loss 0.995651, train_metric nan, valid_metric 0.049218
[1421653:MainThread](2026-01-11 23:06:30,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.995822, valid_loss 0.995728, train_metric nan, valid_metric 0.048598
[1421653:MainThread](2026-01-11 23:06:30,958) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.997473, valid_loss 0.995547, train_metric nan, valid_metric 0.049673
[1421653:MainThread](2026-01-11 23:06:31,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.994801, valid_loss 0.995646, train_metric nan, valid_metric 0.048987
[1421653:MainThread](2026-01-11 23:06:31,748) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.993925, valid_loss 0.995628, train_metric nan, valid_metric 0.047880
[1421653:MainThread](2026-01-11 23:06:32,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.998922, valid_loss 0.995878, train_metric nan, valid_metric 0.048695
[1421653:MainThread](2026-01-11 23:06:32,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.997061, valid_loss 0.995559, train_metric nan, valid_metric 0.049543
[1421653:MainThread](2026-01-11 23:06:32,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 1.000332, valid_loss 0.996016, train_metric nan, valid_metric 0.047991
[1421653:MainThread](2026-01-11 23:06:33,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.999640, valid_loss 0.995577, train_metric nan, valid_metric 0.049152
[1421653:MainThread](2026-01-11 23:06:33,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.998109, valid_loss 0.995313, train_metric nan, valid_metric 0.049007
[1421653:MainThread](2026-01-11 23:06:34,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.996488, valid_loss 0.995471, train_metric nan, valid_metric 0.049805
[1421653:MainThread](2026-01-11 23:06:34,542) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.997542, valid_loss 0.995491, train_metric nan, valid_metric 0.049495
[1421653:MainThread](2026-01-11 23:06:34,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 1.000206, valid_loss 0.995388, train_metric nan, valid_metric 0.050089
[1421653:MainThread](2026-01-11 23:06:35,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 1.000856, valid_loss 0.995605, train_metric nan, valid_metric 0.048803
[1421653:MainThread](2026-01-11 23:06:35,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.997131, valid_loss 0.995563, train_metric nan, valid_metric 0.048628
[1421653:MainThread](2026-01-11 23:06:36,188) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.990552, valid_loss 0.995541, train_metric nan, valid_metric 0.049087
[1421653:MainThread](2026-01-11 23:06:36,190) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 23:06:36.216 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 23:06:38.903 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 23:06:38.904 | INFO     | __main__:train_single_fold:593 -   IC=0.0302, ICIR=0.1546, RankIC=0.0561, RankICIR=0.2732
2026-01-11 23:06:38.904 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1421653:MainThread](2026-01-11 23:06:38,912) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 23:07:30,958) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:07:30,959) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:07:40,621) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0e4ac7be90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:14, 16.75it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:05, 43.32it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:04, 55.65it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 64.52it/s]backtest loop:  15%|█▌        | 37/242 [00:00<00:02, 72.26it/s]backtest loop:  19%|█▊        | 45/242 [00:00<00:02, 73.41it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 73.57it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 72.49it/s]backtest loop:  29%|██▉       | 71/242 [00:01<00:02, 74.80it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:02, 74.82it/s]backtest loop:  36%|███▋      | 88/242 [00:01<00:02, 75.43it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 77.04it/s]backtest loop:  44%|████▍     | 107/242 [00:01<00:01, 77.44it/s]backtest loop:  48%|████▊     | 117/242 [00:01<00:01, 78.50it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 78.68it/s]backtest loop:  56%|█████▌    | 135/242 [00:01<00:01, 78.80it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 77.60it/s]backtest loop:  63%|██████▎   | 152/242 [00:02<00:01, 77.87it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 78.92it/s]backtest loop:  71%|███████   | 171/242 [00:02<00:00, 81.89it/s]backtest loop:  74%|███████▍  | 180/242 [00:02<00:00, 77.14it/s]backtest loop:  78%|███████▊  | 188/242 [00:02<00:00, 77.43it/s]backtest loop:  81%|████████  | 196/242 [00:02<00:00, 77.12it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 77.59it/s]backtest loop:  88%|████████▊ | 214/242 [00:02<00:00, 80.94it/s]backtest loop:  92%|█████████▏| 223/242 [00:02<00:00, 80.97it/s]backtest loop:  96%|█████████▌| 232/242 [00:03<00:00, 80.36it/s]backtest loop: 100%|█████████▉| 241/242 [00:03<00:00, 79.84it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.62it/s]
2026-01-11 23:07:43.885 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1105, Sharpe(w/cost)=0.9757, MaxDD=-0.1534
2026-01-11 23:07:47.846 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 23:08:04.289 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 23:08:04.372 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/fold_8_pred.parquet
2026-01-11 23:08:04.389 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 23:08:04.389 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 23:08:07.191 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0289
2026-01-11 23:08:09.420 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0372
2026-01-11 23:08:11.514 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0346
2026-01-11 23:08:13.517 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0371
2026-01-11 23:08:15.478 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0416
2026-01-11 23:08:17.554 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0359
2026-01-11 23:08:19.403 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0419
2026-01-11 23:08:21.444 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0566
2026-01-11 23:08:21.849 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0332, ICIR=0.1764, RankIC=0.0590
[1421653:MainThread](2026-01-11 23:08:21,855) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1421653:MainThread](2026-01-11 23:09:10,658) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:09:10,659) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:09:20,065) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0e4ac03e90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 21.73it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 49.04it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 59.79it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 66.41it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 71.67it/s]backtest loop:  19%|█▉        | 47/242 [00:00<00:02, 76.91it/s]backtest loop:  23%|██▎       | 55/242 [00:00<00:02, 76.25it/s]backtest loop:  26%|██▌       | 63/242 [00:00<00:02, 75.76it/s]backtest loop:  29%|██▉       | 71/242 [00:01<00:02, 75.50it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:02, 75.16it/s]backtest loop:  36%|███▋      | 88/242 [00:01<00:02, 75.92it/s]backtest loop:  40%|████      | 97/242 [00:01<00:01, 79.89it/s]backtest loop:  44%|████▍     | 106/242 [00:01<00:01, 79.24it/s]backtest loop:  47%|████▋     | 114/242 [00:01<00:01, 77.21it/s]backtest loop:  50%|█████     | 122/242 [00:01<00:01, 76.60it/s]backtest loop:  54%|█████▍    | 131/242 [00:01<00:01, 79.71it/s]backtest loop:  57%|█████▋    | 139/242 [00:01<00:01, 77.94it/s]backtest loop:  61%|██████    | 147/242 [00:01<00:01, 77.03it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 77.67it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 78.37it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 76.83it/s]backtest loop:  76%|███████▌  | 184/242 [00:02<00:00, 78.86it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 77.65it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 77.09it/s]backtest loop:  87%|████████▋ | 210/242 [00:02<00:00, 78.30it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 79.10it/s]backtest loop:  95%|█████████▌| 230/242 [00:03<00:00, 80.43it/s]backtest loop:  99%|█████████▉| 240/242 [00:03<00:00, 80.20it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.53it/s]
2026-01-11 23:09:23.298 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0500, Sharpe(w/cost)=0.4643
2026-01-11 23:09:23.352 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 23:09:23.353 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 23:09:23.353 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 23:09:23.359 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 23:09:23.360 | INFO     | __main__:_print_summary:827 -   IC: 0.0266
2026-01-11 23:09:23.360 | INFO     | __main__:_print_summary:828 -   ICIR: 0.2059
2026-01-11 23:09:23.360 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0445
2026-01-11 23:09:23.360 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0432
2026-01-11 23:09:23.360 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.4084
2026-01-11 23:09:23.360 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0428
2026-01-11 23:09:23.363 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/summary.csv
2026-01-11 23:09:23.364 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 23:09:23.364 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 23:09:23.364 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 23:09:23.364 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 23:09:23.367 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 23:09:23.367 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0445
2026-01-11 23:09:23.367 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0355
2026-01-11 23:09:23.367 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0355)
2026-01-11 23:09:23.367 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 23:09:23.368 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/ensemble_matrix.csv
2026-01-11 23:09:23.368 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 23:09:23.368 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 23:09:23.368 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 23:09:23.519 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 23:09:23.519 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 23:09:25.414 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0266, ICIR=0.1925, RankIC=0.0445
[1421653:MainThread](2026-01-11 23:09:25,425) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.067258 0.603715 0.084535  0.306076  2.928850 -0.041004         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.039759 0.301377 0.058598  0.020697  0.415359 -0.072943    0.062403    1.710190
    2 2018-01-01 ~ 2018-12-31 0.032362 0.271837 0.040842  0.038999  0.526479 -0.048284    0.041761   -0.092030
    3 2019-01-01 ~ 2019-12-31 0.007718 0.064247 0.026594 -0.150178 -1.898341 -0.184630    0.029284   -1.607144
    4 2020-01-01 ~ 2020-12-31 0.010947 0.086272 0.024582 -0.047778 -0.560385 -0.127922    0.031163    0.117092
    5 2021-01-01 ~ 2021-12-31 0.010179 0.084369 0.027502 -0.027345 -0.266619 -0.108679    0.029137   -1.041166
    6 2022-01-01 ~ 2022-12-31 0.020998 0.163160 0.037899  0.101516  1.101113 -0.080476    0.042609    1.009556
    7 2023-01-01 ~ 2023-12-31 0.020108 0.123869 0.043980  0.036565  0.453132 -0.058756    0.047365    1.095854
    8 2024-01-01 ~ 2024-12-31 0.030197 0.154595 0.056069  0.110527  0.975723 -0.153419    0.058957    0.464272

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.0845     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0604  0.0586     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0329  0.0380  0.0408     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0273  0.0309  0.0322  0.0266     NaN     NaN     NaN     NaN     NaN
T4  0.0312  0.0304  0.0393  0.0347  0.0246     NaN     NaN     NaN     NaN
T5  0.0249  0.0229  0.0331  0.0296  0.0270  0.0275     NaN     NaN     NaN
T6  0.0426  0.0361  0.0413  0.0406  0.0311  0.0321  0.0379     NaN     NaN
T7  0.0245  0.0317  0.0392  0.0395  0.0334  0.0358  0.0406  0.0440     NaN
T8  0.0289  0.0372  0.0346  0.0371  0.0416  0.0359  0.0419  0.0566  0.0561
[1421653:MainThread](2026-01-11 23:10:19,086) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:10:19,089) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1421653:MainThread](2026-01-11 23:11:17,988) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f0df9cd0810>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 3/2187 [00:00<01:33, 23.33it/s]backtest loop:   0%|          | 10/2187 [00:00<00:45, 47.76it/s]backtest loop:   1%|          | 20/2187 [00:00<00:33, 64.43it/s]backtest loop:   1%|▏         | 30/2187 [00:00<00:30, 71.39it/s]backtest loop:   2%|▏         | 40/2187 [00:00<00:27, 76.82it/s]backtest loop:   2%|▏         | 50/2187 [00:00<00:26, 80.22it/s]backtest loop:   3%|▎         | 60/2187 [00:00<00:26, 80.50it/s]backtest loop:   3%|▎         | 69/2187 [00:00<00:27, 78.41it/s]backtest loop:   4%|▎         | 79/2187 [00:01<00:26, 79.73it/s]backtest loop:   4%|▍         | 88/2187 [00:01<00:26, 79.75it/s]backtest loop:   4%|▍         | 97/2187 [00:01<00:25, 82.29it/s]backtest loop:   5%|▍         | 106/2187 [00:01<00:27, 74.93it/s]backtest loop:   5%|▌         | 115/2187 [00:01<00:26, 78.46it/s]backtest loop:   6%|▌         | 123/2187 [00:01<00:27, 76.39it/s]backtest loop:   6%|▌         | 131/2187 [00:01<00:27, 75.29it/s]backtest loop:   6%|▋         | 141/2187 [00:01<00:26, 76.92it/s]backtest loop:   7%|▋         | 151/2187 [00:02<00:26, 76.96it/s]backtest loop:   7%|▋         | 160/2187 [00:02<00:25, 80.38it/s]backtest loop:   8%|▊         | 169/2187 [00:02<00:25, 78.67it/s]backtest loop:   8%|▊         | 177/2187 [00:02<00:26, 77.17it/s]backtest loop:   8%|▊         | 185/2187 [00:02<00:25, 77.59it/s]backtest loop:   9%|▉         | 194/2187 [00:02<00:25, 79.33it/s]backtest loop:   9%|▉         | 204/2187 [00:02<00:24, 81.66it/s]backtest loop:  10%|▉         | 214/2187 [00:02<00:23, 84.10it/s]backtest loop:  10%|█         | 224/2187 [00:02<00:23, 83.79it/s]backtest loop:  11%|█         | 234/2187 [00:03<00:23, 83.50it/s]backtest loop:  11%|█         | 244/2187 [00:03<00:23, 82.48it/s]backtest loop:  12%|█▏        | 253/2187 [00:03<00:23, 83.52it/s]backtest loop:  12%|█▏        | 262/2187 [00:03<00:22, 83.92it/s]backtest loop:  12%|█▏        | 271/2187 [00:03<00:22, 84.42it/s]backtest loop:  13%|█▎        | 280/2187 [00:03<00:22, 85.77it/s]backtest loop:  13%|█▎        | 289/2187 [00:03<00:21, 86.88it/s]backtest loop:  14%|█▎        | 298/2187 [00:03<00:21, 87.34it/s]backtest loop:  14%|█▍        | 308/2187 [00:03<00:20, 89.52it/s]backtest loop:  14%|█▍        | 317/2187 [00:03<00:21, 86.64it/s]backtest loop:  15%|█▍        | 326/2187 [00:04<00:22, 83.57it/s]backtest loop:  15%|█▌        | 335/2187 [00:04<00:22, 80.89it/s]backtest loop:  16%|█▌        | 344/2187 [00:04<00:23, 78.07it/s]backtest loop:  16%|█▌        | 352/2187 [00:04<00:23, 78.18it/s]backtest loop:  16%|█▋        | 360/2187 [00:04<00:23, 76.50it/s]backtest loop:  17%|█▋        | 368/2187 [00:04<00:24, 74.35it/s]backtest loop:  17%|█▋        | 377/2187 [00:04<00:23, 77.92it/s]backtest loop:  18%|█▊        | 385/2187 [00:04<00:23, 76.09it/s]backtest loop:  18%|█▊        | 393/2187 [00:04<00:24, 74.63it/s]backtest loop:  18%|█▊        | 403/2187 [00:05<00:23, 75.92it/s]backtest loop:  19%|█▉        | 412/2187 [00:05<00:22, 79.01it/s]backtest loop:  19%|█▉        | 420/2187 [00:05<00:23, 76.56it/s]backtest loop:  20%|█▉        | 428/2187 [00:05<00:22, 77.26it/s]backtest loop:  20%|██        | 438/2187 [00:05<00:21, 79.76it/s]backtest loop:  20%|██        | 448/2187 [00:05<00:21, 81.84it/s]backtest loop:  21%|██        | 458/2187 [00:05<00:20, 84.57it/s]backtest loop:  21%|██▏       | 468/2187 [00:05<00:20, 85.15it/s]backtest loop:  22%|██▏       | 478/2187 [00:06<00:20, 84.71it/s]backtest loop:  22%|██▏       | 488/2187 [00:06<00:19, 87.45it/s]backtest loop:  23%|██▎       | 497/2187 [00:06<00:19, 85.24it/s]backtest loop:  23%|██▎       | 507/2187 [00:06<00:19, 85.95it/s]backtest loop:  24%|██▎       | 517/2187 [00:06<00:19, 87.16it/s]backtest loop:  24%|██▍       | 526/2187 [00:06<00:19, 85.21it/s]backtest loop:  24%|██▍       | 535/2187 [00:06<00:20, 82.29it/s]backtest loop:  25%|██▍       | 544/2187 [00:06<00:19, 82.20it/s]backtest loop:  25%|██▌       | 553/2187 [00:06<00:20, 79.73it/s]backtest loop:  26%|██▌       | 561/2187 [00:07<00:20, 78.79it/s]backtest loop:  26%|██▌       | 569/2187 [00:07<00:20, 77.83it/s]backtest loop:  26%|██▋       | 578/2187 [00:07<00:20, 78.01it/s]backtest loop:  27%|██▋       | 588/2187 [00:07<00:20, 77.96it/s]backtest loop:  27%|██▋       | 598/2187 [00:07<00:19, 79.65it/s]backtest loop:  28%|██▊       | 607/2187 [00:07<00:19, 79.75it/s]backtest loop:  28%|██▊       | 617/2187 [00:07<00:19, 79.23it/s]backtest loop:  29%|██▊       | 627/2187 [00:07<00:19, 80.48it/s]backtest loop:  29%|██▉       | 637/2187 [00:07<00:19, 80.91it/s]backtest loop:  30%|██▉       | 647/2187 [00:08<00:19, 80.85it/s]backtest loop:  30%|███       | 657/2187 [00:08<00:18, 80.71it/s]backtest loop:  30%|███       | 667/2187 [00:08<00:18, 80.94it/s]backtest loop:  31%|███       | 676/2187 [00:08<00:18, 80.53it/s]backtest loop:  31%|███▏      | 686/2187 [00:08<00:18, 80.12it/s]backtest loop:  32%|███▏      | 695/2187 [00:08<00:18, 82.43it/s]backtest loop:  32%|███▏      | 704/2187 [00:08<00:18, 79.42it/s]backtest loop:  33%|███▎      | 712/2187 [00:08<00:19, 76.23it/s]backtest loop:  33%|███▎      | 721/2187 [00:09<00:19, 75.20it/s]backtest loop:  33%|███▎      | 731/2187 [00:09<00:19, 76.36it/s]backtest loop:  34%|███▍      | 739/2187 [00:09<00:18, 76.89it/s]backtest loop:  34%|███▍      | 749/2187 [00:09<00:18, 78.79it/s]backtest loop:  35%|███▍      | 759/2187 [00:09<00:17, 79.86it/s]backtest loop:  35%|███▌      | 769/2187 [00:09<00:17, 80.86it/s]backtest loop:  36%|███▌      | 779/2187 [00:09<00:16, 85.04it/s]backtest loop:  36%|███▌      | 790/2187 [00:09<00:15, 90.54it/s]backtest loop:  37%|███▋      | 801/2187 [00:09<00:14, 95.61it/s]backtest loop:  37%|███▋      | 811/2187 [00:10<00:14, 94.04it/s]backtest loop:  38%|███▊      | 823/2187 [00:10<00:13, 100.05it/s]backtest loop:  38%|███▊      | 834/2187 [00:10<00:13, 97.48it/s] backtest loop:  39%|███▊      | 845/2187 [00:10<00:13, 99.77it/s]backtest loop:  39%|███▉      | 856/2187 [00:10<00:13, 100.78it/s]backtest loop:  40%|███▉      | 867/2187 [00:10<00:12, 102.49it/s]backtest loop:  40%|████      | 878/2187 [00:10<00:12, 102.73it/s]backtest loop:  41%|████      | 889/2187 [00:10<00:13, 97.71it/s] backtest loop:  41%|████      | 899/2187 [00:10<00:13, 94.34it/s]backtest loop:  42%|████▏     | 909/2187 [00:11<00:13, 91.50it/s]backtest loop:  42%|████▏     | 919/2187 [00:11<00:14, 85.45it/s]backtest loop:  42%|████▏     | 928/2187 [00:11<00:14, 84.73it/s]backtest loop:  43%|████▎     | 938/2187 [00:11<00:14, 84.35it/s]backtest loop:  43%|████▎     | 948/2187 [00:11<00:14, 84.69it/s]backtest loop:  44%|████▍     | 958/2187 [00:11<00:14, 83.41it/s]backtest loop:  44%|████▍     | 968/2187 [00:11<00:14, 84.19it/s]backtest loop:  45%|████▍     | 977/2187 [00:11<00:15, 79.73it/s]backtest loop:  45%|████▌     | 987/2187 [00:12<00:14, 81.48it/s]backtest loop:  46%|████▌     | 996/2187 [00:12<00:14, 82.31it/s]backtest loop:  46%|████▌     | 1006/2187 [00:12<00:14, 82.48it/s]backtest loop:  46%|████▋     | 1016/2187 [00:12<00:14, 82.88it/s]backtest loop:  47%|████▋     | 1026/2187 [00:12<00:13, 84.06it/s]backtest loop:  47%|████▋     | 1036/2187 [00:12<00:13, 85.27it/s]backtest loop:  48%|████▊     | 1045/2187 [00:12<00:13, 84.62it/s]backtest loop:  48%|████▊     | 1054/2187 [00:12<00:13, 84.62it/s]backtest loop:  49%|████▊     | 1063/2187 [00:12<00:13, 82.70it/s]backtest loop:  49%|████▉     | 1072/2187 [00:13<00:13, 82.79it/s]backtest loop:  49%|████▉     | 1082/2187 [00:13<00:13, 83.57it/s]backtest loop:  50%|████▉     | 1091/2187 [00:13<00:13, 84.06it/s]backtest loop:  50%|█████     | 1100/2187 [00:13<00:12, 85.52it/s]backtest loop:  51%|█████     | 1110/2187 [00:13<00:12, 86.33it/s]backtest loop:  51%|█████     | 1120/2187 [00:13<00:12, 86.29it/s]backtest loop:  52%|█████▏    | 1130/2187 [00:13<00:12, 86.69it/s]backtest loop:  52%|█████▏    | 1140/2187 [00:13<00:12, 86.90it/s]backtest loop:  53%|█████▎    | 1150/2187 [00:13<00:11, 87.21it/s]backtest loop:  53%|█████▎    | 1159/2187 [00:14<00:12, 81.98it/s]backtest loop:  53%|█████▎    | 1169/2187 [00:14<00:12, 83.00it/s]backtest loop:  54%|█████▍    | 1179/2187 [00:14<00:11, 84.57it/s]backtest loop:  54%|█████▍    | 1189/2187 [00:14<00:11, 85.35it/s]backtest loop:  55%|█████▍    | 1199/2187 [00:14<00:11, 85.51it/s]backtest loop:  55%|█████▌    | 1209/2187 [00:14<00:11, 85.94it/s]backtest loop:  56%|█████▌    | 1218/2187 [00:14<00:11, 85.40it/s]backtest loop:  56%|█████▌    | 1228/2187 [00:14<00:11, 86.17it/s]backtest loop:  57%|█████▋    | 1238/2187 [00:14<00:11, 85.77it/s]backtest loop:  57%|█████▋    | 1247/2187 [00:15<00:11, 85.20it/s]backtest loop:  57%|█████▋    | 1256/2187 [00:15<00:10, 84.69it/s]backtest loop:  58%|█████▊    | 1265/2187 [00:15<00:10, 84.21it/s]backtest loop:  58%|█████▊    | 1274/2187 [00:15<00:10, 83.76it/s]backtest loop:  59%|█████▊    | 1283/2187 [00:15<00:10, 83.77it/s]backtest loop:  59%|█████▉    | 1292/2187 [00:15<00:10, 83.47it/s]backtest loop:  59%|█████▉    | 1301/2187 [00:15<00:10, 83.50it/s]backtest loop:  60%|█████▉    | 1310/2187 [00:15<00:10, 83.25it/s]backtest loop:  60%|██████    | 1319/2187 [00:15<00:10, 83.13it/s]backtest loop:  61%|██████    | 1328/2187 [00:16<00:10, 82.24it/s]backtest loop:  61%|██████    | 1338/2187 [00:16<00:10, 83.21it/s]backtest loop:  62%|██████▏   | 1348/2187 [00:16<00:09, 84.06it/s]backtest loop:  62%|██████▏   | 1358/2187 [00:16<00:09, 84.47it/s]backtest loop:  63%|██████▎   | 1367/2187 [00:16<00:09, 85.92it/s]backtest loop:  63%|██████▎   | 1376/2187 [00:16<00:09, 85.39it/s]backtest loop:  63%|██████▎   | 1385/2187 [00:16<00:09, 84.62it/s]backtest loop:  64%|██████▎   | 1394/2187 [00:16<00:09, 83.83it/s]backtest loop:  64%|██████▍   | 1403/2187 [00:16<00:09, 79.26it/s]backtest loop:  65%|██████▍   | 1411/2187 [00:17<00:09, 79.29it/s]backtest loop:  65%|██████▍   | 1421/2187 [00:17<00:09, 81.30it/s]backtest loop:  65%|██████▌   | 1431/2187 [00:17<00:09, 82.58it/s]backtest loop:  66%|██████▌   | 1441/2187 [00:17<00:08, 83.50it/s]backtest loop:  66%|██████▋   | 1451/2187 [00:17<00:08, 84.52it/s]backtest loop:  67%|██████▋   | 1461/2187 [00:17<00:08, 85.01it/s]backtest loop:  67%|██████▋   | 1470/2187 [00:17<00:08, 84.18it/s]backtest loop:  68%|██████▊   | 1480/2187 [00:17<00:08, 84.61it/s]backtest loop:  68%|██████▊   | 1490/2187 [00:17<00:08, 84.59it/s]backtest loop:  69%|██████▊   | 1500/2187 [00:18<00:08, 84.95it/s]backtest loop:  69%|██████▉   | 1510/2187 [00:18<00:07, 85.06it/s]backtest loop:  70%|██████▉   | 1520/2187 [00:18<00:07, 85.17it/s]backtest loop:  70%|██████▉   | 1529/2187 [00:18<00:07, 85.08it/s]backtest loop:  70%|███████   | 1538/2187 [00:18<00:07, 84.66it/s]backtest loop:  71%|███████   | 1547/2187 [00:18<00:07, 84.07it/s]backtest loop:  71%|███████   | 1556/2187 [00:18<00:07, 83.79it/s]backtest loop:  72%|███████▏  | 1565/2187 [00:18<00:07, 83.87it/s]backtest loop:  72%|███████▏  | 1574/2187 [00:18<00:07, 83.48it/s]backtest loop:  72%|███████▏  | 1584/2187 [00:19<00:07, 83.85it/s]backtest loop:  73%|███████▎  | 1594/2187 [00:19<00:06, 84.72it/s]backtest loop:  73%|███████▎  | 1604/2187 [00:19<00:06, 85.18it/s]backtest loop:  74%|███████▍  | 1614/2187 [00:19<00:06, 85.42it/s]backtest loop:  74%|███████▍  | 1624/2187 [00:19<00:06, 85.44it/s]backtest loop:  75%|███████▍  | 1633/2187 [00:19<00:06, 85.39it/s]backtest loop:  75%|███████▌  | 1643/2187 [00:19<00:06, 85.59it/s]backtest loop:  76%|███████▌  | 1653/2187 [00:19<00:06, 85.83it/s]backtest loop:  76%|███████▌  | 1663/2187 [00:20<00:06, 86.24it/s]backtest loop:  76%|███████▋  | 1673/2187 [00:20<00:05, 86.37it/s]backtest loop:  77%|███████▋  | 1683/2187 [00:20<00:05, 86.13it/s]backtest loop:  77%|███████▋  | 1693/2187 [00:20<00:05, 86.26it/s]backtest loop:  78%|███████▊  | 1703/2187 [00:20<00:05, 85.14it/s]backtest loop:  78%|███████▊  | 1712/2187 [00:20<00:05, 84.63it/s]backtest loop:  79%|███████▊  | 1722/2187 [00:20<00:05, 85.40it/s]backtest loop:  79%|███████▉  | 1732/2187 [00:20<00:05, 85.59it/s]backtest loop:  80%|███████▉  | 1742/2187 [00:20<00:05, 85.39it/s]backtest loop:  80%|████████  | 1752/2187 [00:21<00:05, 85.62it/s]backtest loop:  81%|████████  | 1762/2187 [00:21<00:04, 85.81it/s]backtest loop:  81%|████████  | 1771/2187 [00:21<00:05, 80.95it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:21<00:04, 82.83it/s]backtest loop:  82%|████████▏ | 1790/2187 [00:21<00:04, 83.00it/s]backtest loop:  82%|████████▏ | 1799/2187 [00:21<00:04, 82.85it/s]backtest loop:  83%|████████▎ | 1808/2187 [00:21<00:04, 82.24it/s]backtest loop:  83%|████████▎ | 1817/2187 [00:21<00:04, 82.12it/s]backtest loop:  83%|████████▎ | 1826/2187 [00:21<00:04, 82.96it/s]backtest loop:  84%|████████▍ | 1836/2187 [00:22<00:04, 83.83it/s]backtest loop:  84%|████████▍ | 1846/2187 [00:22<00:04, 83.33it/s]backtest loop:  85%|████████▍ | 1856/2187 [00:22<00:03, 84.01it/s]backtest loop:  85%|████████▌ | 1866/2187 [00:22<00:03, 84.49it/s]backtest loop:  86%|████████▌ | 1876/2187 [00:22<00:03, 84.08it/s]backtest loop:  86%|████████▌ | 1885/2187 [00:22<00:03, 83.42it/s]backtest loop:  87%|████████▋ | 1895/2187 [00:22<00:03, 84.44it/s]backtest loop:  87%|████████▋ | 1905/2187 [00:22<00:03, 84.75it/s]backtest loop:  88%|████████▊ | 1915/2187 [00:23<00:03, 85.13it/s]backtest loop:  88%|████████▊ | 1925/2187 [00:23<00:03, 85.43it/s]backtest loop:  88%|████████▊ | 1935/2187 [00:23<00:02, 85.52it/s]backtest loop:  89%|████████▉ | 1945/2187 [00:23<00:02, 85.80it/s]backtest loop:  89%|████████▉ | 1954/2187 [00:23<00:02, 85.37it/s]backtest loop:  90%|████████▉ | 1964/2187 [00:23<00:02, 85.90it/s]backtest loop:  90%|█████████ | 1973/2187 [00:23<00:02, 85.20it/s]backtest loop:  91%|█████████ | 1982/2187 [00:24<00:05, 34.26it/s]backtest loop:  91%|█████████ | 1990/2187 [00:24<00:04, 40.38it/s]backtest loop:  91%|█████████▏| 1998/2187 [00:24<00:04, 46.75it/s]backtest loop:  92%|█████████▏| 2006/2187 [00:24<00:03, 52.89it/s]backtest loop:  92%|█████████▏| 2016/2187 [00:24<00:02, 60.87it/s]backtest loop:  93%|█████████▎| 2025/2187 [00:24<00:02, 66.98it/s]backtest loop:  93%|█████████▎| 2034/2187 [00:24<00:02, 71.35it/s]backtest loop:  93%|█████████▎| 2043/2187 [00:25<00:01, 74.78it/s]backtest loop:  94%|█████████▍| 2052/2187 [00:25<00:01, 76.92it/s]backtest loop:  94%|█████████▍| 2062/2187 [00:25<00:01, 79.72it/s]backtest loop:  95%|█████████▍| 2072/2187 [00:25<00:01, 81.13it/s]backtest loop:  95%|█████████▌| 2082/2187 [00:25<00:01, 83.08it/s]backtest loop:  96%|█████████▌| 2092/2187 [00:25<00:01, 83.35it/s]backtest loop:  96%|█████████▌| 2102/2187 [00:25<00:01, 83.54it/s]backtest loop:  97%|█████████▋| 2112/2187 [00:25<00:00, 83.45it/s]backtest loop:  97%|█████████▋| 2121/2187 [00:26<00:00, 82.68it/s]backtest loop:  97%|█████████▋| 2130/2187 [00:26<00:00, 79.13it/s]backtest loop:  98%|█████████▊| 2140/2187 [00:26<00:00, 80.79it/s]backtest loop:  98%|█████████▊| 2150/2187 [00:26<00:00, 81.80it/s]backtest loop:  99%|█████████▉| 2160/2187 [00:26<00:00, 82.37it/s]backtest loop:  99%|█████████▉| 2170/2187 [00:26<00:00, 83.05it/s]backtest loop: 100%|█████████▉| 2180/2187 [00:26<00:00, 83.73it/s]backtest loop: 100%|██████████| 2187/2187 [00:26<00:00, 81.52it/s]
2026-01-11 23:11:44.920 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 23:11:44.920 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0632
2026-01-11 23:11:44.920 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.7159
2026-01-11 23:11:44.920 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2786
2026-01-11 23:11:50.609 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pdf/full_backtest_report.pdf
2026-01-11 23:12:10.248 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 23:12:10.475 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_222700_mlp_360_zscore_6y/pred/full_pred.parquet
[1421653:MainThread](2026-01-11 23:12:11,364) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
