Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[835789:MainThread](2026-01-11 17:25:22,464) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[835789:MainThread](2026-01-11 17:25:22,924) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[835789:MainThread](2026-01-11 17:25:22,924) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 17:25:22.933 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y
2026-01-11 17:25:22.933 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/log/gru_158_20_zscore_csi500_topk_20260111_172522.log
2026-01-11 17:25:22.933 | INFO     | __main__:__init__:115 - Model name: gru_158_20_zscore_csi500_topk
2026-01-11 17:25:22.936 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 17:25:22.936 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:25:22.936 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 17:25:22.936 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:25:22.936 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 17:25:42,143) INFO - qlib.timer - [log.py:127] - Time cost: 19.205s | Loading data Done
[835789:MainThread](2026-01-11 17:25:42,413) INFO - qlib.timer - [log.py:127] - Time cost: 0.015s | FilterCol Done
[835789:MainThread](2026-01-11 17:25:42,553) INFO - qlib.timer - [log.py:127] - Time cost: 0.139s | ZScoreNorm Done
[835789:MainThread](2026-01-11 17:25:42,617) INFO - qlib.timer - [log.py:127] - Time cost: 0.063s | Fillna Done
[835789:MainThread](2026-01-11 17:25:42,722) INFO - qlib.timer - [log.py:127] - Time cost: 0.026s | DropnaLabel Done
[835789:MainThread](2026-01-11 17:25:42,912) INFO - qlib.timer - [log.py:127] - Time cost: 0.189s | CSRankNorm Done
[835789:MainThread](2026-01-11 17:25:42,914) INFO - qlib.timer - [log.py:127] - Time cost: 0.770s | fit & process data Done
[835789:MainThread](2026-01-11 17:25:42,914) INFO - qlib.timer - [log.py:127] - Time cost: 19.977s | Init data Done
2026-01-11 17:25:42.914 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 17:25:43,147) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 17:25:43,148) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 17:25:43,173) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 17:25:43,173) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:25:44.565 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 17:25:46,351) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 17:25:46,352) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 17:25:46,353) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[835789:MainThread](2026-01-11 17:26:01,380) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:26:22,770) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991356, valid -0.992796
[835789:MainThread](2026-01-11 17:26:22,772) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 17:26:22,773) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:26:37,583) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:26:58,875) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989819, valid -0.993385
[835789:MainThread](2026-01-11 17:26:58,876) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 17:26:58,876) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:27:14,196) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:27:34,541) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988374, valid -0.992969
[835789:MainThread](2026-01-11 17:27:34,542) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 17:27:34,542) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:27:49,759) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:28:10,511) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986948, valid -0.994701
[835789:MainThread](2026-01-11 17:28:10,512) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 17:28:10,513) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:28:25,099) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:28:46,646) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985398, valid -0.995525
[835789:MainThread](2026-01-11 17:28:46,647) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 17:28:46,648) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:29:00,808) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:29:22,773) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984271, valid -0.995808
[835789:MainThread](2026-01-11 17:29:22,774) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 17:29:22,775) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:29:36,681) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:29:59,771) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983351, valid -0.996199
[835789:MainThread](2026-01-11 17:29:59,772) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 17:29:59,772) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:30:13,389) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:30:36,288) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982282, valid -0.996167
[835789:MainThread](2026-01-11 17:30:36,289) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 17:30:36,290) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:30:50,012) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:31:13,512) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981657, valid -0.995799
[835789:MainThread](2026-01-11 17:31:13,513) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 17:31:13,513) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:31:26,621) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:31:49,581) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981040, valid -0.994723
[835789:MainThread](2026-01-11 17:31:49,588) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 17:31:49,589) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:32:00,030) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:32:10,744) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980437, valid -0.995959
[835789:MainThread](2026-01-11 17:32:10,745) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 17:32:10,746) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.992796 @ 0
2026-01-11 17:32:10.800 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 17:32:13.946 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 17:32:13.947 | INFO     | __main__:train_single_fold:593 -   IC=0.0393, ICIR=0.3040, RankIC=0.0698, RankICIR=0.5564
2026-01-11 17:32:13.947 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 17:32:13,971) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 17:32:28,391) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:32:28,392) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:32:32,770) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67dc9b9dd0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▍         | 10/244 [00:00<00:02, 81.88it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:02, 86.09it/s]backtest loop:  11%|█▏        | 28/244 [00:00<00:02, 82.04it/s]backtest loop:  15%|█▌        | 37/244 [00:00<00:02, 82.45it/s]backtest loop:  19%|█▉        | 46/244 [00:00<00:02, 84.36it/s]backtest loop:  23%|██▎       | 55/244 [00:00<00:02, 83.58it/s]backtest loop:  27%|██▋       | 65/244 [00:00<00:02, 86.40it/s]backtest loop:  30%|███       | 74/244 [00:00<00:01, 86.43it/s]backtest loop:  34%|███▍      | 83/244 [00:00<00:01, 85.79it/s]backtest loop:  38%|███▊      | 93/244 [00:01<00:01, 86.41it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 86.70it/s]backtest loop:  46%|████▌     | 112/244 [00:01<00:01, 85.68it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 85.46it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:01, 85.99it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:01, 86.73it/s]backtest loop:  62%|██████▏   | 151/244 [00:01<00:01, 87.08it/s]backtest loop:  66%|██████▌   | 161/244 [00:01<00:00, 86.37it/s]backtest loop:  70%|███████   | 171/244 [00:02<00:00, 85.26it/s]backtest loop:  74%|███████▍  | 180/244 [00:02<00:00, 83.93it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 82.79it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 82.68it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 82.35it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 83.10it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 84.26it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 85.71it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 85.05it/s]
2026-01-11 17:32:35.659 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.2317, Sharpe(w/cost)=2.3165, MaxDD=-0.0369
2026-01-11 17:32:40.475 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 17:33:00.949 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 17:33:01.134 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_0_pred.parquet
2026-01-11 17:33:01.156 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:33:01.157 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 17:33:01.157 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:33:01.157 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 17:33:38,289) INFO - qlib.timer - [log.py:127] - Time cost: 37.130s | Loading data Done
[835789:MainThread](2026-01-11 17:33:38,550) INFO - qlib.timer - [log.py:127] - Time cost: 0.018s | FilterCol Done
[835789:MainThread](2026-01-11 17:33:38,718) INFO - qlib.timer - [log.py:127] - Time cost: 0.167s | ZScoreNorm Done
[835789:MainThread](2026-01-11 17:33:38,782) INFO - qlib.timer - [log.py:127] - Time cost: 0.063s | Fillna Done
[835789:MainThread](2026-01-11 17:33:38,874) INFO - qlib.timer - [log.py:127] - Time cost: 0.027s | DropnaLabel Done
[835789:MainThread](2026-01-11 17:33:39,073) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[835789:MainThread](2026-01-11 17:33:39,075) INFO - qlib.timer - [log.py:127] - Time cost: 0.784s | fit & process data Done
[835789:MainThread](2026-01-11 17:33:39,075) INFO - qlib.timer - [log.py:127] - Time cost: 37.917s | Init data Done
2026-01-11 17:33:39.076 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 17:33:39,097) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 17:33:39,098) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 17:33:39,100) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 17:33:39,101) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:33:39.112 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 17:33:41,537) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 17:33:41,538) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 17:33:41,539) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:33:51,910) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:34:07,332) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991935, valid -0.991995
[835789:MainThread](2026-01-11 17:34:07,333) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 17:34:07,334) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:34:23,020) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:34:40,610) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991082, valid -0.993259
[835789:MainThread](2026-01-11 17:34:40,610) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 17:34:40,611) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:34:56,698) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:35:17,782) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990046, valid -0.992044
[835789:MainThread](2026-01-11 17:35:17,783) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 17:35:17,783) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:35:32,631) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:35:53,408) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988985, valid -0.992217
[835789:MainThread](2026-01-11 17:35:53,408) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 17:35:53,409) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:36:08,113) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:36:26,227) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987123, valid -0.992767
[835789:MainThread](2026-01-11 17:36:26,227) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 17:36:26,228) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:36:41,584) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:37:04,361) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986331, valid -0.994038
[835789:MainThread](2026-01-11 17:37:04,362) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 17:37:04,362) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:37:19,369) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:37:38,754) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985575, valid -0.995607
[835789:MainThread](2026-01-11 17:37:38,755) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 17:37:38,755) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:37:52,936) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:38:14,781) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984137, valid -0.994425
[835789:MainThread](2026-01-11 17:38:14,782) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 17:38:14,782) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:38:30,707) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:38:50,648) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983211, valid -0.992948
[835789:MainThread](2026-01-11 17:38:50,649) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 17:38:50,649) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:39:04,578) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:39:13,983) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982174, valid -0.994900
[835789:MainThread](2026-01-11 17:39:13,984) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 17:39:13,984) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:39:21,653) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:39:31,528) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981760, valid -0.996114
[835789:MainThread](2026-01-11 17:39:31,529) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 17:39:31,530) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.991995 @ 0
2026-01-11 17:39:31.553 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 17:39:35.013 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 17:39:35.013 | INFO     | __main__:train_single_fold:593 -   IC=0.0245, ICIR=0.1909, RankIC=0.0535, RankICIR=0.4617
2026-01-11 17:39:35.013 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 17:39:35,020) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 17:39:52,201) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:39:52,202) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:39:57,051) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f66210bc2d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   0%|          | 1/244 [00:00<00:48,  4.98it/s]backtest loop:   1%|          | 3/244 [00:00<00:21, 11.11it/s]backtest loop:   5%|▍         | 11/244 [00:00<00:06, 35.92it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:04, 48.66it/s]backtest loop:  12%|█▏        | 29/244 [00:00<00:03, 61.77it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 69.10it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 74.59it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 79.47it/s]backtest loop:  28%|██▊       | 68/244 [00:01<00:02, 81.18it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 82.54it/s]backtest loop:  36%|███▌      | 87/244 [00:01<00:01, 86.38it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 83.21it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 83.01it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 84.22it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 86.46it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 89.36it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 90.38it/s]backtest loop:  63%|██████▎   | 154/244 [00:02<00:01, 86.70it/s]backtest loop:  67%|██████▋   | 164/244 [00:02<00:00, 87.66it/s]backtest loop:  71%|███████▏  | 174/244 [00:02<00:00, 87.98it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 88.68it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 88.51it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 89.93it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 91.22it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 92.20it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 92.64it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 93.24it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 79.84it/s]
2026-01-11 17:40:00.142 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0405, Sharpe(w/cost)=-0.7164, MaxDD=-0.0405
2026-01-11 17:40:03.188 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 17:40:23.516 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 17:40:23.627 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_1_pred.parquet
2026-01-11 17:40:23.643 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 17:40:23.643 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 17:40:26.440 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0450
2026-01-11 17:40:26.724 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0217, ICIR=0.1584, RankIC=0.0507
[835789:MainThread](2026-01-11 17:40:26,730) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 17:40:45,823) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:40:45,824) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:40:51,227) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f667254c2d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<01:04,  3.73it/s]backtest loop:   4%|▎         | 9/244 [00:00<00:19, 12.22it/s]backtest loop:   7%|▋         | 18/244 [00:01<00:08, 25.78it/s]backtest loop:  11%|█         | 27/244 [00:01<00:05, 38.26it/s]backtest loop:  15%|█▌        | 37/244 [00:01<00:04, 51.10it/s]backtest loop:  19%|█▉        | 47/244 [00:01<00:03, 62.09it/s]backtest loop:  23%|██▎       | 57/244 [00:01<00:02, 70.55it/s]backtest loop:  27%|██▋       | 67/244 [00:01<00:02, 74.71it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 79.87it/s]backtest loop:  36%|███▌      | 87/244 [00:01<00:01, 83.52it/s]backtest loop:  40%|███▉      | 97/244 [00:01<00:01, 86.49it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 88.70it/s]backtest loop:  48%|████▊     | 117/244 [00:02<00:01, 90.27it/s]backtest loop:  52%|█████▏    | 127/244 [00:02<00:01, 90.83it/s]backtest loop:  56%|█████▌    | 137/244 [00:02<00:01, 91.44it/s]backtest loop:  60%|██████    | 147/244 [00:02<00:01, 92.32it/s]backtest loop:  64%|██████▍   | 157/244 [00:02<00:00, 93.19it/s]backtest loop:  68%|██████▊   | 167/244 [00:02<00:00, 94.82it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 95.71it/s]backtest loop:  77%|███████▋  | 187/244 [00:02<00:00, 96.16it/s]backtest loop:  81%|████████  | 197/244 [00:02<00:00, 95.65it/s]backtest loop:  85%|████████▍ | 207/244 [00:03<00:00, 96.42it/s]backtest loop:  89%|████████▉ | 217/244 [00:03<00:00, 96.97it/s]backtest loop:  93%|█████████▎| 228/244 [00:03<00:00, 98.59it/s]backtest loop:  98%|█████████▊| 239/244 [00:03<00:00, 97.48it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 71.80it/s]
2026-01-11 17:40:54.644 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0575, Sharpe(w/cost)=-0.9679
2026-01-11 17:40:54.681 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:40:54.681 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 17:40:54.681 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:40:54.681 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 17:41:41,034) INFO - qlib.timer - [log.py:127] - Time cost: 46.351s | Loading data Done
[835789:MainThread](2026-01-11 17:41:41,284) INFO - qlib.timer - [log.py:127] - Time cost: 0.015s | FilterCol Done
[835789:MainThread](2026-01-11 17:41:41,439) INFO - qlib.timer - [log.py:127] - Time cost: 0.153s | ZScoreNorm Done
[835789:MainThread](2026-01-11 17:41:41,496) INFO - qlib.timer - [log.py:127] - Time cost: 0.056s | Fillna Done
[835789:MainThread](2026-01-11 17:41:41,559) INFO - qlib.timer - [log.py:127] - Time cost: 0.025s | DropnaLabel Done
[835789:MainThread](2026-01-11 17:41:41,752) INFO - qlib.timer - [log.py:127] - Time cost: 0.192s | CSRankNorm Done
[835789:MainThread](2026-01-11 17:41:41,753) INFO - qlib.timer - [log.py:127] - Time cost: 0.718s | fit & process data Done
[835789:MainThread](2026-01-11 17:41:41,753) INFO - qlib.timer - [log.py:127] - Time cost: 47.072s | Init data Done
2026-01-11 17:41:41.754 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 17:41:41,767) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 17:41:41,768) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 17:41:41,770) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 17:41:41,770) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:41:41.781 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 17:41:43,516) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 17:41:43,517) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 17:41:43,517) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:41:54,360) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:42:14,476) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991626, valid -0.993903
[835789:MainThread](2026-01-11 17:42:14,478) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 17:42:14,478) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:42:27,727) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:42:45,920) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990482, valid -0.993338
[835789:MainThread](2026-01-11 17:42:45,922) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 17:42:45,922) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:42:59,788) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:43:17,410) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988945, valid -0.992864
[835789:MainThread](2026-01-11 17:43:17,411) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 17:43:17,412) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:43:30,888) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:43:49,127) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988298, valid -0.994625
[835789:MainThread](2026-01-11 17:43:49,128) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 17:43:49,128) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:44:00,726) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:44:16,189) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986994, valid -0.992480
[835789:MainThread](2026-01-11 17:44:16,190) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 17:44:16,191) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:44:28,962) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:44:49,558) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985291, valid -0.992007
[835789:MainThread](2026-01-11 17:44:49,560) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 17:44:49,560) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:45:04,164) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:45:27,381) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984116, valid -0.992038
[835789:MainThread](2026-01-11 17:45:27,381) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 17:45:27,382) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:45:42,572) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:46:04,788) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983271, valid -0.991829
[835789:MainThread](2026-01-11 17:46:04,789) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 17:46:04,790) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:46:20,349) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:46:40,905) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981901, valid -0.991638
[835789:MainThread](2026-01-11 17:46:40,907) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 17:46:40,907) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:46:55,977) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:47:17,221) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982108, valid -0.991206
[835789:MainThread](2026-01-11 17:47:17,223) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 17:47:17,223) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:47:29,784) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:47:50,922) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981219, valid -0.993287
[835789:MainThread](2026-01-11 17:47:50,923) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835789:MainThread](2026-01-11 17:47:50,924) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:48:03,346) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:48:25,356) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980219, valid -0.990560
[835789:MainThread](2026-01-11 17:48:25,358) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835789:MainThread](2026-01-11 17:48:25,358) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:48:39,012) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:49:00,256) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.979695, valid -0.991730
[835789:MainThread](2026-01-11 17:49:00,257) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch13:
[835789:MainThread](2026-01-11 17:49:00,257) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:49:14,488) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:49:36,310) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.978592, valid -0.992028
[835789:MainThread](2026-01-11 17:49:36,310) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch14:
[835789:MainThread](2026-01-11 17:49:36,311) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:49:51,466) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:50:14,056) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.977812, valid -0.991089
[835789:MainThread](2026-01-11 17:50:14,057) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch15:
[835789:MainThread](2026-01-11 17:50:14,057) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:50:27,272) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:50:47,759) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.977088, valid -0.993139
[835789:MainThread](2026-01-11 17:50:47,760) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch16:
[835789:MainThread](2026-01-11 17:50:47,760) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:51:01,202) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:51:19,142) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.976824, valid -0.993346
[835789:MainThread](2026-01-11 17:51:19,143) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch17:
[835789:MainThread](2026-01-11 17:51:19,143) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:51:29,723) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:51:46,953) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.975484, valid -0.991488
[835789:MainThread](2026-01-11 17:51:46,954) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch18:
[835789:MainThread](2026-01-11 17:51:46,955) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:51:55,404) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:52:12,496) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.975497, valid -0.991738
[835789:MainThread](2026-01-11 17:52:12,496) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch19:
[835789:MainThread](2026-01-11 17:52:12,497) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:52:21,193) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:52:38,621) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.973911, valid -0.991852
[835789:MainThread](2026-01-11 17:52:38,622) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch20:
[835789:MainThread](2026-01-11 17:52:38,623) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:52:47,805) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:53:05,128) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.974100, valid -0.992267
[835789:MainThread](2026-01-11 17:53:05,129) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch21:
[835789:MainThread](2026-01-11 17:53:05,129) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:53:14,195) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:53:30,262) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.972732, valid -0.991783
[835789:MainThread](2026-01-11 17:53:30,263) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 17:53:30,264) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.990560 @ 11
2026-01-11 17:53:30.284 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 17:53:33.633 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 17:53:33.634 | INFO     | __main__:train_single_fold:593 -   IC=0.0338, ICIR=0.3514, RankIC=0.0400, RankICIR=0.4579
2026-01-11 17:53:33.634 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 17:53:33,641) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 17:53:58,271) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:53:58,272) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:54:03,416) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d7d942d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 36.41it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 67.77it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 79.86it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:02, 82.65it/s]backtest loop:  18%|█▊        | 44/243 [00:00<00:02, 85.89it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 87.91it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:01, 90.07it/s]backtest loop:  30%|███       | 74/243 [00:00<00:01, 90.37it/s]backtest loop:  35%|███▍      | 84/243 [00:00<00:01, 90.79it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:01, 91.91it/s]backtest loop:  43%|████▎     | 104/243 [00:01<00:01, 92.69it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 88.26it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 87.88it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 86.09it/s]backtest loop:  59%|█████▉    | 144/243 [00:01<00:01, 84.35it/s]backtest loop:  63%|██████▎   | 153/243 [00:01<00:01, 84.38it/s]backtest loop:  67%|██████▋   | 162/243 [00:01<00:00, 82.52it/s]backtest loop:  70%|███████   | 171/243 [00:02<00:00, 80.89it/s]backtest loop:  74%|███████▍  | 180/243 [00:02<00:00, 79.80it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 79.64it/s]backtest loop:  81%|████████  | 197/243 [00:02<00:00, 81.66it/s]backtest loop:  85%|████████▍ | 206/243 [00:02<00:00, 80.44it/s]backtest loop:  88%|████████▊ | 215/243 [00:02<00:00, 79.64it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 78.37it/s]backtest loop:  95%|█████████▌| 232/243 [00:02<00:00, 80.74it/s]backtest loop:  99%|█████████▉| 241/243 [00:02<00:00, 80.89it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.04it/s]
2026-01-11 17:54:06.359 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0777, Sharpe(w/cost)=-1.2165, MaxDD=-0.1275
2026-01-11 17:54:11.199 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 17:54:29.432 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 17:54:29.485 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_2_pred.parquet
2026-01-11 17:54:29.504 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 17:54:29.504 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 17:54:33.052 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0311
2026-01-11 17:54:36.789 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0326
2026-01-11 17:54:37.086 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0321, ICIR=0.3024, RankIC=0.0409
[835789:MainThread](2026-01-11 17:54:37,092) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 17:55:00,381) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:55:00,382) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 17:55:05,987) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67dc12f610>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 38.78it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 71.55it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 83.84it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:02, 85.60it/s]backtest loop:  18%|█▊        | 43/243 [00:00<00:02, 87.11it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:02, 83.26it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:02, 80.37it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:02, 80.37it/s]backtest loop:  33%|███▎      | 79/243 [00:00<00:02, 77.98it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 73.05it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:02, 71.48it/s]backtest loop:  42%|████▏     | 103/243 [00:01<00:01, 72.78it/s]backtest loop:  46%|████▌     | 111/243 [00:01<00:01, 69.74it/s]backtest loop:  49%|████▉     | 119/243 [00:01<00:01, 68.22it/s]backtest loop:  52%|█████▏    | 127/243 [00:01<00:01, 69.62it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 67.41it/s]backtest loop:  58%|█████▊    | 142/243 [00:01<00:01, 69.81it/s]backtest loop:  62%|██████▏   | 150/243 [00:02<00:01, 68.63it/s]backtest loop:  65%|██████▌   | 158/243 [00:02<00:01, 70.54it/s]backtest loop:  68%|██████▊   | 166/243 [00:02<00:01, 68.45it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:01, 67.05it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 69.13it/s]backtest loop:  78%|███████▊  | 189/243 [00:02<00:00, 67.98it/s]backtest loop:  81%|████████  | 197/243 [00:02<00:00, 69.51it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 66.66it/s]backtest loop:  87%|████████▋ | 212/243 [00:02<00:00, 69.64it/s]backtest loop:  91%|█████████ | 220/243 [00:03<00:00, 71.26it/s]backtest loop:  94%|█████████▍| 228/243 [00:03<00:00, 72.25it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 75.49it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 72.77it/s]
2026-01-11 17:55:09.346 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0766, Sharpe(w/cost)=-1.2298
2026-01-11 17:55:09.380 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 17:55:09.380 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 17:55:09.380 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 17:55:09.380 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 17:56:02,069) INFO - qlib.timer - [log.py:127] - Time cost: 52.687s | Loading data Done
[835789:MainThread](2026-01-11 17:56:02,323) INFO - qlib.timer - [log.py:127] - Time cost: 0.016s | FilterCol Done
[835789:MainThread](2026-01-11 17:56:02,484) INFO - qlib.timer - [log.py:127] - Time cost: 0.160s | ZScoreNorm Done
[835789:MainThread](2026-01-11 17:56:02,548) INFO - qlib.timer - [log.py:127] - Time cost: 0.063s | Fillna Done
[835789:MainThread](2026-01-11 17:56:02,623) INFO - qlib.timer - [log.py:127] - Time cost: 0.030s | DropnaLabel Done
[835789:MainThread](2026-01-11 17:56:02,815) INFO - qlib.timer - [log.py:127] - Time cost: 0.191s | CSRankNorm Done
[835789:MainThread](2026-01-11 17:56:02,816) INFO - qlib.timer - [log.py:127] - Time cost: 0.746s | fit & process data Done
[835789:MainThread](2026-01-11 17:56:02,816) INFO - qlib.timer - [log.py:127] - Time cost: 53.435s | Init data Done
2026-01-11 17:56:02.816 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 17:56:02,834) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 17:56:02,839) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 17:56:02,842) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 17:56:02,842) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 17:56:02.853 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 17:56:04,965) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 17:56:04,966) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 17:56:04,966) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:56:11,680) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:56:22,129) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991645, valid -0.998002
[835789:MainThread](2026-01-11 17:56:22,130) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 17:56:22,131) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:56:31,346) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:56:42,655) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990274, valid -0.996640
[835789:MainThread](2026-01-11 17:56:42,657) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 17:56:42,657) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:56:52,518) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:57:09,772) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989092, valid -0.998225
[835789:MainThread](2026-01-11 17:57:09,773) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 17:57:09,773) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:57:24,652) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:57:43,795) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987416, valid -0.996267
[835789:MainThread](2026-01-11 17:57:43,797) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 17:57:43,798) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:57:54,734) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:58:08,454) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986018, valid -0.997296
[835789:MainThread](2026-01-11 17:58:08,455) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 17:58:08,456) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:58:17,678) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:58:32,013) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984842, valid -0.996295
[835789:MainThread](2026-01-11 17:58:32,014) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 17:58:32,014) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:58:40,886) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:58:56,169) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983901, valid -0.997990
[835789:MainThread](2026-01-11 17:58:56,170) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 17:58:56,170) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:59:06,271) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:59:21,598) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983036, valid -0.997747
[835789:MainThread](2026-01-11 17:59:21,599) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 17:59:21,600) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:59:29,796) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 17:59:43,809) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981450, valid -0.997534
[835789:MainThread](2026-01-11 17:59:43,809) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 17:59:43,810) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 17:59:53,154) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:00:05,646) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981020, valid -0.999594
[835789:MainThread](2026-01-11 18:00:05,646) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 18:00:05,647) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:00:17,953) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:00:33,403) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980208, valid -0.998882
[835789:MainThread](2026-01-11 18:00:33,404) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835789:MainThread](2026-01-11 18:00:33,404) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:00:42,899) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:00:58,598) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.980382, valid -0.999249
[835789:MainThread](2026-01-11 18:00:58,599) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835789:MainThread](2026-01-11 18:00:58,599) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:01:09,301) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:01:30,312) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.978084, valid -0.997662
[835789:MainThread](2026-01-11 18:01:30,313) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch13:
[835789:MainThread](2026-01-11 18:01:30,313) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:01:45,917) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:02:06,957) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.977292, valid -0.998779
[835789:MainThread](2026-01-11 18:02:06,957) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 18:02:06,958) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.996267 @ 3
2026-01-11 18:02:06.978 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:02:13.255 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 18:02:13.255 | INFO     | __main__:train_single_fold:593 -   IC=0.0119, ICIR=0.1066, RankIC=0.0425, RankICIR=0.4181
2026-01-11 18:02:13.255 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 18:02:13,268) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:02:42,730) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:02:42,733) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:02:49,717) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d6b47610>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:14, 16.71it/s]backtest loop:   3%|▎         | 8/244 [00:00<00:07, 29.64it/s]backtest loop:   6%|▌         | 15/244 [00:00<00:05, 43.98it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:04, 51.51it/s]backtest loop:  11%|█▏        | 28/244 [00:00<00:04, 52.78it/s]backtest loop:  14%|█▍        | 35/244 [00:00<00:03, 57.64it/s]backtest loop:  17%|█▋        | 42/244 [00:00<00:03, 61.23it/s]backtest loop:  20%|██        | 49/244 [00:00<00:03, 60.63it/s]backtest loop:  23%|██▎       | 56/244 [00:01<00:02, 63.31it/s]backtest loop:  26%|██▌       | 63/244 [00:01<00:02, 61.63it/s]backtest loop:  29%|██▊       | 70/244 [00:01<00:02, 63.68it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 60.91it/s]backtest loop:  34%|███▍      | 84/244 [00:01<00:02, 60.02it/s]backtest loop:  37%|███▋      | 91/244 [00:01<00:02, 62.29it/s]backtest loop:  40%|████      | 98/244 [00:01<00:02, 64.31it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:02, 61.60it/s]backtest loop:  46%|████▌     | 112/244 [00:01<00:02, 63.86it/s]backtest loop:  49%|████▉     | 119/244 [00:02<00:02, 61.52it/s]backtest loop:  52%|█████▏    | 126/244 [00:02<00:01, 60.12it/s]backtest loop:  55%|█████▍    | 133/244 [00:02<00:01, 55.52it/s]backtest loop:  57%|█████▋    | 139/244 [00:02<00:01, 56.04it/s]backtest loop:  60%|█████▉    | 146/244 [00:02<00:01, 59.01it/s]backtest loop:  62%|██████▏   | 152/244 [00:02<00:01, 59.06it/s]backtest loop:  65%|██████▍   | 158/244 [00:02<00:01, 55.60it/s]backtest loop:  68%|██████▊   | 166/244 [00:02<00:01, 61.61it/s]backtest loop:  71%|███████   | 173/244 [00:02<00:01, 59.64it/s]backtest loop:  75%|███████▍  | 182/244 [00:03<00:00, 64.32it/s]backtest loop:  77%|███████▋  | 189/244 [00:03<00:00, 63.69it/s]backtest loop:  81%|████████  | 197/244 [00:03<00:00, 63.12it/s]backtest loop:  84%|████████▍ | 206/244 [00:03<00:00, 69.12it/s]backtest loop:  87%|████████▋ | 213/244 [00:03<00:00, 69.13it/s]backtest loop:  91%|█████████ | 221/244 [00:03<00:00, 70.89it/s]backtest loop:  94%|█████████▍| 229/244 [00:03<00:00, 68.63it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 66.89it/s]backtest loop: 100%|██████████| 244/244 [00:04<00:00, 66.95it/s]backtest loop: 100%|██████████| 244/244 [00:04<00:00, 60.64it/s]
2026-01-11 18:02:53.765 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0134, Sharpe(w/cost)=-0.2245, MaxDD=-0.0714
2026-01-11 18:02:57.531 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 18:03:15.109 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:03:15.194 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_3_pred.parquet
2026-01-11 18:03:15.225 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 18:03:15.225 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 18:03:22.291 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0413
2026-01-11 18:03:28.746 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0470
2026-01-11 18:03:32.771 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0393
2026-01-11 18:03:33.148 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0170, ICIR=0.1453, RankIC=0.0449
[835789:MainThread](2026-01-11 18:03:33,155) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:04:01,874) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:04:01,875) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:04:07,747) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d58342d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 29.92it/s]backtest loop:   5%|▍         | 12/244 [00:00<00:03, 64.38it/s]backtest loop:   8%|▊         | 20/244 [00:00<00:03, 69.63it/s]backtest loop:  11%|█▏        | 28/244 [00:00<00:03, 71.68it/s]backtest loop:  15%|█▌        | 37/244 [00:00<00:02, 78.01it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:02, 76.76it/s]backtest loop:  22%|██▏       | 53/244 [00:00<00:02, 75.85it/s]backtest loop:  25%|██▌       | 62/244 [00:00<00:02, 75.98it/s]backtest loop:  29%|██▉       | 71/244 [00:00<00:02, 79.51it/s]backtest loop:  32%|███▏      | 79/244 [00:01<00:02, 74.85it/s]backtest loop:  36%|███▌      | 88/244 [00:01<00:01, 78.58it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 77.31it/s]backtest loop:  43%|████▎     | 104/244 [00:01<00:01, 76.42it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 76.45it/s]backtest loop:  50%|█████     | 122/244 [00:01<00:01, 79.85it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:01, 78.71it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 77.67it/s]backtest loop:  60%|██████    | 147/244 [00:01<00:01, 78.22it/s]backtest loop:  64%|██████▎   | 155/244 [00:02<00:01, 76.73it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 76.43it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 76.58it/s]backtest loop:  74%|███████▍  | 181/244 [00:02<00:00, 79.95it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 75.52it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 78.41it/s]backtest loop:  85%|████████▌ | 208/244 [00:02<00:00, 81.09it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 82.87it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 84.83it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 86.17it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 78.11it/s]
2026-01-11 18:04:10.888 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0108, Sharpe(w/cost)=0.1762
2026-01-11 18:04:10.920 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:04:10.921 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 18:04:10.921 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:04:10.921 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 18:05:03,101) INFO - qlib.timer - [log.py:127] - Time cost: 52.178s | Loading data Done
[835789:MainThread](2026-01-11 18:05:03,335) INFO - qlib.timer - [log.py:127] - Time cost: 0.014s | FilterCol Done
[835789:MainThread](2026-01-11 18:05:03,491) INFO - qlib.timer - [log.py:127] - Time cost: 0.155s | ZScoreNorm Done
[835789:MainThread](2026-01-11 18:05:03,560) INFO - qlib.timer - [log.py:127] - Time cost: 0.069s | Fillna Done
[835789:MainThread](2026-01-11 18:05:03,625) INFO - qlib.timer - [log.py:127] - Time cost: 0.026s | DropnaLabel Done
[835789:MainThread](2026-01-11 18:05:03,799) INFO - qlib.timer - [log.py:127] - Time cost: 0.173s | CSRankNorm Done
[835789:MainThread](2026-01-11 18:05:03,800) INFO - qlib.timer - [log.py:127] - Time cost: 0.698s | fit & process data Done
[835789:MainThread](2026-01-11 18:05:03,800) INFO - qlib.timer - [log.py:127] - Time cost: 52.879s | Init data Done
2026-01-11 18:05:03.801 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 18:05:03,810) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 18:05:03,810) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 18:05:03,812) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 18:05:03,812) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:05:03.822 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 18:05:06,125) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 18:05:06,126) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 18:05:06,126) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:05:14,506) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:05:22,315) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992156, valid -0.995725
[835789:MainThread](2026-01-11 18:05:22,317) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 18:05:22,317) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:05:27,573) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:05:36,148) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990763, valid -0.995923
[835789:MainThread](2026-01-11 18:05:36,148) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 18:05:36,148) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:05:41,606) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:05:50,397) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989517, valid -0.996750
[835789:MainThread](2026-01-11 18:05:50,398) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 18:05:50,398) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:05:56,044) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:06:03,720) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988072, valid -0.996828
[835789:MainThread](2026-01-11 18:06:03,721) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 18:06:03,721) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:06:09,652) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:06:19,740) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986578, valid -0.997376
[835789:MainThread](2026-01-11 18:06:19,740) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 18:06:19,741) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:06:26,200) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:06:34,374) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.985485, valid -0.997653
[835789:MainThread](2026-01-11 18:06:34,376) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 18:06:34,376) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:06:40,543) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:06:49,808) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984561, valid -0.998420
[835789:MainThread](2026-01-11 18:06:49,809) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 18:06:49,809) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:06:58,262) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:07:12,814) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983729, valid -0.998415
[835789:MainThread](2026-01-11 18:07:12,815) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 18:07:12,815) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:07:22,221) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:07:39,117) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982684, valid -0.999106
[835789:MainThread](2026-01-11 18:07:39,118) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 18:07:39,119) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:07:48,723) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:08:02,606) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982722, valid -0.999907
[835789:MainThread](2026-01-11 18:08:02,606) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 18:08:02,607) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:08:13,619) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:08:31,559) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981278, valid -0.999846
[835789:MainThread](2026-01-11 18:08:31,559) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 18:08:31,560) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.995725 @ 0
2026-01-11 18:08:31.582 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:08:35.518 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 18:08:35.518 | INFO     | __main__:train_single_fold:593 -   IC=0.0042, ICIR=0.0315, RankIC=0.0357, RankICIR=0.2982
2026-01-11 18:08:35.518 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 18:08:35,525) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:09:06,226) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:09:06,228) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:09:13,913) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d75642d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 24.02it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 53.55it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 63.50it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 72.38it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 73.34it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 74.25it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 79.02it/s]backtest loop:  26%|██▌       | 63/243 [00:00<00:02, 77.82it/s]backtest loop:  29%|██▉       | 71/243 [00:00<00:02, 76.99it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 76.05it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 75.65it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 77.58it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 80.95it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 76.84it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 79.82it/s]backtest loop:  55%|█████▍    | 133/243 [00:01<00:01, 75.76it/s]backtest loop:  58%|█████▊    | 141/243 [00:01<00:01, 71.95it/s]backtest loop:  61%|██████▏   | 149/243 [00:02<00:01, 73.69it/s]backtest loop:  65%|██████▍   | 157/243 [00:02<00:01, 69.54it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:01, 66.49it/s]backtest loop:  71%|███████   | 172/243 [00:02<00:01, 67.25it/s]backtest loop:  74%|███████▍  | 180/243 [00:02<00:00, 65.53it/s]backtest loop:  77%|███████▋  | 187/243 [00:02<00:00, 63.96it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 62.78it/s]backtest loop:  83%|████████▎ | 201/243 [00:02<00:00, 64.34it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 63.57it/s]backtest loop:  89%|████████▉ | 216/243 [00:03<00:00, 65.14it/s]backtest loop:  92%|█████████▏| 223/243 [00:03<00:00, 66.44it/s]backtest loop:  95%|█████████▍| 230/243 [00:03<00:00, 63.66it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 66.02it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 69.26it/s]
2026-01-11 18:09:17.446 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0693, Sharpe(w/cost)=-0.8147, MaxDD=-0.1145
2026-01-11 18:09:20.923 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 18:09:37.347 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:09:37.400 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_4_pred.parquet
2026-01-11 18:09:37.421 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 18:09:37.422 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 18:09:44.178 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0328
2026-01-11 18:09:50.077 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0333
2026-01-11 18:09:53.948 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0423
2026-01-11 18:10:00.579 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0426
2026-01-11 18:10:00.945 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0057, ICIR=0.0405, RankIC=0.0394
[835789:MainThread](2026-01-11 18:10:00,952) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:10:32,453) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:10:32,454) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:10:39,822) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d76b90d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 25.02it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 54.87it/s]backtest loop:   8%|▊         | 19/243 [00:00<00:03, 63.65it/s]backtest loop:  11%|█         | 27/243 [00:00<00:03, 67.69it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 71.20it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 76.18it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 78.41it/s]backtest loop:  26%|██▌       | 63/243 [00:00<00:02, 79.92it/s]backtest loop:  30%|██▉       | 72/243 [00:00<00:02, 79.02it/s]backtest loop:  33%|███▎      | 80/243 [00:01<00:02, 77.75it/s]backtest loop:  36%|███▌      | 88/243 [00:01<00:02, 75.72it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 75.94it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 78.64it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 77.17it/s]backtest loop:  50%|█████     | 122/243 [00:01<00:01, 76.23it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 75.81it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 79.25it/s]backtest loop:  60%|██████    | 147/243 [00:01<00:01, 74.02it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 73.92it/s]backtest loop:  67%|██████▋   | 163/243 [00:02<00:01, 66.58it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:01, 64.81it/s]backtest loop:  73%|███████▎  | 178/243 [00:02<00:00, 67.30it/s]backtest loop:  76%|███████▌  | 185/243 [00:02<00:00, 62.87it/s]backtest loop:  79%|███████▉  | 192/243 [00:02<00:00, 64.42it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 62.73it/s]backtest loop:  85%|████████▍ | 206/243 [00:02<00:00, 64.55it/s]backtest loop:  88%|████████▊ | 213/243 [00:03<00:00, 65.82it/s]backtest loop:  91%|█████████ | 220/243 [00:03<00:00, 63.70it/s]backtest loop:  93%|█████████▎| 227/243 [00:03<00:00, 65.31it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 63.55it/s]backtest loop:  99%|█████████▉| 241/243 [00:03<00:00, 64.99it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 69.46it/s]
2026-01-11 18:10:43.343 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0547, Sharpe(w/cost)=-0.6119
2026-01-11 18:10:43.496 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:10:43.496 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 18:10:43.496 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:10:43.497 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 18:11:49,899) INFO - qlib.timer - [log.py:127] - Time cost: 66.400s | Loading data Done
[835789:MainThread](2026-01-11 18:11:50,168) INFO - qlib.timer - [log.py:127] - Time cost: 0.019s | FilterCol Done
[835789:MainThread](2026-01-11 18:11:50,339) INFO - qlib.timer - [log.py:127] - Time cost: 0.169s | ZScoreNorm Done
[835789:MainThread](2026-01-11 18:11:50,410) INFO - qlib.timer - [log.py:127] - Time cost: 0.070s | Fillna Done
[835789:MainThread](2026-01-11 18:11:50,482) INFO - qlib.timer - [log.py:127] - Time cost: 0.030s | DropnaLabel Done
[835789:MainThread](2026-01-11 18:11:50,678) INFO - qlib.timer - [log.py:127] - Time cost: 0.196s | CSRankNorm Done
[835789:MainThread](2026-01-11 18:11:50,679) INFO - qlib.timer - [log.py:127] - Time cost: 0.780s | fit & process data Done
[835789:MainThread](2026-01-11 18:11:50,680) INFO - qlib.timer - [log.py:127] - Time cost: 67.182s | Init data Done
2026-01-11 18:11:50.680 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 18:11:50,690) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 18:11:50,691) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 18:11:50,694) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 18:11:50,694) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:11:50.705 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 18:11:52,651) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 18:11:52,651) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 18:11:52,652) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:11:58,939) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:12:07,830) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993054, valid -0.995454
[835789:MainThread](2026-01-11 18:12:07,832) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 18:12:07,832) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:12:14,442) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:12:25,534) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991947, valid -0.995143
[835789:MainThread](2026-01-11 18:12:25,535) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 18:12:25,536) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:12:32,988) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:12:42,433) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990460, valid -0.994840
[835789:MainThread](2026-01-11 18:12:42,434) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 18:12:42,435) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:12:48,129) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:12:56,877) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989673, valid -0.995216
[835789:MainThread](2026-01-11 18:12:56,878) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 18:12:56,878) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:13:03,608) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:13:13,584) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988350, valid -0.995230
[835789:MainThread](2026-01-11 18:13:13,584) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 18:13:13,585) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:13:19,021) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:13:26,712) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987306, valid -0.995759
[835789:MainThread](2026-01-11 18:13:26,713) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 18:13:26,713) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:13:32,464) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:13:42,437) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986862, valid -0.997040
[835789:MainThread](2026-01-11 18:13:42,437) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 18:13:42,438) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:13:49,784) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:13:58,671) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986029, valid -0.996256
[835789:MainThread](2026-01-11 18:13:58,671) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 18:13:58,672) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:14:04,229) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:14:12,469) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984831, valid -0.997662
[835789:MainThread](2026-01-11 18:14:12,469) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 18:14:12,470) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:14:19,919) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:14:30,263) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.984511, valid -0.997531
[835789:MainThread](2026-01-11 18:14:30,264) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 18:14:30,264) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:14:36,893) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:14:47,584) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.983294, valid -0.997327
[835789:MainThread](2026-01-11 18:14:47,584) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835789:MainThread](2026-01-11 18:14:47,585) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:14:55,316) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:15:15,042) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.982698, valid -0.997751
[835789:MainThread](2026-01-11 18:15:15,043) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch12:
[835789:MainThread](2026-01-11 18:15:15,044) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:15:24,647) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:15:42,245) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.981763, valid -0.997653
[835789:MainThread](2026-01-11 18:15:42,246) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 18:15:42,246) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.994840 @ 2
2026-01-11 18:15:42.268 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:15:47.198 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 18:15:47.198 | INFO     | __main__:train_single_fold:593 -   IC=0.0043, ICIR=0.0360, RankIC=0.0325, RankICIR=0.2758
2026-01-11 18:15:47.198 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 18:15:47,205) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:16:21,767) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:16:21,768) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:16:29,725) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d6b32390>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 28.47it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:05, 45.79it/s]backtest loop:   7%|▋         | 17/243 [00:00<00:04, 55.38it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:03, 60.46it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:03, 56.66it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:03, 60.47it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:03, 60.18it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:03, 62.62it/s]backtest loop:  24%|██▍       | 59/243 [00:00<00:02, 64.61it/s]backtest loop:  27%|██▋       | 66/243 [00:01<00:02, 63.22it/s]backtest loop:  30%|███       | 73/243 [00:01<00:02, 64.37it/s]backtest loop:  33%|███▎      | 80/243 [00:01<00:02, 62.25it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 62.99it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:02, 65.69it/s]backtest loop:  43%|████▎     | 104/243 [00:01<00:02, 69.36it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 70.94it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 69.46it/s]backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 74.55it/s]backtest loop:  56%|█████▋    | 137/243 [00:02<00:01, 75.22it/s]backtest loop:  60%|█████▉    | 145/243 [00:02<00:01, 75.23it/s]backtest loop:  63%|██████▎   | 154/243 [00:02<00:01, 79.02it/s]backtest loop:  67%|██████▋   | 162/243 [00:02<00:01, 77.87it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 75.50it/s]backtest loop:  73%|███████▎  | 178/243 [00:02<00:00, 75.55it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 75.70it/s]backtest loop:  80%|███████▉  | 194/243 [00:02<00:00, 75.55it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 75.43it/s]backtest loop:  87%|████████▋ | 212/243 [00:03<00:00, 78.58it/s]backtest loop:  91%|█████████ | 220/243 [00:03<00:00, 74.51it/s]backtest loop:  94%|█████████▍| 228/243 [00:03<00:00, 70.39it/s]backtest loop:  97%|█████████▋| 236/243 [00:03<00:00, 70.87it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 68.40it/s]
2026-01-11 18:16:33.301 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0248, Sharpe(w/cost)=0.2604, MaxDD=-0.0850
2026-01-11 18:16:37.443 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 18:16:54.428 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:16:54.479 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_5_pred.parquet
2026-01-11 18:16:54.499 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 18:16:54.499 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 18:17:01.285 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0249
2026-01-11 18:17:05.456 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0236
2026-01-11 18:17:12.372 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0249
2026-01-11 18:17:17.004 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0250
2026-01-11 18:17:23.763 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0252
2026-01-11 18:17:24.131 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0031, ICIR=0.0244, RankIC=0.0307
[835789:MainThread](2026-01-11 18:17:24,138) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:17:58,861) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:17:58,862) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:18:06,888) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67cf51be90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:11, 21.50it/s]backtest loop:   3%|▎         | 8/243 [00:00<00:06, 34.66it/s]backtest loop:   6%|▌         | 15/243 [00:00<00:04, 45.68it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:04, 50.07it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:04, 53.03it/s]backtest loop:  14%|█▍        | 35/243 [00:00<00:03, 55.90it/s]backtest loop:  18%|█▊        | 43/243 [00:00<00:03, 61.34it/s]backtest loop:  21%|██        | 50/243 [00:00<00:03, 60.48it/s]backtest loop:  23%|██▎       | 57/243 [00:01<00:02, 63.11it/s]backtest loop:  26%|██▋       | 64/243 [00:01<00:02, 61.89it/s]backtest loop:  29%|██▉       | 71/243 [00:01<00:02, 62.44it/s]backtest loop:  32%|███▏      | 78/243 [00:01<00:02, 64.35it/s]backtest loop:  35%|███▍      | 85/243 [00:01<00:02, 62.99it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:02, 62.53it/s]backtest loop:  41%|████      | 99/243 [00:01<00:02, 64.34it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:02, 63.31it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 65.86it/s]backtest loop:  50%|████▉     | 121/243 [00:02<00:01, 63.66it/s]backtest loop:  53%|█████▎    | 128/243 [00:02<00:01, 65.25it/s]backtest loop:  56%|█████▌    | 135/243 [00:02<00:01, 63.71it/s]backtest loop:  58%|█████▊    | 142/243 [00:02<00:01, 65.31it/s]backtest loop:  61%|██████▏   | 149/243 [00:02<00:01, 66.53it/s]backtest loop:  64%|██████▍   | 156/243 [00:02<00:01, 63.86it/s]backtest loop:  67%|██████▋   | 163/243 [00:02<00:01, 65.32it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:01, 63.22it/s]backtest loop:  73%|███████▎  | 177/243 [00:02<00:01, 64.97it/s]backtest loop:  76%|███████▌  | 184/243 [00:03<00:00, 61.03it/s]backtest loop:  79%|███████▉  | 192/243 [00:03<00:00, 64.27it/s]backtest loop:  82%|████████▏ | 199/243 [00:03<00:00, 62.54it/s]backtest loop:  85%|████████▍ | 206/243 [00:03<00:00, 64.45it/s]backtest loop:  88%|████████▊ | 213/243 [00:03<00:00, 62.82it/s]backtest loop:  91%|█████████ | 221/243 [00:03<00:00, 66.75it/s]backtest loop:  94%|█████████▍| 228/243 [00:03<00:00, 67.21it/s]backtest loop:  98%|█████████▊| 237/243 [00:03<00:00, 72.91it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 62.68it/s]
2026-01-11 18:18:10.786 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0679, Sharpe(w/cost)=-0.7285
2026-01-11 18:18:10.832 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:18:10.832 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 18:18:10.832 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:18:10.832 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 18:19:23,443) INFO - qlib.timer - [log.py:127] - Time cost: 72.609s | Loading data Done
[835789:MainThread](2026-01-11 18:19:23,711) INFO - qlib.timer - [log.py:127] - Time cost: 0.020s | FilterCol Done
[835789:MainThread](2026-01-11 18:19:23,883) INFO - qlib.timer - [log.py:127] - Time cost: 0.172s | ZScoreNorm Done
[835789:MainThread](2026-01-11 18:19:23,972) INFO - qlib.timer - [log.py:127] - Time cost: 0.087s | Fillna Done
[835789:MainThread](2026-01-11 18:19:24,062) INFO - qlib.timer - [log.py:127] - Time cost: 0.032s | DropnaLabel Done
[835789:MainThread](2026-01-11 18:19:24,276) INFO - qlib.timer - [log.py:127] - Time cost: 0.213s | CSRankNorm Done
[835789:MainThread](2026-01-11 18:19:24,277) INFO - qlib.timer - [log.py:127] - Time cost: 0.833s | fit & process data Done
[835789:MainThread](2026-01-11 18:19:24,277) INFO - qlib.timer - [log.py:127] - Time cost: 73.444s | Init data Done
2026-01-11 18:19:24.278 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 18:19:24,291) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 18:19:24,292) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 18:19:24,294) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 18:19:24,295) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:19:24.312 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 18:19:26,436) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 18:19:26,437) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 18:19:26,438) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:19:37,088) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:19:54,655) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994417, valid -0.996788
[835789:MainThread](2026-01-11 18:19:54,656) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 18:19:54,657) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:20:02,765) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:20:14,870) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992716, valid -0.996554
[835789:MainThread](2026-01-11 18:20:14,871) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 18:20:14,872) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:20:22,308) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:20:33,417) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992306, valid -0.996631
[835789:MainThread](2026-01-11 18:20:33,418) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 18:20:33,418) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:20:41,165) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:20:50,975) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991483, valid -0.997942
[835789:MainThread](2026-01-11 18:20:50,975) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 18:20:50,976) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:20:57,759) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:21:07,985) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990515, valid -0.998452
[835789:MainThread](2026-01-11 18:21:07,986) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 18:21:07,986) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:21:14,482) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:21:24,165) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990256, valid -0.998111
[835789:MainThread](2026-01-11 18:21:24,166) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 18:21:24,166) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:21:30,350) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:21:38,681) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988822, valid -0.999881
[835789:MainThread](2026-01-11 18:21:38,682) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 18:21:38,682) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:21:44,879) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:21:54,419) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.988864, valid -1.000914
[835789:MainThread](2026-01-11 18:21:54,420) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 18:21:54,420) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:22:01,395) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:22:09,827) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987822, valid -1.000454
[835789:MainThread](2026-01-11 18:22:09,828) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 18:22:09,828) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:22:15,643) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:22:24,645) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987271, valid -1.001758
[835789:MainThread](2026-01-11 18:22:24,646) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 18:22:24,646) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:22:31,171) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:22:40,752) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.987276, valid -1.003857
[835789:MainThread](2026-01-11 18:22:40,753) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835789:MainThread](2026-01-11 18:22:40,754) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:22:47,801) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:22:56,476) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.986047, valid -1.001938
[835789:MainThread](2026-01-11 18:22:56,476) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 18:22:56,476) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.996554 @ 1
2026-01-11 18:22:56.537 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:23:00.313 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 18:23:00.313 | INFO     | __main__:train_single_fold:593 -   IC=0.0209, ICIR=0.1818, RankIC=0.0502, RankICIR=0.4608
2026-01-11 18:23:00.313 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 18:23:00,319) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:23:29,102) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:23:29,103) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:23:36,421) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d617b5d0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:08, 27.43it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 51.43it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 63.46it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:02, 72.47it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:02, 69.20it/s]backtest loop:  18%|█▊        | 43/242 [00:00<00:02, 69.11it/s]backtest loop:  21%|██        | 50/242 [00:00<00:02, 64.09it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 66.53it/s]backtest loop:  27%|██▋       | 65/242 [00:00<00:02, 67.34it/s]backtest loop:  30%|███       | 73/242 [00:01<00:02, 69.33it/s]backtest loop:  33%|███▎      | 80/242 [00:01<00:02, 69.40it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:02, 71.40it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 73.09it/s]backtest loop:  44%|████▍     | 107/242 [00:01<00:01, 77.51it/s]backtest loop:  48%|████▊     | 115/242 [00:01<00:01, 76.32it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 75.77it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 79.17it/s]backtest loop:  58%|█████▊    | 140/242 [00:01<00:01, 77.42it/s]backtest loop:  61%|██████    | 148/242 [00:02<00:01, 76.38it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 79.75it/s]backtest loop:  68%|██████▊   | 165/242 [00:02<00:00, 77.55it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 75.99it/s]backtest loop:  75%|███████▍  | 181/242 [00:02<00:00, 76.56it/s]backtest loop:  78%|███████▊  | 189/242 [00:02<00:00, 75.79it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 75.56it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 74.35it/s]backtest loop:  88%|████████▊ | 213/242 [00:02<00:00, 71.95it/s]backtest loop:  91%|█████████▏| 221/242 [00:03<00:00, 71.60it/s]backtest loop:  95%|█████████▍| 229/242 [00:03<00:00, 68.58it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 68.71it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 71.17it/s]
2026-01-11 18:23:39.845 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1076, Sharpe(w/cost)=1.4279, MaxDD=-0.0722
2026-01-11 18:23:43.497 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 18:24:04.101 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:24:04.267 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_6_pred.parquet
2026-01-11 18:24:04.288 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 18:24:04.288 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 18:24:10.882 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0456
2026-01-11 18:24:14.790 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0427
2026-01-11 18:24:20.608 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0468
2026-01-11 18:24:26.969 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0419
2026-01-11 18:24:33.529 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0385
2026-01-11 18:24:40.179 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0461
2026-01-11 18:24:40.506 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0223, ICIR=0.1836, RankIC=0.0522
[835789:MainThread](2026-01-11 18:24:40,512) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:25:16,730) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:25:16,731) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:25:25,508) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d9691290>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 20.69it/s]backtest loop:   4%|▎         | 9/242 [00:00<00:06, 38.19it/s]backtest loop:   7%|▋         | 16/242 [00:00<00:04, 50.87it/s]backtest loop:  10%|▉         | 23/242 [00:00<00:03, 56.50it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 56.54it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:03, 60.79it/s]backtest loop:  18%|█▊        | 44/242 [00:00<00:03, 61.13it/s]backtest loop:  21%|██        | 51/242 [00:00<00:03, 63.64it/s]backtest loop:  24%|██▍       | 58/242 [00:01<00:02, 64.84it/s]backtest loop:  27%|██▋       | 65/242 [00:01<00:02, 62.98it/s]backtest loop:  30%|██▉       | 72/242 [00:01<00:02, 61.50it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:02, 60.74it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:02, 64.14it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:02, 62.34it/s]backtest loop:  42%|████▏     | 101/242 [00:01<00:02, 64.23it/s]backtest loop:  45%|████▍     | 108/242 [00:01<00:02, 62.61it/s]backtest loop:  48%|████▊     | 115/242 [00:01<00:01, 64.56it/s]backtest loop:  50%|█████     | 122/242 [00:02<00:01, 66.05it/s]backtest loop:  53%|█████▎    | 129/242 [00:02<00:01, 64.36it/s]backtest loop:  57%|█████▋    | 137/242 [00:02<00:01, 66.60it/s]backtest loop:  60%|█████▉    | 144/242 [00:02<00:01, 64.78it/s]backtest loop:  63%|██████▎   | 152/242 [00:02<00:01, 66.98it/s]backtest loop:  66%|██████▌   | 159/242 [00:02<00:01, 64.18it/s]backtest loop:  69%|██████▊   | 166/242 [00:02<00:01, 65.64it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:01, 63.63it/s]backtest loop:  74%|███████▍  | 180/242 [00:02<00:00, 65.29it/s]backtest loop:  77%|███████▋  | 187/242 [00:03<00:00, 63.18it/s]backtest loop:  81%|████████  | 195/242 [00:03<00:00, 65.74it/s]backtest loop:  83%|████████▎ | 202/242 [00:03<00:00, 63.72it/s]backtest loop:  86%|████████▋ | 209/242 [00:03<00:00, 65.18it/s]backtest loop:  89%|████████▉ | 216/242 [00:03<00:00, 66.26it/s]backtest loop:  92%|█████████▏| 223/242 [00:03<00:00, 64.87it/s]backtest loop:  95%|█████████▌| 231/242 [00:03<00:00, 67.96it/s]backtest loop:  99%|█████████▉| 239/242 [00:03<00:00, 69.85it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 63.26it/s]
2026-01-11 18:25:29.357 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1131, Sharpe(w/cost)=1.5957
2026-01-11 18:25:29.401 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:25:29.401 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 18:25:29.401 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:25:29.401 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 18:26:48,491) INFO - qlib.timer - [log.py:127] - Time cost: 79.088s | Loading data Done
[835789:MainThread](2026-01-11 18:26:48,749) INFO - qlib.timer - [log.py:127] - Time cost: 0.019s | FilterCol Done
[835789:MainThread](2026-01-11 18:26:48,915) INFO - qlib.timer - [log.py:127] - Time cost: 0.165s | ZScoreNorm Done
[835789:MainThread](2026-01-11 18:26:49,007) INFO - qlib.timer - [log.py:127] - Time cost: 0.091s | Fillna Done
[835789:MainThread](2026-01-11 18:26:49,100) INFO - qlib.timer - [log.py:127] - Time cost: 0.044s | DropnaLabel Done
[835789:MainThread](2026-01-11 18:26:49,309) INFO - qlib.timer - [log.py:127] - Time cost: 0.208s | CSRankNorm Done
[835789:MainThread](2026-01-11 18:26:49,310) INFO - qlib.timer - [log.py:127] - Time cost: 0.819s | fit & process data Done
[835789:MainThread](2026-01-11 18:26:49,311) INFO - qlib.timer - [log.py:127] - Time cost: 79.909s | Init data Done
2026-01-11 18:26:49.311 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 18:26:49,325) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 18:26:49,326) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 18:26:49,329) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 18:26:49,329) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:26:49.340 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 18:26:51,745) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 18:26:51,746) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 18:26:51,746) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:27:04,770) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:27:24,311) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994417, valid -0.996073
[835789:MainThread](2026-01-11 18:27:24,313) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 18:27:24,314) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:27:33,892) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:27:46,232) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993841, valid -0.995543
[835789:MainThread](2026-01-11 18:27:46,233) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 18:27:46,234) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:27:52,960) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:28:04,750) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993133, valid -0.996463
[835789:MainThread](2026-01-11 18:28:04,750) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 18:28:04,751) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:28:11,704) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:28:23,440) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992697, valid -0.996836
[835789:MainThread](2026-01-11 18:28:23,440) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 18:28:23,441) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:28:30,931) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:28:39,574) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992336, valid -0.996369
[835789:MainThread](2026-01-11 18:28:39,575) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 18:28:39,575) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:28:46,134) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:28:56,064) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991694, valid -0.997205
[835789:MainThread](2026-01-11 18:28:56,064) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 18:28:56,065) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:29:02,364) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:29:12,925) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991165, valid -0.997382
[835789:MainThread](2026-01-11 18:29:12,925) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 18:29:12,926) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:29:19,081) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:29:27,583) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990526, valid -0.996929
[835789:MainThread](2026-01-11 18:29:27,584) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 18:29:27,584) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:29:33,431) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:29:41,532) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990837, valid -0.997936
[835789:MainThread](2026-01-11 18:29:41,532) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 18:29:41,533) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:29:48,220) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:29:57,293) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990078, valid -0.998554
[835789:MainThread](2026-01-11 18:29:57,294) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 18:29:57,294) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:30:04,010) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:30:12,922) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989157, valid -0.998022
[835789:MainThread](2026-01-11 18:30:12,922) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835789:MainThread](2026-01-11 18:30:12,923) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:30:18,858) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:30:28,723) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.989002, valid -0.997443
[835789:MainThread](2026-01-11 18:30:28,723) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 18:30:28,724) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.995543 @ 1
2026-01-11 18:30:28.746 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:30:32.699 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 18:30:32.700 | INFO     | __main__:train_single_fold:593 -   IC=0.0112, ICIR=0.0773, RankIC=0.0469, RankICIR=0.3935
2026-01-11 18:30:32.700 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 18:30:32,706) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:31:00,743) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:31:00,744) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:31:08,442) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67dbc3a390>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.28it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 53.51it/s]backtest loop:   8%|▊         | 20/242 [00:00<00:03, 68.21it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 74.01it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 78.99it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 82.53it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 84.67it/s]backtest loop:  28%|██▊       | 68/242 [00:00<00:02, 82.49it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:01, 84.85it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:01, 85.59it/s]backtest loop:  40%|███▉      | 96/242 [00:01<00:01, 85.42it/s]backtest loop:  43%|████▎     | 105/242 [00:01<00:01, 85.76it/s]backtest loop:  47%|████▋     | 114/242 [00:01<00:01, 85.37it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 84.93it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 85.70it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 86.64it/s]backtest loop:  63%|██████▎   | 153/242 [00:01<00:01, 85.92it/s]backtest loop:  67%|██████▋   | 163/242 [00:01<00:00, 85.89it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 84.67it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 85.25it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 86.66it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 87.31it/s]backtest loop:  87%|████████▋ | 211/242 [00:02<00:00, 87.41it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 85.63it/s]backtest loop:  95%|█████████▍| 229/242 [00:02<00:00, 84.71it/s]backtest loop:  98%|█████████▊| 238/242 [00:02<00:00, 81.52it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 82.35it/s]
2026-01-11 18:31:11.402 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0097, Sharpe(w/cost)=0.1465, MaxDD=-0.0404
2026-01-11 18:31:16.226 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 18:31:36.338 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:31:36.389 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_7_pred.parquet
2026-01-11 18:31:36.409 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 18:31:36.409 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 18:31:40.654 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0220
2026-01-11 18:31:44.856 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0253
2026-01-11 18:31:49.099 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0331
2026-01-11 18:31:54.177 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0311
2026-01-11 18:31:58.111 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0286
2026-01-11 18:32:03.539 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0498
2026-01-11 18:32:08.235 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0416
2026-01-11 18:32:08.599 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0114, ICIR=0.0771, RankIC=0.0453
[835789:MainThread](2026-01-11 18:32:08,605) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:32:46,529) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:32:46,530) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:32:55,757) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67cef8a390>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 20.30it/s]backtest loop:   4%|▎         | 9/242 [00:00<00:06, 37.71it/s]backtest loop:   7%|▋         | 17/242 [00:00<00:04, 52.32it/s]backtest loop:  10%|▉         | 24/242 [00:00<00:03, 54.75it/s]backtest loop:  13%|█▎        | 32/242 [00:00<00:03, 60.70it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:03, 60.07it/s]backtest loop:  19%|█▉        | 47/242 [00:00<00:03, 64.44it/s]backtest loop:  23%|██▎       | 55/242 [00:00<00:02, 67.07it/s]backtest loop:  26%|██▌       | 63/242 [00:01<00:02, 66.23it/s]backtest loop:  30%|██▉       | 72/242 [00:01<00:02, 72.05it/s]backtest loop:  33%|███▎      | 80/242 [00:01<00:02, 70.02it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:02, 74.82it/s]backtest loop:  40%|████      | 97/242 [00:01<00:01, 74.83it/s]backtest loop:  44%|████▍     | 106/242 [00:01<00:01, 77.19it/s]backtest loop:  48%|████▊     | 115/242 [00:01<00:01, 78.95it/s]backtest loop:  51%|█████     | 124/242 [00:01<00:01, 80.12it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 81.06it/s]backtest loop:  59%|█████▉    | 143/242 [00:02<00:01, 83.18it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 83.86it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 84.50it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 84.80it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 84.35it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 84.74it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 85.01it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 84.17it/s]backtest loop:  91%|█████████▏| 221/242 [00:02<00:00, 84.32it/s]backtest loop:  95%|█████████▌| 230/242 [00:03<00:00, 80.54it/s]backtest loop:  99%|█████████▉| 239/242 [00:03<00:00, 76.62it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.07it/s]
2026-01-11 18:32:59.048 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0216, Sharpe(w/cost)=0.3465
2026-01-11 18:32:59.092 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:32:59.093 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 18:32:59.093 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:32:59.093 | INFO     | __main__:_create_dataset:231 - Initializing Alpha158...
[835789:MainThread](2026-01-11 18:34:14,868) INFO - qlib.timer - [log.py:127] - Time cost: 75.773s | Loading data Done
[835789:MainThread](2026-01-11 18:34:15,109) INFO - qlib.timer - [log.py:127] - Time cost: 0.015s | FilterCol Done
[835789:MainThread](2026-01-11 18:34:15,240) INFO - qlib.timer - [log.py:127] - Time cost: 0.130s | ZScoreNorm Done
[835789:MainThread](2026-01-11 18:34:15,323) INFO - qlib.timer - [log.py:127] - Time cost: 0.083s | Fillna Done
[835789:MainThread](2026-01-11 18:34:15,389) INFO - qlib.timer - [log.py:127] - Time cost: 0.024s | DropnaLabel Done
[835789:MainThread](2026-01-11 18:34:15,596) INFO - qlib.timer - [log.py:127] - Time cost: 0.205s | CSRankNorm Done
[835789:MainThread](2026-01-11 18:34:15,597) INFO - qlib.timer - [log.py:127] - Time cost: 0.728s | fit & process data Done
[835789:MainThread](2026-01-11 18:34:15,597) INFO - qlib.timer - [log.py:127] - Time cost: 76.503s | Init data Done
2026-01-11 18:34:15.598 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[835789:MainThread](2026-01-11 18:34:15,610) INFO - qlib.GRU - [pytorch_gru_ts.py:61] - GRU pytorch version...
[835789:MainThread](2026-01-11 18:34:15,610) INFO - qlib.GRU - [pytorch_gru_ts.py:79] - GRU parameters setting:
d_feat : 20
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.0002
metric : loss
batch_size : 800
early_stop : 10
optimizer : adam
loss_type : mse
device : cuda:0
n_jobs : 20
use_GPU : True
seed : None
[835789:MainThread](2026-01-11 18:34:15,612) INFO - qlib.GRU - [pytorch_gru_ts.py:124] - model:
GRUModel(
  (rnn): GRU(20, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[835789:MainThread](2026-01-11 18:34:15,613) INFO - qlib.GRU - [pytorch_gru_ts.py:125] - model size: 0.0396 MB
2026-01-11 18:34:15.623 | INFO     | __main__:train_single_fold:569 - Training gru_158_20_zscore model (GPU=0)...
[835789:MainThread](2026-01-11 18:34:18,190) INFO - qlib.GRU - [pytorch_gru_ts.py:250] - training...
[835789:MainThread](2026-01-11 18:34:18,191) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch0:
[835789:MainThread](2026-01-11 18:34:18,191) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:34:29,788) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:34:48,813) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994931, valid -0.995954
[835789:MainThread](2026-01-11 18:34:48,818) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch1:
[835789:MainThread](2026-01-11 18:34:48,818) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:35:05,536) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:35:26,868) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.994254, valid -0.995159
[835789:MainThread](2026-01-11 18:35:26,870) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch2:
[835789:MainThread](2026-01-11 18:35:26,870) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:35:43,659) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:36:05,799) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993763, valid -0.995336
[835789:MainThread](2026-01-11 18:36:05,800) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch3:
[835789:MainThread](2026-01-11 18:36:05,800) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:36:21,271) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:36:41,214) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.993389, valid -0.995865
[835789:MainThread](2026-01-11 18:36:41,214) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch4:
[835789:MainThread](2026-01-11 18:36:41,215) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:36:53,276) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:37:10,968) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992944, valid -0.995793
[835789:MainThread](2026-01-11 18:37:10,968) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch5:
[835789:MainThread](2026-01-11 18:37:10,969) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:37:24,049) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:37:41,287) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992445, valid -0.996030
[835789:MainThread](2026-01-11 18:37:41,287) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch6:
[835789:MainThread](2026-01-11 18:37:41,288) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:37:55,315) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:38:13,801) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992268, valid -0.995935
[835789:MainThread](2026-01-11 18:38:13,801) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch7:
[835789:MainThread](2026-01-11 18:38:13,802) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:38:24,040) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:38:33,652) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.992066, valid -0.996507
[835789:MainThread](2026-01-11 18:38:33,653) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch8:
[835789:MainThread](2026-01-11 18:38:33,653) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:38:39,913) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:38:48,986) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991497, valid -0.996437
[835789:MainThread](2026-01-11 18:38:48,987) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch9:
[835789:MainThread](2026-01-11 18:38:48,987) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:38:57,078) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:39:07,977) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.991127, valid -0.996556
[835789:MainThread](2026-01-11 18:39:07,978) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch10:
[835789:MainThread](2026-01-11 18:39:07,978) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:39:15,319) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:39:24,913) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990820, valid -0.995642
[835789:MainThread](2026-01-11 18:39:24,914) INFO - qlib.GRU - [pytorch_gru_ts.py:254] - Epoch11:
[835789:MainThread](2026-01-11 18:39:24,914) INFO - qlib.GRU - [pytorch_gru_ts.py:255] - training...
[835789:MainThread](2026-01-11 18:39:31,571) INFO - qlib.GRU - [pytorch_gru_ts.py:257] - evaluating...
[835789:MainThread](2026-01-11 18:39:41,749) INFO - qlib.GRU - [pytorch_gru_ts.py:260] - train -0.990146, valid -0.996881
[835789:MainThread](2026-01-11 18:39:41,750) INFO - qlib.GRU - [pytorch_gru_ts.py:272] - early stop
[835789:MainThread](2026-01-11 18:39:41,751) INFO - qlib.GRU - [pytorch_gru_ts.py:275] - best score: -0.995159 @ 1
2026-01-11 18:39:41.797 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:39:46.321 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 18:39:46.322 | INFO     | __main__:train_single_fold:593 -   IC=0.0179, ICIR=0.0971, RankIC=0.0458, RankICIR=0.2451
2026-01-11 18:39:46.322 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[835789:MainThread](2026-01-11 18:39:46,328) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:40:15,899) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:40:15,900) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:40:23,738) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67db972390>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 23.85it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 47.93it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.68it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 68.02it/s]backtest loop:  15%|█▌        | 37/242 [00:00<00:02, 74.80it/s]backtest loop:  19%|█▊        | 45/242 [00:00<00:02, 74.51it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 74.76it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 74.79it/s]backtest loop:  29%|██▉       | 70/242 [00:00<00:02, 78.75it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 74.61it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:01, 78.55it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 77.58it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 75.60it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 76.03it/s]backtest loop:  50%|█████     | 121/242 [00:01<00:01, 79.03it/s]backtest loop:  53%|█████▎    | 129/242 [00:01<00:01, 77.59it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 76.16it/s]backtest loop:  60%|██████    | 146/242 [00:01<00:01, 79.46it/s]backtest loop:  64%|██████▎   | 154/242 [00:02<00:01, 78.12it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 77.16it/s]backtest loop:  71%|███████   | 171/242 [00:02<00:00, 79.71it/s]backtest loop:  74%|███████▍  | 179/242 [00:02<00:00, 78.35it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 75.28it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 75.55it/s]backtest loop:  84%|████████▍ | 204/242 [00:02<00:00, 78.21it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 74.06it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 73.29it/s]backtest loop:  94%|█████████▍| 228/242 [00:03<00:00, 74.24it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 72.09it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 73.91it/s]
2026-01-11 18:40:27.032 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0588, Sharpe(w/cost)=-0.5406, MaxDD=-0.1518
2026-01-11 18:40:31.920 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 18:40:51.826 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:40:51.877 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/fold_8_pred.parquet
2026-01-11 18:40:51.895 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 18:40:51.895 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 18:40:56.037 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0286
2026-01-11 18:40:59.915 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0342
2026-01-11 18:41:04.061 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0295
2026-01-11 18:41:07.930 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0245
2026-01-11 18:41:11.757 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0266
2026-01-11 18:41:16.438 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0383
2026-01-11 18:41:21.660 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0385
2026-01-11 18:41:25.274 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0458
2026-01-11 18:41:25.629 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0174, ICIR=0.0967, RankIC=0.0451
[835789:MainThread](2026-01-11 18:41:25,635) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[835789:MainThread](2026-01-11 18:41:56,826) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:41:56,827) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:42:05,455) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67da1c0810>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.11it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 44.99it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 59.08it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 66.08it/s]backtest loop:  15%|█▌        | 37/242 [00:00<00:02, 72.94it/s]backtest loop:  19%|█▊        | 45/242 [00:00<00:02, 72.42it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 73.06it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 73.22it/s]backtest loop:  29%|██▉       | 70/242 [00:01<00:02, 77.44it/s]backtest loop:  32%|███▏      | 78/242 [00:01<00:02, 73.18it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:02, 77.17it/s]backtest loop:  39%|███▉      | 95/242 [00:01<00:01, 76.20it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 75.52it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 75.80it/s]backtest loop:  50%|█████     | 121/242 [00:01<00:01, 78.91it/s]backtest loop:  53%|█████▎    | 129/242 [00:01<00:01, 77.51it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 76.62it/s]backtest loop:  60%|██████    | 146/242 [00:01<00:01, 79.71it/s]backtest loop:  64%|██████▎   | 154/242 [00:02<00:01, 78.09it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 76.81it/s]backtest loop:  71%|███████   | 171/242 [00:02<00:00, 79.85it/s]backtest loop:  74%|███████▍  | 180/242 [00:02<00:00, 75.14it/s]backtest loop:  78%|███████▊  | 188/242 [00:02<00:00, 75.23it/s]backtest loop:  81%|████████  | 196/242 [00:02<00:00, 70.91it/s]backtest loop:  84%|████████▍ | 204/242 [00:02<00:00, 71.87it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 67.92it/s]backtest loop:  90%|█████████ | 219/242 [00:03<00:00, 68.08it/s]backtest loop:  93%|█████████▎| 226/242 [00:03<00:00, 65.29it/s]backtest loop:  96%|█████████▋| 233/242 [00:03<00:00, 66.12it/s]backtest loop:  99%|█████████▉| 240/242 [00:03<00:00, 63.58it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 70.92it/s]
2026-01-11 18:42:08.890 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0373, Sharpe(w/cost)=-0.3527
2026-01-11 18:42:08.937 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 18:42:08.937 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 18:42:08.937 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 18:42:08.944 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 18:42:08.944 | INFO     | __main__:_print_summary:827 -   IC: 0.0187
2026-01-11 18:42:08.944 | INFO     | __main__:_print_summary:828 -   ICIR: 0.1529
2026-01-11 18:42:08.944 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0463
2026-01-11 18:42:08.945 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0127
2026-01-11 18:42:08.945 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.0710
2026-01-11 18:42:08.945 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0437
2026-01-11 18:42:08.948 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/summary.csv
2026-01-11 18:42:08.949 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 18:42:08.949 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 18:42:08.949 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 18:42:08.949 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 18:42:08.952 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 18:42:08.952 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0463
2026-01-11 18:42:08.952 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0353
2026-01-11 18:42:08.952 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0353)
2026-01-11 18:42:08.952 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 18:42:08.953 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/ensemble_matrix.csv
2026-01-11 18:42:08.953 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 18:42:08.953 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 18:42:08.953 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 18:42:09.095 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 18:42:09.096 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 18:42:11.013 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0187, ICIR=0.1419, RankIC=0.0463
[835789:MainThread](2026-01-11 18:42:11,022) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.039257 0.303956 0.069829  0.231685  2.316480 -0.036862         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.024522 0.190936 0.053512 -0.040458 -0.716400 -0.040502    0.050749   -0.967900
    2 2018-01-01 ~ 2018-12-31 0.033825 0.351393 0.040016 -0.077685 -1.216465 -0.127525    0.040945   -1.229810
    3 2019-01-01 ~ 2019-12-31 0.011910 0.106558 0.042467 -0.013450 -0.224491 -0.071440    0.044867    0.176224
    4 2020-01-01 ~ 2020-12-31 0.004241 0.031474 0.035694 -0.069288 -0.814689 -0.114493    0.039397   -0.611940
    5 2021-01-01 ~ 2021-12-31 0.004318 0.036003 0.032485  0.024811  0.260421 -0.084981    0.030680   -0.728544
    6 2022-01-01 ~ 2022-12-31 0.020934 0.181774 0.050164  0.107600  1.427860 -0.072241    0.052205    1.595678
    7 2023-01-01 ~ 2023-12-31 0.011224 0.077285 0.046931  0.009689  0.146533 -0.040351    0.045344    0.346471
    8 2024-01-01 ~ 2024-12-31 0.017859 0.097148 0.045842 -0.058821 -0.540552 -0.151774    0.045091   -0.352651

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.0698     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0450  0.0535     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0311  0.0326  0.0400     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0413  0.0470  0.0393  0.0425     NaN     NaN     NaN     NaN     NaN
T4  0.0328  0.0333  0.0423  0.0426  0.0357     NaN     NaN     NaN     NaN
T5  0.0249  0.0236  0.0249  0.0250  0.0252  0.0325     NaN     NaN     NaN
T6  0.0456  0.0427  0.0468  0.0419  0.0385  0.0461  0.0502     NaN     NaN
T7  0.0220  0.0253  0.0331  0.0311  0.0286  0.0498  0.0416  0.0469     NaN
T8  0.0286  0.0342  0.0295  0.0245  0.0266  0.0383  0.0385  0.0458  0.0458
[835789:MainThread](2026-01-11 18:42:47,516) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:42:47,519) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[835789:MainThread](2026-01-11 18:43:36,013) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f67d48ea390>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 4/2187 [00:00<00:57, 37.96it/s]backtest loop:   1%|          | 15/2187 [00:00<00:30, 72.39it/s]backtest loop:   1%|          | 26/2187 [00:00<00:25, 86.26it/s]backtest loop:   2%|▏         | 38/2187 [00:00<00:22, 96.94it/s]backtest loop:   2%|▏         | 49/2187 [00:00<00:21, 99.40it/s]backtest loop:   3%|▎         | 59/2187 [00:00<00:21, 99.51it/s]backtest loop:   3%|▎         | 69/2187 [00:00<00:22, 94.47it/s]backtest loop:   4%|▎         | 79/2187 [00:00<00:22, 95.82it/s]backtest loop:   4%|▍         | 89/2187 [00:00<00:21, 95.58it/s]backtest loop:   5%|▍         | 99/2187 [00:01<00:21, 95.61it/s]backtest loop:   5%|▍         | 109/2187 [00:01<00:21, 94.91it/s]backtest loop:   5%|▌         | 119/2187 [00:01<00:21, 95.04it/s]backtest loop:   6%|▌         | 129/2187 [00:01<00:21, 95.52it/s]backtest loop:   6%|▋         | 139/2187 [00:01<00:21, 96.15it/s]backtest loop:   7%|▋         | 149/2187 [00:01<00:21, 96.10it/s]backtest loop:   7%|▋         | 159/2187 [00:01<00:26, 76.24it/s]backtest loop:   8%|▊         | 168/2187 [00:01<00:28, 71.54it/s]backtest loop:   8%|▊         | 176/2187 [00:02<00:29, 67.55it/s]backtest loop:   8%|▊         | 184/2187 [00:02<00:28, 69.97it/s]backtest loop:   9%|▉         | 192/2187 [00:02<00:28, 70.10it/s]backtest loop:   9%|▉         | 200/2187 [00:02<00:28, 70.58it/s]backtest loop:  10%|▉         | 209/2187 [00:02<00:27, 72.58it/s]backtest loop:  10%|█         | 219/2187 [00:02<00:25, 76.27it/s]backtest loop:  10%|█         | 229/2187 [00:02<00:24, 78.79it/s]backtest loop:  11%|█         | 239/2187 [00:02<00:24, 80.92it/s]backtest loop:  11%|█▏        | 248/2187 [00:03<00:25, 75.46it/s]backtest loop:  12%|█▏        | 256/2187 [00:03<00:25, 75.95it/s]backtest loop:  12%|█▏        | 264/2187 [00:03<00:25, 75.03it/s]backtest loop:  13%|█▎        | 274/2187 [00:03<00:23, 81.05it/s]backtest loop:  13%|█▎        | 283/2187 [00:03<00:22, 83.22it/s]backtest loop:  13%|█▎        | 293/2187 [00:03<00:22, 85.41it/s]backtest loop:  14%|█▍        | 303/2187 [00:03<00:21, 86.37it/s]backtest loop:  14%|█▍        | 312/2187 [00:03<00:21, 85.26it/s]backtest loop:  15%|█▍        | 321/2187 [00:03<00:21, 85.83it/s]backtest loop:  15%|█▌        | 330/2187 [00:04<00:25, 74.03it/s]backtest loop:  16%|█▌        | 339/2187 [00:04<00:23, 78.01it/s]backtest loop:  16%|█▌        | 348/2187 [00:04<00:24, 76.58it/s]backtest loop:  16%|█▋        | 358/2187 [00:04<00:23, 76.65it/s]backtest loop:  17%|█▋        | 366/2187 [00:04<00:24, 74.64it/s]backtest loop:  17%|█▋        | 374/2187 [00:04<00:24, 72.90it/s]backtest loop:  17%|█▋        | 382/2187 [00:04<00:25, 70.15it/s]backtest loop:  18%|█▊        | 390/2187 [00:04<00:27, 64.34it/s]backtest loop:  18%|█▊        | 397/2187 [00:04<00:27, 64.23it/s]backtest loop:  18%|█▊        | 404/2187 [00:05<00:27, 64.03it/s]backtest loop:  19%|█▉        | 413/2187 [00:05<00:26, 67.72it/s]backtest loop:  19%|█▉        | 420/2187 [00:05<00:26, 65.46it/s]backtest loop:  20%|█▉        | 428/2187 [00:05<00:26, 65.81it/s]backtest loop:  20%|██        | 438/2187 [00:05<00:24, 71.01it/s]backtest loop:  20%|██        | 448/2187 [00:05<00:22, 78.00it/s]backtest loop:  21%|██        | 458/2187 [00:05<00:21, 80.16it/s]backtest loop:  21%|██▏       | 468/2187 [00:05<00:20, 83.03it/s]backtest loop:  22%|██▏       | 478/2187 [00:06<00:20, 84.91it/s]backtest loop:  22%|██▏       | 488/2187 [00:06<00:19, 86.27it/s]backtest loop:  23%|██▎       | 497/2187 [00:06<00:19, 85.40it/s]backtest loop:  23%|██▎       | 507/2187 [00:06<00:19, 86.40it/s]backtest loop:  24%|██▎       | 517/2187 [00:06<00:19, 85.75it/s]backtest loop:  24%|██▍       | 526/2187 [00:06<00:20, 82.60it/s]backtest loop:  24%|██▍       | 535/2187 [00:06<00:20, 79.76it/s]backtest loop:  25%|██▍       | 543/2187 [00:06<00:21, 77.94it/s]backtest loop:  25%|██▌       | 552/2187 [00:06<00:20, 78.29it/s]backtest loop:  26%|██▌       | 560/2187 [00:07<00:24, 65.21it/s]backtest loop:  26%|██▌       | 569/2187 [00:07<00:23, 70.27it/s]backtest loop:  26%|██▋       | 579/2187 [00:07<00:20, 76.68it/s]backtest loop:  27%|██▋       | 588/2187 [00:07<00:20, 79.58it/s]backtest loop:  27%|██▋       | 598/2187 [00:07<00:19, 81.90it/s]backtest loop:  28%|██▊       | 607/2187 [00:07<00:19, 81.59it/s]backtest loop:  28%|██▊       | 617/2187 [00:07<00:18, 83.10it/s]backtest loop:  29%|██▊       | 627/2187 [00:07<00:18, 84.77it/s]backtest loop:  29%|██▉       | 636/2187 [00:07<00:18, 85.54it/s]backtest loop:  29%|██▉       | 645/2187 [00:08<00:18, 81.98it/s]backtest loop:  30%|██▉       | 654/2187 [00:08<00:19, 79.19it/s]backtest loop:  30%|███       | 662/2187 [00:08<00:19, 78.88it/s]backtest loop:  31%|███       | 672/2187 [00:08<00:18, 83.55it/s]backtest loop:  31%|███       | 682/2187 [00:08<00:17, 88.00it/s]backtest loop:  32%|███▏      | 693/2187 [00:08<00:16, 92.73it/s]backtest loop:  32%|███▏      | 704/2187 [00:08<00:15, 96.45it/s]backtest loop:  33%|███▎      | 715/2187 [00:08<00:14, 98.93it/s]backtest loop:  33%|███▎      | 726/2187 [00:08<00:15, 96.55it/s]backtest loop:  34%|███▎      | 738/2187 [00:09<00:14, 101.73it/s]backtest loop:  34%|███▍      | 749/2187 [00:09<00:14, 101.00it/s]backtest loop:  35%|███▍      | 761/2187 [00:09<00:13, 105.99it/s]backtest loop:  35%|███▌      | 773/2187 [00:09<00:12, 109.96it/s]backtest loop:  36%|███▌      | 785/2187 [00:09<00:13, 104.15it/s]backtest loop:  36%|███▋      | 796/2187 [00:09<00:13, 104.86it/s]backtest loop:  37%|███▋      | 807/2187 [00:09<00:13, 105.77it/s]backtest loop:  37%|███▋      | 818/2187 [00:09<00:13, 101.56it/s]backtest loop:  38%|███▊      | 829/2187 [00:09<00:13, 97.77it/s] backtest loop:  38%|███▊      | 839/2187 [00:10<00:15, 84.75it/s]backtest loop:  39%|███▉      | 850/2187 [00:10<00:14, 90.13it/s]backtest loop:  39%|███▉      | 860/2187 [00:10<00:14, 91.18it/s]backtest loop:  40%|███▉      | 870/2187 [00:10<00:14, 89.72it/s]backtest loop:  40%|████      | 880/2187 [00:10<00:14, 88.94it/s]backtest loop:  41%|████      | 890/2187 [00:10<00:14, 88.14it/s]backtest loop:  41%|████      | 899/2187 [00:10<00:14, 86.65it/s]backtest loop:  42%|████▏     | 908/2187 [00:10<00:14, 85.39it/s]backtest loop:  42%|████▏     | 917/2187 [00:11<00:15, 84.28it/s]backtest loop:  42%|████▏     | 926/2187 [00:11<00:15, 83.92it/s]backtest loop:  43%|████▎     | 935/2187 [00:11<00:15, 83.40it/s]backtest loop:  43%|████▎     | 944/2187 [00:11<00:15, 82.67it/s]backtest loop:  44%|████▎     | 953/2187 [00:11<00:14, 82.37it/s]backtest loop:  44%|████▍     | 963/2187 [00:11<00:14, 82.16it/s]backtest loop:  44%|████▍     | 973/2187 [00:11<00:14, 82.69it/s]backtest loop:  45%|████▍     | 982/2187 [00:11<00:14, 80.78it/s]backtest loop:  45%|████▌     | 993/2187 [00:11<00:13, 87.23it/s]backtest loop:  46%|████▌     | 1004/2187 [00:12<00:12, 92.23it/s]backtest loop:  46%|████▋     | 1015/2187 [00:12<00:12, 95.95it/s]backtest loop:  47%|████▋     | 1026/2187 [00:12<00:12, 94.86it/s]backtest loop:  47%|████▋     | 1037/2187 [00:12<00:11, 97.98it/s]backtest loop:  48%|████▊     | 1048/2187 [00:12<00:11, 100.30it/s]backtest loop:  48%|████▊     | 1059/2187 [00:12<00:11, 97.77it/s] backtest loop:  49%|████▉     | 1070/2187 [00:12<00:11, 100.79it/s]backtest loop:  49%|████▉     | 1081/2187 [00:12<00:10, 102.53it/s]backtest loop:  50%|████▉     | 1092/2187 [00:12<00:11, 99.21it/s] backtest loop:  50%|█████     | 1103/2187 [00:12<00:10, 100.98it/s]backtest loop:  51%|█████     | 1114/2187 [00:13<00:10, 103.32it/s]backtest loop:  51%|█████▏    | 1125/2187 [00:13<00:10, 99.83it/s] backtest loop:  52%|█████▏    | 1136/2187 [00:13<00:10, 99.11it/s]backtest loop:  52%|█████▏    | 1147/2187 [00:13<00:10, 100.83it/s]backtest loop:  53%|█████▎    | 1158/2187 [00:13<00:10, 98.51it/s] backtest loop:  53%|█████▎    | 1169/2187 [00:13<00:10, 95.58it/s]backtest loop:  54%|█████▍    | 1179/2187 [00:13<00:10, 96.53it/s]backtest loop:  54%|█████▍    | 1190/2187 [00:13<00:10, 99.16it/s]backtest loop:  55%|█████▍    | 1201/2187 [00:13<00:09, 101.06it/s]backtest loop:  55%|█████▌    | 1212/2187 [00:14<00:09, 102.86it/s]backtest loop:  56%|█████▌    | 1223/2187 [00:14<00:09, 99.23it/s] backtest loop:  56%|█████▋    | 1234/2187 [00:14<00:09, 101.86it/s]backtest loop:  57%|█████▋    | 1246/2187 [00:14<00:09, 102.03it/s]backtest loop:  58%|█████▊    | 1258/2187 [00:14<00:09, 102.84it/s]backtest loop:  58%|█████▊    | 1270/2187 [00:14<00:08, 107.12it/s]backtest loop:  59%|█████▊    | 1282/2187 [00:14<00:08, 105.58it/s]backtest loop:  59%|█████▉    | 1293/2187 [00:14<00:08, 105.03it/s]backtest loop:  60%|█████▉    | 1304/2187 [00:14<00:09, 96.65it/s] backtest loop:  60%|██████    | 1314/2187 [00:15<00:09, 96.87it/s]backtest loop:  61%|██████    | 1324/2187 [00:15<00:08, 97.04it/s]backtest loop:  61%|██████    | 1334/2187 [00:15<00:09, 92.71it/s]backtest loop:  61%|██████▏   | 1344/2187 [00:15<00:09, 90.46it/s]backtest loop:  62%|██████▏   | 1354/2187 [00:15<00:09, 89.06it/s]backtest loop:  62%|██████▏   | 1363/2187 [00:15<00:09, 86.73it/s]backtest loop:  63%|██████▎   | 1373/2187 [00:15<00:09, 85.76it/s]backtest loop:  63%|██████▎   | 1383/2187 [00:15<00:09, 85.16it/s]backtest loop:  64%|██████▎   | 1393/2187 [00:16<00:09, 84.69it/s]backtest loop:  64%|██████▍   | 1402/2187 [00:16<00:09, 81.61it/s]backtest loop:  65%|██████▍   | 1413/2187 [00:16<00:08, 88.15it/s]backtest loop:  65%|██████▌   | 1424/2187 [00:16<00:08, 92.51it/s]backtest loop:  66%|██████▌   | 1435/2187 [00:16<00:07, 95.75it/s]backtest loop:  66%|██████▌   | 1445/2187 [00:16<00:07, 93.52it/s]backtest loop:  67%|██████▋   | 1455/2187 [00:16<00:08, 91.08it/s]backtest loop:  67%|██████▋   | 1465/2187 [00:16<00:08, 84.73it/s]backtest loop:  67%|██████▋   | 1475/2187 [00:16<00:08, 85.05it/s]backtest loop:  68%|██████▊   | 1485/2187 [00:17<00:08, 84.65it/s]backtest loop:  68%|██████▊   | 1495/2187 [00:17<00:08, 84.26it/s]backtest loop:  69%|██████▉   | 1505/2187 [00:17<00:08, 84.56it/s]backtest loop:  69%|██████▉   | 1515/2187 [00:17<00:07, 84.42it/s]backtest loop:  70%|██████▉   | 1524/2187 [00:17<00:07, 83.57it/s]backtest loop:  70%|███████   | 1533/2187 [00:17<00:07, 83.26it/s]backtest loop:  71%|███████   | 1542/2187 [00:17<00:07, 81.53it/s]backtest loop:  71%|███████   | 1551/2187 [00:17<00:07, 81.34it/s]backtest loop:  71%|███████▏  | 1560/2187 [00:17<00:07, 81.67it/s]backtest loop:  72%|███████▏  | 1569/2187 [00:18<00:07, 81.20it/s]backtest loop:  72%|███████▏  | 1579/2187 [00:18<00:07, 81.47it/s]backtest loop:  73%|███████▎  | 1589/2187 [00:18<00:07, 81.83it/s]backtest loop:  73%|███████▎  | 1599/2187 [00:18<00:07, 82.47it/s]backtest loop:  74%|███████▎  | 1609/2187 [00:18<00:06, 83.29it/s]backtest loop:  74%|███████▍  | 1619/2187 [00:18<00:06, 83.94it/s]backtest loop:  74%|███████▍  | 1629/2187 [00:18<00:06, 84.43it/s]backtest loop:  75%|███████▍  | 1638/2187 [00:18<00:06, 82.98it/s]backtest loop:  75%|███████▌  | 1648/2187 [00:19<00:06, 82.91it/s]backtest loop:  76%|███████▌  | 1658/2187 [00:19<00:06, 83.16it/s]backtest loop:  76%|███████▋  | 1668/2187 [00:19<00:06, 82.63it/s]backtest loop:  77%|███████▋  | 1678/2187 [00:19<00:06, 82.75it/s]backtest loop:  77%|███████▋  | 1688/2187 [00:19<00:05, 84.83it/s]backtest loop:  78%|███████▊  | 1698/2187 [00:19<00:05, 85.40it/s]backtest loop:  78%|███████▊  | 1707/2187 [00:19<00:05, 84.03it/s]backtest loop:  79%|███████▊  | 1717/2187 [00:19<00:05, 87.24it/s]backtest loop:  79%|███████▉  | 1727/2187 [00:19<00:05, 90.41it/s]backtest loop:  79%|███████▉  | 1737/2187 [00:20<00:04, 92.33it/s]backtest loop:  80%|███████▉  | 1748/2187 [00:20<00:04, 96.15it/s]backtest loop:  80%|████████  | 1759/2187 [00:20<00:04, 99.06it/s]backtest loop:  81%|████████  | 1769/2187 [00:20<00:04, 96.77it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:20<00:04, 99.55it/s]backtest loop:  82%|████████▏ | 1793/2187 [00:20<00:03, 102.80it/s]backtest loop:  83%|████████▎ | 1806/2187 [00:20<00:03, 109.61it/s]backtest loop:  83%|████████▎ | 1817/2187 [00:20<00:03, 107.82it/s]backtest loop:  84%|████████▎ | 1830/2187 [00:20<00:03, 113.31it/s]backtest loop:  84%|████████▍ | 1842/2187 [00:21<00:03, 111.74it/s]backtest loop:  85%|████████▍ | 1855/2187 [00:21<00:02, 116.03it/s]backtest loop:  85%|████████▌ | 1867/2187 [00:21<00:02, 113.52it/s]backtest loop:  86%|████████▌ | 1880/2187 [00:21<00:02, 116.95it/s]backtest loop:  87%|████████▋ | 1892/2187 [00:21<00:02, 114.22it/s]backtest loop:  87%|████████▋ | 1905/2187 [00:21<00:02, 113.41it/s]backtest loop:  88%|████████▊ | 1918/2187 [00:21<00:02, 117.05it/s]backtest loop:  88%|████████▊ | 1930/2187 [00:21<00:02, 110.93it/s]backtest loop:  89%|████████▉ | 1942/2187 [00:21<00:02, 110.52it/s]backtest loop:  89%|████████▉ | 1954/2187 [00:22<00:02, 105.72it/s]backtest loop:  90%|████████▉ | 1965/2187 [00:22<00:02, 105.60it/s]backtest loop:  90%|█████████ | 1976/2187 [00:22<00:02, 104.65it/s]backtest loop:  91%|█████████ | 1987/2187 [00:22<00:01, 105.15it/s]backtest loop:  91%|█████████▏| 1998/2187 [00:22<00:01, 101.09it/s]backtest loop:  92%|█████████▏| 2009/2187 [00:22<00:01, 102.45it/s]backtest loop:  92%|█████████▏| 2020/2187 [00:22<00:01, 103.40it/s]backtest loop:  93%|█████████▎| 2031/2187 [00:22<00:01, 98.36it/s] backtest loop:  93%|█████████▎| 2041/2187 [00:22<00:01, 95.22it/s]backtest loop:  94%|█████████▍| 2051/2187 [00:23<00:01, 92.93it/s]backtest loop:  94%|█████████▍| 2061/2187 [00:23<00:01, 90.34it/s]backtest loop:  95%|█████████▍| 2071/2187 [00:23<00:01, 89.69it/s]backtest loop:  95%|█████████▌| 2080/2187 [00:23<00:01, 87.81it/s]backtest loop:  96%|█████████▌| 2089/2187 [00:23<00:01, 86.08it/s]backtest loop:  96%|█████████▌| 2098/2187 [00:23<00:01, 84.39it/s]backtest loop:  96%|█████████▋| 2107/2187 [00:23<00:00, 83.43it/s]backtest loop:  97%|█████████▋| 2117/2187 [00:23<00:00, 84.45it/s]backtest loop:  97%|█████████▋| 2126/2187 [00:23<00:00, 79.78it/s]backtest loop:  98%|█████████▊| 2135/2187 [00:24<00:00, 81.77it/s]backtest loop:  98%|█████████▊| 2145/2187 [00:24<00:00, 82.77it/s]backtest loop:  99%|█████████▊| 2155/2187 [00:24<00:00, 83.27it/s]backtest loop:  99%|█████████▉| 2165/2187 [00:24<00:00, 83.47it/s]backtest loop:  99%|█████████▉| 2175/2187 [00:24<00:00, 83.85it/s]backtest loop: 100%|█████████▉| 2185/2187 [00:24<00:00, 84.50it/s]backtest loop: 100%|██████████| 2187/2187 [00:24<00:00, 88.71it/s]
2026-01-11 18:44:00.768 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 18:44:00.769 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0340
2026-01-11 18:44:00.769 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.4193
2026-01-11 18:44:00.769 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2563
2026-01-11 18:44:06.909 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pdf/full_backtest_report.pdf
2026-01-11 18:44:27.503 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:44:27.686 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_172522_gru_158_20_zscore_6y/pred/full_pred.parquet
