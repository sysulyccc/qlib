Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1412324:MainThread](2026-01-11 22:20:29,603) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1412324:MainThread](2026-01-11 22:20:30,177) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1412324:MainThread](2026-01-11 22:20:30,177) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 22:20:30.188 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y
2026-01-11 22:20:30.188 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/log/mlp_360_robust_csi500_topk_20260111_222030.log
2026-01-11 22:20:30.188 | INFO     | __main__:__init__:115 - Model name: mlp_360_robust_csi500_topk
2026-01-11 22:20:30.191 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 22:20:30.191 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:20:30.191 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 22:20:30.191 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:20:30.191 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:21:06,115) INFO - qlib.timer - [log.py:127] - Time cost: 35.922s | Loading data Done
[1412324:MainThread](2026-01-11 22:21:15,332) INFO - qlib.timer - [log.py:127] - Time cost: 8.659s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:21:19,402) INFO - qlib.timer - [log.py:127] - Time cost: 4.068s | Fillna Done
[1412324:MainThread](2026-01-11 22:21:21,129) INFO - qlib.timer - [log.py:127] - Time cost: 0.325s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:21:21,341) INFO - qlib.timer - [log.py:127] - Time cost: 0.212s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:21:21,344) INFO - qlib.timer - [log.py:127] - Time cost: 15.228s | fit & process data Done
[1412324:MainThread](2026-01-11 22:21:21,344) INFO - qlib.timer - [log.py:127] - Time cost: 51.152s | Init data Done
2026-01-11 22:21:21.345 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:21:21,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:21:21,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:21:21,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:21:21,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:21:22.973 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:21:24,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:21:24,764) INFO - qlib.workflow - [exp.py:258] - Experiment 528155627018642494 starts running ...
[1412324:MainThread](2026-01-11 22:21:24,840) INFO - qlib.workflow - [recorder.py:345] - Recorder 82bdadfc9c2e4a328b7ffd45dc6fb658 starts running under Experiment 528155627018642494 ...
[1412324:MainThread](2026-01-11 22:21:25,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.571518, valid_loss 1.095920, train_metric nan, valid_metric 0.029616
[1412324:MainThread](2026-01-11 22:21:25,645) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.095920, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:26,022) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.075603, valid_loss 1.031126, train_metric nan, valid_metric 0.066796
[1412324:MainThread](2026-01-11 22:21:26,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.095920 to 1.031126, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:26,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.049517, valid_loss 1.007365, train_metric nan, valid_metric 0.063759
[1412324:MainThread](2026-01-11 22:21:26,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.031126 to 1.007365, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:26,781) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.047434, valid_loss 1.002741, train_metric nan, valid_metric 0.066826
[1412324:MainThread](2026-01-11 22:21:26,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007365 to 1.002741, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:27,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.039887, valid_loss 1.000966, train_metric nan, valid_metric 0.067446
[1412324:MainThread](2026-01-11 22:21:27,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002741 to 1.000966, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:27,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.038728, valid_loss 1.005870, train_metric nan, valid_metric 0.079441
[1412324:MainThread](2026-01-11 22:21:28,011) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.036254, valid_loss 0.998097, train_metric nan, valid_metric 0.063294
[1412324:MainThread](2026-01-11 22:21:28,013) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000966 to 0.998097, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:28,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.035519, valid_loss 0.997636, train_metric nan, valid_metric 0.062002
[1412324:MainThread](2026-01-11 22:21:28,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998097 to 0.997636, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:28,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.031644, valid_loss 0.999061, train_metric nan, valid_metric 0.073485
[1412324:MainThread](2026-01-11 22:21:29,206) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.023808, valid_loss 0.997527, train_metric nan, valid_metric 0.068667
[1412324:MainThread](2026-01-11 22:21:29,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997636 to 0.997527, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:29,633) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.024707, valid_loss 0.996212, train_metric nan, valid_metric 0.073116
[1412324:MainThread](2026-01-11 22:21:29,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997527 to 0.996212, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:30,037) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.022020, valid_loss 0.995709, train_metric nan, valid_metric 0.078274
[1412324:MainThread](2026-01-11 22:21:30,044) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996212 to 0.995709, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:30,470) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.018313, valid_loss 0.997212, train_metric nan, valid_metric 0.067666
[1412324:MainThread](2026-01-11 22:21:30,861) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.018363, valid_loss 1.002410, train_metric nan, valid_metric 0.084990
[1412324:MainThread](2026-01-11 22:21:31,271) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.019839, valid_loss 0.998709, train_metric nan, valid_metric 0.085328
[1412324:MainThread](2026-01-11 22:21:31,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.019560, valid_loss 0.996503, train_metric nan, valid_metric 0.079805
[1412324:MainThread](2026-01-11 22:21:32,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.014120, valid_loss 0.995305, train_metric nan, valid_metric 0.082551
[1412324:MainThread](2026-01-11 22:21:32,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995709 to 0.995305, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:32,468) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.015155, valid_loss 0.995620, train_metric nan, valid_metric 0.087160
[1412324:MainThread](2026-01-11 22:21:32,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.008083, valid_loss 0.994494, train_metric nan, valid_metric 0.072342
[1412324:MainThread](2026-01-11 22:21:32,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995305 to 0.994494, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:33,270) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.016771, valid_loss 0.999334, train_metric nan, valid_metric 0.081321
[1412324:MainThread](2026-01-11 22:21:33,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.009781, valid_loss 0.994572, train_metric nan, valid_metric 0.088459
[1412324:MainThread](2026-01-11 22:21:34,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.010409, valid_loss 0.998421, train_metric nan, valid_metric 0.075765
[1412324:MainThread](2026-01-11 22:21:34,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.013162, valid_loss 0.994148, train_metric nan, valid_metric 0.085969
[1412324:MainThread](2026-01-11 22:21:34,472) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994494 to 0.994148, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:34,841) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.002388, valid_loss 0.993317, train_metric nan, valid_metric 0.088011
[1412324:MainThread](2026-01-11 22:21:34,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994148 to 0.993317, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:35,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.013030, valid_loss 0.995903, train_metric nan, valid_metric 0.078575
[1412324:MainThread](2026-01-11 22:21:35,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.003114, valid_loss 0.994845, train_metric nan, valid_metric 0.091878
[1412324:MainThread](2026-01-11 22:21:36,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.011512, valid_loss 0.995189, train_metric nan, valid_metric 0.073148
[1412324:MainThread](2026-01-11 22:21:36,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.005870, valid_loss 1.000441, train_metric nan, valid_metric 0.075942
[1412324:MainThread](2026-01-11 22:21:36,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.007367, valid_loss 1.000178, train_metric nan, valid_metric 0.092375
[1412324:MainThread](2026-01-11 22:21:37,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.003048, valid_loss 0.993770, train_metric nan, valid_metric 0.085843
[1412324:MainThread](2026-01-11 22:21:37,523) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.998154, valid_loss 1.001015, train_metric nan, valid_metric 0.089824
[1412324:MainThread](2026-01-11 22:21:37,898) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.011835, valid_loss 0.995403, train_metric nan, valid_metric 0.070262
[1412324:MainThread](2026-01-11 22:21:38,281) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.998931, valid_loss 0.994637, train_metric nan, valid_metric 0.079657
[1412324:MainThread](2026-01-11 22:21:38,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.003697, valid_loss 0.994605, train_metric nan, valid_metric 0.086421
[1412324:MainThread](2026-01-11 22:21:39,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.992840, valid_loss 0.997177, train_metric nan, valid_metric 0.094454
[1412324:MainThread](2026-01-11 22:21:39,418) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.997842, valid_loss 0.997543, train_metric nan, valid_metric 0.091800
[1412324:MainThread](2026-01-11 22:21:39,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.993502, valid_loss 0.993747, train_metric nan, valid_metric 0.091026
[1412324:MainThread](2026-01-11 22:21:40,181) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.998470, valid_loss 0.994945, train_metric nan, valid_metric 0.087816
[1412324:MainThread](2026-01-11 22:21:40,562) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.997788, valid_loss 0.994048, train_metric nan, valid_metric 0.084987
[1412324:MainThread](2026-01-11 22:21:40,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.995212, valid_loss 0.994395, train_metric nan, valid_metric 0.095850
[1412324:MainThread](2026-01-11 22:21:41,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.995097, valid_loss 0.996575, train_metric nan, valid_metric 0.095036
[1412324:MainThread](2026-01-11 22:21:41,716) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.991065, valid_loss 0.994144, train_metric nan, valid_metric 0.085850
[1412324:MainThread](2026-01-11 22:21:42,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.998385, valid_loss 0.999779, train_metric nan, valid_metric 0.096124
[1412324:MainThread](2026-01-11 22:21:42,497) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.997178, valid_loss 0.993110, train_metric nan, valid_metric 0.092572
[1412324:MainThread](2026-01-11 22:21:42,500) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993317 to 0.993110, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:42,909) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.996292, valid_loss 0.992620, train_metric nan, valid_metric 0.093439
[1412324:MainThread](2026-01-11 22:21:42,912) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993110 to 0.992620, save checkpoint.
[1412324:MainThread](2026-01-11 22:21:43,305) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.998482, valid_loss 0.993676, train_metric nan, valid_metric 0.084566
[1412324:MainThread](2026-01-11 22:21:43,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.992028, valid_loss 0.994485, train_metric nan, valid_metric 0.098226
[1412324:MainThread](2026-01-11 22:21:44,083) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.993989, valid_loss 0.994905, train_metric nan, valid_metric 0.080597
[1412324:MainThread](2026-01-11 22:21:44,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.992665, valid_loss 0.994636, train_metric nan, valid_metric 0.098564
[1412324:MainThread](2026-01-11 22:21:44,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.994886, valid_loss 0.996113, train_metric nan, valid_metric 0.095370
[1412324:MainThread](2026-01-11 22:21:45,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.993420, valid_loss 0.994706, train_metric nan, valid_metric 0.096236
[1412324:MainThread](2026-01-11 22:21:45,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.998284, valid_loss 0.995856, train_metric nan, valid_metric 0.092377
[1412324:MainThread](2026-01-11 22:21:45,752) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.993862, valid_loss 0.995990, train_metric nan, valid_metric 0.084819
[1412324:MainThread](2026-01-11 22:21:46,128) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.000587, valid_loss 0.994503, train_metric nan, valid_metric 0.093525
[1412324:MainThread](2026-01-11 22:21:46,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.996391, valid_loss 0.994006, train_metric nan, valid_metric 0.096311
[1412324:MainThread](2026-01-11 22:21:46,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.990862, valid_loss 0.997054, train_metric nan, valid_metric 0.094073
[1412324:MainThread](2026-01-11 22:21:47,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.995608, valid_loss 0.993255, train_metric nan, valid_metric 0.097869
[1412324:MainThread](2026-01-11 22:21:47,777) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.991058, valid_loss 0.996413, train_metric nan, valid_metric 0.093300
[1412324:MainThread](2026-01-11 22:21:48,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.998890, valid_loss 0.997063, train_metric nan, valid_metric 0.093023
[1412324:MainThread](2026-01-11 22:21:48,556) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.989657, valid_loss 0.993627, train_metric nan, valid_metric 0.096734
[1412324:MainThread](2026-01-11 22:21:48,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.991139, valid_loss 0.996428, train_metric nan, valid_metric 0.097719
[1412324:MainThread](2026-01-11 22:21:49,354) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.989914, valid_loss 0.994405, train_metric nan, valid_metric 0.094012
[1412324:MainThread](2026-01-11 22:21:49,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.992338, valid_loss 0.993983, train_metric nan, valid_metric 0.095106
[1412324:MainThread](2026-01-11 22:21:50,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.989676, valid_loss 0.995061, train_metric nan, valid_metric 0.082344
[1412324:MainThread](2026-01-11 22:21:50,476) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.986780, valid_loss 0.993658, train_metric nan, valid_metric 0.088357
[1412324:MainThread](2026-01-11 22:21:50,851) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.988086, valid_loss 0.993839, train_metric nan, valid_metric 0.091006
[1412324:MainThread](2026-01-11 22:21:51,228) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.989463, valid_loss 0.994658, train_metric nan, valid_metric 0.092195
[1412324:MainThread](2026-01-11 22:21:51,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.990668, valid_loss 0.993265, train_metric nan, valid_metric 0.092166
[1412324:MainThread](2026-01-11 22:21:51,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.993542, valid_loss 0.993561, train_metric nan, valid_metric 0.094812
[1412324:MainThread](2026-01-11 22:21:52,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.996513, valid_loss 0.993496, train_metric nan, valid_metric 0.094039
[1412324:MainThread](2026-01-11 22:21:52,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.986822, valid_loss 0.995316, train_metric nan, valid_metric 0.095533
[1412324:MainThread](2026-01-11 22:21:53,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.993598, valid_loss 0.993677, train_metric nan, valid_metric 0.094735
[1412324:MainThread](2026-01-11 22:21:53,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.989421, valid_loss 0.993718, train_metric nan, valid_metric 0.096154
[1412324:MainThread](2026-01-11 22:21:53,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.994860, valid_loss 0.993315, train_metric nan, valid_metric 0.090349
[1412324:MainThread](2026-01-11 22:21:54,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.991063, valid_loss 0.994752, train_metric nan, valid_metric 0.092278
[1412324:MainThread](2026-01-11 22:21:54,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.994510, valid_loss 0.993368, train_metric nan, valid_metric 0.094515
[1412324:MainThread](2026-01-11 22:21:55,062) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.987611, valid_loss 0.994231, train_metric nan, valid_metric 0.092601
[1412324:MainThread](2026-01-11 22:21:55,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.986429, valid_loss 0.994881, train_metric nan, valid_metric 0.089029
[1412324:MainThread](2026-01-11 22:21:55,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.992532, valid_loss 0.995143, train_metric nan, valid_metric 0.097945
[1412324:MainThread](2026-01-11 22:21:56,336) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.992531, valid_loss 0.993913, train_metric nan, valid_metric 0.095981
[1412324:MainThread](2026-01-11 22:21:56,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.984297, valid_loss 0.993845, train_metric nan, valid_metric 0.093238
[1412324:MainThread](2026-01-11 22:21:57,125) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.988964, valid_loss 0.993512, train_metric nan, valid_metric 0.095181
[1412324:MainThread](2026-01-11 22:21:57,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.985721, valid_loss 0.993878, train_metric nan, valid_metric 0.092617
[1412324:MainThread](2026-01-11 22:21:57,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.994190, valid_loss 0.993846, train_metric nan, valid_metric 0.095629
[1412324:MainThread](2026-01-11 22:21:58,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.995935, valid_loss 0.994852, train_metric nan, valid_metric 0.097624
[1412324:MainThread](2026-01-11 22:21:58,625) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.989940, valid_loss 0.994002, train_metric nan, valid_metric 0.094740
[1412324:MainThread](2026-01-11 22:21:58,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.992529, valid_loss 0.994410, train_metric nan, valid_metric 0.093790
[1412324:MainThread](2026-01-11 22:21:59,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.987492, valid_loss 0.993946, train_metric nan, valid_metric 0.096612
[1412324:MainThread](2026-01-11 22:21:59,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.983479, valid_loss 0.994170, train_metric nan, valid_metric 0.097458
[1412324:MainThread](2026-01-11 22:22:00,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.989392, valid_loss 0.994579, train_metric nan, valid_metric 0.097040
[1412324:MainThread](2026-01-11 22:22:00,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.992607, valid_loss 0.994024, train_metric nan, valid_metric 0.096504
[1412324:MainThread](2026-01-11 22:22:00,907) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.993786, valid_loss 0.993806, train_metric nan, valid_metric 0.095940
[1412324:MainThread](2026-01-11 22:22:01,283) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.990232, valid_loss 0.993893, train_metric nan, valid_metric 0.095671
[1412324:MainThread](2026-01-11 22:22:01,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.992015, valid_loss 0.993921, train_metric nan, valid_metric 0.096234
[1412324:MainThread](2026-01-11 22:22:02,046) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.993931, valid_loss 0.994204, train_metric nan, valid_metric 0.096788
[1412324:MainThread](2026-01-11 22:22:02,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:22:02.063 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:22:05.071 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 22:22:05.071 | INFO     | __main__:train_single_fold:593 -   IC=0.0686, ICIR=0.5714, RankIC=0.0882, RankICIR=0.7947
2026-01-11 22:22:05.071 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:22:05,079) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1412324:MainThread](2026-01-11 22:22:29,334) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:22:29,335) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:22:35,256) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1bdc5e05d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▍         | 10/244 [00:00<00:02, 79.23it/s]backtest loop:   8%|▊         | 20/244 [00:00<00:02, 82.67it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:02, 83.31it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 86.53it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 85.06it/s]backtest loop:  25%|██▌       | 61/244 [00:00<00:02, 90.93it/s]backtest loop:  29%|██▉       | 71/244 [00:00<00:01, 93.18it/s]backtest loop:  33%|███▎      | 81/244 [00:00<00:01, 93.32it/s]backtest loop:  37%|███▋      | 91/244 [00:01<00:01, 93.59it/s]backtest loop:  41%|████▏     | 101/244 [00:01<00:01, 93.35it/s]backtest loop:  45%|████▌     | 111/244 [00:01<00:01, 91.51it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 92.68it/s]backtest loop:  54%|█████▎    | 131/244 [00:01<00:01, 94.01it/s]backtest loop:  58%|█████▊    | 142/244 [00:01<00:01, 97.15it/s]backtest loop:  62%|██████▏   | 152/244 [00:01<00:00, 96.30it/s]backtest loop:  66%|██████▋   | 162/244 [00:01<00:00, 92.93it/s]backtest loop:  70%|███████   | 172/244 [00:01<00:00, 88.46it/s]backtest loop:  74%|███████▍  | 181/244 [00:02<00:00, 86.05it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 78.75it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 79.88it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 81.02it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 82.74it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 82.48it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 82.56it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 87.32it/s]
2026-01-11 22:22:38.075 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3337, Sharpe(w/cost)=3.3082, MaxDD=-0.0292
2026-01-11 22:22:42.466 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 22:22:58.698 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:22:58.791 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_0_pred.parquet
2026-01-11 22:22:58.819 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:22:58.819 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 22:22:58.819 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:22:58.819 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:24:08,849) INFO - qlib.timer - [log.py:127] - Time cost: 70.028s | Loading data Done
[1412324:MainThread](2026-01-11 22:24:17,409) INFO - qlib.timer - [log.py:127] - Time cost: 8.004s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:24:21,210) INFO - qlib.timer - [log.py:127] - Time cost: 3.799s | Fillna Done
[1412324:MainThread](2026-01-11 22:24:22,919) INFO - qlib.timer - [log.py:127] - Time cost: 0.318s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:24:23,126) INFO - qlib.timer - [log.py:127] - Time cost: 0.206s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:24:23,129) INFO - qlib.timer - [log.py:127] - Time cost: 14.279s | fit & process data Done
[1412324:MainThread](2026-01-11 22:24:23,130) INFO - qlib.timer - [log.py:127] - Time cost: 84.309s | Init data Done
2026-01-11 22:24:23.130 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:24:23,131) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:24:23,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:24:23,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:24:23,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:24:23.147 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:24:24,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:24:25,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.914659, valid_loss 1.360822, train_metric nan, valid_metric -0.039398
[1412324:MainThread](2026-01-11 22:24:25,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.360822, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:25,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.114156, valid_loss 1.033514, train_metric nan, valid_metric 0.008280
[1412324:MainThread](2026-01-11 22:24:25,930) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.360822 to 1.033514, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:26,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.069854, valid_loss 1.010794, train_metric nan, valid_metric 0.039537
[1412324:MainThread](2026-01-11 22:24:26,246) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.033514 to 1.010794, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:26,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.046021, valid_loss 1.006089, train_metric nan, valid_metric 0.043128
[1412324:MainThread](2026-01-11 22:24:26,597) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.010794 to 1.006089, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:26,974) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.053574, valid_loss 1.006543, train_metric nan, valid_metric 0.044285
[1412324:MainThread](2026-01-11 22:24:27,373) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.054294, valid_loss 1.006082, train_metric nan, valid_metric 0.069802
[1412324:MainThread](2026-01-11 22:24:27,375) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006089 to 1.006082, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:27,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.044826, valid_loss 1.005216, train_metric nan, valid_metric 0.075976
[1412324:MainThread](2026-01-11 22:24:27,758) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006082 to 1.005216, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:28,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.044068, valid_loss 1.000095, train_metric nan, valid_metric 0.064110
[1412324:MainThread](2026-01-11 22:24:28,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005216 to 1.000095, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:28,608) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.046931, valid_loss 0.999148, train_metric nan, valid_metric 0.067500
[1412324:MainThread](2026-01-11 22:24:28,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000095 to 0.999148, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:29,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.039221, valid_loss 1.000667, train_metric nan, valid_metric 0.075477
[1412324:MainThread](2026-01-11 22:24:29,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.040141, valid_loss 0.998399, train_metric nan, valid_metric 0.080884
[1412324:MainThread](2026-01-11 22:24:29,400) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999148 to 0.998399, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:29,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.039462, valid_loss 0.998273, train_metric nan, valid_metric 0.077256
[1412324:MainThread](2026-01-11 22:24:29,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998399 to 0.998273, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:30,192) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.032301, valid_loss 1.001863, train_metric nan, valid_metric 0.084762
[1412324:MainThread](2026-01-11 22:24:30,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.027623, valid_loss 0.999149, train_metric nan, valid_metric 0.064862
[1412324:MainThread](2026-01-11 22:24:30,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.031185, valid_loss 1.003581, train_metric nan, valid_metric 0.076418
[1412324:MainThread](2026-01-11 22:24:31,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.022635, valid_loss 1.001033, train_metric nan, valid_metric 0.086294
[1412324:MainThread](2026-01-11 22:24:31,844) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.027620, valid_loss 1.002214, train_metric nan, valid_metric 0.049558
[1412324:MainThread](2026-01-11 22:24:32,318) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.023050, valid_loss 0.996726, train_metric nan, valid_metric 0.083373
[1412324:MainThread](2026-01-11 22:24:32,320) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998273 to 0.996726, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:32,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.018652, valid_loss 1.000263, train_metric nan, valid_metric 0.075448
[1412324:MainThread](2026-01-11 22:24:33,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.018267, valid_loss 0.998807, train_metric nan, valid_metric 0.089513
[1412324:MainThread](2026-01-11 22:24:33,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.021412, valid_loss 1.001207, train_metric nan, valid_metric 0.052491
[1412324:MainThread](2026-01-11 22:24:33,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.014987, valid_loss 0.996029, train_metric nan, valid_metric 0.089889
[1412324:MainThread](2026-01-11 22:24:33,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996726 to 0.996029, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:34,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.014606, valid_loss 0.998627, train_metric nan, valid_metric 0.093292
[1412324:MainThread](2026-01-11 22:24:34,705) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.021026, valid_loss 0.995225, train_metric nan, valid_metric 0.073234
[1412324:MainThread](2026-01-11 22:24:34,708) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996029 to 0.995225, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:35,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.015766, valid_loss 0.998694, train_metric nan, valid_metric 0.083328
[1412324:MainThread](2026-01-11 22:24:35,588) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.019018, valid_loss 0.998398, train_metric nan, valid_metric 0.087886
[1412324:MainThread](2026-01-11 22:24:36,043) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.007922, valid_loss 0.995339, train_metric nan, valid_metric 0.084067
[1412324:MainThread](2026-01-11 22:24:36,479) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.008126, valid_loss 0.996165, train_metric nan, valid_metric 0.092258
[1412324:MainThread](2026-01-11 22:24:36,900) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.007122, valid_loss 0.995031, train_metric nan, valid_metric 0.084011
[1412324:MainThread](2026-01-11 22:24:36,902) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995225 to 0.995031, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:37,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.011865, valid_loss 0.997597, train_metric nan, valid_metric 0.066374
[1412324:MainThread](2026-01-11 22:24:37,715) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.009418, valid_loss 0.996590, train_metric nan, valid_metric 0.071180
[1412324:MainThread](2026-01-11 22:24:38,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.013625, valid_loss 0.995621, train_metric nan, valid_metric 0.086728
[1412324:MainThread](2026-01-11 22:24:38,585) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.001221, valid_loss 1.000756, train_metric nan, valid_metric 0.091314
[1412324:MainThread](2026-01-11 22:24:38,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.010593, valid_loss 0.995147, train_metric nan, valid_metric 0.090784
[1412324:MainThread](2026-01-11 22:24:39,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.006636, valid_loss 0.996502, train_metric nan, valid_metric 0.070429
[1412324:MainThread](2026-01-11 22:24:39,829) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.008606, valid_loss 1.000865, train_metric nan, valid_metric 0.099257
[1412324:MainThread](2026-01-11 22:24:40,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.004220, valid_loss 0.994172, train_metric nan, valid_metric 0.087048
[1412324:MainThread](2026-01-11 22:24:40,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995031 to 0.994172, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:40,628) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.000269, valid_loss 0.994783, train_metric nan, valid_metric 0.081515
[1412324:MainThread](2026-01-11 22:24:41,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.005607, valid_loss 0.998276, train_metric nan, valid_metric 0.092187
[1412324:MainThread](2026-01-11 22:24:41,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.007517, valid_loss 0.996590, train_metric nan, valid_metric 0.084540
[1412324:MainThread](2026-01-11 22:24:41,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.996345, valid_loss 0.994835, train_metric nan, valid_metric 0.082417
[1412324:MainThread](2026-01-11 22:24:42,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.001493, valid_loss 0.998266, train_metric nan, valid_metric 0.062091
[1412324:MainThread](2026-01-11 22:24:42,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.003561, valid_loss 0.996987, train_metric nan, valid_metric 0.069862
[1412324:MainThread](2026-01-11 22:24:43,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.000266, valid_loss 0.996519, train_metric nan, valid_metric 0.094921
[1412324:MainThread](2026-01-11 22:24:43,576) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.997296, valid_loss 0.997871, train_metric nan, valid_metric 0.084998
[1412324:MainThread](2026-01-11 22:24:43,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.003168, valid_loss 0.996534, train_metric nan, valid_metric 0.084796
[1412324:MainThread](2026-01-11 22:24:44,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.996026, valid_loss 0.994347, train_metric nan, valid_metric 0.086714
[1412324:MainThread](2026-01-11 22:24:44,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.003782, valid_loss 0.994905, train_metric nan, valid_metric 0.097159
[1412324:MainThread](2026-01-11 22:24:45,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.997442, valid_loss 0.994998, train_metric nan, valid_metric 0.094070
[1412324:MainThread](2026-01-11 22:24:45,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.997023, valid_loss 0.993297, train_metric nan, valid_metric 0.088516
[1412324:MainThread](2026-01-11 22:24:45,607) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994172 to 0.993297, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:46,027) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.995044, valid_loss 0.994053, train_metric nan, valid_metric 0.093993
[1412324:MainThread](2026-01-11 22:24:46,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.998793, valid_loss 0.995020, train_metric nan, valid_metric 0.087734
[1412324:MainThread](2026-01-11 22:24:46,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.995948, valid_loss 0.994321, train_metric nan, valid_metric 0.095515
[1412324:MainThread](2026-01-11 22:24:47,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.995376, valid_loss 0.996125, train_metric nan, valid_metric 0.100353
[1412324:MainThread](2026-01-11 22:24:47,674) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.999868, valid_loss 0.994269, train_metric nan, valid_metric 0.093703
[1412324:MainThread](2026-01-11 22:24:48,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.997789, valid_loss 0.994700, train_metric nan, valid_metric 0.093774
[1412324:MainThread](2026-01-11 22:24:48,552) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.997130, valid_loss 0.994808, train_metric nan, valid_metric 0.099848
[1412324:MainThread](2026-01-11 22:24:48,955) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.996980, valid_loss 0.995246, train_metric nan, valid_metric 0.096227
[1412324:MainThread](2026-01-11 22:24:49,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.998588, valid_loss 0.998314, train_metric nan, valid_metric 0.099656
[1412324:MainThread](2026-01-11 22:24:49,760) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.995801, valid_loss 0.995120, train_metric nan, valid_metric 0.078145
[1412324:MainThread](2026-01-11 22:24:50,189) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 1.000391, valid_loss 0.994399, train_metric nan, valid_metric 0.094508
[1412324:MainThread](2026-01-11 22:24:50,592) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.992662, valid_loss 0.994103, train_metric nan, valid_metric 0.093670
[1412324:MainThread](2026-01-11 22:24:50,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.997338, valid_loss 0.995056, train_metric nan, valid_metric 0.094867
[1412324:MainThread](2026-01-11 22:24:51,391) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.998862, valid_loss 0.993836, train_metric nan, valid_metric 0.097605
[1412324:MainThread](2026-01-11 22:24:51,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.997155, valid_loss 0.994845, train_metric nan, valid_metric 0.082986
[1412324:MainThread](2026-01-11 22:24:52,196) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.997898, valid_loss 0.994060, train_metric nan, valid_metric 0.091888
[1412324:MainThread](2026-01-11 22:24:52,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.992793, valid_loss 0.994553, train_metric nan, valid_metric 0.087810
[1412324:MainThread](2026-01-11 22:24:53,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.994243, valid_loss 0.994345, train_metric nan, valid_metric 0.091132
[1412324:MainThread](2026-01-11 22:24:53,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.998369, valid_loss 0.995675, train_metric nan, valid_metric 0.100735
[1412324:MainThread](2026-01-11 22:24:53,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.995292, valid_loss 0.994434, train_metric nan, valid_metric 0.098830
[1412324:MainThread](2026-01-11 22:24:54,195) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.991886, valid_loss 0.994359, train_metric nan, valid_metric 0.099275
[1412324:MainThread](2026-01-11 22:24:54,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.990735, valid_loss 0.993622, train_metric nan, valid_metric 0.098174
[1412324:MainThread](2026-01-11 22:24:55,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.994734, valid_loss 0.993982, train_metric nan, valid_metric 0.098030
[1412324:MainThread](2026-01-11 22:24:55,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.992557, valid_loss 0.993485, train_metric nan, valid_metric 0.095979
[1412324:MainThread](2026-01-11 22:24:55,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.991286, valid_loss 0.994147, train_metric nan, valid_metric 0.100184
[1412324:MainThread](2026-01-11 22:24:56,205) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.986779, valid_loss 0.993257, train_metric nan, valid_metric 0.098216
[1412324:MainThread](2026-01-11 22:24:56,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993297 to 0.993257, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:56,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.991543, valid_loss 0.994782, train_metric nan, valid_metric 0.088639
[1412324:MainThread](2026-01-11 22:24:57,086) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.989168, valid_loss 0.993722, train_metric nan, valid_metric 0.095730
[1412324:MainThread](2026-01-11 22:24:57,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.991184, valid_loss 0.994785, train_metric nan, valid_metric 0.097757
[1412324:MainThread](2026-01-11 22:24:57,972) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.991155, valid_loss 0.993795, train_metric nan, valid_metric 0.097573
[1412324:MainThread](2026-01-11 22:24:58,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.995459, valid_loss 0.994184, train_metric nan, valid_metric 0.100471
[1412324:MainThread](2026-01-11 22:24:58,922) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.995770, valid_loss 0.994227, train_metric nan, valid_metric 0.094663
[1412324:MainThread](2026-01-11 22:24:59,321) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.990673, valid_loss 0.993164, train_metric nan, valid_metric 0.099619
[1412324:MainThread](2026-01-11 22:24:59,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993257 to 0.993164, save checkpoint.
[1412324:MainThread](2026-01-11 22:24:59,736) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.994982, valid_loss 0.994550, train_metric nan, valid_metric 0.096162
[1412324:MainThread](2026-01-11 22:25:00,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.990920, valid_loss 0.995278, train_metric nan, valid_metric 0.096119
[1412324:MainThread](2026-01-11 22:25:00,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.986109, valid_loss 0.993674, train_metric nan, valid_metric 0.096571
[1412324:MainThread](2026-01-11 22:25:01,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.991575, valid_loss 0.995001, train_metric nan, valid_metric 0.102019
[1412324:MainThread](2026-01-11 22:25:01,424) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.988816, valid_loss 0.995330, train_metric nan, valid_metric 0.100030
[1412324:MainThread](2026-01-11 22:25:01,818) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.990413, valid_loss 0.994301, train_metric nan, valid_metric 0.101761
[1412324:MainThread](2026-01-11 22:25:02,200) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.990554, valid_loss 0.994026, train_metric nan, valid_metric 0.097986
[1412324:MainThread](2026-01-11 22:25:02,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.996342, valid_loss 0.995274, train_metric nan, valid_metric 0.102089
[1412324:MainThread](2026-01-11 22:25:03,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.989120, valid_loss 0.994246, train_metric nan, valid_metric 0.096978
[1412324:MainThread](2026-01-11 22:25:03,433) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.992492, valid_loss 0.994265, train_metric nan, valid_metric 0.103019
[1412324:MainThread](2026-01-11 22:25:03,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.995761, valid_loss 0.994242, train_metric nan, valid_metric 0.100723
[1412324:MainThread](2026-01-11 22:25:04,203) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.989197, valid_loss 0.993857, train_metric nan, valid_metric 0.096194
[1412324:MainThread](2026-01-11 22:25:04,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.993654, valid_loss 0.993684, train_metric nan, valid_metric 0.099817
[1412324:MainThread](2026-01-11 22:25:05,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.991863, valid_loss 0.994116, train_metric nan, valid_metric 0.100540
[1412324:MainThread](2026-01-11 22:25:05,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.987290, valid_loss 0.993638, train_metric nan, valid_metric 0.096347
[1412324:MainThread](2026-01-11 22:25:05,901) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.994832, valid_loss 0.993879, train_metric nan, valid_metric 0.100494
[1412324:MainThread](2026-01-11 22:25:06,306) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.991003, valid_loss 0.993915, train_metric nan, valid_metric 0.096816
[1412324:MainThread](2026-01-11 22:25:06,687) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.987901, valid_loss 0.994461, train_metric nan, valid_metric 0.098871
[1412324:MainThread](2026-01-11 22:25:07,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.989182, valid_loss 0.994311, train_metric nan, valid_metric 0.097232
[1412324:MainThread](2026-01-11 22:25:07,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.994887, valid_loss 0.994127, train_metric nan, valid_metric 0.100383
[1412324:MainThread](2026-01-11 22:25:07,872) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.989103, valid_loss 0.993954, train_metric nan, valid_metric 0.095896
[1412324:MainThread](2026-01-11 22:25:08,310) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.991850, valid_loss 0.993799, train_metric nan, valid_metric 0.096434
[1412324:MainThread](2026-01-11 22:25:08,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.990953, valid_loss 0.994287, train_metric nan, valid_metric 0.099930
[1412324:MainThread](2026-01-11 22:25:09,119) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.993647, valid_loss 0.993772, train_metric nan, valid_metric 0.099341
[1412324:MainThread](2026-01-11 22:25:09,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.992440, valid_loss 0.993771, train_metric nan, valid_metric 0.099709
[1412324:MainThread](2026-01-11 22:25:09,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.985753, valid_loss 0.993738, train_metric nan, valid_metric 0.097397
[1412324:MainThread](2026-01-11 22:25:10,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.985977, valid_loss 0.993845, train_metric nan, valid_metric 0.098409
[1412324:MainThread](2026-01-11 22:25:10,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.989861, valid_loss 0.994341, train_metric nan, valid_metric 0.100100
[1412324:MainThread](2026-01-11 22:25:11,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.990820, valid_loss 0.993958, train_metric nan, valid_metric 0.098341
[1412324:MainThread](2026-01-11 22:25:11,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.993638, valid_loss 0.994394, train_metric nan, valid_metric 0.099874
[1412324:MainThread](2026-01-11 22:25:11,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.991941, valid_loss 0.994119, train_metric nan, valid_metric 0.098945
[1412324:MainThread](2026-01-11 22:25:12,367) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.991961, valid_loss 0.994943, train_metric nan, valid_metric 0.100875
[1412324:MainThread](2026-01-11 22:25:12,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.997323, valid_loss 0.994304, train_metric nan, valid_metric 0.093783
[1412324:MainThread](2026-01-11 22:25:13,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.999219, valid_loss 0.994231, train_metric nan, valid_metric 0.099283
[1412324:MainThread](2026-01-11 22:25:13,847) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.998901, valid_loss 0.994122, train_metric nan, valid_metric 0.098737
[1412324:MainThread](2026-01-11 22:25:14,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.995419, valid_loss 0.994245, train_metric nan, valid_metric 0.098679
[1412324:MainThread](2026-01-11 22:25:14,654) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.988423, valid_loss 0.993975, train_metric nan, valid_metric 0.098063
[1412324:MainThread](2026-01-11 22:25:15,047) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.992479, valid_loss 0.994120, train_metric nan, valid_metric 0.099555
[1412324:MainThread](2026-01-11 22:25:15,430) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.991376, valid_loss 0.994427, train_metric nan, valid_metric 0.099368
[1412324:MainThread](2026-01-11 22:25:15,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2460]: train_loss 0.991393, valid_loss 0.994186, train_metric nan, valid_metric 0.098647
[1412324:MainThread](2026-01-11 22:25:16,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2480]: train_loss 0.985942, valid_loss 0.993933, train_metric nan, valid_metric 0.099220
[1412324:MainThread](2026-01-11 22:25:16,604) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2500]: train_loss 0.991225, valid_loss 0.993453, train_metric nan, valid_metric 0.098620
[1412324:MainThread](2026-01-11 22:25:16,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2520]: train_loss 0.996995, valid_loss 0.993615, train_metric nan, valid_metric 0.099645
[1412324:MainThread](2026-01-11 22:25:17,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2540]: train_loss 0.991492, valid_loss 0.993975, train_metric nan, valid_metric 0.100508
[1412324:MainThread](2026-01-11 22:25:17,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2560]: train_loss 0.991403, valid_loss 0.994026, train_metric nan, valid_metric 0.100314
[1412324:MainThread](2026-01-11 22:25:18,155) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2580]: train_loss 0.992329, valid_loss 0.993704, train_metric nan, valid_metric 0.097890
[1412324:MainThread](2026-01-11 22:25:18,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2600]: train_loss 0.987371, valid_loss 0.993602, train_metric nan, valid_metric 0.098085
[1412324:MainThread](2026-01-11 22:25:18,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2620]: train_loss 0.991871, valid_loss 0.993810, train_metric nan, valid_metric 0.098931
[1412324:MainThread](2026-01-11 22:25:19,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2640]: train_loss 0.996302, valid_loss 0.993826, train_metric nan, valid_metric 0.098732
[1412324:MainThread](2026-01-11 22:25:19,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2660]: train_loss 0.988264, valid_loss 0.993787, train_metric nan, valid_metric 0.098208
[1412324:MainThread](2026-01-11 22:25:19,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:25:19.745 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:25:22.369 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 22:25:22.370 | INFO     | __main__:train_single_fold:593 -   IC=0.0445, ICIR=0.3167, RankIC=0.0640, RankICIR=0.5966
2026-01-11 22:25:22.370 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:25:22,376) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:25:53,424) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:25:53,425) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:25:59,841) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77731950>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 39.29it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 65.86it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 70.42it/s]backtest loop:  13%|█▎        | 31/244 [00:00<00:02, 76.97it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 79.49it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 82.40it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 82.50it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 83.63it/s]backtest loop:  32%|███▏      | 77/244 [00:00<00:02, 83.46it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 83.27it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 83.96it/s]backtest loop:  43%|████▎     | 105/244 [00:01<00:01, 83.86it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 84.97it/s]backtest loop:  51%|█████     | 124/244 [00:01<00:01, 85.12it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 85.39it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:01, 85.13it/s]backtest loop:  63%|██████▎   | 154/244 [00:01<00:01, 86.07it/s]backtest loop:  67%|██████▋   | 164/244 [00:01<00:00, 86.87it/s]backtest loop:  71%|███████▏  | 174/244 [00:02<00:00, 86.35it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 86.44it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 85.40it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 84.82it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 83.33it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 83.60it/s]backtest loop:  96%|█████████▌| 234/244 [00:02<00:00, 82.72it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 83.87it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 82.86it/s]
2026-01-11 22:26:02.809 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0338, Sharpe(w/cost)=-0.6311, MaxDD=-0.0779
2026-01-11 22:26:06.647 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 22:26:21.815 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:26:21.911 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_1_pred.parquet
2026-01-11 22:26:21.935 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 22:26:21.935 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 22:26:25.248 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0585
2026-01-11 22:26:25.569 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0446, ICIR=0.3153, RankIC=0.0640
[1412324:MainThread](2026-01-11 22:26:25,575) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:26:56,838) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:26:56,840) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:27:02,220) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77c5d710>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 36.05it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 66.10it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 71.68it/s]backtest loop:  13%|█▎        | 31/244 [00:00<00:02, 76.70it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 80.17it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 80.33it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 82.07it/s]backtest loop:  28%|██▊       | 68/244 [00:00<00:02, 82.31it/s]backtest loop:  32%|███▏      | 77/244 [00:00<00:02, 82.83it/s]backtest loop:  35%|███▌      | 86/244 [00:01<00:01, 83.23it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 85.02it/s]backtest loop:  43%|████▎     | 106/244 [00:01<00:01, 87.42it/s]backtest loop:  48%|████▊     | 116/244 [00:01<00:01, 89.25it/s]backtest loop:  51%|█████     | 125/244 [00:01<00:01, 85.27it/s]backtest loop:  55%|█████▍    | 134/244 [00:01<00:01, 81.02it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 70.25it/s]backtest loop:  62%|██████▏   | 151/244 [00:02<00:01, 47.11it/s]backtest loop:  64%|██████▍   | 157/244 [00:02<00:01, 44.21it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 47.19it/s]backtest loop:  69%|██████▉   | 169/244 [00:02<00:01, 49.42it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:01, 60.07it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 68.85it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 73.43it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 77.77it/s]backtest loop:  90%|████████▉ | 219/244 [00:03<00:00, 80.85it/s]backtest loop:  94%|█████████▍| 229/244 [00:03<00:00, 83.52it/s]backtest loop:  98%|█████████▊| 239/244 [00:03<00:00, 86.22it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 72.83it/s]
2026-01-11 22:27:05.595 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0613, Sharpe(w/cost)=1.1039
2026-01-11 22:27:05.673 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:27:05.674 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 22:27:05.674 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:27:05.674 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:28:28,346) INFO - qlib.timer - [log.py:127] - Time cost: 82.670s | Loading data Done
[1412324:MainThread](2026-01-11 22:28:36,657) INFO - qlib.timer - [log.py:127] - Time cost: 7.805s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:28:39,320) INFO - qlib.timer - [log.py:127] - Time cost: 2.661s | Fillna Done
[1412324:MainThread](2026-01-11 22:28:41,016) INFO - qlib.timer - [log.py:127] - Time cost: 0.305s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:28:41,221) INFO - qlib.timer - [log.py:127] - Time cost: 0.204s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:28:41,224) INFO - qlib.timer - [log.py:127] - Time cost: 12.877s | fit & process data Done
[1412324:MainThread](2026-01-11 22:28:41,224) INFO - qlib.timer - [log.py:127] - Time cost: 95.549s | Init data Done
2026-01-11 22:28:41.225 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:28:41,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:28:41,226) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:28:41,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:28:41,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:28:41.240 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:28:42,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:28:43,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.495137, valid_loss 1.088903, train_metric nan, valid_metric 0.042436
[1412324:MainThread](2026-01-11 22:28:43,380) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.088903, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:43,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.094015, valid_loss 1.024808, train_metric nan, valid_metric 0.047635
[1412324:MainThread](2026-01-11 22:28:43,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.088903 to 1.024808, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:44,019) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.061359, valid_loss 1.001166, train_metric nan, valid_metric 0.035182
[1412324:MainThread](2026-01-11 22:28:44,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.024808 to 1.001166, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:44,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.044448, valid_loss 0.998459, train_metric nan, valid_metric 0.053910
[1412324:MainThread](2026-01-11 22:28:44,348) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001166 to 0.998459, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:44,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.049631, valid_loss 0.999234, train_metric nan, valid_metric 0.047258
[1412324:MainThread](2026-01-11 22:28:45,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.040159, valid_loss 0.997709, train_metric nan, valid_metric 0.060816
[1412324:MainThread](2026-01-11 22:28:45,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998459 to 0.997709, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:45,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.038191, valid_loss 0.996316, train_metric nan, valid_metric 0.057503
[1412324:MainThread](2026-01-11 22:28:45,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997709 to 0.996316, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:45,702) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.035523, valid_loss 0.997267, train_metric nan, valid_metric 0.056394
[1412324:MainThread](2026-01-11 22:28:46,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.031791, valid_loss 0.995442, train_metric nan, valid_metric 0.063271
[1412324:MainThread](2026-01-11 22:28:46,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996316 to 0.995442, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:46,379) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.034073, valid_loss 0.995807, train_metric nan, valid_metric 0.057315
[1412324:MainThread](2026-01-11 22:28:46,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.030850, valid_loss 0.996080, train_metric nan, valid_metric 0.064056
[1412324:MainThread](2026-01-11 22:28:47,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.027077, valid_loss 1.000911, train_metric nan, valid_metric 0.061718
[1412324:MainThread](2026-01-11 22:28:47,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.022051, valid_loss 0.995545, train_metric nan, valid_metric 0.066853
[1412324:MainThread](2026-01-11 22:28:47,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.022241, valid_loss 0.997926, train_metric nan, valid_metric 0.059269
[1412324:MainThread](2026-01-11 22:28:48,113) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.018870, valid_loss 0.996047, train_metric nan, valid_metric 0.066508
[1412324:MainThread](2026-01-11 22:28:48,422) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.021062, valid_loss 0.996018, train_metric nan, valid_metric 0.055223
[1412324:MainThread](2026-01-11 22:28:48,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.019600, valid_loss 0.994744, train_metric nan, valid_metric 0.064960
[1412324:MainThread](2026-01-11 22:28:48,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.995442 to 0.994744, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:49,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.016847, valid_loss 0.995020, train_metric nan, valid_metric 0.066120
[1412324:MainThread](2026-01-11 22:28:49,358) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.012584, valid_loss 0.996792, train_metric nan, valid_metric 0.046529
[1412324:MainThread](2026-01-11 22:28:49,664) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.013485, valid_loss 0.997378, train_metric nan, valid_metric 0.059074
[1412324:MainThread](2026-01-11 22:28:49,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.008445, valid_loss 0.996789, train_metric nan, valid_metric 0.062173
[1412324:MainThread](2026-01-11 22:28:50,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.005603, valid_loss 0.994486, train_metric nan, valid_metric 0.065808
[1412324:MainThread](2026-01-11 22:28:50,288) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994744 to 0.994486, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:50,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.009184, valid_loss 0.995129, train_metric nan, valid_metric 0.068841
[1412324:MainThread](2026-01-11 22:28:50,911) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.007807, valid_loss 0.997152, train_metric nan, valid_metric 0.058659
[1412324:MainThread](2026-01-11 22:28:51,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.006885, valid_loss 0.994963, train_metric nan, valid_metric 0.063258
[1412324:MainThread](2026-01-11 22:28:51,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.003358, valid_loss 0.995728, train_metric nan, valid_metric 0.054396
[1412324:MainThread](2026-01-11 22:28:51,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.002126, valid_loss 0.994390, train_metric nan, valid_metric 0.068773
[1412324:MainThread](2026-01-11 22:28:51,837) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994486 to 0.994390, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:52,147) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.005253, valid_loss 0.994431, train_metric nan, valid_metric 0.069292
[1412324:MainThread](2026-01-11 22:28:52,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.003959, valid_loss 0.993905, train_metric nan, valid_metric 0.068342
[1412324:MainThread](2026-01-11 22:28:52,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.994390 to 0.993905, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:52,779) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.998935, valid_loss 0.994388, train_metric nan, valid_metric 0.072163
[1412324:MainThread](2026-01-11 22:28:53,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.001328, valid_loss 0.996434, train_metric nan, valid_metric 0.070188
[1412324:MainThread](2026-01-11 22:28:53,408) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.001437, valid_loss 0.996239, train_metric nan, valid_metric 0.068378
[1412324:MainThread](2026-01-11 22:28:53,722) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.998463, valid_loss 0.993394, train_metric nan, valid_metric 0.068847
[1412324:MainThread](2026-01-11 22:28:53,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993905 to 0.993394, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:54,035) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.999781, valid_loss 0.992780, train_metric nan, valid_metric 0.073200
[1412324:MainThread](2026-01-11 22:28:54,036) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.993394 to 0.992780, save checkpoint.
[1412324:MainThread](2026-01-11 22:28:54,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.000254, valid_loss 0.994496, train_metric nan, valid_metric 0.067758
[1412324:MainThread](2026-01-11 22:28:54,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.997051, valid_loss 0.996360, train_metric nan, valid_metric 0.053018
[1412324:MainThread](2026-01-11 22:28:54,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.002176, valid_loss 0.994477, train_metric nan, valid_metric 0.062495
[1412324:MainThread](2026-01-11 22:28:55,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.001169, valid_loss 0.994206, train_metric nan, valid_metric 0.063334
[1412324:MainThread](2026-01-11 22:28:55,741) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.994268, valid_loss 0.995220, train_metric nan, valid_metric 0.058651
[1412324:MainThread](2026-01-11 22:28:56,105) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.001804, valid_loss 0.993187, train_metric nan, valid_metric 0.074922
[1412324:MainThread](2026-01-11 22:28:57,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.001529, valid_loss 0.998079, train_metric nan, valid_metric 0.045023
[1412324:MainThread](2026-01-11 22:28:57,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.992989, valid_loss 0.995113, train_metric nan, valid_metric 0.066156
[1412324:MainThread](2026-01-11 22:28:57,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.994217, valid_loss 0.992998, train_metric nan, valid_metric 0.075576
[1412324:MainThread](2026-01-11 22:28:58,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.998671, valid_loss 0.995169, train_metric nan, valid_metric 0.065786
[1412324:MainThread](2026-01-11 22:28:58,449) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.994669, valid_loss 0.993706, train_metric nan, valid_metric 0.070566
[1412324:MainThread](2026-01-11 22:28:58,772) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.993742, valid_loss 0.992832, train_metric nan, valid_metric 0.075854
[1412324:MainThread](2026-01-11 22:28:59,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.993590, valid_loss 0.994222, train_metric nan, valid_metric 0.075177
[1412324:MainThread](2026-01-11 22:28:59,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.992896, valid_loss 0.993838, train_metric nan, valid_metric 0.074778
[1412324:MainThread](2026-01-11 22:28:59,728) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.987789, valid_loss 0.993879, train_metric nan, valid_metric 0.075398
[1412324:MainThread](2026-01-11 22:29:00,055) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.991869, valid_loss 0.993283, train_metric nan, valid_metric 0.069861
[1412324:MainThread](2026-01-11 22:29:00,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.994922, valid_loss 0.993371, train_metric nan, valid_metric 0.073792
[1412324:MainThread](2026-01-11 22:29:00,690) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.993993, valid_loss 0.993823, train_metric nan, valid_metric 0.071440
[1412324:MainThread](2026-01-11 22:29:01,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.993278, valid_loss 0.992999, train_metric nan, valid_metric 0.075707
[1412324:MainThread](2026-01-11 22:29:01,322) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.992279, valid_loss 0.994201, train_metric nan, valid_metric 0.075376
[1412324:MainThread](2026-01-11 22:29:01,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.989995, valid_loss 0.992998, train_metric nan, valid_metric 0.071798
[1412324:MainThread](2026-01-11 22:29:01,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.989567, valid_loss 0.993611, train_metric nan, valid_metric 0.074976
[1412324:MainThread](2026-01-11 22:29:02,277) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.992719, valid_loss 0.993788, train_metric nan, valid_metric 0.075927
[1412324:MainThread](2026-01-11 22:29:02,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.992116, valid_loss 0.994281, train_metric nan, valid_metric 0.077304
[1412324:MainThread](2026-01-11 22:29:02,925) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.990369, valid_loss 0.993849, train_metric nan, valid_metric 0.073243
[1412324:MainThread](2026-01-11 22:29:03,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.996353, valid_loss 0.992515, train_metric nan, valid_metric 0.077986
[1412324:MainThread](2026-01-11 22:29:03,240) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992780 to 0.992515, save checkpoint.
[1412324:MainThread](2026-01-11 22:29:03,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.992315, valid_loss 0.992832, train_metric nan, valid_metric 0.077975
[1412324:MainThread](2026-01-11 22:29:03,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.986994, valid_loss 0.993247, train_metric nan, valid_metric 0.073782
[1412324:MainThread](2026-01-11 22:29:04,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.985844, valid_loss 0.993188, train_metric nan, valid_metric 0.072112
[1412324:MainThread](2026-01-11 22:29:04,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.989079, valid_loss 0.992495, train_metric nan, valid_metric 0.076246
[1412324:MainThread](2026-01-11 22:29:04,540) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992515 to 0.992495, save checkpoint.
[1412324:MainThread](2026-01-11 22:29:04,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.984969, valid_loss 0.993078, train_metric nan, valid_metric 0.077450
[1412324:MainThread](2026-01-11 22:29:05,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.995348, valid_loss 0.992443, train_metric nan, valid_metric 0.075559
[1412324:MainThread](2026-01-11 22:29:05,171) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992495 to 0.992443, save checkpoint.
[1412324:MainThread](2026-01-11 22:29:05,484) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 1.001298, valid_loss 0.992392, train_metric nan, valid_metric 0.078122
[1412324:MainThread](2026-01-11 22:29:05,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992443 to 0.992392, save checkpoint.
[1412324:MainThread](2026-01-11 22:29:05,805) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.986664, valid_loss 0.992976, train_metric nan, valid_metric 0.073299
[1412324:MainThread](2026-01-11 22:29:06,115) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.984946, valid_loss 0.993013, train_metric nan, valid_metric 0.076564
[1412324:MainThread](2026-01-11 22:29:06,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.990066, valid_loss 0.992628, train_metric nan, valid_metric 0.079599
[1412324:MainThread](2026-01-11 22:29:06,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.984008, valid_loss 0.992230, train_metric nan, valid_metric 0.077739
[1412324:MainThread](2026-01-11 22:29:06,744) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.992392 to 0.992230, save checkpoint.
[1412324:MainThread](2026-01-11 22:29:07,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.984970, valid_loss 0.993124, train_metric nan, valid_metric 0.075996
[1412324:MainThread](2026-01-11 22:29:07,363) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.988615, valid_loss 0.992866, train_metric nan, valid_metric 0.077915
[1412324:MainThread](2026-01-11 22:29:07,672) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.989308, valid_loss 0.992264, train_metric nan, valid_metric 0.077202
[1412324:MainThread](2026-01-11 22:29:07,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.985774, valid_loss 0.992928, train_metric nan, valid_metric 0.078318
[1412324:MainThread](2026-01-11 22:29:08,293) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.991397, valid_loss 0.992801, train_metric nan, valid_metric 0.078813
[1412324:MainThread](2026-01-11 22:29:08,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.988448, valid_loss 0.992965, train_metric nan, valid_metric 0.076382
[1412324:MainThread](2026-01-11 22:29:08,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.984888, valid_loss 0.992756, train_metric nan, valid_metric 0.076855
[1412324:MainThread](2026-01-11 22:29:09,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.986121, valid_loss 0.994349, train_metric nan, valid_metric 0.077679
[1412324:MainThread](2026-01-11 22:29:09,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.984719, valid_loss 0.993858, train_metric nan, valid_metric 0.076393
[1412324:MainThread](2026-01-11 22:29:09,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.993890, valid_loss 0.993188, train_metric nan, valid_metric 0.073309
[1412324:MainThread](2026-01-11 22:29:10,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.984890, valid_loss 0.993393, train_metric nan, valid_metric 0.078507
[1412324:MainThread](2026-01-11 22:29:10,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.991831, valid_loss 0.992714, train_metric nan, valid_metric 0.076914
[1412324:MainThread](2026-01-11 22:29:10,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.989002, valid_loss 0.993516, train_metric nan, valid_metric 0.079511
[1412324:MainThread](2026-01-11 22:29:11,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.983539, valid_loss 0.992272, train_metric nan, valid_metric 0.079344
[1412324:MainThread](2026-01-11 22:29:11,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.992627, valid_loss 0.993541, train_metric nan, valid_metric 0.078849
[1412324:MainThread](2026-01-11 22:29:11,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.987119, valid_loss 0.993073, train_metric nan, valid_metric 0.079574
[1412324:MainThread](2026-01-11 22:29:12,070) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.986473, valid_loss 0.992569, train_metric nan, valid_metric 0.078608
[1412324:MainThread](2026-01-11 22:29:12,393) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.988167, valid_loss 0.992484, train_metric nan, valid_metric 0.078979
[1412324:MainThread](2026-01-11 22:29:12,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.987679, valid_loss 0.993174, train_metric nan, valid_metric 0.080041
[1412324:MainThread](2026-01-11 22:29:13,024) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.987413, valid_loss 0.992674, train_metric nan, valid_metric 0.078419
[1412324:MainThread](2026-01-11 22:29:13,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.989731, valid_loss 0.993537, train_metric nan, valid_metric 0.079194
[1412324:MainThread](2026-01-11 22:29:13,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.987320, valid_loss 0.992473, train_metric nan, valid_metric 0.077044
[1412324:MainThread](2026-01-11 22:29:13,954) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.988866, valid_loss 0.992919, train_metric nan, valid_metric 0.080231
[1412324:MainThread](2026-01-11 22:29:14,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.991043, valid_loss 0.992676, train_metric nan, valid_metric 0.079273
[1412324:MainThread](2026-01-11 22:29:14,571) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.984997, valid_loss 0.993310, train_metric nan, valid_metric 0.080285
[1412324:MainThread](2026-01-11 22:29:14,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.988053, valid_loss 0.992886, train_metric nan, valid_metric 0.079121
[1412324:MainThread](2026-01-11 22:29:15,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.986370, valid_loss 0.992687, train_metric nan, valid_metric 0.079628
[1412324:MainThread](2026-01-11 22:29:15,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.988255, valid_loss 0.993376, train_metric nan, valid_metric 0.080662
[1412324:MainThread](2026-01-11 22:29:15,853) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.986566, valid_loss 0.992472, train_metric nan, valid_metric 0.080150
[1412324:MainThread](2026-01-11 22:29:16,174) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.986977, valid_loss 0.992785, train_metric nan, valid_metric 0.079610
[1412324:MainThread](2026-01-11 22:29:16,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.990257, valid_loss 0.992624, train_metric nan, valid_metric 0.080560
[1412324:MainThread](2026-01-11 22:29:16,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.984101, valid_loss 0.992741, train_metric nan, valid_metric 0.081041
[1412324:MainThread](2026-01-11 22:29:17,120) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.990864, valid_loss 0.992503, train_metric nan, valid_metric 0.079222
[1412324:MainThread](2026-01-11 22:29:17,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.984762, valid_loss 0.992399, train_metric nan, valid_metric 0.079466
[1412324:MainThread](2026-01-11 22:29:17,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.982892, valid_loss 0.992727, train_metric nan, valid_metric 0.079176
[1412324:MainThread](2026-01-11 22:29:18,045) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.987661, valid_loss 0.992888, train_metric nan, valid_metric 0.079547
[1412324:MainThread](2026-01-11 22:29:18,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.989307, valid_loss 0.992450, train_metric nan, valid_metric 0.080337
[1412324:MainThread](2026-01-11 22:29:18,660) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.984080, valid_loss 0.992416, train_metric nan, valid_metric 0.079854
[1412324:MainThread](2026-01-11 22:29:18,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.984290, valid_loss 0.992267, train_metric nan, valid_metric 0.079989
[1412324:MainThread](2026-01-11 22:29:19,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.982891, valid_loss 0.992637, train_metric nan, valid_metric 0.080474
[1412324:MainThread](2026-01-11 22:29:19,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.987328, valid_loss 0.992592, train_metric nan, valid_metric 0.080807
[1412324:MainThread](2026-01-11 22:29:19,908) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.987716, valid_loss 0.992470, train_metric nan, valid_metric 0.079541
[1412324:MainThread](2026-01-11 22:29:20,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.983167, valid_loss 0.992971, train_metric nan, valid_metric 0.080334
[1412324:MainThread](2026-01-11 22:29:20,541) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.988036, valid_loss 0.992247, train_metric nan, valid_metric 0.079761
[1412324:MainThread](2026-01-11 22:29:20,859) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.984456, valid_loss 0.992513, train_metric nan, valid_metric 0.079596
[1412324:MainThread](2026-01-11 22:29:21,179) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.985245, valid_loss 0.992926, train_metric nan, valid_metric 0.079646
[1412324:MainThread](2026-01-11 22:29:21,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.991295, valid_loss 0.992634, train_metric nan, valid_metric 0.080091
[1412324:MainThread](2026-01-11 22:29:21,812) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.990170, valid_loss 0.992603, train_metric nan, valid_metric 0.080375
[1412324:MainThread](2026-01-11 22:29:22,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.982320, valid_loss 0.992523, train_metric nan, valid_metric 0.080410
[1412324:MainThread](2026-01-11 22:29:22,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.986923, valid_loss 0.992457, train_metric nan, valid_metric 0.080097
[1412324:MainThread](2026-01-11 22:29:22,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:29:22.462 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:29:25.222 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 22:29:25.223 | INFO     | __main__:train_single_fold:593 -   IC=0.0259, ICIR=0.2353, RankIC=0.0381, RankICIR=0.3593
2026-01-11 22:29:25.223 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:29:25,228) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:29:59,131) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:29:59,131) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:30:04,193) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77f685d0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 6/243 [00:00<00:04, 57.66it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:02, 81.21it/s]backtest loop:  11%|█         | 26/243 [00:00<00:02, 89.42it/s]backtest loop:  14%|█▍        | 35/243 [00:00<00:02, 86.96it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 90.66it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 92.82it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:01, 94.09it/s]backtest loop:  31%|███       | 75/243 [00:00<00:01, 95.30it/s]backtest loop:  35%|███▍      | 85/243 [00:00<00:01, 92.18it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 93.70it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 94.68it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 95.38it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 96.13it/s]backtest loop:  56%|█████▌    | 135/243 [00:01<00:01, 96.86it/s]backtest loop:  60%|██████    | 146/243 [00:01<00:00, 99.09it/s]backtest loop:  64%|██████▍   | 156/243 [00:01<00:00, 98.11it/s]backtest loop:  68%|██████▊   | 166/243 [00:01<00:00, 91.58it/s]backtest loop:  72%|███████▏  | 176/243 [00:01<00:00, 93.56it/s]backtest loop:  77%|███████▋  | 186/243 [00:01<00:00, 94.63it/s]backtest loop:  81%|████████  | 197/243 [00:02<00:00, 97.09it/s]backtest loop:  85%|████████▌ | 207/243 [00:02<00:00, 97.44it/s]backtest loop:  89%|████████▉ | 217/243 [00:02<00:00, 97.33it/s]backtest loop:  93%|█████████▎| 227/243 [00:02<00:00, 97.41it/s]backtest loop:  98%|█████████▊| 237/243 [00:02<00:00, 97.60it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 94.02it/s]
2026-01-11 22:30:06.793 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0702, Sharpe(w/cost)=0.9924, MaxDD=-0.0557
2026-01-11 22:30:11.848 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 22:30:27.641 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:30:27.742 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_2_pred.parquet
2026-01-11 22:30:27.758 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 22:30:27.758 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 22:30:29.774 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0344
2026-01-11 22:30:31.522 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0435
2026-01-11 22:30:31.810 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0283, ICIR=0.2483, RankIC=0.0416
[1412324:MainThread](2026-01-11 22:30:31,814) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:31:02,232) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:31:02,239) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:31:07,471) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1bf80e4790>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:07, 33.60it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 67.21it/s]backtest loop:  10%|█         | 25/243 [00:00<00:02, 83.06it/s]backtest loop:  14%|█▍        | 34/243 [00:00<00:02, 81.77it/s]backtest loop:  18%|█▊        | 44/243 [00:00<00:02, 85.85it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 89.68it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:01, 90.85it/s]backtest loop:  30%|███       | 74/243 [00:00<00:01, 92.49it/s]backtest loop:  35%|███▍      | 84/243 [00:00<00:01, 94.08it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:01, 95.64it/s]backtest loop:  43%|████▎     | 104/243 [00:01<00:01, 96.91it/s]backtest loop:  47%|████▋     | 114/243 [00:01<00:01, 93.66it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 97.11it/s]backtest loop:  56%|█████▋    | 137/243 [00:01<00:01, 102.18it/s]backtest loop:  61%|██████    | 148/243 [00:01<00:00, 103.92it/s]backtest loop:  65%|██████▌   | 159/243 [00:01<00:00, 99.73it/s] backtest loop:  70%|██████▉   | 170/243 [00:01<00:00, 99.29it/s]backtest loop:  74%|███████▍  | 181/243 [00:01<00:00, 100.37it/s]backtest loop:  79%|███████▉  | 192/243 [00:02<00:00, 99.56it/s] backtest loop:  83%|████████▎ | 202/243 [00:02<00:00, 98.76it/s]backtest loop:  87%|████████▋ | 212/243 [00:02<00:00, 97.92it/s]backtest loop:  91%|█████████▏| 222/243 [00:02<00:00, 97.00it/s]backtest loop:  95%|█████████▌| 232/243 [00:02<00:00, 96.83it/s]backtest loop: 100%|█████████▉| 242/243 [00:02<00:00, 96.09it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 93.71it/s]
2026-01-11 22:31:10.084 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0338, Sharpe(w/cost)=0.4881
2026-01-11 22:31:10.127 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:31:10.127 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 22:31:10.127 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:31:10.127 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:32:27,582) INFO - qlib.timer - [log.py:127] - Time cost: 77.452s | Loading data Done
[1412324:MainThread](2026-01-11 22:32:36,504) INFO - qlib.timer - [log.py:127] - Time cost: 8.353s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:32:40,696) INFO - qlib.timer - [log.py:127] - Time cost: 4.189s | Fillna Done
[1412324:MainThread](2026-01-11 22:32:42,856) INFO - qlib.timer - [log.py:127] - Time cost: 0.306s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:32:43,060) INFO - qlib.timer - [log.py:127] - Time cost: 0.203s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:32:43,063) INFO - qlib.timer - [log.py:127] - Time cost: 15.480s | fit & process data Done
[1412324:MainThread](2026-01-11 22:32:43,063) INFO - qlib.timer - [log.py:127] - Time cost: 92.935s | Init data Done
2026-01-11 22:32:43.064 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:32:43,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:32:43,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:32:43,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:32:43,069) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:32:43.079 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:32:44,745) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:32:45,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.517062, valid_loss 1.086046, train_metric nan, valid_metric 0.019462
[1412324:MainThread](2026-01-11 22:32:45,603) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.086046, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:45,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.096129, valid_loss 1.018722, train_metric nan, valid_metric 0.018945
[1412324:MainThread](2026-01-11 22:32:45,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.086046 to 1.018722, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:46,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.065305, valid_loss 1.007710, train_metric nan, valid_metric 0.022486
[1412324:MainThread](2026-01-11 22:32:46,404) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.018722 to 1.007710, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:46,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.050632, valid_loss 1.003451, train_metric nan, valid_metric 0.026213
[1412324:MainThread](2026-01-11 22:32:46,803) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007710 to 1.003451, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:47,191) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.045358, valid_loss 1.002398, train_metric nan, valid_metric 0.026028
[1412324:MainThread](2026-01-11 22:32:47,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003451 to 1.002398, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:47,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.040694, valid_loss 1.002990, train_metric nan, valid_metric 0.031980
[1412324:MainThread](2026-01-11 22:32:48,091) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.037280, valid_loss 1.001397, train_metric nan, valid_metric 0.029435
[1412324:MainThread](2026-01-11 22:32:48,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002398 to 1.001397, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:48,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.028294, valid_loss 1.004173, train_metric nan, valid_metric 0.035383
[1412324:MainThread](2026-01-11 22:32:48,915) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.024406, valid_loss 1.000175, train_metric nan, valid_metric 0.031653
[1412324:MainThread](2026-01-11 22:32:48,916) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001397 to 1.000175, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:49,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.028467, valid_loss 1.000293, train_metric nan, valid_metric 0.029245
[1412324:MainThread](2026-01-11 22:32:49,755) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.022926, valid_loss 1.000979, train_metric nan, valid_metric 0.032398
[1412324:MainThread](2026-01-11 22:32:50,162) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.016836, valid_loss 0.999493, train_metric nan, valid_metric 0.036039
[1412324:MainThread](2026-01-11 22:32:50,165) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000175 to 0.999493, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:50,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.017213, valid_loss 0.999418, train_metric nan, valid_metric 0.040239
[1412324:MainThread](2026-01-11 22:32:50,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999493 to 0.999418, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:51,048) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.008707, valid_loss 0.999293, train_metric nan, valid_metric 0.034829
[1412324:MainThread](2026-01-11 22:32:51,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999418 to 0.999293, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:51,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.019394, valid_loss 0.999374, train_metric nan, valid_metric 0.039323
[1412324:MainThread](2026-01-11 22:32:51,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.014075, valid_loss 0.999584, train_metric nan, valid_metric 0.041942
[1412324:MainThread](2026-01-11 22:32:52,256) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.010243, valid_loss 0.999347, train_metric nan, valid_metric 0.030449
[1412324:MainThread](2026-01-11 22:32:52,658) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.008394, valid_loss 1.001783, train_metric nan, valid_metric 0.039707
[1412324:MainThread](2026-01-11 22:32:53,061) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.008623, valid_loss 1.001287, train_metric nan, valid_metric 0.037397
[1412324:MainThread](2026-01-11 22:32:53,459) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.003239, valid_loss 1.001725, train_metric nan, valid_metric 0.041738
[1412324:MainThread](2026-01-11 22:32:53,854) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.008585, valid_loss 0.998137, train_metric nan, valid_metric 0.039812
[1412324:MainThread](2026-01-11 22:32:53,857) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999293 to 0.998137, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:54,263) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.002013, valid_loss 0.997544, train_metric nan, valid_metric 0.036642
[1412324:MainThread](2026-01-11 22:32:54,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998137 to 0.997544, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:54,738) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.002357, valid_loss 0.997698, train_metric nan, valid_metric 0.039306
[1412324:MainThread](2026-01-11 22:32:55,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 0.999292, valid_loss 0.996978, train_metric nan, valid_metric 0.042273
[1412324:MainThread](2026-01-11 22:32:55,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997544 to 0.996978, save checkpoint.
[1412324:MainThread](2026-01-11 22:32:55,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.006052, valid_loss 0.997179, train_metric nan, valid_metric 0.038702
[1412324:MainThread](2026-01-11 22:32:55,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.005630, valid_loss 0.997655, train_metric nan, valid_metric 0.037504
[1412324:MainThread](2026-01-11 22:32:56,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.008741, valid_loss 0.997740, train_metric nan, valid_metric 0.042800
[1412324:MainThread](2026-01-11 22:32:56,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 0.992403, valid_loss 0.997145, train_metric nan, valid_metric 0.039234
[1412324:MainThread](2026-01-11 22:32:57,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.004539, valid_loss 1.002698, train_metric nan, valid_metric 0.040031
[1412324:MainThread](2026-01-11 22:32:57,651) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 0.994147, valid_loss 1.000608, train_metric nan, valid_metric 0.040664
[1412324:MainThread](2026-01-11 22:32:58,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.000471, valid_loss 0.997840, train_metric nan, valid_metric 0.044485
[1412324:MainThread](2026-01-11 22:32:58,462) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 0.994477, valid_loss 0.998948, train_metric nan, valid_metric 0.044880
[1412324:MainThread](2026-01-11 22:32:58,887) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 0.996486, valid_loss 1.000191, train_metric nan, valid_metric 0.041238
[1412324:MainThread](2026-01-11 22:32:59,292) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.000766, valid_loss 0.997957, train_metric nan, valid_metric 0.043643
[1412324:MainThread](2026-01-11 22:32:59,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 0.991199, valid_loss 0.996874, train_metric nan, valid_metric 0.045733
[1412324:MainThread](2026-01-11 22:32:59,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996978 to 0.996874, save checkpoint.
[1412324:MainThread](2026-01-11 22:33:00,132) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.996494, valid_loss 0.996908, train_metric nan, valid_metric 0.042714
[1412324:MainThread](2026-01-11 22:33:00,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 0.994025, valid_loss 0.996209, train_metric nan, valid_metric 0.046099
[1412324:MainThread](2026-01-11 22:33:00,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996874 to 0.996209, save checkpoint.
[1412324:MainThread](2026-01-11 22:33:00,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.996587, valid_loss 0.997259, train_metric nan, valid_metric 0.041897
[1412324:MainThread](2026-01-11 22:33:01,389) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.992669, valid_loss 0.997163, train_metric nan, valid_metric 0.041951
[1412324:MainThread](2026-01-11 22:33:01,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 0.996188, valid_loss 0.997100, train_metric nan, valid_metric 0.043463
[1412324:MainThread](2026-01-11 22:33:02,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.990053, valid_loss 0.998489, train_metric nan, valid_metric 0.046513
[1412324:MainThread](2026-01-11 22:33:02,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.991825, valid_loss 0.999090, train_metric nan, valid_metric 0.045372
[1412324:MainThread](2026-01-11 22:33:03,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 0.992092, valid_loss 0.996659, train_metric nan, valid_metric 0.046293
[1412324:MainThread](2026-01-11 22:33:03,460) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.991060, valid_loss 0.997632, train_metric nan, valid_metric 0.046551
[1412324:MainThread](2026-01-11 22:33:03,869) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.993009, valid_loss 0.997322, train_metric nan, valid_metric 0.043381
[1412324:MainThread](2026-01-11 22:33:04,290) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.992860, valid_loss 0.996952, train_metric nan, valid_metric 0.043062
[1412324:MainThread](2026-01-11 22:33:04,723) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.990856, valid_loss 0.997033, train_metric nan, valid_metric 0.046949
[1412324:MainThread](2026-01-11 22:33:05,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.996742, valid_loss 1.000432, train_metric nan, valid_metric 0.044911
[1412324:MainThread](2026-01-11 22:33:05,558) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.987377, valid_loss 0.996613, train_metric nan, valid_metric 0.046589
[1412324:MainThread](2026-01-11 22:33:05,904) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.993965, valid_loss 0.997712, train_metric nan, valid_metric 0.045361
[1412324:MainThread](2026-01-11 22:33:06,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.986035, valid_loss 0.998221, train_metric nan, valid_metric 0.048188
[1412324:MainThread](2026-01-11 22:33:06,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.986724, valid_loss 0.997906, train_metric nan, valid_metric 0.047691
[1412324:MainThread](2026-01-11 22:33:06,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.992414, valid_loss 0.998435, train_metric nan, valid_metric 0.047023
[1412324:MainThread](2026-01-11 22:33:07,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.989477, valid_loss 0.996801, train_metric nan, valid_metric 0.045988
[1412324:MainThread](2026-01-11 22:33:07,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.989765, valid_loss 0.997250, train_metric nan, valid_metric 0.040675
[1412324:MainThread](2026-01-11 22:33:08,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.991955, valid_loss 0.997454, train_metric nan, valid_metric 0.049089
[1412324:MainThread](2026-01-11 22:33:08,647) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.991132, valid_loss 1.001105, train_metric nan, valid_metric 0.043035
[1412324:MainThread](2026-01-11 22:33:09,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.992460, valid_loss 0.999287, train_metric nan, valid_metric 0.045892
[1412324:MainThread](2026-01-11 22:33:09,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.990624, valid_loss 0.997091, train_metric nan, valid_metric 0.045482
[1412324:MainThread](2026-01-11 22:33:09,865) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.987741, valid_loss 0.996307, train_metric nan, valid_metric 0.048550
[1412324:MainThread](2026-01-11 22:33:10,261) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.991555, valid_loss 0.996925, train_metric nan, valid_metric 0.049066
[1412324:MainThread](2026-01-11 22:33:10,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.994787, valid_loss 0.998125, train_metric nan, valid_metric 0.048426
[1412324:MainThread](2026-01-11 22:33:11,064) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.988245, valid_loss 0.997713, train_metric nan, valid_metric 0.049419
[1412324:MainThread](2026-01-11 22:33:11,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.985980, valid_loss 0.996088, train_metric nan, valid_metric 0.050328
[1412324:MainThread](2026-01-11 22:33:11,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996209 to 0.996088, save checkpoint.
[1412324:MainThread](2026-01-11 22:33:11,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.989909, valid_loss 0.996996, train_metric nan, valid_metric 0.051729
[1412324:MainThread](2026-01-11 22:33:12,368) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.985786, valid_loss 0.996329, train_metric nan, valid_metric 0.048603
[1412324:MainThread](2026-01-11 22:33:12,751) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.985720, valid_loss 0.997899, train_metric nan, valid_metric 0.048362
[1412324:MainThread](2026-01-11 22:33:13,136) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.985535, valid_loss 0.998441, train_metric nan, valid_metric 0.046637
[1412324:MainThread](2026-01-11 22:33:13,537) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.986013, valid_loss 0.997755, train_metric nan, valid_metric 0.047945
[1412324:MainThread](2026-01-11 22:33:13,927) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.986698, valid_loss 0.997082, train_metric nan, valid_metric 0.047416
[1412324:MainThread](2026-01-11 22:33:14,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.986580, valid_loss 0.996538, train_metric nan, valid_metric 0.049570
[1412324:MainThread](2026-01-11 22:33:14,763) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.988268, valid_loss 0.996578, train_metric nan, valid_metric 0.050890
[1412324:MainThread](2026-01-11 22:33:15,149) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.983520, valid_loss 0.997852, train_metric nan, valid_metric 0.048866
[1412324:MainThread](2026-01-11 22:33:15,534) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.983775, valid_loss 0.997183, train_metric nan, valid_metric 0.048227
[1412324:MainThread](2026-01-11 22:33:15,945) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.990745, valid_loss 0.996565, train_metric nan, valid_metric 0.051706
[1412324:MainThread](2026-01-11 22:33:16,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.989448, valid_loss 0.997917, train_metric nan, valid_metric 0.049253
[1412324:MainThread](2026-01-11 22:33:16,768) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.987634, valid_loss 0.997987, train_metric nan, valid_metric 0.049001
[1412324:MainThread](2026-01-11 22:33:17,173) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.982553, valid_loss 0.998480, train_metric nan, valid_metric 0.048821
[1412324:MainThread](2026-01-11 22:33:17,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.989051, valid_loss 0.997961, train_metric nan, valid_metric 0.049250
[1412324:MainThread](2026-01-11 22:33:17,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.984835, valid_loss 0.996919, train_metric nan, valid_metric 0.052075
[1412324:MainThread](2026-01-11 22:33:18,324) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.986302, valid_loss 0.997210, train_metric nan, valid_metric 0.049583
[1412324:MainThread](2026-01-11 22:33:18,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.986032, valid_loss 0.996187, train_metric nan, valid_metric 0.051214
[1412324:MainThread](2026-01-11 22:33:19,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.988031, valid_loss 0.996761, train_metric nan, valid_metric 0.049918
[1412324:MainThread](2026-01-11 22:33:19,559) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.987668, valid_loss 0.996145, train_metric nan, valid_metric 0.051745
[1412324:MainThread](2026-01-11 22:33:19,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.986766, valid_loss 0.996436, train_metric nan, valid_metric 0.049981
[1412324:MainThread](2026-01-11 22:33:20,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.984535, valid_loss 0.996279, train_metric nan, valid_metric 0.051674
[1412324:MainThread](2026-01-11 22:33:20,965) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.985595, valid_loss 0.997662, train_metric nan, valid_metric 0.050438
[1412324:MainThread](2026-01-11 22:33:21,442) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.993218, valid_loss 0.997868, train_metric nan, valid_metric 0.048144
[1412324:MainThread](2026-01-11 22:33:22,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.988651, valid_loss 0.996869, train_metric nan, valid_metric 0.049444
[1412324:MainThread](2026-01-11 22:33:22,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.992374, valid_loss 0.997079, train_metric nan, valid_metric 0.050615
[1412324:MainThread](2026-01-11 22:33:23,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.985140, valid_loss 0.997048, train_metric nan, valid_metric 0.051332
[1412324:MainThread](2026-01-11 22:33:23,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.984450, valid_loss 0.997641, train_metric nan, valid_metric 0.049706
[1412324:MainThread](2026-01-11 22:33:24,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.992402, valid_loss 0.997030, train_metric nan, valid_metric 0.051924
[1412324:MainThread](2026-01-11 22:33:24,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.991921, valid_loss 0.997135, train_metric nan, valid_metric 0.051098
[1412324:MainThread](2026-01-11 22:33:24,882) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.990769, valid_loss 0.996599, train_metric nan, valid_metric 0.052302
[1412324:MainThread](2026-01-11 22:33:25,362) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.988830, valid_loss 0.996793, train_metric nan, valid_metric 0.051943
[1412324:MainThread](2026-01-11 22:33:25,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.988886, valid_loss 0.997308, train_metric nan, valid_metric 0.050576
[1412324:MainThread](2026-01-11 22:33:26,307) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.984003, valid_loss 0.996861, train_metric nan, valid_metric 0.051572
[1412324:MainThread](2026-01-11 22:33:26,709) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.985373, valid_loss 0.996875, train_metric nan, valid_metric 0.052250
[1412324:MainThread](2026-01-11 22:33:27,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.989163, valid_loss 0.997003, train_metric nan, valid_metric 0.051521
[1412324:MainThread](2026-01-11 22:33:27,513) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.986551, valid_loss 0.997384, train_metric nan, valid_metric 0.050906
[1412324:MainThread](2026-01-11 22:33:27,939) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.983600, valid_loss 0.996852, train_metric nan, valid_metric 0.051976
[1412324:MainThread](2026-01-11 22:33:28,331) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.983873, valid_loss 0.996291, train_metric nan, valid_metric 0.051840
[1412324:MainThread](2026-01-11 22:33:28,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.987893, valid_loss 0.996425, train_metric nan, valid_metric 0.052576
[1412324:MainThread](2026-01-11 22:33:29,146) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.985042, valid_loss 0.997257, train_metric nan, valid_metric 0.051319
[1412324:MainThread](2026-01-11 22:33:29,544) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.984982, valid_loss 0.996964, train_metric nan, valid_metric 0.051108
[1412324:MainThread](2026-01-11 22:33:29,979) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.983123, valid_loss 0.996493, train_metric nan, valid_metric 0.052455
[1412324:MainThread](2026-01-11 22:33:30,376) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.984130, valid_loss 0.997540, train_metric nan, valid_metric 0.051421
[1412324:MainThread](2026-01-11 22:33:30,809) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.989995, valid_loss 0.996509, train_metric nan, valid_metric 0.052678
[1412324:MainThread](2026-01-11 22:33:31,222) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.986950, valid_loss 0.996661, train_metric nan, valid_metric 0.052753
[1412324:MainThread](2026-01-11 22:33:31,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.982854, valid_loss 0.997277, train_metric nan, valid_metric 0.051507
[1412324:MainThread](2026-01-11 22:33:32,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.989346, valid_loss 0.996763, train_metric nan, valid_metric 0.052305
[1412324:MainThread](2026-01-11 22:33:32,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.990397, valid_loss 0.996934, train_metric nan, valid_metric 0.051849
[1412324:MainThread](2026-01-11 22:33:32,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.991425, valid_loss 0.996559, train_metric nan, valid_metric 0.052904
[1412324:MainThread](2026-01-11 22:33:32,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:33:32.984 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:33:35.956 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 22:33:35.957 | INFO     | __main__:train_single_fold:593 -   IC=0.0183, ICIR=0.1686, RankIC=0.0269, RankICIR=0.2621
2026-01-11 22:33:35.957 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:33:35,965) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:34:14,085) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:34:14,087) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:34:20,989) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1c9612f450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 36.85it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 58.94it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 68.72it/s]backtest loop:  14%|█▎        | 33/244 [00:00<00:02, 72.63it/s]backtest loop:  17%|█▋        | 42/244 [00:00<00:02, 76.42it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 74.02it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:02, 73.80it/s]backtest loop:  27%|██▋       | 66/244 [00:00<00:02, 74.86it/s]backtest loop:  30%|███       | 74/244 [00:01<00:02, 64.82it/s]backtest loop:  33%|███▎      | 81/244 [00:01<00:04, 35.66it/s]backtest loop:  36%|███▌      | 87/244 [00:01<00:04, 36.89it/s]backtest loop:  39%|███▊      | 94/244 [00:01<00:03, 42.33it/s]backtest loop:  41%|████      | 100/244 [00:01<00:03, 43.82it/s]backtest loop:  44%|████▍     | 108/244 [00:02<00:02, 49.07it/s]backtest loop:  48%|████▊     | 116/244 [00:02<00:02, 55.67it/s]backtest loop:  50%|█████     | 123/244 [00:02<00:02, 58.57it/s]backtest loop:  55%|█████▍    | 133/244 [00:02<00:01, 65.23it/s]backtest loop:  59%|█████▊    | 143/244 [00:02<00:01, 69.49it/s]backtest loop:  62%|██████▏   | 152/244 [00:02<00:01, 74.37it/s]backtest loop:  66%|██████▌   | 160/244 [00:02<00:01, 74.87it/s]backtest loop:  69%|██████▉   | 168/244 [00:02<00:01, 75.73it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 76.19it/s]backtest loop:  76%|███████▌  | 185/244 [00:03<00:00, 75.91it/s]backtest loop:  79%|███████▉  | 193/244 [00:03<00:00, 76.66it/s]backtest loop:  83%|████████▎ | 202/244 [00:03<00:00, 77.74it/s]backtest loop:  87%|████████▋ | 212/244 [00:03<00:00, 79.12it/s]backtest loop:  91%|█████████ | 221/244 [00:03<00:00, 81.57it/s]backtest loop:  94%|█████████▍| 230/244 [00:03<00:00, 80.70it/s]backtest loop:  98%|█████████▊| 239/244 [00:03<00:00, 80.42it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 65.14it/s]
2026-01-11 22:34:24.757 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0395, Sharpe(w/cost)=-0.5669, MaxDD=-0.0873
2026-01-11 22:34:28.284 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 22:34:43.915 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:34:44.022 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_3_pred.parquet
2026-01-11 22:34:44.042 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 22:34:44.042 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 22:34:46.988 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0311
2026-01-11 22:34:49.902 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0402
2026-01-11 22:34:52.896 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0385
2026-01-11 22:34:53.247 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0213, ICIR=0.1854, RankIC=0.0329
[1412324:MainThread](2026-01-11 22:34:53,253) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:35:27,899) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:35:27,900) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:35:34,924) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a75807450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:09, 25.91it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 59.47it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 68.45it/s]backtest loop:  13%|█▎        | 32/244 [00:00<00:02, 75.90it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 75.09it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 75.93it/s]backtest loop:  23%|██▎       | 57/244 [00:00<00:02, 78.77it/s]backtest loop:  27%|██▋       | 65/244 [00:00<00:02, 78.46it/s]backtest loop:  30%|██▉       | 73/244 [00:00<00:02, 78.35it/s]backtest loop:  33%|███▎      | 81/244 [00:01<00:02, 78.47it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 78.09it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 80.21it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 80.69it/s]backtest loop:  48%|████▊     | 116/244 [00:01<00:01, 80.66it/s]backtest loop:  51%|█████     | 125/244 [00:01<00:01, 79.15it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 78.75it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 79.95it/s]backtest loop:  63%|██████▎   | 153/244 [00:01<00:01, 80.86it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:00, 81.15it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 79.85it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 80.23it/s]backtest loop:  78%|███████▊  | 191/244 [00:02<00:00, 80.82it/s]backtest loop:  82%|████████▏ | 200/244 [00:02<00:00, 80.14it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 80.13it/s]backtest loop:  89%|████████▉ | 218/244 [00:02<00:00, 79.85it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 79.82it/s]backtest loop:  97%|█████████▋| 237/244 [00:03<00:00, 80.68it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 78.03it/s]
2026-01-11 22:35:38.071 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0653, Sharpe(w/cost)=-0.9347
2026-01-11 22:35:38.143 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:35:38.143 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 22:35:38.143 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:35:38.144 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:37:09,597) INFO - qlib.timer - [log.py:127] - Time cost: 91.450s | Loading data Done
[1412324:MainThread](2026-01-11 22:37:18,677) INFO - qlib.timer - [log.py:127] - Time cost: 8.503s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:37:22,343) INFO - qlib.timer - [log.py:127] - Time cost: 3.664s | Fillna Done
[1412324:MainThread](2026-01-11 22:37:24,222) INFO - qlib.timer - [log.py:127] - Time cost: 0.329s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:37:24,478) INFO - qlib.timer - [log.py:127] - Time cost: 0.256s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:37:24,483) INFO - qlib.timer - [log.py:127] - Time cost: 14.885s | fit & process data Done
[1412324:MainThread](2026-01-11 22:37:24,483) INFO - qlib.timer - [log.py:127] - Time cost: 106.339s | Init data Done
2026-01-11 22:37:24.484 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:37:24,485) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:37:24,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:37:24,489) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:37:24,490) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:37:24.500 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:37:26,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:37:26,994) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.901826, valid_loss 1.225273, train_metric nan, valid_metric -0.024616
[1412324:MainThread](2026-01-11 22:37:26,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.225273, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:27,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.121940, valid_loss 1.022488, train_metric nan, valid_metric -0.010085
[1412324:MainThread](2026-01-11 22:37:27,410) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.225273 to 1.022488, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:27,813) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.066641, valid_loss 1.008292, train_metric nan, valid_metric 0.015448
[1412324:MainThread](2026-01-11 22:37:27,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.022488 to 1.008292, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:28,212) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.061253, valid_loss 1.005520, train_metric nan, valid_metric 0.015601
[1412324:MainThread](2026-01-11 22:37:28,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008292 to 1.005520, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:28,602) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.050309, valid_loss 1.006124, train_metric nan, valid_metric 0.025153
[1412324:MainThread](2026-01-11 22:37:29,006) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.045633, valid_loss 1.004772, train_metric nan, valid_metric 0.020380
[1412324:MainThread](2026-01-11 22:37:29,008) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005520 to 1.004772, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:29,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.044963, valid_loss 1.002878, train_metric nan, valid_metric 0.024870
[1412324:MainThread](2026-01-11 22:37:29,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004772 to 1.002878, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:29,843) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.047042, valid_loss 1.002918, train_metric nan, valid_metric 0.023560
[1412324:MainThread](2026-01-11 22:37:30,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.043838, valid_loss 1.003001, train_metric nan, valid_metric 0.016960
[1412324:MainThread](2026-01-11 22:37:30,719) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.043119, valid_loss 1.001291, train_metric nan, valid_metric 0.026135
[1412324:MainThread](2026-01-11 22:37:30,721) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002878 to 1.001291, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:31,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.038504, valid_loss 1.003385, train_metric nan, valid_metric 0.030761
[1412324:MainThread](2026-01-11 22:37:31,601) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.033771, valid_loss 1.001730, train_metric nan, valid_metric 0.021702
[1412324:MainThread](2026-01-11 22:37:31,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.032655, valid_loss 1.001938, train_metric nan, valid_metric 0.022404
[1412324:MainThread](2026-01-11 22:37:32,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.028226, valid_loss 1.002324, train_metric nan, valid_metric 0.027364
[1412324:MainThread](2026-01-11 22:37:32,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.032243, valid_loss 1.003315, train_metric nan, valid_metric 0.016303
[1412324:MainThread](2026-01-11 22:37:33,227) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.026436, valid_loss 1.005633, train_metric nan, valid_metric 0.022121
[1412324:MainThread](2026-01-11 22:37:33,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.026962, valid_loss 1.001619, train_metric nan, valid_metric 0.026811
[1412324:MainThread](2026-01-11 22:37:34,087) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.023086, valid_loss 1.000652, train_metric nan, valid_metric 0.031463
[1412324:MainThread](2026-01-11 22:37:34,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001291 to 1.000652, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:34,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.024303, valid_loss 1.001462, train_metric nan, valid_metric 0.023951
[1412324:MainThread](2026-01-11 22:37:34,959) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.021082, valid_loss 0.999826, train_metric nan, valid_metric 0.028594
[1412324:MainThread](2026-01-11 22:37:34,960) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000652 to 0.999826, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:35,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.017480, valid_loss 0.999320, train_metric nan, valid_metric 0.025495
[1412324:MainThread](2026-01-11 22:37:35,357) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999826 to 0.999320, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:35,747) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.017532, valid_loss 1.000224, train_metric nan, valid_metric 0.037101
[1412324:MainThread](2026-01-11 22:37:36,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.015916, valid_loss 1.000926, train_metric nan, valid_metric 0.030406
[1412324:MainThread](2026-01-11 22:37:36,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.019926, valid_loss 1.001546, train_metric nan, valid_metric 0.027510
[1412324:MainThread](2026-01-11 22:37:37,007) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.015627, valid_loss 1.000991, train_metric nan, valid_metric 0.029437
[1412324:MainThread](2026-01-11 22:37:37,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.021005, valid_loss 0.999663, train_metric nan, valid_metric 0.031010
[1412324:MainThread](2026-01-11 22:37:37,870) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.008075, valid_loss 1.000320, train_metric nan, valid_metric 0.037466
[1412324:MainThread](2026-01-11 22:37:38,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.009707, valid_loss 1.001752, train_metric nan, valid_metric 0.016937
[1412324:MainThread](2026-01-11 22:37:38,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.006152, valid_loss 0.999707, train_metric nan, valid_metric 0.032106
[1412324:MainThread](2026-01-11 22:37:39,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.008410, valid_loss 1.001347, train_metric nan, valid_metric 0.033997
[1412324:MainThread](2026-01-11 22:37:39,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.006226, valid_loss 0.998145, train_metric nan, valid_metric 0.031890
[1412324:MainThread](2026-01-11 22:37:39,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999320 to 0.998145, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:40,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.010986, valid_loss 0.997927, train_metric nan, valid_metric 0.032589
[1412324:MainThread](2026-01-11 22:37:40,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998145 to 0.997927, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:40,439) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.007541, valid_loss 0.999782, train_metric nan, valid_metric 0.028506
[1412324:MainThread](2026-01-11 22:37:40,846) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.005465, valid_loss 1.004746, train_metric nan, valid_metric 0.039965
[1412324:MainThread](2026-01-11 22:37:41,267) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.006978, valid_loss 0.999263, train_metric nan, valid_metric 0.037711
[1412324:MainThread](2026-01-11 22:37:41,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.003412, valid_loss 0.998735, train_metric nan, valid_metric 0.030316
[1412324:MainThread](2026-01-11 22:37:42,101) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.001118, valid_loss 0.999750, train_metric nan, valid_metric 0.026787
[1412324:MainThread](2026-01-11 22:37:42,505) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.007290, valid_loss 1.000063, train_metric nan, valid_metric 0.029154
[1412324:MainThread](2026-01-11 22:37:42,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.001801, valid_loss 1.000627, train_metric nan, valid_metric 0.038342
[1412324:MainThread](2026-01-11 22:37:43,323) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.004719, valid_loss 1.000899, train_metric nan, valid_metric 0.029480
[1412324:MainThread](2026-01-11 22:37:43,735) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 0.998372, valid_loss 0.999524, train_metric nan, valid_metric 0.025036
[1412324:MainThread](2026-01-11 22:37:44,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.006184, valid_loss 0.998724, train_metric nan, valid_metric 0.037570
[1412324:MainThread](2026-01-11 22:37:44,554) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.000934, valid_loss 0.999575, train_metric nan, valid_metric 0.038725
[1412324:MainThread](2026-01-11 22:37:44,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.998308, valid_loss 0.998997, train_metric nan, valid_metric 0.032165
[1412324:MainThread](2026-01-11 22:37:45,444) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 0.999597, valid_loss 0.999685, train_metric nan, valid_metric 0.023145
[1412324:MainThread](2026-01-11 22:37:45,949) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.997698, valid_loss 0.998811, train_metric nan, valid_metric 0.035995
[1412324:MainThread](2026-01-11 22:37:46,369) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.994673, valid_loss 0.998375, train_metric nan, valid_metric 0.037576
[1412324:MainThread](2026-01-11 22:37:46,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.006679, valid_loss 0.999186, train_metric nan, valid_metric 0.037977
[1412324:MainThread](2026-01-11 22:37:47,204) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.996188, valid_loss 1.000118, train_metric nan, valid_metric 0.035100
[1412324:MainThread](2026-01-11 22:37:47,622) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.999285, valid_loss 0.998694, train_metric nan, valid_metric 0.029465
[1412324:MainThread](2026-01-11 22:37:47,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.993478, valid_loss 0.997751, train_metric nan, valid_metric 0.036987
[1412324:MainThread](2026-01-11 22:37:47,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997927 to 0.997751, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:48,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.994428, valid_loss 0.998281, train_metric nan, valid_metric 0.030934
[1412324:MainThread](2026-01-11 22:37:48,612) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.993489, valid_loss 1.000477, train_metric nan, valid_metric 0.035208
[1412324:MainThread](2026-01-11 22:37:48,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.006739, valid_loss 0.997770, train_metric nan, valid_metric 0.039598
[1412324:MainThread](2026-01-11 22:37:49,366) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.997067, valid_loss 0.998504, train_metric nan, valid_metric 0.036953
[1412324:MainThread](2026-01-11 22:37:49,791) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 1.000920, valid_loss 0.999210, train_metric nan, valid_metric 0.033803
[1412324:MainThread](2026-01-11 22:37:50,244) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 1.000096, valid_loss 0.998659, train_metric nan, valid_metric 0.035348
[1412324:MainThread](2026-01-11 22:37:50,689) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.996915, valid_loss 0.997465, train_metric nan, valid_metric 0.041672
[1412324:MainThread](2026-01-11 22:37:50,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997751 to 0.997465, save checkpoint.
[1412324:MainThread](2026-01-11 22:37:51,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 1.001139, valid_loss 0.998187, train_metric nan, valid_metric 0.038746
[1412324:MainThread](2026-01-11 22:37:51,512) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.993347, valid_loss 1.001477, train_metric nan, valid_metric 0.032322
[1412324:MainThread](2026-01-11 22:37:51,923) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.990195, valid_loss 0.998689, train_metric nan, valid_metric 0.036665
[1412324:MainThread](2026-01-11 22:37:52,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.994724, valid_loss 0.997776, train_metric nan, valid_metric 0.037755
[1412324:MainThread](2026-01-11 22:37:52,737) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.995678, valid_loss 1.000597, train_metric nan, valid_metric 0.037898
[1412324:MainThread](2026-01-11 22:37:53,126) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.993530, valid_loss 0.999196, train_metric nan, valid_metric 0.035274
[1412324:MainThread](2026-01-11 22:37:53,520) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.993340, valid_loss 0.999310, train_metric nan, valid_metric 0.041990
[1412324:MainThread](2026-01-11 22:37:53,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.998221, valid_loss 0.997890, train_metric nan, valid_metric 0.038728
[1412324:MainThread](2026-01-11 22:37:54,426) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.991485, valid_loss 0.999287, train_metric nan, valid_metric 0.037612
[1412324:MainThread](2026-01-11 22:37:54,826) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.996304, valid_loss 0.997755, train_metric nan, valid_metric 0.035951
[1412324:MainThread](2026-01-11 22:37:55,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.999029, valid_loss 0.999027, train_metric nan, valid_metric 0.027026
[1412324:MainThread](2026-01-11 22:37:55,641) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.995369, valid_loss 0.997720, train_metric nan, valid_metric 0.042224
[1412324:MainThread](2026-01-11 22:37:56,025) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.989863, valid_loss 0.999134, train_metric nan, valid_metric 0.036811
[1412324:MainThread](2026-01-11 22:37:56,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.993633, valid_loss 0.997841, train_metric nan, valid_metric 0.039398
[1412324:MainThread](2026-01-11 22:37:56,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.997348, valid_loss 0.997799, train_metric nan, valid_metric 0.040855
[1412324:MainThread](2026-01-11 22:37:57,213) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.997206, valid_loss 0.998650, train_metric nan, valid_metric 0.043519
[1412324:MainThread](2026-01-11 22:37:57,659) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.988199, valid_loss 0.998539, train_metric nan, valid_metric 0.038822
[1412324:MainThread](2026-01-11 22:37:58,049) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.996983, valid_loss 0.998207, train_metric nan, valid_metric 0.040427
[1412324:MainThread](2026-01-11 22:37:58,498) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.990549, valid_loss 0.997566, train_metric nan, valid_metric 0.041302
[1412324:MainThread](2026-01-11 22:37:58,910) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.995383, valid_loss 0.998333, train_metric nan, valid_metric 0.038288
[1412324:MainThread](2026-01-11 22:37:59,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.995983, valid_loss 0.999120, train_metric nan, valid_metric 0.041042
[1412324:MainThread](2026-01-11 22:37:59,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.995123, valid_loss 0.997886, train_metric nan, valid_metric 0.040612
[1412324:MainThread](2026-01-11 22:38:00,145) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.986926, valid_loss 0.998232, train_metric nan, valid_metric 0.038161
[1412324:MainThread](2026-01-11 22:38:00,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.990842, valid_loss 0.998293, train_metric nan, valid_metric 0.041192
[1412324:MainThread](2026-01-11 22:38:00,913) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.993657, valid_loss 0.998862, train_metric nan, valid_metric 0.040858
[1412324:MainThread](2026-01-11 22:38:01,308) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.996721, valid_loss 0.998011, train_metric nan, valid_metric 0.040916
[1412324:MainThread](2026-01-11 22:38:01,694) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.994393, valid_loss 0.997777, train_metric nan, valid_metric 0.040498
[1412324:MainThread](2026-01-11 22:38:02,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.993955, valid_loss 0.997865, train_metric nan, valid_metric 0.040732
[1412324:MainThread](2026-01-11 22:38:02,486) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.992440, valid_loss 0.998238, train_metric nan, valid_metric 0.038964
[1412324:MainThread](2026-01-11 22:38:02,873) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.989055, valid_loss 0.998355, train_metric nan, valid_metric 0.039259
[1412324:MainThread](2026-01-11 22:38:03,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.993432, valid_loss 0.998621, train_metric nan, valid_metric 0.038189
[1412324:MainThread](2026-01-11 22:38:03,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.997193, valid_loss 0.997698, train_metric nan, valid_metric 0.037771
[1412324:MainThread](2026-01-11 22:38:04,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.984728, valid_loss 0.997798, train_metric nan, valid_metric 0.037968
[1412324:MainThread](2026-01-11 22:38:04,473) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.993839, valid_loss 0.997921, train_metric nan, valid_metric 0.040205
[1412324:MainThread](2026-01-11 22:38:04,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.991674, valid_loss 0.997845, train_metric nan, valid_metric 0.038283
[1412324:MainThread](2026-01-11 22:38:05,275) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.990930, valid_loss 0.997951, train_metric nan, valid_metric 0.038505
[1412324:MainThread](2026-01-11 22:38:05,671) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.990864, valid_loss 0.998291, train_metric nan, valid_metric 0.039148
[1412324:MainThread](2026-01-11 22:38:06,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.996744, valid_loss 0.998485, train_metric nan, valid_metric 0.037439
[1412324:MainThread](2026-01-11 22:38:06,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.989443, valid_loss 0.998464, train_metric nan, valid_metric 0.040054
[1412324:MainThread](2026-01-11 22:38:06,884) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.989304, valid_loss 0.997946, train_metric nan, valid_metric 0.041409
[1412324:MainThread](2026-01-11 22:38:07,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.991762, valid_loss 0.997727, train_metric nan, valid_metric 0.038406
[1412324:MainThread](2026-01-11 22:38:07,695) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.998180, valid_loss 0.998797, train_metric nan, valid_metric 0.040482
[1412324:MainThread](2026-01-11 22:38:08,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.986297, valid_loss 0.998160, train_metric nan, valid_metric 0.039193
[1412324:MainThread](2026-01-11 22:38:08,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.991884, valid_loss 0.997764, train_metric nan, valid_metric 0.039065
[1412324:MainThread](2026-01-11 22:38:08,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.993401, valid_loss 0.998095, train_metric nan, valid_metric 0.040861
[1412324:MainThread](2026-01-11 22:38:09,386) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.991956, valid_loss 0.998106, train_metric nan, valid_metric 0.039848
[1412324:MainThread](2026-01-11 22:38:09,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.993363, valid_loss 0.998147, train_metric nan, valid_metric 0.038381
[1412324:MainThread](2026-01-11 22:38:10,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.993429, valid_loss 0.998091, train_metric nan, valid_metric 0.038916
[1412324:MainThread](2026-01-11 22:38:10,679) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.993161, valid_loss 0.998284, train_metric nan, valid_metric 0.040880
[1412324:MainThread](2026-01-11 22:38:11,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.993515, valid_loss 0.998327, train_metric nan, valid_metric 0.040225
[1412324:MainThread](2026-01-11 22:38:11,099) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:38:11.120 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:38:14.385 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 22:38:14.385 | INFO     | __main__:train_single_fold:593 -   IC=0.0063, ICIR=0.0432, RankIC=0.0330, RankICIR=0.2465
2026-01-11 22:38:14.385 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:38:14,416) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:38:53,961) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:38:53,962) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:39:01,749) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a7677f990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 22.78it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 52.32it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 64.87it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 71.80it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:02, 76.39it/s]backtest loop:  20%|█▉        | 48/243 [00:00<00:02, 73.49it/s]backtest loop:  23%|██▎       | 56/243 [00:00<00:02, 73.75it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:02, 75.95it/s]backtest loop:  31%|███       | 75/243 [00:01<00:02, 77.30it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 76.49it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 76.81it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 77.80it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 71.66it/s]backtest loop:  49%|████▊     | 118/243 [00:01<00:02, 60.48it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:02, 55.23it/s]backtest loop:  54%|█████▍    | 132/243 [00:01<00:01, 58.08it/s]backtest loop:  58%|█████▊    | 140/243 [00:02<00:01, 61.47it/s]backtest loop:  62%|██████▏   | 150/243 [00:02<00:01, 66.73it/s]backtest loop:  65%|██████▌   | 159/243 [00:02<00:01, 72.60it/s]backtest loop:  69%|██████▊   | 167/243 [00:02<00:01, 73.10it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 73.34it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 73.96it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 74.23it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 74.35it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 76.26it/s]backtest loop:  90%|█████████ | 219/243 [00:03<00:00, 77.68it/s]backtest loop:  94%|█████████▍| 229/243 [00:03<00:00, 78.39it/s]backtest loop:  98%|█████████▊| 239/243 [00:03<00:00, 79.06it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 71.29it/s]
2026-01-11 22:39:05.181 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1031, Sharpe(w/cost)=-1.0803, MaxDD=-0.1511
2026-01-11 22:39:11.598 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 22:39:33.011 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:39:33.075 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_4_pred.parquet
2026-01-11 22:39:33.093 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 22:39:33.093 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 22:39:35.658 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0280
2026-01-11 22:39:38.641 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0341
2026-01-11 22:39:41.258 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0367
2026-01-11 22:39:43.911 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0296
2026-01-11 22:39:44.220 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0078, ICIR=0.0522, RankIC=0.0347
[1412324:MainThread](2026-01-11 22:39:44,225) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:40:25,729) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:40:25,730) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:40:33,447) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77cd8450>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 22.48it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 51.78it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 63.54it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:03, 70.26it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 73.39it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 75.92it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:02, 77.10it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:02, 77.45it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 77.45it/s]backtest loop:  36%|███▌      | 88/243 [00:01<00:01, 79.42it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 81.73it/s]backtest loop:  44%|████▍     | 107/243 [00:01<00:01, 81.38it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 80.14it/s]backtest loop:  51%|█████▏    | 125/243 [00:01<00:01, 79.51it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 82.04it/s]backtest loop:  59%|█████▉    | 143/243 [00:01<00:01, 81.23it/s]backtest loop:  63%|██████▎   | 152/243 [00:02<00:01, 79.01it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 77.20it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 77.84it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 81.07it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 76.71it/s]backtest loop:  81%|████████  | 196/243 [00:02<00:00, 76.12it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 75.25it/s]backtest loop:  88%|████████▊ | 214/243 [00:02<00:00, 77.47it/s]backtest loop:  92%|█████████▏| 224/243 [00:02<00:00, 78.22it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 79.90it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 79.67it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.73it/s]
2026-01-11 22:40:36.637 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0022, Sharpe(w/cost)=0.0241
2026-01-11 22:40:36.706 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:40:36.707 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 22:40:36.707 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:40:36.707 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:42:12,211) INFO - qlib.timer - [log.py:127] - Time cost: 95.502s | Loading data Done
[1412324:MainThread](2026-01-11 22:42:21,529) INFO - qlib.timer - [log.py:127] - Time cost: 8.777s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:42:24,893) INFO - qlib.timer - [log.py:127] - Time cost: 3.362s | Fillna Done
[1412324:MainThread](2026-01-11 22:42:26,759) INFO - qlib.timer - [log.py:127] - Time cost: 0.329s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:42:26,990) INFO - qlib.timer - [log.py:127] - Time cost: 0.230s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:42:26,994) INFO - qlib.timer - [log.py:127] - Time cost: 14.782s | fit & process data Done
[1412324:MainThread](2026-01-11 22:42:26,994) INFO - qlib.timer - [log.py:127] - Time cost: 110.286s | Init data Done
2026-01-11 22:42:26.995 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:42:26,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:42:26,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:42:27,000) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:42:27,001) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:42:27.011 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:42:28,822) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:42:29,648) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.568699, valid_loss 1.252602, train_metric nan, valid_metric -0.023545
[1412324:MainThread](2026-01-11 22:42:29,650) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.252602, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:30,074) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.108697, valid_loss 1.025285, train_metric nan, valid_metric 0.007352
[1412324:MainThread](2026-01-11 22:42:30,076) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.252602 to 1.025285, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:30,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.058914, valid_loss 1.006721, train_metric nan, valid_metric 0.016924
[1412324:MainThread](2026-01-11 22:42:30,496) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.025285 to 1.006721, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:30,914) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.053807, valid_loss 1.007995, train_metric nan, valid_metric 0.031909
[1412324:MainThread](2026-01-11 22:42:31,316) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.041273, valid_loss 1.007104, train_metric nan, valid_metric 0.025741
[1412324:MainThread](2026-01-11 22:42:31,733) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.051050, valid_loss 1.001084, train_metric nan, valid_metric 0.033351
[1412324:MainThread](2026-01-11 22:42:31,734) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.006721 to 1.001084, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:32,154) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.038062, valid_loss 1.001707, train_metric nan, valid_metric 0.021697
[1412324:MainThread](2026-01-11 22:42:32,495) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.040384, valid_loss 1.005845, train_metric nan, valid_metric 0.029031
[1412324:MainThread](2026-01-11 22:42:32,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.036018, valid_loss 1.000291, train_metric nan, valid_metric 0.028721
[1412324:MainThread](2026-01-11 22:42:32,849) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001084 to 1.000291, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:33,178) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.028469, valid_loss 1.002313, train_metric nan, valid_metric 0.031437
[1412324:MainThread](2026-01-11 22:42:33,546) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.032171, valid_loss 1.003152, train_metric nan, valid_metric 0.011558
[1412324:MainThread](2026-01-11 22:42:33,969) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.030538, valid_loss 1.001133, train_metric nan, valid_metric 0.033628
[1412324:MainThread](2026-01-11 22:42:34,370) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.027959, valid_loss 1.001611, train_metric nan, valid_metric 0.032446
[1412324:MainThread](2026-01-11 22:42:34,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.031401, valid_loss 0.999724, train_metric nan, valid_metric 0.031851
[1412324:MainThread](2026-01-11 22:42:34,802) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000291 to 0.999724, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:35,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.020169, valid_loss 1.002660, train_metric nan, valid_metric 0.013674
[1412324:MainThread](2026-01-11 22:42:35,634) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.016985, valid_loss 1.001524, train_metric nan, valid_metric 0.038952
[1412324:MainThread](2026-01-11 22:42:36,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.017519, valid_loss 1.001749, train_metric nan, valid_metric 0.027722
[1412324:MainThread](2026-01-11 22:42:36,451) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.016617, valid_loss 0.999320, train_metric nan, valid_metric 0.038171
[1412324:MainThread](2026-01-11 22:42:36,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999724 to 0.999320, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:36,879) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.015085, valid_loss 1.000847, train_metric nan, valid_metric 0.039110
[1412324:MainThread](2026-01-11 22:42:37,294) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.012471, valid_loss 0.998527, train_metric nan, valid_metric 0.036474
[1412324:MainThread](2026-01-11 22:42:37,295) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999320 to 0.998527, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:37,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.014405, valid_loss 0.999106, train_metric nan, valid_metric 0.039936
[1412324:MainThread](2026-01-11 22:42:38,096) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.016748, valid_loss 0.999388, train_metric nan, valid_metric 0.032120
[1412324:MainThread](2026-01-11 22:42:38,528) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.012875, valid_loss 1.000711, train_metric nan, valid_metric 0.044025
[1412324:MainThread](2026-01-11 22:42:38,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.008222, valid_loss 0.999910, train_metric nan, valid_metric 0.032350
[1412324:MainThread](2026-01-11 22:42:39,343) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.013291, valid_loss 0.999531, train_metric nan, valid_metric 0.041384
[1412324:MainThread](2026-01-11 22:42:39,767) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.007774, valid_loss 0.998274, train_metric nan, valid_metric 0.039530
[1412324:MainThread](2026-01-11 22:42:39,771) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998527 to 0.998274, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:40,219) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.009981, valid_loss 1.000797, train_metric nan, valid_metric 0.043660
[1412324:MainThread](2026-01-11 22:42:40,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.010317, valid_loss 0.999739, train_metric nan, valid_metric 0.031736
[1412324:MainThread](2026-01-11 22:42:41,033) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.008579, valid_loss 0.999612, train_metric nan, valid_metric 0.046366
[1412324:MainThread](2026-01-11 22:42:41,454) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.004667, valid_loss 0.999495, train_metric nan, valid_metric 0.031887
[1412324:MainThread](2026-01-11 22:42:41,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 0.997636, valid_loss 0.997898, train_metric nan, valid_metric 0.037379
[1412324:MainThread](2026-01-11 22:42:41,890) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998274 to 0.997898, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:42,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.003552, valid_loss 1.000255, train_metric nan, valid_metric 0.038395
[1412324:MainThread](2026-01-11 22:42:42,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.003857, valid_loss 0.999489, train_metric nan, valid_metric 0.037707
[1412324:MainThread](2026-01-11 22:42:43,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 0.998218, valid_loss 0.998959, train_metric nan, valid_metric 0.033645
[1412324:MainThread](2026-01-11 22:42:43,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.003209, valid_loss 0.998348, train_metric nan, valid_metric 0.030738
[1412324:MainThread](2026-01-11 22:42:43,962) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.993572, valid_loss 1.002293, train_metric nan, valid_metric 0.040735
[1412324:MainThread](2026-01-11 22:42:44,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.000876, valid_loss 0.998751, train_metric nan, valid_metric 0.035604
[1412324:MainThread](2026-01-11 22:42:44,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 0.994719, valid_loss 0.998219, train_metric nan, valid_metric 0.045428
[1412324:MainThread](2026-01-11 22:42:45,208) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 0.996208, valid_loss 0.998951, train_metric nan, valid_metric 0.041665
[1412324:MainThread](2026-01-11 22:42:45,637) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.004464, valid_loss 0.999111, train_metric nan, valid_metric 0.027414
[1412324:MainThread](2026-01-11 22:42:46,038) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.001981, valid_loss 0.999058, train_metric nan, valid_metric 0.028711
[1412324:MainThread](2026-01-11 22:42:46,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.000704, valid_loss 0.998797, train_metric nan, valid_metric 0.034263
[1412324:MainThread](2026-01-11 22:42:46,821) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.001154, valid_loss 0.997156, train_metric nan, valid_metric 0.037369
[1412324:MainThread](2026-01-11 22:42:46,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997898 to 0.997156, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:47,220) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.999993, valid_loss 0.998129, train_metric nan, valid_metric 0.044215
[1412324:MainThread](2026-01-11 22:42:47,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.003118, valid_loss 0.997604, train_metric nan, valid_metric 0.042599
[1412324:MainThread](2026-01-11 22:42:47,989) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.997353, valid_loss 0.997140, train_metric nan, valid_metric 0.040091
[1412324:MainThread](2026-01-11 22:42:47,991) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997156 to 0.997140, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:48,372) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.991844, valid_loss 0.997199, train_metric nan, valid_metric 0.044193
[1412324:MainThread](2026-01-11 22:42:48,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 0.996287, valid_loss 0.997841, train_metric nan, valid_metric 0.045046
[1412324:MainThread](2026-01-11 22:42:49,156) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.997503, valid_loss 0.996794, train_metric nan, valid_metric 0.042400
[1412324:MainThread](2026-01-11 22:42:49,159) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997140 to 0.996794, save checkpoint.
[1412324:MainThread](2026-01-11 22:42:49,557) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.994068, valid_loss 0.997947, train_metric nan, valid_metric 0.043877
[1412324:MainThread](2026-01-11 22:42:49,953) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.996580, valid_loss 0.997838, train_metric nan, valid_metric 0.038193
[1412324:MainThread](2026-01-11 22:42:50,341) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.993508, valid_loss 1.002511, train_metric nan, valid_metric 0.044055
[1412324:MainThread](2026-01-11 22:42:50,730) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.989208, valid_loss 0.997519, train_metric nan, valid_metric 0.042753
[1412324:MainThread](2026-01-11 22:42:51,124) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.995410, valid_loss 1.000429, train_metric nan, valid_metric 0.043460
[1412324:MainThread](2026-01-11 22:42:51,510) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.988467, valid_loss 0.997442, train_metric nan, valid_metric 0.042040
[1412324:MainThread](2026-01-11 22:42:51,893) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.995040, valid_loss 0.997533, train_metric nan, valid_metric 0.037910
[1412324:MainThread](2026-01-11 22:42:52,298) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.991577, valid_loss 0.996816, train_metric nan, valid_metric 0.044067
[1412324:MainThread](2026-01-11 22:42:52,697) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.991485, valid_loss 0.997516, train_metric nan, valid_metric 0.046407
[1412324:MainThread](2026-01-11 22:42:53,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.991614, valid_loss 0.999828, train_metric nan, valid_metric 0.045631
[1412324:MainThread](2026-01-11 22:42:53,478) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.993898, valid_loss 1.002114, train_metric nan, valid_metric 0.041728
[1412324:MainThread](2026-01-11 22:42:53,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.989957, valid_loss 0.997359, train_metric nan, valid_metric 0.039106
[1412324:MainThread](2026-01-11 22:42:54,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.992412, valid_loss 0.996990, train_metric nan, valid_metric 0.042965
[1412324:MainThread](2026-01-11 22:42:54,676) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.996105, valid_loss 0.997698, train_metric nan, valid_metric 0.042670
[1412324:MainThread](2026-01-11 22:42:55,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.988701, valid_loss 0.997449, train_metric nan, valid_metric 0.044154
[1412324:MainThread](2026-01-11 22:42:55,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.992065, valid_loss 0.997869, train_metric nan, valid_metric 0.043625
[1412324:MainThread](2026-01-11 22:42:55,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.992652, valid_loss 0.997555, train_metric nan, valid_metric 0.038310
[1412324:MainThread](2026-01-11 22:42:56,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.989024, valid_loss 0.997496, train_metric nan, valid_metric 0.038344
[1412324:MainThread](2026-01-11 22:42:56,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.997221, valid_loss 0.997632, train_metric nan, valid_metric 0.044553
[1412324:MainThread](2026-01-11 22:42:57,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.995560, valid_loss 0.997470, train_metric nan, valid_metric 0.040416
[1412324:MainThread](2026-01-11 22:42:57,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.991903, valid_loss 0.997669, train_metric nan, valid_metric 0.041061
[1412324:MainThread](2026-01-11 22:42:58,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.990593, valid_loss 0.997650, train_metric nan, valid_metric 0.044106
[1412324:MainThread](2026-01-11 22:42:58,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.994418, valid_loss 0.997312, train_metric nan, valid_metric 0.045979
[1412324:MainThread](2026-01-11 22:42:58,833) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.992924, valid_loss 0.997792, train_metric nan, valid_metric 0.044699
[1412324:MainThread](2026-01-11 22:42:59,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.991851, valid_loss 0.997460, train_metric nan, valid_metric 0.041318
[1412324:MainThread](2026-01-11 22:42:59,640) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.993521, valid_loss 0.997611, train_metric nan, valid_metric 0.042959
[1412324:MainThread](2026-01-11 22:43:00,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.992809, valid_loss 0.997389, train_metric nan, valid_metric 0.042475
[1412324:MainThread](2026-01-11 22:43:00,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.992073, valid_loss 0.997254, train_metric nan, valid_metric 0.043136
[1412324:MainThread](2026-01-11 22:43:00,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.998286, valid_loss 0.996987, train_metric nan, valid_metric 0.041030
[1412324:MainThread](2026-01-11 22:43:00,984) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.991008, valid_loss 0.996815, train_metric nan, valid_metric 0.044230
[1412324:MainThread](2026-01-11 22:43:01,349) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.984840, valid_loss 0.997360, train_metric nan, valid_metric 0.046868
[1412324:MainThread](2026-01-11 22:43:01,769) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.979824, valid_loss 0.997098, train_metric nan, valid_metric 0.043043
[1412324:MainThread](2026-01-11 22:43:02,194) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.991627, valid_loss 0.996961, train_metric nan, valid_metric 0.045425
[1412324:MainThread](2026-01-11 22:43:02,596) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.990122, valid_loss 0.997016, train_metric nan, valid_metric 0.045261
[1412324:MainThread](2026-01-11 22:43:02,981) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.989615, valid_loss 0.997041, train_metric nan, valid_metric 0.045474
[1412324:MainThread](2026-01-11 22:43:03,371) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.993356, valid_loss 0.996843, train_metric nan, valid_metric 0.045203
[1412324:MainThread](2026-01-11 22:43:03,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.991917, valid_loss 0.997341, train_metric nan, valid_metric 0.044490
[1412324:MainThread](2026-01-11 22:43:04,230) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.989636, valid_loss 0.997153, train_metric nan, valid_metric 0.043723
[1412324:MainThread](2026-01-11 22:43:04,609) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.990150, valid_loss 0.997153, train_metric nan, valid_metric 0.044653
[1412324:MainThread](2026-01-11 22:43:05,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.992504, valid_loss 0.997049, train_metric nan, valid_metric 0.042353
[1412324:MainThread](2026-01-11 22:43:05,431) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.989823, valid_loss 0.997073, train_metric nan, valid_metric 0.045161
[1412324:MainThread](2026-01-11 22:43:05,862) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.986064, valid_loss 0.997295, train_metric nan, valid_metric 0.044620
[1412324:MainThread](2026-01-11 22:43:06,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.992178, valid_loss 0.997461, train_metric nan, valid_metric 0.042665
[1412324:MainThread](2026-01-11 22:43:06,703) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.996111, valid_loss 0.997317, train_metric nan, valid_metric 0.045102
[1412324:MainThread](2026-01-11 22:43:07,103) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.987793, valid_loss 0.997079, train_metric nan, valid_metric 0.045494
[1412324:MainThread](2026-01-11 22:43:07,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.992046, valid_loss 0.997152, train_metric nan, valid_metric 0.043498
[1412324:MainThread](2026-01-11 22:43:07,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.990842, valid_loss 0.997230, train_metric nan, valid_metric 0.044608
[1412324:MainThread](2026-01-11 22:43:08,330) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.989479, valid_loss 0.997187, train_metric nan, valid_metric 0.043876
[1412324:MainThread](2026-01-11 22:43:08,775) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.992351, valid_loss 0.997266, train_metric nan, valid_metric 0.046160
[1412324:MainThread](2026-01-11 22:43:09,184) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.989699, valid_loss 0.997440, train_metric nan, valid_metric 0.046707
[1412324:MainThread](2026-01-11 22:43:09,187) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:43:09.206 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:43:12.104 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 22:43:12.105 | INFO     | __main__:train_single_fold:593 -   IC=0.0029, ICIR=0.0317, RankIC=0.0258, RankICIR=0.2852
2026-01-11 22:43:12.105 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:43:12,112) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:43:54,373) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:43:54,374) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:44:02,584) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a4e677990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.79it/s]backtest loop:   5%|▍         | 11/243 [00:00<00:04, 52.43it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 65.17it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 70.12it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 72.53it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 75.04it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 77.57it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 78.49it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 80.27it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:01, 80.68it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 80.51it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 78.94it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 79.41it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 79.43it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 79.34it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 80.08it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 81.03it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 80.89it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 81.05it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 80.72it/s]backtest loop:  77%|███████▋  | 188/243 [00:02<00:00, 77.23it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 79.00it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 79.95it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 80.54it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 81.06it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 81.38it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.86it/s]
2026-01-11 22:44:05.728 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0597, Sharpe(w/cost)=0.7242, MaxDD=-0.0830
2026-01-11 22:44:12.065 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 22:44:34.863 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:44:34.973 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_5_pred.parquet
2026-01-11 22:44:35.001 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 22:44:35.001 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 22:44:38.285 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0248
2026-01-11 22:44:41.156 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0288
2026-01-11 22:44:44.103 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0291
2026-01-11 22:44:46.742 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0248
2026-01-11 22:44:49.805 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0270
2026-01-11 22:44:50.157 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0033, ICIR=0.0288, RankIC=0.0290
[1412324:MainThread](2026-01-11 22:44:50,162) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:45:33,304) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:45:33,305) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:45:41,195) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1c90f00650>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 29.33it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:03, 62.11it/s]backtest loop:   8%|▊         | 20/243 [00:00<00:03, 68.56it/s]backtest loop:  12%|█▏        | 28/243 [00:00<00:03, 71.31it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 73.59it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 75.39it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 77.78it/s]backtest loop:  26%|██▋       | 64/243 [00:00<00:02, 78.47it/s]backtest loop:  30%|███       | 74/243 [00:00<00:02, 78.90it/s]backtest loop:  34%|███▎      | 82/243 [00:01<00:02, 77.83it/s]backtest loop:  37%|███▋      | 91/243 [00:01<00:01, 77.79it/s]backtest loop:  42%|████▏     | 101/243 [00:01<00:01, 79.05it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 79.32it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 80.22it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 80.60it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 80.88it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:01, 80.80it/s]backtest loop:  66%|██████▌   | 160/243 [00:02<00:01, 80.99it/s]backtest loop:  70%|██████▉   | 170/243 [00:02<00:00, 80.50it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 80.03it/s]backtest loop:  77%|███████▋  | 187/243 [00:02<00:00, 79.53it/s]backtest loop:  80%|████████  | 195/243 [00:02<00:00, 77.67it/s]backtest loop:  84%|████████▎ | 203/243 [00:02<00:00, 76.70it/s]backtest loop:  88%|████████▊ | 213/243 [00:02<00:00, 78.28it/s]backtest loop:  92%|█████████▏| 223/243 [00:02<00:00, 78.97it/s]backtest loop:  96%|█████████▌| 233/243 [00:02<00:00, 79.84it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 80.09it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.85it/s]
2026-01-11 22:45:44.340 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0336, Sharpe(w/cost)=0.3924
2026-01-11 22:45:44.434 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:45:44.434 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 22:45:44.434 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:45:44.434 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:47:16,667) INFO - qlib.timer - [log.py:127] - Time cost: 92.231s | Loading data Done
[1412324:MainThread](2026-01-11 22:47:25,623) INFO - qlib.timer - [log.py:127] - Time cost: 8.400s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:47:29,467) INFO - qlib.timer - [log.py:127] - Time cost: 3.843s | Fillna Done
[1412324:MainThread](2026-01-11 22:47:31,240) INFO - qlib.timer - [log.py:127] - Time cost: 0.334s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:47:31,459) INFO - qlib.timer - [log.py:127] - Time cost: 0.217s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:47:31,462) INFO - qlib.timer - [log.py:127] - Time cost: 14.794s | fit & process data Done
[1412324:MainThread](2026-01-11 22:47:31,463) INFO - qlib.timer - [log.py:127] - Time cost: 107.027s | Init data Done
2026-01-11 22:47:31.463 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:47:31,464) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:47:31,465) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:47:31,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:47:31,469) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:47:31.479 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:47:34,563) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:47:35,566) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.828594, valid_loss 1.208751, train_metric nan, valid_metric 0.015130
[1412324:MainThread](2026-01-11 22:47:35,567) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.208751, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:36,031) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.096616, valid_loss 1.017816, train_metric nan, valid_metric 0.012890
[1412324:MainThread](2026-01-11 22:47:36,034) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.208751 to 1.017816, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:36,436) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.053015, valid_loss 1.007182, train_metric nan, valid_metric 0.009339
[1412324:MainThread](2026-01-11 22:47:36,438) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.017816 to 1.007182, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:36,832) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.050652, valid_loss 1.005142, train_metric nan, valid_metric 0.015059
[1412324:MainThread](2026-01-11 22:47:36,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.007182 to 1.005142, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:37,225) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.042990, valid_loss 1.005329, train_metric nan, valid_metric 0.019694
[1412324:MainThread](2026-01-11 22:47:37,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.039760, valid_loss 1.003214, train_metric nan, valid_metric 0.017477
[1412324:MainThread](2026-01-11 22:47:37,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.005142 to 1.003214, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:37,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.041501, valid_loss 1.003741, train_metric nan, valid_metric 0.021301
[1412324:MainThread](2026-01-11 22:47:38,313) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.033942, valid_loss 1.002018, train_metric nan, valid_metric 0.023947
[1412324:MainThread](2026-01-11 22:47:38,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003214 to 1.002018, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:38,629) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.041978, valid_loss 1.005819, train_metric nan, valid_metric 0.026038
[1412324:MainThread](2026-01-11 22:47:38,947) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.036012, valid_loss 1.000404, train_metric nan, valid_metric 0.022571
[1412324:MainThread](2026-01-11 22:47:38,948) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002018 to 1.000404, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:39,338) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.032877, valid_loss 1.000664, train_metric nan, valid_metric 0.023192
[1412324:MainThread](2026-01-11 22:47:39,782) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.030812, valid_loss 1.002621, train_metric nan, valid_metric 0.025385
[1412324:MainThread](2026-01-11 22:47:40,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.026117, valid_loss 1.002225, train_metric nan, valid_metric 0.030448
[1412324:MainThread](2026-01-11 22:47:40,560) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.024666, valid_loss 1.001887, train_metric nan, valid_metric 0.029950
[1412324:MainThread](2026-01-11 22:47:40,978) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.025242, valid_loss 1.003274, train_metric nan, valid_metric 0.027658
[1412324:MainThread](2026-01-11 22:47:41,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.020751, valid_loss 1.002770, train_metric nan, valid_metric 0.031461
[1412324:MainThread](2026-01-11 22:47:41,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.030224, valid_loss 1.000341, train_metric nan, valid_metric 0.032021
[1412324:MainThread](2026-01-11 22:47:41,836) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000404 to 1.000341, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:42,233) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.018511, valid_loss 0.999897, train_metric nan, valid_metric 0.026491
[1412324:MainThread](2026-01-11 22:47:42,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000341 to 0.999897, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:42,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.020379, valid_loss 1.000586, train_metric nan, valid_metric 0.028207
[1412324:MainThread](2026-01-11 22:47:43,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.022112, valid_loss 1.003228, train_metric nan, valid_metric 0.033112
[1412324:MainThread](2026-01-11 22:47:43,402) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.016168, valid_loss 1.001353, train_metric nan, valid_metric 0.031472
[1412324:MainThread](2026-01-11 22:47:43,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.019185, valid_loss 0.999872, train_metric nan, valid_metric 0.029942
[1412324:MainThread](2026-01-11 22:47:43,787) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999897 to 0.999872, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:44,186) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.013357, valid_loss 1.000249, train_metric nan, valid_metric 0.029433
[1412324:MainThread](2026-01-11 22:47:44,577) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.013765, valid_loss 1.000000, train_metric nan, valid_metric 0.029024
[1412324:MainThread](2026-01-11 22:47:44,999) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.013340, valid_loss 0.999465, train_metric nan, valid_metric 0.033239
[1412324:MainThread](2026-01-11 22:47:45,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999872 to 0.999465, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:45,398) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.008937, valid_loss 1.000693, train_metric nan, valid_metric 0.018966
[1412324:MainThread](2026-01-11 22:47:45,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.012791, valid_loss 1.001042, train_metric nan, valid_metric 0.032101
[1412324:MainThread](2026-01-11 22:47:46,193) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.007677, valid_loss 1.004913, train_metric nan, valid_metric 0.034613
[1412324:MainThread](2026-01-11 22:47:46,575) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.008208, valid_loss 1.000690, train_metric nan, valid_metric 0.025210
[1412324:MainThread](2026-01-11 22:47:46,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.005828, valid_loss 1.000201, train_metric nan, valid_metric 0.031024
[1412324:MainThread](2026-01-11 22:47:47,383) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.005872, valid_loss 1.000888, train_metric nan, valid_metric 0.032267
[1412324:MainThread](2026-01-11 22:47:47,780) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.008758, valid_loss 0.999941, train_metric nan, valid_metric 0.033368
[1412324:MainThread](2026-01-11 22:47:48,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.008311, valid_loss 1.000876, train_metric nan, valid_metric 0.028709
[1412324:MainThread](2026-01-11 22:47:48,599) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.004417, valid_loss 0.999357, train_metric nan, valid_metric 0.028279
[1412324:MainThread](2026-01-11 22:47:48,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999465 to 0.999357, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:48,988) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.004998, valid_loss 0.999708, train_metric nan, valid_metric 0.032174
[1412324:MainThread](2026-01-11 22:47:49,405) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 0.998005, valid_loss 1.003252, train_metric nan, valid_metric 0.035334
[1412324:MainThread](2026-01-11 22:47:49,786) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.007366, valid_loss 1.000110, train_metric nan, valid_metric 0.028079
[1412324:MainThread](2026-01-11 22:47:50,201) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.008150, valid_loss 1.003348, train_metric nan, valid_metric 0.032555
[1412324:MainThread](2026-01-11 22:47:50,615) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.004393, valid_loss 1.000593, train_metric nan, valid_metric 0.026404
[1412324:MainThread](2026-01-11 22:47:51,020) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.001238, valid_loss 1.002594, train_metric nan, valid_metric 0.035374
[1412324:MainThread](2026-01-11 22:47:51,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.002994, valid_loss 1.000551, train_metric nan, valid_metric 0.034694
[1412324:MainThread](2026-01-11 22:47:51,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 0.999988, valid_loss 0.998977, train_metric nan, valid_metric 0.033945
[1412324:MainThread](2026-01-11 22:47:51,936) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999357 to 0.998977, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:52,332) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.001077, valid_loss 1.001973, train_metric nan, valid_metric 0.034848
[1412324:MainThread](2026-01-11 22:47:52,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 1.001373, valid_loss 0.999770, train_metric nan, valid_metric 0.032308
[1412324:MainThread](2026-01-11 22:47:53,167) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.000379, valid_loss 1.001724, train_metric nan, valid_metric 0.034180
[1412324:MainThread](2026-01-11 22:47:53,569) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.001818, valid_loss 0.999953, train_metric nan, valid_metric 0.034407
[1412324:MainThread](2026-01-11 22:47:53,968) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.999662, valid_loss 0.999325, train_metric nan, valid_metric 0.033279
[1412324:MainThread](2026-01-11 22:47:54,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.002441, valid_loss 1.000982, train_metric nan, valid_metric 0.025814
[1412324:MainThread](2026-01-11 22:47:54,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 1.006315, valid_loss 1.001875, train_metric nan, valid_metric 0.030125
[1412324:MainThread](2026-01-11 22:47:55,269) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.996984, valid_loss 1.002242, train_metric nan, valid_metric 0.026243
[1412324:MainThread](2026-01-11 22:47:55,698) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.999733, valid_loss 1.002351, train_metric nan, valid_metric 0.033606
[1412324:MainThread](2026-01-11 22:47:56,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.989392, valid_loss 0.998883, train_metric nan, valid_metric 0.028210
[1412324:MainThread](2026-01-11 22:47:56,121) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998977 to 0.998883, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:56,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.998683, valid_loss 1.002390, train_metric nan, valid_metric 0.019768
[1412324:MainThread](2026-01-11 22:47:56,977) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.001204, valid_loss 1.000537, train_metric nan, valid_metric 0.033321
[1412324:MainThread](2026-01-11 22:47:57,409) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.994010, valid_loss 0.998672, train_metric nan, valid_metric 0.032511
[1412324:MainThread](2026-01-11 22:47:57,413) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998883 to 0.998672, save checkpoint.
[1412324:MainThread](2026-01-11 22:47:57,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.997305, valid_loss 1.002155, train_metric nan, valid_metric 0.033668
[1412324:MainThread](2026-01-11 22:47:58,239) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 1.000007, valid_loss 1.000876, train_metric nan, valid_metric 0.036605
[1412324:MainThread](2026-01-11 22:47:58,691) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.998072, valid_loss 0.999925, train_metric nan, valid_metric 0.033940
[1412324:MainThread](2026-01-11 22:47:59,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.997864, valid_loss 0.999385, train_metric nan, valid_metric 0.033549
[1412324:MainThread](2026-01-11 22:47:59,564) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.993355, valid_loss 0.998781, train_metric nan, valid_metric 0.028303
[1412324:MainThread](2026-01-11 22:47:59,967) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.993860, valid_loss 0.999329, train_metric nan, valid_metric 0.033861
[1412324:MainThread](2026-01-11 22:48:00,388) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.990358, valid_loss 1.002821, train_metric nan, valid_metric 0.032737
[1412324:MainThread](2026-01-11 22:48:00,830) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.993081, valid_loss 1.001314, train_metric nan, valid_metric 0.034954
[1412324:MainThread](2026-01-11 22:48:01,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.992580, valid_loss 0.999371, train_metric nan, valid_metric 0.029083
[1412324:MainThread](2026-01-11 22:48:01,668) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.991473, valid_loss 1.000879, train_metric nan, valid_metric 0.033671
[1412324:MainThread](2026-01-11 22:48:02,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.991093, valid_loss 1.001911, train_metric nan, valid_metric 0.034915
[1412324:MainThread](2026-01-11 22:48:02,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.998689, valid_loss 0.999559, train_metric nan, valid_metric 0.029149
[1412324:MainThread](2026-01-11 22:48:02,810) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.998844, valid_loss 0.998921, train_metric nan, valid_metric 0.033290
[1412324:MainThread](2026-01-11 22:48:03,141) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.995213, valid_loss 1.000727, train_metric nan, valid_metric 0.034280
[1412324:MainThread](2026-01-11 22:48:03,463) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.993678, valid_loss 0.999057, train_metric nan, valid_metric 0.035279
[1412324:MainThread](2026-01-11 22:48:04,549) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.996438, valid_loss 0.999174, train_metric nan, valid_metric 0.033211
[1412324:MainThread](2026-01-11 22:48:05,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.995725, valid_loss 0.999461, train_metric nan, valid_metric 0.034753
[1412324:MainThread](2026-01-11 22:48:05,457) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.994203, valid_loss 0.999046, train_metric nan, valid_metric 0.034886
[1412324:MainThread](2026-01-11 22:48:05,839) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.998856, valid_loss 1.001559, train_metric nan, valid_metric 0.034118
[1412324:MainThread](2026-01-11 22:48:06,247) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.995759, valid_loss 0.999301, train_metric nan, valid_metric 0.034353
[1412324:MainThread](2026-01-11 22:48:06,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.991788, valid_loss 1.000757, train_metric nan, valid_metric 0.033579
[1412324:MainThread](2026-01-11 22:48:07,056) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.997515, valid_loss 1.001890, train_metric nan, valid_metric 0.033029
[1412324:MainThread](2026-01-11 22:48:07,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.991347, valid_loss 0.998960, train_metric nan, valid_metric 0.031992
[1412324:MainThread](2026-01-11 22:48:07,871) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.994418, valid_loss 0.998882, train_metric nan, valid_metric 0.033285
[1412324:MainThread](2026-01-11 22:48:08,265) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.998062, valid_loss 0.999316, train_metric nan, valid_metric 0.034770
[1412324:MainThread](2026-01-11 22:48:08,655) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.994414, valid_loss 1.000475, train_metric nan, valid_metric 0.035330
[1412324:MainThread](2026-01-11 22:48:09,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.994458, valid_loss 0.999736, train_metric nan, valid_metric 0.033131
[1412324:MainThread](2026-01-11 22:48:09,445) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.992291, valid_loss 0.999173, train_metric nan, valid_metric 0.032278
[1412324:MainThread](2026-01-11 22:48:09,856) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.994373, valid_loss 0.999692, train_metric nan, valid_metric 0.033636
[1412324:MainThread](2026-01-11 22:48:10,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.996927, valid_loss 0.999221, train_metric nan, valid_metric 0.033336
[1412324:MainThread](2026-01-11 22:48:10,712) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.992990, valid_loss 1.000257, train_metric nan, valid_metric 0.034631
[1412324:MainThread](2026-01-11 22:48:11,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.988832, valid_loss 0.999477, train_metric nan, valid_metric 0.035028
[1412324:MainThread](2026-01-11 22:48:11,532) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.988862, valid_loss 0.999296, train_metric nan, valid_metric 0.032350
[1412324:MainThread](2026-01-11 22:48:11,980) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.991426, valid_loss 0.999146, train_metric nan, valid_metric 0.034837
[1412324:MainThread](2026-01-11 22:48:12,387) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.991298, valid_loss 1.000120, train_metric nan, valid_metric 0.036035
[1412324:MainThread](2026-01-11 22:48:12,806) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.994494, valid_loss 0.999076, train_metric nan, valid_metric 0.034693
[1412324:MainThread](2026-01-11 22:48:13,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.993063, valid_loss 1.000332, train_metric nan, valid_metric 0.035808
[1412324:MainThread](2026-01-11 22:48:13,600) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.988750, valid_loss 0.998997, train_metric nan, valid_metric 0.034205
[1412324:MainThread](2026-01-11 22:48:13,997) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.983581, valid_loss 0.999594, train_metric nan, valid_metric 0.035360
[1412324:MainThread](2026-01-11 22:48:14,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.990215, valid_loss 0.999322, train_metric nan, valid_metric 0.034675
[1412324:MainThread](2026-01-11 22:48:14,794) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.991019, valid_loss 0.999397, train_metric nan, valid_metric 0.034708
[1412324:MainThread](2026-01-11 22:48:15,207) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.993708, valid_loss 0.999046, train_metric nan, valid_metric 0.034057
[1412324:MainThread](2026-01-11 22:48:15,589) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.993106, valid_loss 0.999718, train_metric nan, valid_metric 0.034648
[1412324:MainThread](2026-01-11 22:48:16,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.993453, valid_loss 0.999732, train_metric nan, valid_metric 0.034578
[1412324:MainThread](2026-01-11 22:48:16,399) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.990093, valid_loss 1.000062, train_metric nan, valid_metric 0.035174
[1412324:MainThread](2026-01-11 22:48:16,835) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.991098, valid_loss 0.998781, train_metric nan, valid_metric 0.032478
[1412324:MainThread](2026-01-11 22:48:17,249) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.990174, valid_loss 0.999687, train_metric nan, valid_metric 0.034448
[1412324:MainThread](2026-01-11 22:48:17,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.985276, valid_loss 0.999196, train_metric nan, valid_metric 0.033435
[1412324:MainThread](2026-01-11 22:48:18,090) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.993865, valid_loss 0.999230, train_metric nan, valid_metric 0.034678
[1412324:MainThread](2026-01-11 22:48:18,616) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.992729, valid_loss 0.999237, train_metric nan, valid_metric 0.034667
[1412324:MainThread](2026-01-11 22:48:18,617) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:48:18.638 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:48:21.606 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 22:48:21.607 | INFO     | __main__:train_single_fold:593 -   IC=0.0196, ICIR=0.1587, RankIC=0.0424, RankICIR=0.3401
2026-01-11 22:48:21.607 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:48:21,614) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:49:02,723) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:49:02,724) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:49:12,418) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a74739ad0>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:16, 14.66it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:06, 36.69it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:04, 53.10it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 64.92it/s]backtest loop:  15%|█▍        | 36/242 [00:00<00:03, 67.77it/s]backtest loop:  18%|█▊        | 44/242 [00:00<00:02, 69.66it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 75.67it/s]backtest loop:  25%|██▌       | 61/242 [00:00<00:02, 74.77it/s]backtest loop:  29%|██▊       | 69/242 [00:01<00:02, 73.85it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 74.11it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 74.05it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 74.41it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 74.89it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 78.59it/s]backtest loop:  50%|████▉     | 120/242 [00:01<00:01, 77.11it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 75.10it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 78.80it/s]backtest loop:  60%|█████▉    | 145/242 [00:02<00:01, 76.99it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 76.07it/s]backtest loop:  67%|██████▋   | 162/242 [00:02<00:01, 79.71it/s]backtest loop:  71%|███████   | 171/242 [00:02<00:00, 78.47it/s]backtest loop:  74%|███████▍  | 179/242 [00:02<00:00, 76.85it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 75.86it/s]backtest loop:  81%|████████  | 196/242 [00:02<00:00, 79.71it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 78.87it/s]backtest loop:  88%|████████▊ | 213/242 [00:02<00:00, 76.79it/s]backtest loop:  92%|█████████▏| 222/242 [00:03<00:00, 76.61it/s]backtest loop:  95%|█████████▌| 231/242 [00:03<00:00, 80.19it/s]backtest loop:  99%|█████████▉| 240/242 [00:03<00:00, 78.73it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 73.23it/s]
2026-01-11 22:49:15.748 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1172, Sharpe(w/cost)=1.3786, MaxDD=-0.0929
2026-01-11 22:49:19.690 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 22:49:38.302 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:49:38.380 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_6_pred.parquet
2026-01-11 22:49:38.406 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 22:49:38.406 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 22:49:41.286 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0436
2026-01-11 22:49:44.307 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0445
2026-01-11 22:49:46.994 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0406
2026-01-11 22:49:49.682 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0404
2026-01-11 22:49:53.622 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0341
2026-01-11 22:49:56.419 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0321
2026-01-11 22:49:56.793 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0231, ICIR=0.1732, RankIC=0.0454
[1412324:MainThread](2026-01-11 22:49:56,799) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:50:34,994) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:50:34,995) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:50:43,975) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77304750>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.91it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 48.83it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 63.38it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 70.98it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 75.51it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 77.64it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 78.91it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 78.46it/s]backtest loop:  32%|███▏      | 77/242 [00:01<00:02, 79.86it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:01, 79.25it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 79.31it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 79.75it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 80.40it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 80.81it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 81.02it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 81.13it/s]backtest loop:  63%|██████▎   | 152/242 [00:01<00:01, 82.24it/s]backtest loop:  67%|██████▋   | 161/242 [00:02<00:00, 81.27it/s]backtest loop:  70%|███████   | 170/242 [00:02<00:00, 79.24it/s]backtest loop:  74%|███████▎  | 178/242 [00:02<00:00, 78.45it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 78.66it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 79.66it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 80.26it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 80.32it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 81.08it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 81.20it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 78.18it/s]
2026-01-11 22:50:47.094 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1396, Sharpe(w/cost)=1.5860
2026-01-11 22:50:47.150 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:50:47.150 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 22:50:47.150 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:50:47.151 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:52:18,274) INFO - qlib.timer - [log.py:127] - Time cost: 91.118s | Loading data Done
[1412324:MainThread](2026-01-11 22:52:26,882) INFO - qlib.timer - [log.py:127] - Time cost: 8.048s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:52:30,393) INFO - qlib.timer - [log.py:127] - Time cost: 3.510s | Fillna Done
[1412324:MainThread](2026-01-11 22:52:32,298) INFO - qlib.timer - [log.py:127] - Time cost: 0.338s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:52:32,520) INFO - qlib.timer - [log.py:127] - Time cost: 0.221s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:52:32,523) INFO - qlib.timer - [log.py:127] - Time cost: 14.248s | fit & process data Done
[1412324:MainThread](2026-01-11 22:52:32,524) INFO - qlib.timer - [log.py:127] - Time cost: 105.372s | Init data Done
2026-01-11 22:52:32.524 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:52:32,525) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:52:32,526) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:52:32,530) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:52:32,531) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:52:32.540 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:52:34,406) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:52:35,250) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.789117, valid_loss 1.157681, train_metric nan, valid_metric -0.014738
[1412324:MainThread](2026-01-11 22:52:35,254) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.157681, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:35,665) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.101001, valid_loss 1.019743, train_metric nan, valid_metric -0.000850
[1412324:MainThread](2026-01-11 22:52:35,666) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.157681 to 1.019743, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:36,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.054541, valid_loss 1.008032, train_metric nan, valid_metric 0.010285
[1412324:MainThread](2026-01-11 22:52:36,138) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.019743 to 1.008032, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:36,545) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.037843, valid_loss 1.004337, train_metric nan, valid_metric 0.016870
[1412324:MainThread](2026-01-11 22:52:36,547) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.008032 to 1.004337, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:36,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.042128, valid_loss 1.005273, train_metric nan, valid_metric 0.020325
[1412324:MainThread](2026-01-11 22:52:37,352) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.045359, valid_loss 1.004451, train_metric nan, valid_metric 0.009140
[1412324:MainThread](2026-01-11 22:52:37,792) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.037753, valid_loss 1.002733, train_metric nan, valid_metric 0.019313
[1412324:MainThread](2026-01-11 22:52:37,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.004337 to 1.002733, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:38,238) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.036903, valid_loss 1.001986, train_metric nan, valid_metric 0.021925
[1412324:MainThread](2026-01-11 22:52:38,241) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.002733 to 1.001986, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:38,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.036625, valid_loss 1.000805, train_metric nan, valid_metric 0.022731
[1412324:MainThread](2026-01-11 22:52:38,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001986 to 1.000805, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:39,071) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.039067, valid_loss 1.002590, train_metric nan, valid_metric 0.021032
[1412324:MainThread](2026-01-11 22:52:39,491) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.032400, valid_loss 1.003437, train_metric nan, valid_metric 0.012295
[1412324:MainThread](2026-01-11 22:52:39,986) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.034515, valid_loss 1.000870, train_metric nan, valid_metric 0.029710
[1412324:MainThread](2026-01-11 22:52:40,377) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.033144, valid_loss 1.001363, train_metric nan, valid_metric 0.025800
[1412324:MainThread](2026-01-11 22:52:40,776) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.032036, valid_loss 0.999848, train_metric nan, valid_metric 0.023107
[1412324:MainThread](2026-01-11 22:52:40,778) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.000805 to 0.999848, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:41,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.028802, valid_loss 1.000364, train_metric nan, valid_metric 0.028087
[1412324:MainThread](2026-01-11 22:52:41,555) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.027355, valid_loss 1.000066, train_metric nan, valid_metric 0.019162
[1412324:MainThread](2026-01-11 22:52:41,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.023924, valid_loss 1.000739, train_metric nan, valid_metric 0.018967
[1412324:MainThread](2026-01-11 22:52:42,337) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.020784, valid_loss 1.000238, train_metric nan, valid_metric 0.021819
[1412324:MainThread](2026-01-11 22:52:42,729) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.019241, valid_loss 0.999457, train_metric nan, valid_metric 0.023323
[1412324:MainThread](2026-01-11 22:52:42,731) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999848 to 0.999457, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:43,116) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.022394, valid_loss 0.998359, train_metric nan, valid_metric 0.032982
[1412324:MainThread](2026-01-11 22:52:43,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999457 to 0.998359, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:43,506) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.021573, valid_loss 1.003744, train_metric nan, valid_metric 0.005809
[1412324:MainThread](2026-01-11 22:52:43,888) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.018707, valid_loss 1.000378, train_metric nan, valid_metric 0.027325
[1412324:MainThread](2026-01-11 22:52:44,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.015554, valid_loss 0.998819, train_metric nan, valid_metric 0.031771
[1412324:MainThread](2026-01-11 22:52:44,681) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.016377, valid_loss 1.000504, train_metric nan, valid_metric 0.034676
[1412324:MainThread](2026-01-11 22:52:45,118) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.017482, valid_loss 0.999920, train_metric nan, valid_metric 0.024672
[1412324:MainThread](2026-01-11 22:52:45,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.007963, valid_loss 0.999615, train_metric nan, valid_metric 0.030234
[1412324:MainThread](2026-01-11 22:52:45,941) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.010179, valid_loss 0.997681, train_metric nan, valid_metric 0.038945
[1412324:MainThread](2026-01-11 22:52:45,944) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998359 to 0.997681, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:46,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.010265, valid_loss 0.999288, train_metric nan, valid_metric 0.027052
[1412324:MainThread](2026-01-11 22:52:46,785) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.008675, valid_loss 1.000560, train_metric nan, valid_metric 0.025050
[1412324:MainThread](2026-01-11 22:52:47,211) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.009063, valid_loss 1.001000, train_metric nan, valid_metric 0.024522
[1412324:MainThread](2026-01-11 22:52:47,618) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.009945, valid_loss 1.000018, train_metric nan, valid_metric 0.019101
[1412324:MainThread](2026-01-11 22:52:48,041) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.007333, valid_loss 0.998359, train_metric nan, valid_metric 0.028741
[1412324:MainThread](2026-01-11 22:52:48,466) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.010463, valid_loss 0.998973, train_metric nan, valid_metric 0.031304
[1412324:MainThread](2026-01-11 22:52:48,875) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.008981, valid_loss 0.999740, train_metric nan, valid_metric 0.034283
[1412324:MainThread](2026-01-11 22:52:49,285) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.008441, valid_loss 0.999467, train_metric nan, valid_metric 0.022831
[1412324:MainThread](2026-01-11 22:52:49,707) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.004222, valid_loss 0.998808, train_metric nan, valid_metric 0.030878
[1412324:MainThread](2026-01-11 22:52:50,109) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.002722, valid_loss 0.998142, train_metric nan, valid_metric 0.033790
[1412324:MainThread](2026-01-11 22:52:50,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.005964, valid_loss 1.000011, train_metric nan, valid_metric 0.033053
[1412324:MainThread](2026-01-11 22:52:50,961) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.000629, valid_loss 0.998310, train_metric nan, valid_metric 0.030113
[1412324:MainThread](2026-01-11 22:52:51,333) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.003689, valid_loss 0.997097, train_metric nan, valid_metric 0.037450
[1412324:MainThread](2026-01-11 22:52:51,334) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997681 to 0.997097, save checkpoint.
[1412324:MainThread](2026-01-11 22:52:51,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.008353, valid_loss 0.999021, train_metric nan, valid_metric 0.029074
[1412324:MainThread](2026-01-11 22:52:51,996) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.005297, valid_loss 0.997984, train_metric nan, valid_metric 0.034858
[1412324:MainThread](2026-01-11 22:52:52,314) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.006748, valid_loss 0.998099, train_metric nan, valid_metric 0.034779
[1412324:MainThread](2026-01-11 22:52:52,638) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.998052, valid_loss 0.998066, train_metric nan, valid_metric 0.026690
[1412324:MainThread](2026-01-11 22:52:52,990) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.000133, valid_loss 0.997590, train_metric nan, valid_metric 0.038123
[1412324:MainThread](2026-01-11 22:52:53,450) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 0.997140, valid_loss 0.998488, train_metric nan, valid_metric 0.034987
[1412324:MainThread](2026-01-11 22:52:53,885) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 0.999013, valid_loss 1.000047, train_metric nan, valid_metric 0.036748
[1412324:MainThread](2026-01-11 22:52:54,353) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.005250, valid_loss 0.999130, train_metric nan, valid_metric 0.028911
[1412324:MainThread](2026-01-11 22:52:54,739) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.994274, valid_loss 0.997793, train_metric nan, valid_metric 0.036254
[1412324:MainThread](2026-01-11 22:52:55,129) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 1.003905, valid_loss 0.997914, train_metric nan, valid_metric 0.037405
[1412324:MainThread](2026-01-11 22:52:55,539) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 0.998815, valid_loss 0.998179, train_metric nan, valid_metric 0.029400
[1412324:MainThread](2026-01-11 22:52:55,964) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.995659, valid_loss 0.997690, train_metric nan, valid_metric 0.035495
[1412324:MainThread](2026-01-11 22:52:56,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.999169, valid_loss 0.997733, train_metric nan, valid_metric 0.034212
[1412324:MainThread](2026-01-11 22:52:56,799) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 1.000354, valid_loss 0.997633, train_metric nan, valid_metric 0.037358
[1412324:MainThread](2026-01-11 22:52:57,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.997217, valid_loss 0.997548, train_metric nan, valid_metric 0.037670
[1412324:MainThread](2026-01-11 22:52:57,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.993023, valid_loss 0.997374, train_metric nan, valid_metric 0.037375
[1412324:MainThread](2026-01-11 22:52:58,164) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.997344, valid_loss 0.997196, train_metric nan, valid_metric 0.036792
[1412324:MainThread](2026-01-11 22:52:58,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.994936, valid_loss 0.998064, train_metric nan, valid_metric 0.033866
[1412324:MainThread](2026-01-11 22:52:58,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 1.000791, valid_loss 0.997390, train_metric nan, valid_metric 0.038671
[1412324:MainThread](2026-01-11 22:52:59,374) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 1.001664, valid_loss 0.997416, train_metric nan, valid_metric 0.037237
[1412324:MainThread](2026-01-11 22:52:59,783) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.998862, valid_loss 0.997297, train_metric nan, valid_metric 0.033453
[1412324:MainThread](2026-01-11 22:53:00,170) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 1.005846, valid_loss 0.997449, train_metric nan, valid_metric 0.033192
[1412324:MainThread](2026-01-11 22:53:00,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 0.999547, valid_loss 0.998312, train_metric nan, valid_metric 0.029995
[1412324:MainThread](2026-01-11 22:53:00,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 1.002085, valid_loss 0.997864, train_metric nan, valid_metric 0.038246
[1412324:MainThread](2026-01-11 22:53:01,392) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.993588, valid_loss 0.997936, train_metric nan, valid_metric 0.035460
[1412324:MainThread](2026-01-11 22:53:01,816) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 1.000472, valid_loss 0.997727, train_metric nan, valid_metric 0.032564
[1412324:MainThread](2026-01-11 22:53:02,253) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 1.001024, valid_loss 0.997038, train_metric nan, valid_metric 0.038308
[1412324:MainThread](2026-01-11 22:53:02,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997097 to 0.997038, save checkpoint.
[1412324:MainThread](2026-01-11 22:53:02,692) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.995033, valid_loss 0.998377, train_metric nan, valid_metric 0.027862
[1412324:MainThread](2026-01-11 22:53:03,148) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.997819, valid_loss 0.997873, train_metric nan, valid_metric 0.035808
[1412324:MainThread](2026-01-11 22:53:03,553) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.994850, valid_loss 0.997677, train_metric nan, valid_metric 0.038950
[1412324:MainThread](2026-01-11 22:53:03,940) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 0.998143, valid_loss 0.998136, train_metric nan, valid_metric 0.029661
[1412324:MainThread](2026-01-11 22:53:04,351) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.994528, valid_loss 0.997755, train_metric nan, valid_metric 0.031749
[1412324:MainThread](2026-01-11 22:53:04,797) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.999103, valid_loss 0.997072, train_metric nan, valid_metric 0.038220
[1412324:MainThread](2026-01-11 22:53:05,216) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.993603, valid_loss 0.997052, train_metric nan, valid_metric 0.039952
[1412324:MainThread](2026-01-11 22:53:05,613) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.999554, valid_loss 0.997328, train_metric nan, valid_metric 0.037370
[1412324:MainThread](2026-01-11 22:53:06,040) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.993544, valid_loss 0.997433, train_metric nan, valid_metric 0.038081
[1412324:MainThread](2026-01-11 22:53:06,467) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 1.000702, valid_loss 0.997045, train_metric nan, valid_metric 0.039358
[1412324:MainThread](2026-01-11 22:53:06,864) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.991511, valid_loss 0.997694, train_metric nan, valid_metric 0.035843
[1412324:MainThread](2026-01-11 22:53:07,257) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.995945, valid_loss 0.997273, train_metric nan, valid_metric 0.035749
[1412324:MainThread](2026-01-11 22:53:07,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.997469, valid_loss 0.997681, train_metric nan, valid_metric 0.034160
[1412324:MainThread](2026-01-11 22:53:08,081) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.998697, valid_loss 0.997248, train_metric nan, valid_metric 0.038406
[1412324:MainThread](2026-01-11 22:53:08,483) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 1.000487, valid_loss 0.997374, train_metric nan, valid_metric 0.036652
[1412324:MainThread](2026-01-11 22:53:08,924) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.997909, valid_loss 0.997585, train_metric nan, valid_metric 0.037663
[1412324:MainThread](2026-01-11 22:53:09,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.995971, valid_loss 0.997447, train_metric nan, valid_metric 0.037220
[1412324:MainThread](2026-01-11 22:53:09,798) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.998490, valid_loss 0.997499, train_metric nan, valid_metric 0.038694
[1412324:MainThread](2026-01-11 22:53:10,245) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.996015, valid_loss 0.997406, train_metric nan, valid_metric 0.037975
[1412324:MainThread](2026-01-11 22:53:10,669) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.994622, valid_loss 0.997517, train_metric nan, valid_metric 0.036261
[1412324:MainThread](2026-01-11 22:53:11,088) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.996556, valid_loss 0.997409, train_metric nan, valid_metric 0.036373
[1412324:MainThread](2026-01-11 22:53:11,522) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.996585, valid_loss 0.997319, train_metric nan, valid_metric 0.037620
[1412324:MainThread](2026-01-11 22:53:11,938) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.993000, valid_loss 0.997438, train_metric nan, valid_metric 0.038438
[1412324:MainThread](2026-01-11 22:53:12,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 1.000623, valid_loss 0.997452, train_metric nan, valid_metric 0.035857
[1412324:MainThread](2026-01-11 22:53:12,761) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 1.000857, valid_loss 0.997305, train_metric nan, valid_metric 0.036639
[1412324:MainThread](2026-01-11 22:53:13,175) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.999576, valid_loss 0.997260, train_metric nan, valid_metric 0.037930
[1412324:MainThread](2026-01-11 22:53:13,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.995924, valid_loss 0.997490, train_metric nan, valid_metric 0.038278
[1412324:MainThread](2026-01-11 22:53:14,014) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.999956, valid_loss 0.997472, train_metric nan, valid_metric 0.038110
[1412324:MainThread](2026-01-11 22:53:14,412) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.997333, valid_loss 0.997599, train_metric nan, valid_metric 0.035554
[1412324:MainThread](2026-01-11 22:53:14,848) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 1.000104, valid_loss 0.997659, train_metric nan, valid_metric 0.037522
[1412324:MainThread](2026-01-11 22:53:15,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.994350, valid_loss 0.997642, train_metric nan, valid_metric 0.036971
[1412324:MainThread](2026-01-11 22:53:16,581) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.995931, valid_loss 0.997525, train_metric nan, valid_metric 0.036042
[1412324:MainThread](2026-01-11 22:53:17,030) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.996423, valid_loss 0.997632, train_metric nan, valid_metric 0.035557
[1412324:MainThread](2026-01-11 22:53:17,456) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.993601, valid_loss 0.997549, train_metric nan, valid_metric 0.036029
[1412324:MainThread](2026-01-11 22:53:17,883) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 1.000266, valid_loss 0.997575, train_metric nan, valid_metric 0.037773
[1412324:MainThread](2026-01-11 22:53:18,339) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.998974, valid_loss 0.997444, train_metric nan, valid_metric 0.036425
[1412324:MainThread](2026-01-11 22:53:18,749) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.992776, valid_loss 0.997246, train_metric nan, valid_metric 0.037649
[1412324:MainThread](2026-01-11 22:53:19,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.991912, valid_loss 0.997243, train_metric nan, valid_metric 0.038945
[1412324:MainThread](2026-01-11 22:53:19,591) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.997813, valid_loss 0.997368, train_metric nan, valid_metric 0.036397
[1412324:MainThread](2026-01-11 22:53:20,004) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.994655, valid_loss 0.997407, train_metric nan, valid_metric 0.036614
[1412324:MainThread](2026-01-11 22:53:20,415) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.999046, valid_loss 0.997314, train_metric nan, valid_metric 0.037523
[1412324:MainThread](2026-01-11 22:53:20,814) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.996219, valid_loss 0.997325, train_metric nan, valid_metric 0.038026
[1412324:MainThread](2026-01-11 22:53:21,210) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.993402, valid_loss 0.997286, train_metric nan, valid_metric 0.037234
[1412324:MainThread](2026-01-11 22:53:21,623) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.998540, valid_loss 0.997285, train_metric nan, valid_metric 0.037535
[1412324:MainThread](2026-01-11 22:53:22,023) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.992162, valid_loss 0.997296, train_metric nan, valid_metric 0.038738
[1412324:MainThread](2026-01-11 22:53:22,435) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 1.000018, valid_loss 0.997277, train_metric nan, valid_metric 0.038191
[1412324:MainThread](2026-01-11 22:53:22,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.995174, valid_loss 0.997299, train_metric nan, valid_metric 0.037981
[1412324:MainThread](2026-01-11 22:53:23,235) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.992975, valid_loss 0.997280, train_metric nan, valid_metric 0.038028
[1412324:MainThread](2026-01-11 22:53:23,653) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.996137, valid_loss 0.997345, train_metric nan, valid_metric 0.037157
[1412324:MainThread](2026-01-11 22:53:24,054) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.992230, valid_loss 0.997406, train_metric nan, valid_metric 0.037971
[1412324:MainThread](2026-01-11 22:53:24,057) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:53:24.075 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:53:27.057 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 22:53:27.058 | INFO     | __main__:train_single_fold:593 -   IC=0.0117, ICIR=0.0914, RankIC=0.0342, RankICIR=0.3057
2026-01-11 22:53:27.058 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:53:27,065) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:54:07,301) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:54:07,302) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:54:17,021) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a75077990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.08it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 48.46it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.80it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 69.62it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 73.59it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 75.82it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 77.15it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 76.59it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 75.65it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 75.69it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:02, 75.38it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 76.14it/s]backtest loop:  45%|████▌     | 110/242 [00:01<00:01, 77.31it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 76.63it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 78.01it/s]backtest loop:  57%|█████▋    | 138/242 [00:01<00:01, 78.32it/s]backtest loop:  61%|██████    | 148/242 [00:01<00:01, 78.17it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 78.41it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 81.08it/s]backtest loop:  73%|███████▎  | 176/242 [00:02<00:00, 79.71it/s]backtest loop:  76%|███████▌  | 184/242 [00:02<00:00, 77.52it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 76.41it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 78.06it/s]backtest loop:  87%|████████▋ | 211/242 [00:02<00:00, 80.80it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 80.04it/s]backtest loop:  95%|█████████▍| 229/242 [00:03<00:00, 78.71it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 77.72it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.89it/s]
2026-01-11 22:54:20.234 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0983, Sharpe(w/cost)=1.5112, MaxDD=-0.0489
2026-01-11 22:54:25.595 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 22:54:42.937 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 22:54:43.004 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_7_pred.parquet
2026-01-11 22:54:43.020 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 22:54:43.020 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 22:54:46.085 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0312
2026-01-11 22:54:48.589 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0332
2026-01-11 22:54:51.100 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0290
2026-01-11 22:54:53.416 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0293
2026-01-11 22:54:55.969 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0304
2026-01-11 22:54:58.352 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0412
2026-01-11 22:55:00.776 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0451
2026-01-11 22:55:01.161 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0156, ICIR=0.1160, RankIC=0.0393
[1412324:MainThread](2026-01-11 22:55:01,167) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:55:46,772) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:55:46,774) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:55:56,188) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a76d27990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.49it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 50.46it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.26it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 69.58it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 73.83it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 76.36it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 77.94it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 77.30it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 76.50it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 76.99it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:01, 76.25it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 76.63it/s]backtest loop:  45%|████▌     | 109/242 [00:01<00:01, 79.43it/s]backtest loop:  48%|████▊     | 117/242 [00:01<00:01, 78.15it/s]backtest loop:  52%|█████▏    | 125/242 [00:01<00:01, 76.31it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 76.01it/s]backtest loop:  59%|█████▊    | 142/242 [00:01<00:01, 79.39it/s]backtest loop:  62%|██████▏   | 150/242 [00:02<00:01, 77.54it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 76.31it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:00, 77.23it/s]backtest loop:  74%|███████▎  | 178/242 [00:02<00:00, 77.98it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 77.24it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 78.26it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 78.85it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 79.32it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 79.35it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 81.67it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 75.83it/s]
2026-01-11 22:55:59.402 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0876, Sharpe(w/cost)=1.2720
2026-01-11 22:55:59.458 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 22:55:59.458 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 22:55:59.458 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 22:55:59.458 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1412324:MainThread](2026-01-11 22:57:34,753) INFO - qlib.timer - [log.py:127] - Time cost: 95.292s | Loading data Done
[1412324:MainThread](2026-01-11 22:57:43,598) INFO - qlib.timer - [log.py:127] - Time cost: 8.267s | RobustZScoreNorm Done
[1412324:MainThread](2026-01-11 22:57:47,130) INFO - qlib.timer - [log.py:127] - Time cost: 3.531s | Fillna Done
[1412324:MainThread](2026-01-11 22:57:49,126) INFO - qlib.timer - [log.py:127] - Time cost: 0.341s | DropnaLabel Done
[1412324:MainThread](2026-01-11 22:57:49,350) INFO - qlib.timer - [log.py:127] - Time cost: 0.223s | CSRankNorm Done
[1412324:MainThread](2026-01-11 22:57:49,353) INFO - qlib.timer - [log.py:127] - Time cost: 14.599s | fit & process data Done
[1412324:MainThread](2026-01-11 22:57:49,353) INFO - qlib.timer - [log.py:127] - Time cost: 109.894s | Init data Done
2026-01-11 22:57:49.354 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1412324:MainThread](2026-01-11 22:57:49,355) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:82] - DNN pytorch version...
[1412324:MainThread](2026-01-11 22:57:49,356) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:104] - DNN parameters setting:
lr : 0.002
max_steps : 8000
batch_size : 4096
early_stop_rounds : 50
eval_steps : 20
optimizer : adam
loss_type : mse
seed : None
device : cuda:0
use_GPU : True
weight_decay : 0.0
enable data parall : False
pt_model_uri: qlib.contrib.model.pytorch_nn.Net
pt_model_kwargs: {'input_dim': 360}
[1412324:MainThread](2026-01-11 22:57:49,359) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:138] - model:
Net(
  (dnn_layers): ModuleList(
    (0): Dropout(p=0.05, inplace=False)
    (1): Sequential(
      (0): Linear(in_features=360, out_features=256, bias=True)
      (1): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
      (2): LeakyReLU(negative_slope=0.1)
    )
    (2): Dropout(p=0.05, inplace=False)
    (3): Linear(in_features=256, out_features=1, bias=True)
  )
)
[1412324:MainThread](2026-01-11 22:57:49,360) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:139] - model size: 0.0889 MB
2026-01-11 22:57:49.370 | INFO     | __main__:train_single_fold:569 - Training mlp_360_robust model (GPU=0)...
[1412324:MainThread](2026-01-11 22:57:51,237) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:234] - training...
[1412324:MainThread](2026-01-11 22:57:52,092) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 20]: train_loss 1.683149, valid_loss 1.192177, train_metric nan, valid_metric -0.001244
[1412324:MainThread](2026-01-11 22:57:52,093) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from inf to 1.192177, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:52,516) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 40]: train_loss 1.087137, valid_loss 1.014618, train_metric nan, valid_metric 0.000682
[1412324:MainThread](2026-01-11 22:57:52,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.192177 to 1.014618, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:52,917) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 60]: train_loss 1.055249, valid_loss 1.003855, train_metric nan, valid_metric 0.017298
[1412324:MainThread](2026-01-11 22:57:52,919) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.014618 to 1.003855, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:53,300) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 80]: train_loss 1.048674, valid_loss 1.001795, train_metric nan, valid_metric 0.019116
[1412324:MainThread](2026-01-11 22:57:53,302) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.003855 to 1.001795, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:53,699) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 100]: train_loss 1.052750, valid_loss 1.001028, train_metric nan, valid_metric 0.025372
[1412324:MainThread](2026-01-11 22:57:53,704) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001795 to 1.001028, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:54,106) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 120]: train_loss 1.051168, valid_loss 1.001143, train_metric nan, valid_metric 0.025280
[1412324:MainThread](2026-01-11 22:57:54,480) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 140]: train_loss 1.043977, valid_loss 1.001258, train_metric nan, valid_metric 0.019452
[1412324:MainThread](2026-01-11 22:57:54,933) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 160]: train_loss 1.041323, valid_loss 0.999531, train_metric nan, valid_metric 0.026362
[1412324:MainThread](2026-01-11 22:57:54,934) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 1.001028 to 0.999531, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:55,347) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 180]: train_loss 1.036754, valid_loss 0.999960, train_metric nan, valid_metric 0.023932
[1412324:MainThread](2026-01-11 22:57:55,756) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 200]: train_loss 1.035938, valid_loss 0.999171, train_metric nan, valid_metric 0.028013
[1412324:MainThread](2026-01-11 22:57:55,764) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999531 to 0.999171, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:56,215) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 220]: train_loss 1.040466, valid_loss 0.998875, train_metric nan, valid_metric 0.027880
[1412324:MainThread](2026-01-11 22:57:56,217) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.999171 to 0.998875, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:56,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 240]: train_loss 1.035392, valid_loss 0.999895, train_metric nan, valid_metric 0.031929
[1412324:MainThread](2026-01-11 22:57:57,018) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 260]: train_loss 1.031602, valid_loss 0.999705, train_metric nan, valid_metric 0.029172
[1412324:MainThread](2026-01-11 22:57:57,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 280]: train_loss 1.029423, valid_loss 0.999096, train_metric nan, valid_metric 0.026667
[1412324:MainThread](2026-01-11 22:57:57,827) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 300]: train_loss 1.029198, valid_loss 0.997806, train_metric nan, valid_metric 0.037104
[1412324:MainThread](2026-01-11 22:57:57,828) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.998875 to 0.997806, save checkpoint.
[1412324:MainThread](2026-01-11 22:57:58,262) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 320]: train_loss 1.024536, valid_loss 0.998685, train_metric nan, valid_metric 0.030051
[1412324:MainThread](2026-01-11 22:57:58,663) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 340]: train_loss 1.022815, valid_loss 1.000665, train_metric nan, valid_metric 0.020014
[1412324:MainThread](2026-01-11 22:57:59,137) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 360]: train_loss 1.016357, valid_loss 1.001203, train_metric nan, valid_metric 0.025762
[1412324:MainThread](2026-01-11 22:57:59,595) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 380]: train_loss 1.021587, valid_loss 1.000229, train_metric nan, valid_metric 0.028158
[1412324:MainThread](2026-01-11 22:58:00,010) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 400]: train_loss 1.017066, valid_loss 0.999044, train_metric nan, valid_metric 0.033759
[1412324:MainThread](2026-01-11 22:58:00,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 420]: train_loss 1.020318, valid_loss 0.998628, train_metric nan, valid_metric 0.028690
[1412324:MainThread](2026-01-11 22:58:00,929) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 440]: train_loss 1.023128, valid_loss 0.997586, train_metric nan, valid_metric 0.037474
[1412324:MainThread](2026-01-11 22:58:00,931) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997806 to 0.997586, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:01,328) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 460]: train_loss 1.016829, valid_loss 0.999141, train_metric nan, valid_metric 0.029587
[1412324:MainThread](2026-01-11 22:58:01,727) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 480]: train_loss 1.019135, valid_loss 0.998162, train_metric nan, valid_metric 0.039632
[1412324:MainThread](2026-01-11 22:58:02,158) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 500]: train_loss 1.013061, valid_loss 0.998670, train_metric nan, valid_metric 0.028410
[1412324:MainThread](2026-01-11 22:58:02,565) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 520]: train_loss 1.017103, valid_loss 0.997188, train_metric nan, valid_metric 0.040058
[1412324:MainThread](2026-01-11 22:58:02,568) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997586 to 0.997188, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:02,971) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 540]: train_loss 1.014423, valid_loss 0.998079, train_metric nan, valid_metric 0.030693
[1412324:MainThread](2026-01-11 22:58:03,396) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 560]: train_loss 1.009115, valid_loss 0.998766, train_metric nan, valid_metric 0.028457
[1412324:MainThread](2026-01-11 22:58:03,808) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 580]: train_loss 1.009576, valid_loss 0.996827, train_metric nan, valid_metric 0.040216
[1412324:MainThread](2026-01-11 22:58:03,811) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.997188 to 0.996827, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:04,224) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 600]: train_loss 1.003098, valid_loss 1.000745, train_metric nan, valid_metric 0.023663
[1412324:MainThread](2026-01-11 22:58:04,662) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 620]: train_loss 1.007194, valid_loss 0.997920, train_metric nan, valid_metric 0.035645
[1412324:MainThread](2026-01-11 22:58:05,094) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 640]: train_loss 1.006292, valid_loss 0.998795, train_metric nan, valid_metric 0.027839
[1412324:MainThread](2026-01-11 22:58:05,509) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 660]: train_loss 1.011737, valid_loss 0.996672, train_metric nan, valid_metric 0.039329
[1412324:MainThread](2026-01-11 22:58:05,515) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996827 to 0.996672, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:05,992) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 680]: train_loss 1.008018, valid_loss 0.997632, train_metric nan, valid_metric 0.033524
[1412324:MainThread](2026-01-11 22:58:06,443) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 700]: train_loss 1.013848, valid_loss 0.997954, train_metric nan, valid_metric 0.035736
[1412324:MainThread](2026-01-11 22:58:06,860) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 720]: train_loss 1.005551, valid_loss 1.000295, train_metric nan, valid_metric 0.029813
[1412324:MainThread](2026-01-11 22:58:07,266) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 740]: train_loss 1.008908, valid_loss 0.997673, train_metric nan, valid_metric 0.036355
[1412324:MainThread](2026-01-11 22:58:07,642) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 760]: train_loss 1.000963, valid_loss 0.997732, train_metric nan, valid_metric 0.037432
[1412324:MainThread](2026-01-11 22:58:07,975) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 780]: train_loss 1.002754, valid_loss 0.997200, train_metric nan, valid_metric 0.038078
[1412324:MainThread](2026-01-11 22:58:08,286) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 800]: train_loss 1.003497, valid_loss 0.996417, train_metric nan, valid_metric 0.041291
[1412324:MainThread](2026-01-11 22:58:08,287) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996672 to 0.996417, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:08,657) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 820]: train_loss 1.007027, valid_loss 0.998349, train_metric nan, valid_metric 0.035211
[1412324:MainThread](2026-01-11 22:58:09,082) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 840]: train_loss 1.004747, valid_loss 0.996253, train_metric nan, valid_metric 0.046077
[1412324:MainThread](2026-01-11 22:58:09,084) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996417 to 0.996253, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:09,535) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 860]: train_loss 1.001219, valid_loss 0.998555, train_metric nan, valid_metric 0.034882
[1412324:MainThread](2026-01-11 22:58:09,932) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 880]: train_loss 0.998159, valid_loss 0.997450, train_metric nan, valid_metric 0.036857
[1412324:MainThread](2026-01-11 22:58:10,390) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 900]: train_loss 1.001607, valid_loss 0.997304, train_metric nan, valid_metric 0.037027
[1412324:MainThread](2026-01-11 22:58:10,823) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 920]: train_loss 1.004677, valid_loss 0.996106, train_metric nan, valid_metric 0.045914
[1412324:MainThread](2026-01-11 22:58:10,824) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996253 to 0.996106, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:11,252) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 940]: train_loss 1.003332, valid_loss 0.997580, train_metric nan, valid_metric 0.039000
[1412324:MainThread](2026-01-11 22:58:11,646) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 960]: train_loss 1.003683, valid_loss 0.998190, train_metric nan, valid_metric 0.040578
[1412324:MainThread](2026-01-11 22:58:12,039) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 980]: train_loss 0.996577, valid_loss 0.996705, train_metric nan, valid_metric 0.040434
[1412324:MainThread](2026-01-11 22:58:12,429) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1000]: train_loss 0.999513, valid_loss 0.997090, train_metric nan, valid_metric 0.033836
[1412324:MainThread](2026-01-11 22:58:12,874) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1020]: train_loss 1.000700, valid_loss 0.997651, train_metric nan, valid_metric 0.042995
[1412324:MainThread](2026-01-11 22:58:13,258) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1040]: train_loss 0.994334, valid_loss 0.999371, train_metric nan, valid_metric 0.030854
[1412324:MainThread](2026-01-11 22:58:13,684) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1060]: train_loss 0.997713, valid_loss 0.997176, train_metric nan, valid_metric 0.038643
[1412324:MainThread](2026-01-11 22:58:14,085) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1080]: train_loss 0.992910, valid_loss 0.997808, train_metric nan, valid_metric 0.035447
[1412324:MainThread](2026-01-11 22:58:14,471) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1100]: train_loss 0.992427, valid_loss 0.996392, train_metric nan, valid_metric 0.042408
[1412324:MainThread](2026-01-11 22:58:14,852) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1120]: train_loss 0.996026, valid_loss 0.998892, train_metric nan, valid_metric 0.037121
[1412324:MainThread](2026-01-11 22:58:15,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1140]: train_loss 0.998826, valid_loss 0.996704, train_metric nan, valid_metric 0.044681
[1412324:MainThread](2026-01-11 22:58:15,693) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1160]: train_loss 0.996783, valid_loss 0.997610, train_metric nan, valid_metric 0.033674
[1412324:MainThread](2026-01-11 22:58:16,123) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1180]: train_loss 0.999565, valid_loss 0.997761, train_metric nan, valid_metric 0.037084
[1412324:MainThread](2026-01-11 22:58:16,524) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1200]: train_loss 0.998241, valid_loss 0.996260, train_metric nan, valid_metric 0.042364
[1412324:MainThread](2026-01-11 22:58:17,012) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1220]: train_loss 0.993825, valid_loss 0.996567, train_metric nan, valid_metric 0.040938
[1412324:MainThread](2026-01-11 22:58:17,446) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1240]: train_loss 0.997475, valid_loss 0.996485, train_metric nan, valid_metric 0.042171
[1412324:MainThread](2026-01-11 22:58:17,850) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1260]: train_loss 1.003518, valid_loss 0.997861, train_metric nan, valid_metric 0.035557
[1412324:MainThread](2026-01-11 22:58:18,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1280]: train_loss 0.996434, valid_loss 0.996667, train_metric nan, valid_metric 0.042415
[1412324:MainThread](2026-01-11 22:58:18,724) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1300]: train_loss 0.995486, valid_loss 0.996467, train_metric nan, valid_metric 0.041276
[1412324:MainThread](2026-01-11 22:58:19,160) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1320]: train_loss 0.992122, valid_loss 0.996742, train_metric nan, valid_metric 0.042367
[1412324:MainThread](2026-01-11 22:58:19,573) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1340]: train_loss 0.993741, valid_loss 0.996885, train_metric nan, valid_metric 0.036948
[1412324:MainThread](2026-01-11 22:58:20,032) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1360]: train_loss 0.999491, valid_loss 0.997512, train_metric nan, valid_metric 0.042186
[1412324:MainThread](2026-01-11 22:58:20,437) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1380]: train_loss 0.997572, valid_loss 0.996724, train_metric nan, valid_metric 0.039935
[1412324:MainThread](2026-01-11 22:58:20,858) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1400]: train_loss 0.995463, valid_loss 0.996392, train_metric nan, valid_metric 0.043395
[1412324:MainThread](2026-01-11 22:58:21,296) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1420]: train_loss 1.000081, valid_loss 0.996314, train_metric nan, valid_metric 0.041289
[1412324:MainThread](2026-01-11 22:58:21,701) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1440]: train_loss 0.996336, valid_loss 0.996536, train_metric nan, valid_metric 0.043120
[1412324:MainThread](2026-01-11 22:58:22,135) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1460]: train_loss 0.992416, valid_loss 0.996487, train_metric nan, valid_metric 0.043318
[1412324:MainThread](2026-01-11 22:58:22,548) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1480]: train_loss 0.992147, valid_loss 0.997045, train_metric nan, valid_metric 0.040052
[1412324:MainThread](2026-01-11 22:58:22,998) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1500]: train_loss 0.995083, valid_loss 0.996665, train_metric nan, valid_metric 0.040545
[1412324:MainThread](2026-01-11 22:58:23,414) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1520]: train_loss 0.996044, valid_loss 0.996632, train_metric nan, valid_metric 0.042945
[1412324:MainThread](2026-01-11 22:58:23,845) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1540]: train_loss 0.996362, valid_loss 0.996279, train_metric nan, valid_metric 0.043888
[1412324:MainThread](2026-01-11 22:58:24,572) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1560]: train_loss 0.995326, valid_loss 0.996660, train_metric nan, valid_metric 0.044365
[1412324:MainThread](2026-01-11 22:58:25,543) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1580]: train_loss 0.992291, valid_loss 0.996614, train_metric nan, valid_metric 0.040187
[1412324:MainThread](2026-01-11 22:58:26,066) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1600]: train_loss 0.998007, valid_loss 0.996830, train_metric nan, valid_metric 0.041375
[1412324:MainThread](2026-01-11 22:58:26,475) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1620]: train_loss 0.999099, valid_loss 0.996347, train_metric nan, valid_metric 0.044112
[1412324:MainThread](2026-01-11 22:58:26,877) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1640]: train_loss 0.996154, valid_loss 0.996142, train_metric nan, valid_metric 0.044004
[1412324:MainThread](2026-01-11 22:58:27,274) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1660]: train_loss 0.995556, valid_loss 0.996631, train_metric nan, valid_metric 0.043253
[1412324:MainThread](2026-01-11 22:58:27,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1680]: train_loss 0.995629, valid_loss 0.996105, train_metric nan, valid_metric 0.044361
[1412324:MainThread](2026-01-11 22:58:27,686) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996106 to 0.996105, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:28,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1700]: train_loss 0.995282, valid_loss 0.996138, train_metric nan, valid_metric 0.043899
[1412324:MainThread](2026-01-11 22:58:28,519) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1720]: train_loss 0.993505, valid_loss 0.996798, train_metric nan, valid_metric 0.042801
[1412324:MainThread](2026-01-11 22:58:28,946) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1740]: train_loss 0.992617, valid_loss 0.997124, train_metric nan, valid_metric 0.038487
[1412324:MainThread](2026-01-11 22:58:29,345) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1760]: train_loss 0.992507, valid_loss 0.996292, train_metric nan, valid_metric 0.042809
[1412324:MainThread](2026-01-11 22:58:29,766) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1780]: train_loss 0.993111, valid_loss 0.996900, train_metric nan, valid_metric 0.040233
[1412324:MainThread](2026-01-11 22:58:30,168) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1800]: train_loss 0.991944, valid_loss 0.996009, train_metric nan, valid_metric 0.044911
[1412324:MainThread](2026-01-11 22:58:30,169) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:311] - 	valid loss update from 0.996105 to 0.996009, save checkpoint.
[1412324:MainThread](2026-01-11 22:58:30,590) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1820]: train_loss 0.997290, valid_loss 0.996322, train_metric nan, valid_metric 0.043526
[1412324:MainThread](2026-01-11 22:58:30,987) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1840]: train_loss 0.991962, valid_loss 0.996106, train_metric nan, valid_metric 0.044246
[1412324:MainThread](2026-01-11 22:58:31,397) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1860]: train_loss 0.993000, valid_loss 0.996116, train_metric nan, valid_metric 0.044956
[1412324:MainThread](2026-01-11 22:58:31,807) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1880]: train_loss 0.992586, valid_loss 0.996363, train_metric nan, valid_metric 0.044226
[1412324:MainThread](2026-01-11 22:58:32,282) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1900]: train_loss 0.987349, valid_loss 0.996409, train_metric nan, valid_metric 0.044014
[1412324:MainThread](2026-01-11 22:58:32,644) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1920]: train_loss 0.992379, valid_loss 0.996265, train_metric nan, valid_metric 0.043705
[1412324:MainThread](2026-01-11 22:58:32,982) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1940]: train_loss 0.994158, valid_loss 0.996292, train_metric nan, valid_metric 0.044369
[1412324:MainThread](2026-01-11 22:58:33,280) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1960]: train_loss 0.997287, valid_loss 0.996317, train_metric nan, valid_metric 0.043495
[1412324:MainThread](2026-01-11 22:58:33,578) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 1980]: train_loss 0.991009, valid_loss 0.996144, train_metric nan, valid_metric 0.044130
[1412324:MainThread](2026-01-11 22:58:33,886) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2000]: train_loss 0.994311, valid_loss 0.996449, train_metric nan, valid_metric 0.044021
[1412324:MainThread](2026-01-11 22:58:34,284) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2020]: train_loss 0.994377, valid_loss 0.996813, train_metric nan, valid_metric 0.040980
[1412324:MainThread](2026-01-11 22:58:34,673) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2040]: train_loss 0.992938, valid_loss 0.996300, train_metric nan, valid_metric 0.043719
[1412324:MainThread](2026-01-11 22:58:35,065) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2060]: train_loss 0.993009, valid_loss 0.996372, train_metric nan, valid_metric 0.042743
[1412324:MainThread](2026-01-11 22:58:35,493) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2080]: train_loss 0.993631, valid_loss 0.996365, train_metric nan, valid_metric 0.043408
[1412324:MainThread](2026-01-11 22:58:35,942) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2100]: train_loss 0.994646, valid_loss 0.996218, train_metric nan, valid_metric 0.044281
[1412324:MainThread](2026-01-11 22:58:36,364) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2120]: train_loss 0.991018, valid_loss 0.996362, train_metric nan, valid_metric 0.042839
[1412324:MainThread](2026-01-11 22:58:36,795) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2140]: train_loss 0.994569, valid_loss 0.996397, train_metric nan, valid_metric 0.043663
[1412324:MainThread](2026-01-11 22:58:37,182) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2160]: train_loss 0.991712, valid_loss 0.996435, train_metric nan, valid_metric 0.042946
[1412324:MainThread](2026-01-11 22:58:37,587) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2180]: train_loss 0.998140, valid_loss 0.996458, train_metric nan, valid_metric 0.043635
[1412324:MainThread](2026-01-11 22:58:37,993) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2200]: train_loss 0.993776, valid_loss 0.996412, train_metric nan, valid_metric 0.042511
[1412324:MainThread](2026-01-11 22:58:38,441) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2220]: train_loss 0.994274, valid_loss 0.996280, train_metric nan, valid_metric 0.043937
[1412324:MainThread](2026-01-11 22:58:38,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2240]: train_loss 0.992300, valid_loss 0.996372, train_metric nan, valid_metric 0.042230
[1412324:MainThread](2026-01-11 22:58:39,279) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2260]: train_loss 0.998440, valid_loss 0.996451, train_metric nan, valid_metric 0.042100
[1412324:MainThread](2026-01-11 22:58:39,742) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2280]: train_loss 0.990488, valid_loss 0.996417, train_metric nan, valid_metric 0.042232
[1412324:MainThread](2026-01-11 22:58:40,197) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2300]: train_loss 0.991052, valid_loss 0.996463, train_metric nan, valid_metric 0.042497
[1412324:MainThread](2026-01-11 22:58:40,610) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2320]: train_loss 0.997585, valid_loss 0.996577, train_metric nan, valid_metric 0.041938
[1412324:MainThread](2026-01-11 22:58:41,002) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2340]: train_loss 0.994822, valid_loss 0.996423, train_metric nan, valid_metric 0.042891
[1412324:MainThread](2026-01-11 22:58:41,428) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2360]: train_loss 0.996522, valid_loss 0.996345, train_metric nan, valid_metric 0.043477
[1412324:MainThread](2026-01-11 22:58:41,831) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2380]: train_loss 0.998567, valid_loss 0.996421, train_metric nan, valid_metric 0.041931
[1412324:MainThread](2026-01-11 22:58:42,232) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2400]: train_loss 0.996965, valid_loss 0.996321, train_metric nan, valid_metric 0.043441
[1412324:MainThread](2026-01-11 22:58:42,696) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2420]: train_loss 0.989868, valid_loss 0.996257, train_metric nan, valid_metric 0.043624
[1412324:MainThread](2026-01-11 22:58:43,107) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2440]: train_loss 0.993615, valid_loss 0.996283, train_metric nan, valid_metric 0.043280
[1412324:MainThread](2026-01-11 22:58:43,507) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2460]: train_loss 0.988364, valid_loss 0.996270, train_metric nan, valid_metric 0.042874
[1412324:MainThread](2026-01-11 22:58:43,951) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2480]: train_loss 0.989661, valid_loss 0.996372, train_metric nan, valid_metric 0.042428
[1412324:MainThread](2026-01-11 22:58:44,417) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2500]: train_loss 1.001035, valid_loss 0.996427, train_metric nan, valid_metric 0.042521
[1412324:MainThread](2026-01-11 22:58:44,834) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2520]: train_loss 1.001802, valid_loss 0.996382, train_metric nan, valid_metric 0.042763
[1412324:MainThread](2026-01-11 22:58:45,255) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2540]: train_loss 0.987461, valid_loss 0.996414, train_metric nan, valid_metric 0.042522
[1412324:MainThread](2026-01-11 22:58:45,670) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2560]: train_loss 0.996757, valid_loss 0.996345, train_metric nan, valid_metric 0.042888
[1412324:MainThread](2026-01-11 22:58:46,111) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2580]: train_loss 0.992695, valid_loss 0.996399, train_metric nan, valid_metric 0.042364
[1412324:MainThread](2026-01-11 22:58:46,529) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2600]: train_loss 0.993624, valid_loss 0.996313, train_metric nan, valid_metric 0.043190
[1412324:MainThread](2026-01-11 22:58:46,966) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2620]: train_loss 0.997779, valid_loss 0.996344, train_metric nan, valid_metric 0.043099
[1412324:MainThread](2026-01-11 22:58:47,407) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2640]: train_loss 0.996365, valid_loss 0.996324, train_metric nan, valid_metric 0.042824
[1412324:MainThread](2026-01-11 22:58:47,801) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2660]: train_loss 0.991125, valid_loss 0.996312, train_metric nan, valid_metric 0.042599
[1412324:MainThread](2026-01-11 22:58:48,214) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2680]: train_loss 0.993486, valid_loss 0.996284, train_metric nan, valid_metric 0.043088
[1412324:MainThread](2026-01-11 22:58:48,626) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2700]: train_loss 0.985542, valid_loss 0.996349, train_metric nan, valid_metric 0.042789
[1412324:MainThread](2026-01-11 22:58:49,042) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2720]: train_loss 0.999578, valid_loss 0.996403, train_metric nan, valid_metric 0.042685
[1412324:MainThread](2026-01-11 22:58:49,461) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2740]: train_loss 0.993669, valid_loss 0.996423, train_metric nan, valid_metric 0.042333
[1412324:MainThread](2026-01-11 22:58:49,867) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2760]: train_loss 0.991491, valid_loss 0.996438, train_metric nan, valid_metric 0.042277
[1412324:MainThread](2026-01-11 22:58:50,272) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2780]: train_loss 0.987261, valid_loss 0.996479, train_metric nan, valid_metric 0.042395
[1412324:MainThread](2026-01-11 22:58:50,685) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:304] - [Step 2800]: train_loss 0.987482, valid_loss 0.996540, train_metric nan, valid_metric 0.042109
[1412324:MainThread](2026-01-11 22:58:50,688) INFO - qlib.DNNModelPytorch - [pytorch_nn.py:243] - 	early stop
2026-01-11 22:58:50.716 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 22:58:53.881 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 22:58:53.881 | INFO     | __main__:train_single_fold:593 -   IC=0.0315, ICIR=0.1859, RankIC=0.0556, RankICIR=0.3147
2026-01-11 22:58:53.881 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1412324:MainThread](2026-01-11 22:58:53,889) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 22:59:37,004) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:59:37,005) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 22:59:46,834) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77837990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.99it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 51.22it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 61.85it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 68.33it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 73.59it/s]backtest loop:  20%|█▉        | 48/242 [00:00<00:02, 76.51it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 78.24it/s]backtest loop:  27%|██▋       | 66/242 [00:00<00:02, 77.87it/s]backtest loop:  31%|███▏      | 76/242 [00:01<00:02, 79.30it/s]backtest loop:  35%|███▍      | 84/242 [00:01<00:02, 77.95it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 78.06it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 78.71it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 78.56it/s]backtest loop:  50%|█████     | 122/242 [00:01<00:01, 78.96it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 79.22it/s]backtest loop:  58%|█████▊    | 141/242 [00:01<00:01, 81.99it/s]backtest loop:  62%|██████▏   | 150/242 [00:01<00:01, 80.61it/s]backtest loop:  66%|██████▌   | 159/242 [00:02<00:01, 79.28it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 77.56it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 76.65it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 76.87it/s]backtest loop:  79%|███████▉  | 191/242 [00:02<00:00, 76.81it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 77.26it/s]backtest loop:  86%|████████▋ | 209/242 [00:02<00:00, 79.85it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 78.60it/s]backtest loop:  93%|█████████▎| 225/242 [00:02<00:00, 77.31it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 78.40it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 76.13it/s]
2026-01-11 22:59:50.036 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0269, Sharpe(w/cost)=0.2590, MaxDD=-0.1644
2026-01-11 22:59:53.962 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 23:00:14.403 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 23:00:14.486 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/fold_8_pred.parquet
2026-01-11 23:00:14.504 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 23:00:14.505 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 23:00:17.583 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0341
2026-01-11 23:00:20.525 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0381
2026-01-11 23:00:24.398 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0302
2026-01-11 23:00:26.787 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0300
2026-01-11 23:00:29.586 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0370
2026-01-11 23:00:31.978 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0422
2026-01-11 23:00:34.808 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0486
2026-01-11 23:00:37.226 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0458
2026-01-11 23:00:37.634 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0329, ICIR=0.1939, RankIC=0.0573
[1412324:MainThread](2026-01-11 23:00:37,640) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1412324:MainThread](2026-01-11 23:01:19,800) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 23:01:19,801) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 23:01:29,450) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a77432a90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:10, 22.16it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:04, 49.85it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.52it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:03, 68.30it/s]backtest loop:  16%|█▌        | 38/242 [00:00<00:02, 73.15it/s]backtest loop:  19%|█▉        | 47/242 [00:00<00:02, 77.84it/s]backtest loop:  23%|██▎       | 55/242 [00:00<00:02, 77.59it/s]backtest loop:  26%|██▌       | 63/242 [00:00<00:02, 77.60it/s]backtest loop:  29%|██▉       | 71/242 [00:00<00:02, 77.30it/s]backtest loop:  33%|███▎      | 79/242 [00:01<00:02, 77.05it/s]backtest loop:  36%|███▋      | 88/242 [00:01<00:01, 77.48it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 78.80it/s]backtest loop:  44%|████▍     | 107/242 [00:01<00:01, 78.92it/s]backtest loop:  48%|████▊     | 117/242 [00:01<00:01, 79.76it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 80.27it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:01, 80.59it/s]backtest loop:  61%|██████    | 147/242 [00:01<00:01, 80.80it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 80.96it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 80.95it/s]backtest loop:  73%|███████▎  | 176/242 [00:02<00:00, 80.63it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 77.62it/s]backtest loop:  81%|████████  | 195/242 [00:02<00:00, 78.99it/s]backtest loop:  85%|████████▍ | 205/242 [00:02<00:00, 79.09it/s]backtest loop:  89%|████████▉ | 215/242 [00:02<00:00, 79.91it/s]backtest loop:  93%|█████████▎| 225/242 [00:02<00:00, 80.62it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 81.26it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 77.11it/s]
2026-01-11 23:01:32.612 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1133, Sharpe(w/cost)=1.1599
2026-01-11 23:01:32.703 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 23:01:32.703 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 23:01:32.703 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 23:01:32.711 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 23:01:32.711 | INFO     | __main__:_print_summary:827 -   IC: 0.0255
2026-01-11 23:01:32.711 | INFO     | __main__:_print_summary:828 -   ICIR: 0.2003
2026-01-11 23:01:32.711 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0454
2026-01-11 23:01:32.712 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0588
2026-01-11 23:01:32.712 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.6550
2026-01-11 23:01:32.712 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0430
2026-01-11 23:01:32.715 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/summary.csv
2026-01-11 23:01:32.715 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 23:01:32.715 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 23:01:32.715 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 23:01:32.715 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 23:01:32.719 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 23:01:32.719 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0454
2026-01-11 23:01:32.719 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0358
2026-01-11 23:01:32.719 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0358)
2026-01-11 23:01:32.719 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 23:01:32.720 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/ensemble_matrix.csv
2026-01-11 23:01:32.720 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 23:01:32.720 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 23:01:32.720 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 23:01:32.850 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 23:01:32.850 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 23:01:34.777 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0255, ICIR=0.1971, RankIC=0.0454
[1412324:MainThread](2026-01-11 23:01:34,788) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.068594 0.571449 0.088236  0.333679  3.308170 -0.029201         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.044508 0.316668 0.063959 -0.033832 -0.631112 -0.077912    0.064042    1.103936
    2 2018-01-01 ~ 2018-12-31 0.025904 0.235288 0.038124  0.070186  0.992374 -0.055746    0.041582    0.488083
    3 2019-01-01 ~ 2019-12-31 0.018280 0.168583 0.026928 -0.039536 -0.566889 -0.087273    0.032924   -0.934742
    4 2020-01-01 ~ 2020-12-31 0.006257 0.043164 0.032990 -0.103144 -1.080296 -0.151146    0.034685    0.024131
    5 2021-01-01 ~ 2021-12-31 0.002916 0.031653 0.025822  0.059737  0.724212 -0.083016    0.028995    0.392369
    6 2022-01-01 ~ 2022-12-31 0.019578 0.158699 0.042362  0.117193  1.378553 -0.092857    0.045384    1.585973
    7 2023-01-01 ~ 2023-12-31 0.011700 0.091388 0.034194  0.098261  1.511184 -0.048888    0.039250    1.272029
    8 2024-01-01 ~ 2024-12-31 0.031529 0.185943 0.055554  0.026852  0.258995 -0.164385    0.057317    1.159857

        M0      M1      M2      M3      M4      M5      M6      M7      M8
T0  0.0882     NaN     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T1  0.0585  0.0640     NaN     NaN     NaN     NaN     NaN     NaN     NaN
T2  0.0344  0.0435  0.0381     NaN     NaN     NaN     NaN     NaN     NaN
T3  0.0311  0.0402  0.0385  0.0269     NaN     NaN     NaN     NaN     NaN
T4  0.0280  0.0341  0.0367  0.0296  0.0330     NaN     NaN     NaN     NaN
T5  0.0248  0.0288  0.0291  0.0248  0.0270  0.0258     NaN     NaN     NaN
T6  0.0436  0.0445  0.0406  0.0404  0.0341  0.0321  0.0424     NaN     NaN
T7  0.0312  0.0332  0.0290  0.0293  0.0304  0.0412  0.0451  0.0342     NaN
T8  0.0341  0.0381  0.0302  0.0300  0.0370  0.0422  0.0486  0.0458  0.0556
[1412324:MainThread](2026-01-11 23:02:22,852) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 23:02:22,858) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1412324:MainThread](2026-01-11 23:03:21,300) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1a7716ce10>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 3/2187 [00:00<01:32, 23.62it/s]backtest loop:   1%|          | 11/2187 [00:00<00:41, 52.18it/s]backtest loop:   1%|          | 20/2187 [00:00<00:33, 64.98it/s]backtest loop:   1%|▏         | 30/2187 [00:00<00:29, 73.86it/s]backtest loop:   2%|▏         | 40/2187 [00:00<00:27, 78.38it/s]backtest loop:   2%|▏         | 50/2187 [00:00<00:26, 80.00it/s]backtest loop:   3%|▎         | 60/2187 [00:00<00:26, 81.32it/s]backtest loop:   3%|▎         | 69/2187 [00:00<00:26, 80.73it/s]backtest loop:   4%|▎         | 79/2187 [00:01<00:26, 79.99it/s]backtest loop:   4%|▍         | 88/2187 [00:01<00:26, 78.76it/s]backtest loop:   4%|▍         | 98/2187 [00:01<00:26, 79.95it/s]backtest loop:   5%|▍         | 106/2187 [00:01<00:26, 79.65it/s]backtest loop:   5%|▌         | 116/2187 [00:01<00:25, 81.34it/s]backtest loop:   6%|▌         | 126/2187 [00:01<00:25, 81.67it/s]backtest loop:   6%|▌         | 136/2187 [00:01<00:24, 82.53it/s]backtest loop:   7%|▋         | 146/2187 [00:01<00:24, 82.80it/s]backtest loop:   7%|▋         | 156/2187 [00:02<00:24, 81.33it/s]backtest loop:   8%|▊         | 165/2187 [00:02<00:24, 83.41it/s]backtest loop:   8%|▊         | 174/2187 [00:02<00:26, 77.07it/s]backtest loop:   8%|▊         | 184/2187 [00:02<00:25, 78.18it/s]backtest loop:   9%|▉         | 194/2187 [00:02<00:25, 78.87it/s]backtest loop:   9%|▉         | 204/2187 [00:02<00:25, 79.20it/s]backtest loop:  10%|▉         | 214/2187 [00:02<00:24, 80.11it/s]backtest loop:  10%|█         | 224/2187 [00:02<00:24, 80.31it/s]backtest loop:  11%|█         | 234/2187 [00:02<00:24, 80.11it/s]backtest loop:  11%|█         | 243/2187 [00:03<00:23, 81.69it/s]backtest loop:  12%|█▏        | 252/2187 [00:03<00:24, 79.99it/s]backtest loop:  12%|█▏        | 261/2187 [00:03<00:24, 80.17it/s]backtest loop:  12%|█▏        | 270/2187 [00:03<00:25, 76.41it/s]backtest loop:  13%|█▎        | 278/2187 [00:03<00:24, 76.65it/s]backtest loop:  13%|█▎        | 288/2187 [00:03<00:24, 77.22it/s]backtest loop:  14%|█▎        | 298/2187 [00:03<00:23, 79.84it/s]backtest loop:  14%|█▍        | 307/2187 [00:03<00:23, 81.35it/s]backtest loop:  14%|█▍        | 316/2187 [00:04<00:22, 81.51it/s]backtest loop:  15%|█▍        | 325/2187 [00:04<00:23, 79.40it/s]backtest loop:  15%|█▌        | 335/2187 [00:04<00:22, 81.05it/s]backtest loop:  16%|█▌        | 344/2187 [00:04<00:22, 81.53it/s]backtest loop:  16%|█▌        | 353/2187 [00:04<00:22, 80.90it/s]backtest loop:  17%|█▋        | 363/2187 [00:04<00:22, 82.57it/s]backtest loop:  17%|█▋        | 373/2187 [00:04<00:21, 83.10it/s]backtest loop:  18%|█▊        | 383/2187 [00:04<00:21, 82.03it/s]backtest loop:  18%|█▊        | 393/2187 [00:04<00:21, 83.20it/s]backtest loop:  18%|█▊        | 403/2187 [00:05<00:21, 82.75it/s]backtest loop:  19%|█▉        | 413/2187 [00:05<00:21, 82.97it/s]backtest loop:  19%|█▉        | 422/2187 [00:05<00:20, 84.54it/s]backtest loop:  20%|█▉        | 431/2187 [00:05<00:21, 83.08it/s]backtest loop:  20%|██        | 440/2187 [00:05<00:21, 81.89it/s]backtest loop:  21%|██        | 449/2187 [00:05<00:21, 80.00it/s]backtest loop:  21%|██        | 458/2187 [00:05<00:21, 78.96it/s]backtest loop:  21%|██▏       | 468/2187 [00:05<00:21, 79.09it/s]backtest loop:  22%|██▏       | 478/2187 [00:06<00:21, 79.87it/s]backtest loop:  22%|██▏       | 488/2187 [00:06<00:20, 81.40it/s]backtest loop:  23%|██▎       | 497/2187 [00:06<00:20, 80.64it/s]backtest loop:  23%|██▎       | 507/2187 [00:06<00:20, 80.82it/s]backtest loop:  24%|██▎       | 517/2187 [00:06<00:20, 81.65it/s]backtest loop:  24%|██▍       | 526/2187 [00:06<00:20, 81.19it/s]backtest loop:  24%|██▍       | 535/2187 [00:06<00:20, 80.01it/s]backtest loop:  25%|██▍       | 543/2187 [00:06<00:21, 78.16it/s]backtest loop:  25%|██▌       | 551/2187 [00:06<00:21, 75.31it/s]backtest loop:  26%|██▌       | 560/2187 [00:07<00:22, 73.51it/s]backtest loop:  26%|██▌       | 568/2187 [00:07<00:22, 72.60it/s]backtest loop:  26%|██▋       | 578/2187 [00:07<00:21, 74.16it/s]backtest loop:  27%|██▋       | 587/2187 [00:07<00:20, 77.82it/s]backtest loop:  27%|██▋       | 595/2187 [00:07<00:20, 75.89it/s]backtest loop:  28%|██▊       | 603/2187 [00:07<00:21, 74.36it/s]backtest loop:  28%|██▊       | 612/2187 [00:07<00:21, 74.29it/s]backtest loop:  28%|██▊       | 621/2187 [00:07<00:19, 78.51it/s]backtest loop:  29%|██▉       | 629/2187 [00:07<00:20, 76.46it/s]backtest loop:  29%|██▉       | 637/2187 [00:08<00:20, 75.58it/s]backtest loop:  30%|██▉       | 646/2187 [00:08<00:19, 79.58it/s]backtest loop:  30%|██▉       | 655/2187 [00:08<00:19, 77.41it/s]backtest loop:  30%|███       | 663/2187 [00:08<00:20, 75.28it/s]backtest loop:  31%|███       | 671/2187 [00:08<00:20, 73.59it/s]backtest loop:  31%|███       | 680/2187 [00:08<00:19, 78.05it/s]backtest loop:  31%|███▏      | 688/2187 [00:08<00:19, 75.31it/s]backtest loop:  32%|███▏      | 696/2187 [00:08<00:20, 72.63it/s]backtest loop:  32%|███▏      | 705/2187 [00:08<00:19, 76.69it/s]backtest loop:  33%|███▎      | 713/2187 [00:09<00:19, 74.27it/s]backtest loop:  33%|███▎      | 721/2187 [00:09<00:20, 72.89it/s]backtest loop:  33%|███▎      | 730/2187 [00:09<00:18, 77.12it/s]backtest loop:  34%|███▎      | 738/2187 [00:09<00:19, 74.95it/s]backtest loop:  34%|███▍      | 746/2187 [00:09<00:19, 73.59it/s]backtest loop:  34%|███▍      | 754/2187 [00:09<00:19, 72.54it/s]backtest loop:  35%|███▍      | 763/2187 [00:09<00:18, 76.80it/s]backtest loop:  35%|███▌      | 771/2187 [00:09<00:18, 74.82it/s]backtest loop:  36%|███▌      | 779/2187 [00:09<00:19, 73.48it/s]backtest loop:  36%|███▌      | 788/2187 [00:10<00:18, 77.68it/s]backtest loop:  36%|███▋      | 796/2187 [00:10<00:18, 75.65it/s]backtest loop:  37%|███▋      | 804/2187 [00:10<00:18, 74.31it/s]backtest loop:  37%|███▋      | 812/2187 [00:10<00:18, 73.48it/s]backtest loop:  37%|███▋      | 820/2187 [00:10<00:18, 72.29it/s]backtest loop:  38%|███▊      | 829/2187 [00:10<00:17, 76.80it/s]backtest loop:  38%|███▊      | 837/2187 [00:10<00:18, 74.93it/s]backtest loop:  39%|███▊      | 845/2187 [00:10<00:18, 73.14it/s]backtest loop:  39%|███▉      | 854/2187 [00:10<00:18, 73.39it/s]backtest loop:  39%|███▉      | 863/2187 [00:11<00:17, 76.48it/s]backtest loop:  40%|███▉      | 871/2187 [00:11<00:17, 74.47it/s]backtest loop:  40%|████      | 879/2187 [00:11<00:17, 72.99it/s]backtest loop:  41%|████      | 888/2187 [00:11<00:16, 77.47it/s]backtest loop:  41%|████      | 896/2187 [00:11<00:17, 75.30it/s]backtest loop:  41%|████▏     | 904/2187 [00:11<00:17, 73.77it/s]backtest loop:  42%|████▏     | 913/2187 [00:11<00:17, 73.45it/s]backtest loop:  42%|████▏     | 921/2187 [00:11<00:17, 72.84it/s]backtest loop:  42%|████▏     | 929/2187 [00:11<00:17, 72.48it/s]backtest loop:  43%|████▎     | 938/2187 [00:12<00:17, 73.02it/s]backtest loop:  43%|████▎     | 947/2187 [00:12<00:16, 77.13it/s]backtest loop:  44%|████▎     | 955/2187 [00:12<00:16, 74.94it/s]backtest loop:  44%|████▍     | 963/2187 [00:12<00:16, 73.35it/s]backtest loop:  44%|████▍     | 972/2187 [00:12<00:15, 77.42it/s]backtest loop:  45%|████▍     | 980/2187 [00:12<00:16, 71.06it/s]backtest loop:  45%|████▌     | 988/2187 [00:12<00:16, 71.12it/s]backtest loop:  46%|████▌     | 996/2187 [00:12<00:16, 71.70it/s]backtest loop:  46%|████▌     | 1005/2187 [00:13<00:15, 76.03it/s]backtest loop:  46%|████▋     | 1013/2187 [00:13<00:15, 74.53it/s]backtest loop:  47%|████▋     | 1021/2187 [00:13<00:15, 73.23it/s]backtest loop:  47%|████▋     | 1030/2187 [00:13<00:14, 77.61it/s]backtest loop:  47%|████▋     | 1038/2187 [00:13<00:15, 75.08it/s]backtest loop:  48%|████▊     | 1046/2187 [00:13<00:15, 74.07it/s]backtest loop:  48%|████▊     | 1054/2187 [00:13<00:15, 72.04it/s]backtest loop:  49%|████▊     | 1062/2187 [00:13<00:15, 71.72it/s]backtest loop:  49%|████▉     | 1071/2187 [00:13<00:14, 76.20it/s]backtest loop:  49%|████▉     | 1080/2187 [00:13<00:13, 79.83it/s]backtest loop:  50%|████▉     | 1090/2187 [00:14<00:13, 80.40it/s]backtest loop:  50%|█████     | 1100/2187 [00:14<00:12, 84.48it/s]backtest loop:  51%|█████     | 1110/2187 [00:14<00:12, 87.04it/s]backtest loop:  51%|█████     | 1120/2187 [00:14<00:12, 88.81it/s]backtest loop:  52%|█████▏    | 1130/2187 [00:14<00:11, 90.17it/s]backtest loop:  52%|█████▏    | 1140/2187 [00:14<00:11, 91.51it/s]backtest loop:  53%|█████▎    | 1150/2187 [00:14<00:11, 91.91it/s]backtest loop:  53%|█████▎    | 1160/2187 [00:14<00:11, 88.21it/s]backtest loop:  53%|█████▎    | 1169/2187 [00:14<00:11, 88.52it/s]backtest loop:  54%|█████▍    | 1179/2187 [00:15<00:11, 86.24it/s]backtest loop:  54%|█████▍    | 1189/2187 [00:15<00:11, 84.05it/s]backtest loop:  55%|█████▍    | 1199/2187 [00:15<00:11, 82.46it/s]backtest loop:  55%|█████▌    | 1209/2187 [00:15<00:11, 82.01it/s]backtest loop:  56%|█████▌    | 1218/2187 [00:15<00:12, 80.17it/s]backtest loop:  56%|█████▌    | 1228/2187 [00:15<00:11, 80.31it/s]backtest loop:  57%|█████▋    | 1238/2187 [00:15<00:11, 79.99it/s]backtest loop:  57%|█████▋    | 1247/2187 [00:15<00:11, 78.53it/s]backtest loop:  57%|█████▋    | 1255/2187 [00:16<00:12, 75.74it/s]backtest loop:  58%|█████▊    | 1263/2187 [00:16<00:12, 74.83it/s]backtest loop:  58%|█████▊    | 1273/2187 [00:16<00:12, 75.98it/s]backtest loop:  59%|█████▊    | 1282/2187 [00:16<00:11, 75.74it/s]backtest loop:  59%|█████▉    | 1291/2187 [00:16<00:11, 79.14it/s]backtest loop:  59%|█████▉    | 1299/2187 [00:16<00:12, 73.26it/s]backtest loop:  60%|█████▉    | 1308/2187 [00:16<00:11, 76.97it/s]backtest loop:  60%|██████    | 1316/2187 [00:16<00:11, 75.55it/s]backtest loop:  61%|██████    | 1324/2187 [00:16<00:11, 74.38it/s]backtest loop:  61%|██████    | 1333/2187 [00:17<00:11, 74.71it/s]backtest loop:  61%|██████▏   | 1343/2187 [00:17<00:10, 76.79it/s]backtest loop:  62%|██████▏   | 1353/2187 [00:17<00:10, 77.38it/s]backtest loop:  62%|██████▏   | 1363/2187 [00:17<00:10, 77.95it/s]backtest loop:  63%|██████▎   | 1372/2187 [00:17<00:10, 80.60it/s]backtest loop:  63%|██████▎   | 1381/2187 [00:17<00:10, 78.80it/s]backtest loop:  64%|██████▎   | 1389/2187 [00:17<00:10, 77.07it/s]backtest loop:  64%|██████▍   | 1397/2187 [00:17<00:10, 75.93it/s]backtest loop:  64%|██████▍   | 1405/2187 [00:18<00:10, 75.14it/s]backtest loop:  65%|██████▍   | 1413/2187 [00:18<00:10, 73.12it/s]backtest loop:  65%|██████▍   | 1421/2187 [00:18<00:10, 71.97it/s]backtest loop:  65%|██████▌   | 1431/2187 [00:18<00:10, 74.22it/s]backtest loop:  66%|██████▌   | 1441/2187 [00:18<00:09, 75.64it/s]backtest loop:  66%|██████▋   | 1451/2187 [00:18<00:09, 76.37it/s]backtest loop:  67%|██████▋   | 1461/2187 [00:18<00:09, 76.73it/s]backtest loop:  67%|██████▋   | 1470/2187 [00:18<00:09, 76.69it/s]backtest loop:  68%|██████▊   | 1480/2187 [00:19<00:09, 77.56it/s]backtest loop:  68%|██████▊   | 1490/2187 [00:19<00:08, 78.08it/s]backtest loop:  69%|██████▊   | 1499/2187 [00:19<00:08, 81.09it/s]backtest loop:  69%|██████▉   | 1508/2187 [00:19<00:08, 79.48it/s]backtest loop:  69%|██████▉   | 1516/2187 [00:19<00:08, 78.64it/s]backtest loop:  70%|██████▉   | 1524/2187 [00:19<00:08, 76.41it/s]backtest loop:  70%|███████   | 1533/2187 [00:19<00:08, 76.44it/s]backtest loop:  70%|███████   | 1541/2187 [00:19<00:08, 75.80it/s]backtest loop:  71%|███████   | 1550/2187 [00:19<00:08, 75.95it/s]backtest loop:  71%|███████▏  | 1559/2187 [00:20<00:08, 76.40it/s]backtest loop:  72%|███████▏  | 1569/2187 [00:20<00:08, 76.64it/s]backtest loop:  72%|███████▏  | 1579/2187 [00:20<00:07, 76.99it/s]backtest loop:  73%|███████▎  | 1588/2187 [00:20<00:07, 80.29it/s]backtest loop:  73%|███████▎  | 1597/2187 [00:20<00:07, 76.24it/s]backtest loop:  73%|███████▎  | 1605/2187 [00:20<00:07, 75.15it/s]backtest loop:  74%|███████▍  | 1614/2187 [00:20<00:07, 75.75it/s]backtest loop:  74%|███████▍  | 1624/2187 [00:20<00:07, 76.62it/s]backtest loop:  75%|███████▍  | 1633/2187 [00:21<00:07, 76.11it/s]backtest loop:  75%|███████▌  | 1642/2187 [00:21<00:06, 79.29it/s]backtest loop:  75%|███████▌  | 1650/2187 [00:21<00:06, 77.33it/s]backtest loop:  76%|███████▌  | 1658/2187 [00:21<00:06, 76.11it/s]backtest loop:  76%|███████▋  | 1668/2187 [00:21<00:06, 77.19it/s]backtest loop:  77%|███████▋  | 1678/2187 [00:21<00:06, 77.53it/s]backtest loop:  77%|███████▋  | 1688/2187 [00:21<00:06, 77.79it/s]backtest loop:  78%|███████▊  | 1698/2187 [00:21<00:06, 78.21it/s]backtest loop:  78%|███████▊  | 1707/2187 [00:21<00:06, 77.62it/s]backtest loop:  79%|███████▊  | 1717/2187 [00:22<00:06, 76.81it/s]backtest loop:  79%|███████▉  | 1725/2187 [00:22<00:05, 77.42it/s]backtest loop:  79%|███████▉  | 1733/2187 [00:22<00:05, 75.92it/s]backtest loop:  80%|███████▉  | 1741/2187 [00:22<00:05, 76.87it/s]backtest loop:  80%|███████▉  | 1749/2187 [00:22<00:05, 75.64it/s]backtest loop:  80%|████████  | 1757/2187 [00:22<00:05, 75.15it/s]backtest loop:  81%|████████  | 1765/2187 [00:22<00:05, 73.65it/s]backtest loop:  81%|████████  | 1773/2187 [00:22<00:05, 73.20it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:22<00:05, 73.03it/s]backtest loop:  82%|████████▏ | 1789/2187 [00:23<00:05, 71.50it/s]backtest loop:  82%|████████▏ | 1798/2187 [00:23<00:05, 71.66it/s]backtest loop:  83%|████████▎ | 1808/2187 [00:23<00:05, 73.97it/s]backtest loop:  83%|████████▎ | 1816/2187 [00:23<00:05, 70.49it/s]backtest loop:  83%|████████▎ | 1825/2187 [00:23<00:04, 74.05it/s]backtest loop:  84%|████████▍ | 1833/2187 [00:23<00:04, 73.14it/s]backtest loop:  84%|████████▍ | 1841/2187 [00:23<00:04, 72.16it/s]backtest loop:  85%|████████▍ | 1850/2187 [00:23<00:04, 76.69it/s]backtest loop:  85%|████████▍ | 1858/2187 [00:24<00:04, 75.83it/s]backtest loop:  85%|████████▌ | 1866/2187 [00:24<00:04, 74.17it/s]backtest loop:  86%|████████▌ | 1876/2187 [00:24<00:04, 76.01it/s]backtest loop:  86%|████████▌ | 1884/2187 [00:24<00:03, 77.02it/s]backtest loop:  87%|████████▋ | 1892/2187 [00:24<00:03, 76.26it/s]backtest loop:  87%|████████▋ | 1900/2187 [00:24<00:03, 75.30it/s]backtest loop:  87%|████████▋ | 1909/2187 [00:24<00:03, 78.02it/s]backtest loop:  88%|████████▊ | 1917/2187 [00:24<00:03, 76.36it/s]backtest loop:  88%|████████▊ | 1925/2187 [00:24<00:03, 74.60it/s]backtest loop:  88%|████████▊ | 1935/2187 [00:25<00:03, 72.34it/s]backtest loop:  89%|████████▉ | 1943/2187 [00:25<00:03, 70.69it/s]backtest loop:  89%|████████▉ | 1951/2187 [00:26<00:15, 15.57it/s]backtest loop:  90%|████████▉ | 1959/2187 [00:26<00:11, 20.21it/s]backtest loop:  90%|████████▉ | 1968/2187 [00:26<00:08, 26.79it/s]backtest loop:  90%|█████████ | 1975/2187 [00:26<00:06, 31.83it/s]backtest loop:  91%|█████████ | 1983/2187 [00:27<00:05, 38.34it/s]backtest loop:  91%|█████████ | 1992/2187 [00:27<00:04, 46.86it/s]backtest loop:  91%|█████████▏| 2000/2187 [00:27<00:03, 51.89it/s]backtest loop:  92%|█████████▏| 2008/2187 [00:27<00:03, 56.18it/s]backtest loop:  92%|█████████▏| 2016/2187 [00:27<00:02, 60.19it/s]backtest loop:  93%|█████████▎| 2024/2187 [00:27<00:02, 63.17it/s]backtest loop:  93%|█████████▎| 2033/2187 [00:27<00:02, 66.80it/s]backtest loop:  93%|█████████▎| 2043/2187 [00:27<00:02, 70.36it/s]backtest loop:  94%|█████████▍| 2052/2187 [00:28<00:01, 71.86it/s]backtest loop:  94%|█████████▍| 2062/2187 [00:28<00:01, 74.00it/s]backtest loop:  95%|█████████▍| 2072/2187 [00:28<00:01, 75.17it/s]backtest loop:  95%|█████████▌| 2081/2187 [00:28<00:01, 78.62it/s]backtest loop:  96%|█████████▌| 2090/2187 [00:28<00:01, 77.73it/s]backtest loop:  96%|█████████▌| 2098/2187 [00:28<00:01, 76.06it/s]backtest loop:  96%|█████████▋| 2107/2187 [00:28<00:01, 76.14it/s]backtest loop:  97%|█████████▋| 2116/2187 [00:28<00:00, 79.32it/s]backtest loop:  97%|█████████▋| 2124/2187 [00:28<00:00, 77.55it/s]backtest loop:  97%|█████████▋| 2132/2187 [00:29<00:00, 73.42it/s]backtest loop:  98%|█████████▊| 2140/2187 [00:29<00:00, 73.39it/s]backtest loop:  98%|█████████▊| 2150/2187 [00:29<00:00, 74.95it/s]backtest loop:  99%|█████████▉| 2160/2187 [00:29<00:00, 76.40it/s]backtest loop:  99%|█████████▉| 2170/2187 [00:29<00:00, 77.21it/s]backtest loop: 100%|█████████▉| 2180/2187 [00:29<00:00, 76.87it/s]backtest loop: 100%|██████████| 2187/2187 [00:29<00:00, 73.46it/s]
2026-01-11 23:03:51.177 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 23:03:51.177 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0671
2026-01-11 23:03:51.177 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.8186
2026-01-11 23:03:51.177 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2299
2026-01-11 23:03:56.909 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pdf/full_backtest_report.pdf
2026-01-11 23:04:17.483 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 23:04:17.759 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_222030_mlp_360_robust_6y/pred/full_pred.parquet
[1412324:MainThread](2026-01-11 23:04:18,994) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
