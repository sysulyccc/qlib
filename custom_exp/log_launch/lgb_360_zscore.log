Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1303276:MainThread](2026-01-11 20:52:29,110) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1303276:MainThread](2026-01-11 20:52:29,663) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1303276:MainThread](2026-01-11 20:52:29,663) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 20:52:29.673 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y
2026-01-11 20:52:29.673 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/log/lgb_360_zscore_csi500_topk_20260111_205229.log
2026-01-11 20:52:29.673 | INFO     | __main__:__init__:115 - Model name: lgb_360_zscore_csi500_topk
2026-01-11 20:52:29.676 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 20:52:29.676 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:52:29.676 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 20:52:29.676 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:52:29.676 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 20:53:04,376) INFO - qlib.timer - [log.py:127] - Time cost: 34.698s | Loading data Done
[1303276:MainThread](2026-01-11 20:53:07,510) INFO - qlib.timer - [log.py:127] - Time cost: 2.581s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 20:53:09,459) INFO - qlib.timer - [log.py:127] - Time cost: 1.947s | Fillna Done
[1303276:MainThread](2026-01-11 20:53:11,550) INFO - qlib.timer - [log.py:127] - Time cost: 0.331s | DropnaLabel Done
[1303276:MainThread](2026-01-11 20:53:11,779) INFO - qlib.timer - [log.py:127] - Time cost: 0.229s | CSRankNorm Done
[1303276:MainThread](2026-01-11 20:53:11,782) INFO - qlib.timer - [log.py:127] - Time cost: 7.405s | fit & process data Done
[1303276:MainThread](2026-01-11 20:53:11,782) INFO - qlib.timer - [log.py:127] - Time cost: 42.105s | Init data Done
2026-01-11 20:53:11.783 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:53:12.043 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
[1303276:MainThread](2026-01-11 20:55:41,802) INFO - qlib.workflow - [exp.py:258] - Experiment 528155627018642494 starts running ...
[1303276:MainThread](2026-01-11 20:55:41,862) INFO - qlib.workflow - [recorder.py:345] - Recorder bd1651d8052048768d9d0cf65b051575 starts running under Experiment 528155627018642494 ...
2026-01-11 20:55:41.927 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:55:44.278 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 20:55:44.278 | INFO     | __main__:train_single_fold:593 -   IC=0.0741, ICIR=0.6221, RankIC=0.0957, RankICIR=0.8388
2026-01-11 20:55:44.278 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 20:55:44,286) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.983291	valid's l2: 0.990988
[40]	train's l2: 0.977445	valid's l2: 0.991168
[60]	train's l2: 0.972805	valid's l2: 0.992058
Early stopping, best iteration is:
[25]	train's l2: 0.981597	valid's l2: 0.990881
[1303276:MainThread](2026-01-11 20:56:22,344) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 20:56:22,345) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 20:56:27,722) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2cc58ed450>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   4%|▍         | 10/244 [00:00<00:02, 84.61it/s]backtest loop:   8%|▊         | 20/244 [00:00<00:02, 85.58it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:02, 84.68it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 86.71it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 88.66it/s]backtest loop:  25%|██▍       | 60/244 [00:00<00:02, 89.63it/s]backtest loop:  28%|██▊       | 69/244 [00:00<00:01, 88.88it/s]backtest loop:  32%|███▏      | 79/244 [00:00<00:01, 91.20it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 90.33it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 91.06it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 90.17it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 89.56it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 83.55it/s]backtest loop:  56%|█████▌    | 137/244 [00:01<00:01, 84.69it/s]backtest loop:  60%|█████▉    | 146/244 [00:01<00:01, 85.29it/s]backtest loop:  64%|██████▍   | 156/244 [00:01<00:01, 85.89it/s]backtest loop:  68%|██████▊   | 166/244 [00:01<00:00, 86.93it/s]backtest loop:  72%|███████▏  | 175/244 [00:01<00:00, 87.14it/s]backtest loop:  75%|███████▌  | 184/244 [00:02<00:00, 87.42it/s]backtest loop:  80%|███████▉  | 194/244 [00:02<00:00, 88.23it/s]backtest loop:  84%|████████▎ | 204/244 [00:02<00:00, 88.41it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 88.79it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 90.79it/s]backtest loop:  96%|█████████▋| 235/244 [00:02<00:00, 95.14it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 89.22it/s]
2026-01-11 20:56:30.477 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1872, Sharpe(w/cost)=1.7931, MaxDD=-0.0330
2026-01-11 20:56:34.228 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 20:56:57.605 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 20:56:57.697 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_0_pred.parquet
2026-01-11 20:56:57.733 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 20:56:57.734 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 20:56:57.734 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 20:56:57.734 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 20:58:42,341) INFO - qlib.timer - [log.py:127] - Time cost: 104.605s | Loading data Done
[1303276:MainThread](2026-01-11 20:58:47,621) INFO - qlib.timer - [log.py:127] - Time cost: 4.715s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 20:58:49,101) INFO - qlib.timer - [log.py:127] - Time cost: 1.479s | Fillna Done
[1303276:MainThread](2026-01-11 20:58:50,720) INFO - qlib.timer - [log.py:127] - Time cost: 0.226s | DropnaLabel Done
[1303276:MainThread](2026-01-11 20:58:50,939) INFO - qlib.timer - [log.py:127] - Time cost: 0.218s | CSRankNorm Done
[1303276:MainThread](2026-01-11 20:58:50,943) INFO - qlib.timer - [log.py:127] - Time cost: 8.601s | fit & process data Done
[1303276:MainThread](2026-01-11 20:58:50,944) INFO - qlib.timer - [log.py:127] - Time cost: 113.209s | Init data Done
2026-01-11 20:58:50.944 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 20:58:50.945 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 20:59:32.365 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 20:59:35.828 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 20:59:35.828 | INFO     | __main__:train_single_fold:593 -   IC=0.0463, ICIR=0.3302, RankIC=0.0669, RankICIR=0.6370
2026-01-11 20:59:35.828 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 20:59:35,844) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.984516	valid's l2: 0.990393
[40]	train's l2: 0.978757	valid's l2: 0.990476
[60]	train's l2: 0.974242	valid's l2: 0.991197
Early stopping, best iteration is:
[26]	train's l2: 0.982507	valid's l2: 0.990138
[1303276:MainThread](2026-01-11 21:00:32,452) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:00:32,453) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:00:38,640) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5b2a1d90>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 28.93it/s]backtest loop:   5%|▍         | 11/244 [00:00<00:04, 56.81it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:03, 60.80it/s]backtest loop:  12%|█▏        | 29/244 [00:00<00:03, 71.12it/s]backtest loop:  16%|█▌        | 39/244 [00:00<00:02, 77.31it/s]backtest loop:  20%|██        | 49/244 [00:00<00:02, 82.45it/s]backtest loop:  24%|██▍       | 59/244 [00:00<00:02, 86.67it/s]backtest loop:  28%|██▊       | 69/244 [00:00<00:01, 89.27it/s]backtest loop:  32%|███▏      | 79/244 [00:00<00:01, 91.06it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 92.14it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 88.95it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 89.42it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 89.90it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 89.52it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 89.94it/s]backtest loop:  61%|██████    | 149/244 [00:01<00:01, 88.82it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:00, 89.62it/s]backtest loop:  69%|██████▉   | 169/244 [00:01<00:00, 90.88it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:00, 90.95it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 91.13it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 90.74it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 92.79it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 93.23it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 93.47it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 94.77it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 87.76it/s]
2026-01-11 21:00:41.441 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1389, Sharpe(w/cost)=2.6105, MaxDD=-0.0396
2026-01-11 21:00:47.190 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 21:01:10.389 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:01:10.515 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_1_pred.parquet
2026-01-11 21:01:10.534 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 21:01:10.535 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 21:01:13.426 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0652
2026-01-11 21:01:13.757 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0488, ICIR=0.3506, RankIC=0.0681
[1303276:MainThread](2026-01-11 21:01:13,761) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:02:08,228) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:02:08,230) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:02:14,333) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2ac42572d0>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 35.72it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 64.23it/s]backtest loop:   9%|▉         | 23/244 [00:00<00:03, 73.02it/s]backtest loop:  13%|█▎        | 31/244 [00:00<00:02, 75.56it/s]backtest loop:  17%|█▋        | 41/244 [00:00<00:02, 82.12it/s]backtest loop:  20%|██        | 50/244 [00:00<00:02, 83.17it/s]backtest loop:  25%|██▍       | 60/244 [00:00<00:02, 86.32it/s]backtest loop:  29%|██▊       | 70/244 [00:00<00:01, 88.88it/s]backtest loop:  32%|███▏      | 79/244 [00:00<00:01, 88.16it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:01, 90.56it/s]backtest loop:  41%|████      | 99/244 [00:01<00:01, 87.55it/s]backtest loop:  45%|████▍     | 109/244 [00:01<00:01, 88.76it/s]backtest loop:  49%|████▉     | 119/244 [00:01<00:01, 90.83it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 88.91it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 87.66it/s]backtest loop:  61%|██████    | 149/244 [00:01<00:01, 86.85it/s]backtest loop:  65%|██████▌   | 159/244 [00:01<00:00, 85.57it/s]backtest loop:  69%|██████▉   | 169/244 [00:02<00:00, 84.72it/s]backtest loop:  73%|███████▎  | 179/244 [00:02<00:00, 85.14it/s]backtest loop:  77%|███████▋  | 189/244 [00:02<00:00, 85.19it/s]backtest loop:  82%|████████▏ | 199/244 [00:02<00:00, 85.96it/s]backtest loop:  86%|████████▌ | 209/244 [00:02<00:00, 86.82it/s]backtest loop:  90%|████████▉ | 219/244 [00:02<00:00, 88.80it/s]backtest loop:  94%|█████████▍| 229/244 [00:02<00:00, 90.83it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 91.97it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 86.28it/s]
2026-01-11 21:02:17.183 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0281, Sharpe(w/cost)=0.5241
2026-01-11 21:02:17.257 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:02:17.257 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 21:02:17.257 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:02:17.257 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:04:09,215) INFO - qlib.timer - [log.py:127] - Time cost: 111.955s | Loading data Done
[1303276:MainThread](2026-01-11 21:04:12,860) INFO - qlib.timer - [log.py:127] - Time cost: 3.088s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:04:14,014) INFO - qlib.timer - [log.py:127] - Time cost: 1.152s | Fillna Done
[1303276:MainThread](2026-01-11 21:04:14,888) INFO - qlib.timer - [log.py:127] - Time cost: 0.280s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:04:15,097) INFO - qlib.timer - [log.py:127] - Time cost: 0.208s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:04:15,100) INFO - qlib.timer - [log.py:127] - Time cost: 5.884s | fit & process data Done
[1303276:MainThread](2026-01-11 21:04:15,101) INFO - qlib.timer - [log.py:127] - Time cost: 117.842s | Init data Done
2026-01-11 21:04:15.101 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:04:15.102 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:06:04.893 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:06:07.391 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 21:06:07.391 | INFO     | __main__:train_single_fold:593 -   IC=0.0564, ICIR=0.5042, RankIC=0.0447, RankICIR=0.4645
2026-01-11 21:06:07.391 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:06:07,399) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.982901	valid's l2: 0.991773
[40]	train's l2: 0.976511	valid's l2: 0.990991
[60]	train's l2: 0.971638	valid's l2: 0.990696
[80]	train's l2: 0.967167	valid's l2: 0.990561
[100]	train's l2: 0.963049	valid's l2: 0.990596
[120]	train's l2: 0.95909	valid's l2: 0.990542
[140]	train's l2: 0.955105	valid's l2: 0.990537
[160]	train's l2: 0.951355	valid's l2: 0.990579
[180]	train's l2: 0.947688	valid's l2: 0.990616
Early stopping, best iteration is:
[139]	train's l2: 0.955306	valid's l2: 0.990532
[1303276:MainThread](2026-01-11 21:06:49,611) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:06:49,611) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:06:54,716) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5b697310>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/243 [00:00<00:05, 47.04it/s]backtest loop:   6%|▌         | 15/243 [00:00<00:03, 74.44it/s]backtest loop:  11%|█         | 26/243 [00:00<00:02, 89.17it/s]backtest loop:  14%|█▍        | 35/243 [00:00<00:02, 87.58it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 91.37it/s]backtest loop:  23%|██▎       | 56/243 [00:00<00:01, 95.41it/s]backtest loop:  27%|██▋       | 66/243 [00:00<00:01, 96.53it/s]backtest loop:  32%|███▏      | 77/243 [00:00<00:01, 96.10it/s]backtest loop:  36%|███▌      | 87/243 [00:00<00:01, 95.93it/s]backtest loop:  41%|████      | 99/243 [00:01<00:01, 101.36it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 102.31it/s]backtest loop:  50%|█████     | 122/243 [00:01<00:01, 106.81it/s]backtest loop:  55%|█████▌    | 134/243 [00:01<00:01, 107.18it/s]backtest loop:  60%|██████    | 146/243 [00:01<00:00, 109.96it/s]backtest loop:  65%|██████▌   | 158/243 [00:01<00:00, 110.41it/s]backtest loop:  70%|██████▉   | 170/243 [00:01<00:00, 107.74it/s]backtest loop:  75%|███████▌  | 183/243 [00:01<00:00, 108.27it/s]backtest loop:  80%|████████  | 195/243 [00:01<00:00, 110.61it/s]backtest loop:  85%|████████▌ | 207/243 [00:02<00:00, 109.41it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 101.74it/s]backtest loop:  94%|█████████▍| 229/243 [00:02<00:00, 102.01it/s]backtest loop:  99%|█████████▉| 240/243 [00:02<00:00, 102.39it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 100.62it/s]
2026-01-11 21:06:57.148 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0194, Sharpe(w/cost)=0.2888, MaxDD=-0.0547
2026-01-11 21:06:59.759 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 21:07:18.010 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:07:18.081 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_2_pred.parquet
2026-01-11 21:07:18.103 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 21:07:18.104 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 21:07:20.726 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0305
2026-01-11 21:07:22.387 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0330
2026-01-11 21:07:22.881 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0547, ICIR=0.4819, RankIC=0.0420
[1303276:MainThread](2026-01-11 21:07:22,886) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:08:04,551) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:08:04,553) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:08:10,155) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2d5be22190>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 37.10it/s]backtest loop:   5%|▌         | 13/243 [00:00<00:03, 66.75it/s]backtest loop:   9%|▉         | 22/243 [00:00<00:02, 76.52it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 75.97it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 74.10it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 75.00it/s]backtest loop:  22%|██▏       | 54/243 [00:00<00:02, 75.28it/s]backtest loop:  26%|██▌       | 62/243 [00:00<00:02, 75.22it/s]backtest loop:  30%|██▉       | 72/243 [00:00<00:02, 77.75it/s]backtest loop:  33%|███▎      | 80/243 [00:01<00:02, 78.29it/s]backtest loop:  37%|███▋      | 90/243 [00:01<00:01, 80.39it/s]backtest loop:  41%|████      | 100/243 [00:01<00:01, 82.27it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 84.50it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 87.29it/s]backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 87.66it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 88.42it/s]backtest loop:  61%|██████▏   | 149/243 [00:01<00:01, 89.92it/s]backtest loop:  65%|██████▌   | 159/243 [00:01<00:00, 90.45it/s]backtest loop:  70%|██████▉   | 169/243 [00:02<00:00, 91.32it/s]backtest loop:  74%|███████▎  | 179/243 [00:02<00:00, 92.42it/s]backtest loop:  78%|███████▊  | 189/243 [00:02<00:00, 92.13it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 90.72it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 89.03it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 86.44it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 85.38it/s]backtest loop:  98%|█████████▊| 238/243 [00:02<00:00, 84.80it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 83.38it/s]
2026-01-11 21:08:13.091 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0199, Sharpe(w/cost)=-0.3036
2026-01-11 21:08:13.162 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:08:13.162 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 21:08:13.163 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:08:13.163 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:10:28,853) INFO - qlib.timer - [log.py:127] - Time cost: 135.688s | Loading data Done
[1303276:MainThread](2026-01-11 21:10:33,546) INFO - qlib.timer - [log.py:127] - Time cost: 4.103s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:10:34,908) INFO - qlib.timer - [log.py:127] - Time cost: 1.360s | Fillna Done
[1303276:MainThread](2026-01-11 21:10:36,025) INFO - qlib.timer - [log.py:127] - Time cost: 0.318s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:10:36,227) INFO - qlib.timer - [log.py:127] - Time cost: 0.201s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:10:36,231) INFO - qlib.timer - [log.py:127] - Time cost: 7.377s | fit & process data Done
[1303276:MainThread](2026-01-11 21:10:36,231) INFO - qlib.timer - [log.py:127] - Time cost: 143.068s | Init data Done
2026-01-11 21:10:36.232 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:10:36.232 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:10:52.810 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:10:54.675 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 21:10:54.675 | INFO     | __main__:train_single_fold:593 -   IC=0.0151, ICIR=0.1255, RankIC=0.0313, RankICIR=0.2880
2026-01-11 21:10:54.675 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:10:54,682) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.982503	valid's l2: 0.995044
[40]	train's l2: 0.975853	valid's l2: 0.994882
[60]	train's l2: 0.970823	valid's l2: 0.994841
Early stopping, best iteration is:
[29]	train's l2: 0.979179	valid's l2: 0.994817
[1303276:MainThread](2026-01-11 21:11:58,767) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:11:58,768) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:12:05,495) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5aad0b50>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:06, 38.11it/s]backtest loop:   5%|▌         | 13/244 [00:00<00:03, 61.71it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 71.80it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:03, 70.88it/s]backtest loop:  16%|█▌        | 38/244 [00:00<00:02, 72.82it/s]backtest loop:  20%|█▉        | 48/244 [00:00<00:02, 76.63it/s]backtest loop:  24%|██▍       | 58/244 [00:00<00:02, 77.68it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:02, 78.09it/s]backtest loop:  32%|███▏      | 77/244 [00:01<00:02, 79.69it/s]backtest loop:  35%|███▍      | 85/244 [00:01<00:02, 78.43it/s]backtest loop:  39%|███▊      | 94/244 [00:01<00:01, 77.63it/s]backtest loop:  42%|████▏     | 103/244 [00:01<00:01, 77.60it/s]backtest loop:  46%|████▋     | 113/244 [00:01<00:01, 79.02it/s]backtest loop:  50%|████▉     | 121/244 [00:01<00:01, 78.70it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 77.29it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 77.15it/s]backtest loop:  60%|██████    | 147/244 [00:01<00:01, 80.56it/s]backtest loop:  64%|██████▍   | 156/244 [00:02<00:01, 79.33it/s]backtest loop:  67%|██████▋   | 164/244 [00:02<00:01, 78.60it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 77.69it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 78.25it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 77.04it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 76.90it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 77.41it/s]backtest loop:  89%|████████▉ | 217/244 [00:02<00:00, 77.65it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 78.67it/s]backtest loop:  97%|█████████▋| 236/244 [00:03<00:00, 80.46it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 76.65it/s]
2026-01-11 21:12:08.700 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0540, Sharpe(w/cost)=-0.7818, MaxDD=-0.1126
2026-01-11 21:12:12.596 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 21:12:30.269 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:12:30.355 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_3_pred.parquet
2026-01-11 21:12:30.369 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 21:12:30.369 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 21:12:32.305 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0213
2026-01-11 21:12:33.879 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0248
2026-01-11 21:12:35.476 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0339
2026-01-11 21:12:35.852 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0173, ICIR=0.1451, RankIC=0.0311
[1303276:MainThread](2026-01-11 21:12:35,857) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:13:36,410) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:13:36,411) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:13:43,026) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2d783e8b50>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 28.87it/s]backtest loop:   5%|▍         | 12/244 [00:00<00:03, 63.01it/s]backtest loop:   8%|▊         | 19/244 [00:00<00:03, 66.09it/s]backtest loop:  11%|█▏        | 28/244 [00:00<00:03, 70.82it/s]backtest loop:  16%|█▌        | 38/244 [00:00<00:02, 73.91it/s]backtest loop:  19%|█▉        | 47/244 [00:00<00:02, 78.13it/s]backtest loop:  23%|██▎       | 55/244 [00:00<00:02, 75.68it/s]backtest loop:  26%|██▌       | 63/244 [00:00<00:02, 74.50it/s]backtest loop:  30%|██▉       | 72/244 [00:00<00:02, 75.26it/s]backtest loop:  33%|███▎      | 80/244 [00:01<00:02, 75.27it/s]backtest loop:  36%|███▋      | 89/244 [00:01<00:02, 75.65it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 79.48it/s]backtest loop:  43%|████▎     | 106/244 [00:01<00:01, 77.90it/s]backtest loop:  47%|████▋     | 114/244 [00:01<00:01, 77.00it/s]backtest loop:  50%|█████     | 123/244 [00:01<00:01, 76.92it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 77.59it/s]backtest loop:  59%|█████▊    | 143/244 [00:01<00:01, 77.95it/s]backtest loop:  63%|██████▎   | 153/244 [00:02<00:01, 78.31it/s]backtest loop:  67%|██████▋   | 163/244 [00:02<00:01, 79.13it/s]backtest loop:  70%|███████   | 172/244 [00:02<00:00, 78.64it/s]backtest loop:  75%|███████▍  | 182/244 [00:02<00:00, 78.81it/s]backtest loop:  78%|███████▊  | 190/244 [00:02<00:00, 78.24it/s]backtest loop:  81%|████████  | 198/244 [00:02<00:00, 77.65it/s]backtest loop:  85%|████████▍ | 207/244 [00:02<00:00, 77.44it/s]backtest loop:  89%|████████▊ | 216/244 [00:02<00:00, 80.71it/s]backtest loop:  92%|█████████▏| 225/244 [00:02<00:00, 79.60it/s]backtest loop:  95%|█████████▌| 233/244 [00:03<00:00, 77.42it/s]backtest loop:  99%|█████████▉| 242/244 [00:03<00:00, 76.90it/s]backtest loop: 100%|██████████| 244/244 [00:03<00:00, 76.07it/s]
2026-01-11 21:13:46.254 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0865, Sharpe(w/cost)=-1.2098
2026-01-11 21:13:46.328 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:13:46.328 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 21:13:46.328 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:13:46.329 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:16:01,056) INFO - qlib.timer - [log.py:127] - Time cost: 134.725s | Loading data Done
[1303276:MainThread](2026-01-11 21:16:04,496) INFO - qlib.timer - [log.py:127] - Time cost: 2.887s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:16:06,299) INFO - qlib.timer - [log.py:127] - Time cost: 1.802s | Fillna Done
[1303276:MainThread](2026-01-11 21:16:07,296) INFO - qlib.timer - [log.py:127] - Time cost: 0.327s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:16:07,505) INFO - qlib.timer - [log.py:127] - Time cost: 0.208s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:16:07,509) INFO - qlib.timer - [log.py:127] - Time cost: 6.452s | fit & process data Done
[1303276:MainThread](2026-01-11 21:16:07,509) INFO - qlib.timer - [log.py:127] - Time cost: 141.179s | Init data Done
2026-01-11 21:16:07.509 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:16:07.510 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:18:04.656 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:18:07.272 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 21:18:07.272 | INFO     | __main__:train_single_fold:593 -   IC=0.0186, ICIR=0.1268, RankIC=0.0398, RankICIR=0.2995
2026-01-11 21:18:07.273 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:18:07,281) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.983683	valid's l2: 0.996196
[40]	train's l2: 0.97737	valid's l2: 0.996437
[60]	train's l2: 0.972314	valid's l2: 0.996579
Early stopping, best iteration is:
[20]	train's l2: 0.983683	valid's l2: 0.996196
[1303276:MainThread](2026-01-11 21:19:09,671) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:19:09,673) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:19:16,866) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b59cbf310>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 26.15it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 55.89it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 66.50it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 74.86it/s]backtest loop:  16%|█▌        | 38/243 [00:00<00:02, 74.16it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 74.00it/s]backtest loop:  23%|██▎       | 56/243 [00:00<00:02, 75.84it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:02, 76.15it/s]backtest loop:  30%|███       | 74/243 [00:01<00:02, 79.79it/s]backtest loop:  34%|███▍      | 83/243 [00:01<00:02, 75.49it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 75.64it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 76.56it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 77.20it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 76.33it/s]backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 79.93it/s]backtest loop:  57%|█████▋    | 138/243 [00:01<00:01, 78.97it/s]backtest loop:  60%|██████    | 146/243 [00:01<00:01, 78.18it/s]backtest loop:  64%|██████▍   | 155/243 [00:02<00:01, 77.83it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 78.75it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 78.90it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 77.46it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 76.32it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 75.46it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 76.68it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 79.86it/s]backtest loop:  93%|█████████▎| 227/243 [00:02<00:00, 79.51it/s]backtest loop:  97%|█████████▋| 235/243 [00:03<00:00, 78.35it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 77.21it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 76.03it/s]
2026-01-11 21:19:20.083 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0109, Sharpe(w/cost)=0.1239, MaxDD=-0.1402
2026-01-11 21:19:23.875 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 21:19:41.053 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:19:41.126 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_4_pred.parquet
2026-01-11 21:19:41.137 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 21:19:41.137 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 21:19:43.492 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0263
2026-01-11 21:19:45.201 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0275
2026-01-11 21:19:46.770 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0401
2026-01-11 21:19:48.379 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0407
2026-01-11 21:19:48.744 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0198, ICIR=0.1335, RankIC=0.0405
[1303276:MainThread](2026-01-11 21:19:48,750) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:20:52,642) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:20:52,644) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:20:59,773) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2cc4f28810>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 27.07it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:04, 55.54it/s]backtest loop:   9%|▊         | 21/243 [00:00<00:03, 66.30it/s]backtest loop:  13%|█▎        | 31/243 [00:00<00:02, 72.09it/s]backtest loop:  17%|█▋        | 41/243 [00:00<00:02, 76.92it/s]backtest loop:  21%|██        | 51/243 [00:00<00:02, 78.81it/s]backtest loop:  25%|██▌       | 61/243 [00:00<00:02, 79.47it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:02, 78.68it/s]backtest loop:  33%|███▎      | 79/243 [00:01<00:02, 77.87it/s]backtest loop:  36%|███▌      | 87/243 [00:01<00:02, 76.68it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:01, 80.06it/s]backtest loop:  43%|████▎     | 105/243 [00:01<00:01, 78.41it/s]backtest loop:  47%|████▋     | 113/243 [00:01<00:01, 76.62it/s]backtest loop:  50%|████▉     | 121/243 [00:01<00:01, 75.16it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 75.48it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 72.60it/s]backtest loop:  61%|██████▏   | 149/243 [00:01<00:01, 76.62it/s]backtest loop:  65%|██████▍   | 157/243 [00:02<00:01, 75.43it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:01, 74.21it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 77.76it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 75.68it/s]backtest loop:  78%|███████▊  | 190/243 [00:02<00:00, 71.12it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 72.07it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 76.46it/s]backtest loop:  89%|████████▉ | 216/243 [00:02<00:00, 74.26it/s]backtest loop:  92%|█████████▏| 224/243 [00:03<00:00, 74.55it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 75.85it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 75.52it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 74.78it/s]
2026-01-11 21:21:03.050 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0614, Sharpe(w/cost)=0.7042
2026-01-11 21:21:03.125 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:21:03.125 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 21:21:03.125 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:21:03.125 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:23:18,445) INFO - qlib.timer - [log.py:127] - Time cost: 135.317s | Loading data Done
[1303276:MainThread](2026-01-11 21:23:22,093) INFO - qlib.timer - [log.py:127] - Time cost: 3.103s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:23:23,543) INFO - qlib.timer - [log.py:127] - Time cost: 1.449s | Fillna Done
[1303276:MainThread](2026-01-11 21:23:24,607) INFO - qlib.timer - [log.py:127] - Time cost: 0.320s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:23:24,815) INFO - qlib.timer - [log.py:127] - Time cost: 0.207s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:23:24,819) INFO - qlib.timer - [log.py:127] - Time cost: 6.372s | fit & process data Done
[1303276:MainThread](2026-01-11 21:23:24,819) INFO - qlib.timer - [log.py:127] - Time cost: 141.692s | Init data Done
2026-01-11 21:23:24.819 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:23:24.820 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:25:23.069 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:25:27.969 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 21:25:27.969 | INFO     | __main__:train_single_fold:593 -   IC=0.0068, ICIR=0.0485, RankIC=0.0223, RankICIR=0.1749
2026-01-11 21:25:27.969 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:25:27,987) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.984612	valid's l2: 0.996163
[40]	train's l2: 0.978359	valid's l2: 0.996404
[60]	train's l2: 0.973309	valid's l2: 0.996587
Early stopping, best iteration is:
[11]	train's l2: 0.988648	valid's l2: 0.995919
[1303276:MainThread](2026-01-11 21:26:44,530) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:26:44,531) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:26:52,750) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5aa99d90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:10, 23.08it/s]backtest loop:   4%|▍         | 10/243 [00:00<00:05, 45.90it/s]backtest loop:   8%|▊         | 19/243 [00:00<00:03, 63.18it/s]backtest loop:  11%|█         | 26/243 [00:00<00:03, 65.50it/s]backtest loop:  14%|█▎        | 33/243 [00:00<00:03, 64.91it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:03, 64.94it/s]backtest loop:  20%|██        | 49/243 [00:00<00:02, 70.79it/s]backtest loop:  23%|██▎       | 57/243 [00:00<00:02, 68.13it/s]backtest loop:  26%|██▋       | 64/243 [00:01<00:02, 67.71it/s]backtest loop:  30%|███       | 73/243 [00:01<00:02, 73.90it/s]backtest loop:  33%|███▎      | 81/243 [00:01<00:02, 68.44it/s]backtest loop:  37%|███▋      | 90/243 [00:01<00:02, 73.88it/s]backtest loop:  40%|████      | 98/243 [00:01<00:01, 72.85it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 71.90it/s]backtest loop:  47%|████▋     | 115/243 [00:01<00:01, 72.70it/s]backtest loop:  51%|█████     | 124/243 [00:01<00:01, 77.06it/s]backtest loop:  54%|█████▍    | 132/243 [00:01<00:01, 75.17it/s]backtest loop:  58%|█████▊    | 140/243 [00:02<00:01, 73.67it/s]backtest loop:  61%|██████▏   | 149/243 [00:02<00:01, 76.91it/s]backtest loop:  65%|██████▍   | 157/243 [00:02<00:01, 75.74it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:01, 75.28it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 79.03it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 73.39it/s]backtest loop:  78%|███████▊  | 190/243 [00:02<00:00, 70.27it/s]backtest loop:  81%|████████▏ | 198/243 [00:02<00:00, 70.65it/s]backtest loop:  86%|████████▌ | 208/243 [00:02<00:00, 73.36it/s]backtest loop:  90%|████████▉ | 218/243 [00:03<00:00, 75.55it/s]backtest loop:  93%|█████████▎| 226/243 [00:03<00:00, 76.29it/s]backtest loop:  96%|█████████▋| 234/243 [00:03<00:00, 73.12it/s]backtest loop: 100%|█████████▉| 242/243 [00:03<00:00, 74.70it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 71.20it/s]
2026-01-11 21:26:56.192 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0021, Sharpe(w/cost)=0.0198, MaxDD=-0.1000
2026-01-11 21:27:00.122 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 21:27:18.913 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:27:19.031 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_5_pred.parquet
2026-01-11 21:27:19.053 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 21:27:19.054 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 21:27:21.313 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0185
2026-01-11 21:27:23.342 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0223
2026-01-11 21:27:26.084 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0247
2026-01-11 21:27:28.746 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0273
2026-01-11 21:27:30.564 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0247
2026-01-11 21:27:30.942 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0069, ICIR=0.0483, RankIC=0.0254
[1303276:MainThread](2026-01-11 21:27:30,948) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:28:47,785) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:28:47,786) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:28:56,349) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2cc67b9d90>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:12, 19.54it/s]backtest loop:   4%|▎         | 9/243 [00:00<00:06, 36.68it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:04, 48.20it/s]backtest loop:  10%|█         | 25/243 [00:00<00:03, 59.57it/s]backtest loop:  13%|█▎        | 32/243 [00:00<00:03, 62.76it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:03, 67.05it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 71.90it/s]backtest loop:  25%|██▍       | 60/243 [00:00<00:02, 74.55it/s]backtest loop:  28%|██▊       | 69/243 [00:01<00:02, 75.19it/s]backtest loop:  32%|███▏      | 78/243 [00:01<00:02, 79.26it/s]backtest loop:  35%|███▌      | 86/243 [00:01<00:02, 74.22it/s]backtest loop:  39%|███▉      | 95/243 [00:01<00:01, 77.40it/s]backtest loop:  42%|████▏     | 103/243 [00:01<00:01, 76.35it/s]backtest loop:  46%|████▌     | 111/243 [00:01<00:01, 75.88it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 76.07it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 77.89it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 81.16it/s]backtest loop:  61%|██████    | 148/243 [00:02<00:01, 79.80it/s]backtest loop:  65%|██████▍   | 157/243 [00:02<00:01, 79.57it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:01, 77.26it/s]backtest loop:  72%|███████▏  | 175/243 [00:02<00:00, 78.51it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 63.45it/s]backtest loop:  78%|███████▊  | 190/243 [00:02<00:00, 60.87it/s]backtest loop:  81%|████████  | 197/243 [00:02<00:00, 58.80it/s]backtest loop:  84%|████████▍ | 204/243 [00:02<00:00, 60.60it/s]backtest loop:  87%|████████▋ | 212/243 [00:03<00:00, 64.56it/s]backtest loop:  90%|█████████ | 219/243 [00:03<00:00, 64.38it/s]backtest loop:  94%|█████████▍| 228/243 [00:03<00:00, 68.79it/s]backtest loop:  98%|█████████▊| 238/243 [00:03<00:00, 72.76it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 69.77it/s]
2026-01-11 21:28:59.853 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0273, Sharpe(w/cost)=-0.2695
2026-01-11 21:28:59.919 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:28:59.920 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 21:28:59.920 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:28:59.920 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:31:28,837) INFO - qlib.timer - [log.py:127] - Time cost: 148.915s | Loading data Done
[1303276:MainThread](2026-01-11 21:31:32,270) INFO - qlib.timer - [log.py:127] - Time cost: 2.882s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:31:35,305) INFO - qlib.timer - [log.py:127] - Time cost: 3.035s | Fillna Done
[1303276:MainThread](2026-01-11 21:31:36,305) INFO - qlib.timer - [log.py:127] - Time cost: 0.321s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:31:36,531) INFO - qlib.timer - [log.py:127] - Time cost: 0.224s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:31:36,534) INFO - qlib.timer - [log.py:127] - Time cost: 7.696s | fit & process data Done
[1303276:MainThread](2026-01-11 21:31:36,534) INFO - qlib.timer - [log.py:127] - Time cost: 156.613s | Init data Done
2026-01-11 21:31:36.535 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:31:36.535 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:32:29.992 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:32:32.808 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 21:32:32.808 | INFO     | __main__:train_single_fold:593 -   IC=0.0206, ICIR=0.1604, RankIC=0.0340, RankICIR=0.2823
2026-01-11 21:32:32.808 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:32:32,819) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.986841	valid's l2: 0.997006
[40]	train's l2: 0.981143	valid's l2: 0.997861
Early stopping, best iteration is:
[7]	train's l2: 0.992231	valid's l2: 0.996359
[1303276:MainThread](2026-01-11 21:33:44,420) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:33:44,421) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:33:53,403) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5bfe9d90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:08, 28.15it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 51.54it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 64.14it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 71.18it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 74.47it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 76.67it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 77.96it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 76.87it/s]backtest loop:  31%|███▏      | 76/242 [00:01<00:02, 80.33it/s]backtest loop:  35%|███▌      | 85/242 [00:01<00:02, 75.70it/s]backtest loop:  39%|███▉      | 94/242 [00:01<00:01, 74.12it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 75.00it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 77.09it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 78.29it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 78.98it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 79.14it/s]backtest loop:  63%|██████▎   | 153/242 [00:02<00:01, 79.57it/s]backtest loop:  67%|██████▋   | 163/242 [00:02<00:00, 79.23it/s]backtest loop:  71%|███████   | 172/242 [00:02<00:00, 78.76it/s]backtest loop:  75%|███████▍  | 181/242 [00:02<00:00, 80.51it/s]backtest loop:  79%|███████▊  | 190/242 [00:02<00:00, 79.79it/s]backtest loop:  82%|████████▏ | 198/242 [00:02<00:00, 78.15it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 77.65it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 77.82it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 78.48it/s]backtest loop:  98%|█████████▊| 236/242 [00:03<00:00, 81.38it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 76.52it/s]
2026-01-11 21:33:56.599 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0380, Sharpe(w/cost)=0.4919, MaxDD=-0.0633
2026-01-11 21:34:02.044 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 21:34:21.952 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:34:22.065 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_6_pred.parquet
2026-01-11 21:34:22.084 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 21:34:22.084 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 21:34:25.968 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0242
2026-01-11 21:34:27.714 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0298
2026-01-11 21:34:29.296 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0279
2026-01-11 21:34:30.848 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0333
2026-01-11 21:34:32.440 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0332
2026-01-11 21:34:34.070 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0321
2026-01-11 21:34:34.464 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0238, ICIR=0.1683, RankIC=0.0369
[1303276:MainThread](2026-01-11 21:34:34,470) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:35:44,992) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:35:44,993) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:35:53,524) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b59389d90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:08, 28.12it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 50.61it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 64.17it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:02, 75.98it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 82.62it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 86.56it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 89.44it/s]backtest loop:  29%|██▊       | 69/242 [00:00<00:01, 91.66it/s]backtest loop:  33%|███▎      | 79/242 [00:00<00:01, 87.43it/s]backtest loop:  37%|███▋      | 89/242 [00:01<00:01, 89.48it/s]backtest loop:  40%|████      | 98/242 [00:01<00:01, 89.19it/s]backtest loop:  45%|████▍     | 108/242 [00:01<00:01, 90.34it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 88.69it/s]backtest loop:  53%|█████▎    | 128/242 [00:01<00:01, 90.46it/s]backtest loop:  57%|█████▋    | 138/242 [00:01<00:01, 88.76it/s]backtest loop:  61%|██████    | 148/242 [00:01<00:01, 85.83it/s]backtest loop:  65%|██████▌   | 158/242 [00:01<00:00, 84.07it/s]backtest loop:  69%|██████▉   | 168/242 [00:02<00:00, 82.94it/s]backtest loop:  73%|███████▎  | 177/242 [00:02<00:00, 80.12it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 80.21it/s]backtest loop:  81%|████████▏ | 197/242 [00:02<00:00, 79.88it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 79.83it/s]backtest loop:  90%|████████▉ | 217/242 [00:02<00:00, 79.88it/s]backtest loop:  94%|█████████▍| 227/242 [00:02<00:00, 80.03it/s]backtest loop:  98%|█████████▊| 236/242 [00:02<00:00, 80.90it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 81.98it/s]
2026-01-11 21:35:56.504 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1481, Sharpe(w/cost)=1.7601
2026-01-11 21:35:56.571 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:35:56.572 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 21:35:56.572 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:35:56.572 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:38:21,244) INFO - qlib.timer - [log.py:127] - Time cost: 144.670s | Loading data Done
[1303276:MainThread](2026-01-11 21:38:24,426) INFO - qlib.timer - [log.py:127] - Time cost: 2.574s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:38:26,109) INFO - qlib.timer - [log.py:127] - Time cost: 1.682s | Fillna Done
[1303276:MainThread](2026-01-11 21:38:27,167) INFO - qlib.timer - [log.py:127] - Time cost: 0.335s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:38:27,384) INFO - qlib.timer - [log.py:127] - Time cost: 0.216s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:38:27,388) INFO - qlib.timer - [log.py:127] - Time cost: 6.143s | fit & process data Done
[1303276:MainThread](2026-01-11 21:38:27,388) INFO - qlib.timer - [log.py:127] - Time cost: 150.815s | Init data Done
2026-01-11 21:38:27.389 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:38:27.389 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:39:19.442 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:39:21.965 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 21:39:21.965 | INFO     | __main__:train_single_fold:593 -   IC=0.0076, ICIR=0.0590, RankIC=0.0303, RankICIR=0.2844
2026-01-11 21:39:21.965 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:39:21,975) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.988535	valid's l2: 0.99603
[40]	train's l2: 0.98327	valid's l2: 0.996176
[60]	train's l2: 0.978683	valid's l2: 0.996484
Early stopping, best iteration is:
[19]	train's l2: 0.98879	valid's l2: 0.996012
[1303276:MainThread](2026-01-11 21:40:30,369) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:40:30,370) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:40:39,811) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5b803290>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 24.33it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:04, 46.89it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 60.39it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 68.37it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 72.54it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 74.90it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 76.89it/s]backtest loop:  28%|██▊       | 67/242 [00:00<00:02, 76.04it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 73.85it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 73.13it/s]backtest loop:  38%|███▊      | 91/242 [00:01<00:02, 72.85it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 72.02it/s]backtest loop:  45%|████▌     | 109/242 [00:01<00:01, 76.72it/s]backtest loop:  48%|████▊     | 117/242 [00:01<00:01, 76.06it/s]backtest loop:  52%|█████▏    | 125/242 [00:01<00:01, 75.05it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 75.01it/s]backtest loop:  59%|█████▊    | 142/242 [00:01<00:01, 79.13it/s]backtest loop:  62%|██████▏   | 150/242 [00:02<00:01, 77.53it/s]backtest loop:  65%|██████▌   | 158/242 [00:02<00:01, 76.50it/s]backtest loop:  69%|██████▉   | 167/242 [00:02<00:00, 80.01it/s]backtest loop:  73%|███████▎  | 176/242 [00:02<00:00, 78.63it/s]backtest loop:  76%|███████▌  | 184/242 [00:02<00:00, 77.99it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 76.48it/s]backtest loop:  83%|████████▎ | 201/242 [00:02<00:00, 79.90it/s]backtest loop:  87%|████████▋ | 210/242 [00:02<00:00, 77.87it/s]backtest loop:  90%|█████████ | 218/242 [00:02<00:00, 75.68it/s]backtest loop:  94%|█████████▍| 227/242 [00:03<00:00, 74.60it/s]backtest loop:  98%|█████████▊| 237/242 [00:03<00:00, 76.15it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 74.44it/s]
2026-01-11 21:40:43.086 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0243, Sharpe(w/cost)=0.4198, MaxDD=-0.0340
2026-01-11 21:40:47.929 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 21:41:10.245 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:41:10.335 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_7_pred.parquet
2026-01-11 21:41:10.346 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 21:41:10.346 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 21:41:13.163 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0099
2026-01-11 21:41:14.856 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0192
2026-01-11 21:41:16.667 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0253
2026-01-11 21:41:18.476 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0291
2026-01-11 21:41:20.138 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0187
2026-01-11 21:41:21.762 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0224
2026-01-11 21:41:23.374 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0290
2026-01-11 21:41:23.766 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0134, ICIR=0.1007, RankIC=0.0302
[1303276:MainThread](2026-01-11 21:41:23,770) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:42:35,988) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:42:35,990) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:42:45,355) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b5bb2d390>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:08, 26.63it/s]backtest loop:   5%|▍         | 12/242 [00:00<00:03, 60.96it/s]backtest loop:   9%|▊         | 21/242 [00:00<00:03, 73.44it/s]backtest loop:  12%|█▏        | 30/242 [00:00<00:02, 79.52it/s]backtest loop:  17%|█▋        | 40/242 [00:00<00:02, 82.88it/s]backtest loop:  20%|██        | 49/242 [00:00<00:02, 84.89it/s]backtest loop:  24%|██▍       | 59/242 [00:00<00:02, 87.41it/s]backtest loop:  28%|██▊       | 68/242 [00:00<00:02, 84.43it/s]backtest loop:  32%|███▏      | 78/242 [00:00<00:01, 87.01it/s]backtest loop:  36%|███▌      | 87/242 [00:01<00:01, 86.68it/s]backtest loop:  40%|███▉      | 96/242 [00:01<00:01, 86.01it/s]backtest loop:  43%|████▎     | 105/242 [00:01<00:01, 86.66it/s]backtest loop:  47%|████▋     | 114/242 [00:01<00:01, 85.69it/s]backtest loop:  51%|█████     | 124/242 [00:01<00:01, 88.32it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 88.16it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 84.33it/s]backtest loop:  63%|██████▎   | 153/242 [00:01<00:01, 84.64it/s]backtest loop:  67%|██████▋   | 163/242 [00:01<00:00, 86.79it/s]backtest loop:  71%|███████▏  | 173/242 [00:02<00:00, 88.99it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 90.40it/s]backtest loop:  80%|███████▉  | 193/242 [00:02<00:00, 91.37it/s]backtest loop:  84%|████████▍ | 203/242 [00:02<00:00, 92.06it/s]backtest loop:  88%|████████▊ | 213/242 [00:02<00:00, 92.73it/s]backtest loop:  92%|█████████▏| 223/242 [00:02<00:00, 93.05it/s]backtest loop:  96%|█████████▋| 233/242 [00:02<00:00, 93.00it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 86.63it/s]
2026-01-11 21:42:48.166 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0391, Sharpe(w/cost)=0.6389
2026-01-11 21:42:48.219 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 21:42:48.219 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 21:42:48.219 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 21:42:48.219 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1303276:MainThread](2026-01-11 21:45:15,740) INFO - qlib.timer - [log.py:127] - Time cost: 147.519s | Loading data Done
[1303276:MainThread](2026-01-11 21:45:18,778) INFO - qlib.timer - [log.py:127] - Time cost: 2.415s | ZScoreNorm Done
[1303276:MainThread](2026-01-11 21:45:20,857) INFO - qlib.timer - [log.py:127] - Time cost: 2.078s | Fillna Done
[1303276:MainThread](2026-01-11 21:45:21,927) INFO - qlib.timer - [log.py:127] - Time cost: 0.327s | DropnaLabel Done
[1303276:MainThread](2026-01-11 21:45:22,137) INFO - qlib.timer - [log.py:127] - Time cost: 0.209s | CSRankNorm Done
[1303276:MainThread](2026-01-11 21:45:22,140) INFO - qlib.timer - [log.py:127] - Time cost: 6.400s | fit & process data Done
[1303276:MainThread](2026-01-11 21:45:22,141) INFO - qlib.timer - [log.py:127] - Time cost: 153.921s | Init data Done
2026-01-11 21:45:22.141 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
2026-01-11 21:45:22.142 | INFO     | __main__:train_single_fold:569 - Training lgb_360_zscore model (GPU=0)...
2026-01-11 21:45:28.003 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 21:45:29.519 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 21:45:29.519 | INFO     | __main__:train_single_fold:593 -   IC=0.0224, ICIR=0.1529, RankIC=0.0380, RankICIR=0.2529
2026-01-11 21:45:29.519 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1303276:MainThread](2026-01-11 21:45:29,525) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
Training until validation scores don't improve for 50 rounds
[20]	train's l2: 0.989153	valid's l2: 0.995946
[40]	train's l2: 0.984298	valid's l2: 0.995865
[60]	train's l2: 0.979984	valid's l2: 0.996033
[80]	train's l2: 0.975919	valid's l2: 0.996147
Early stopping, best iteration is:
[35]	train's l2: 0.985472	valid's l2: 0.995857
[1303276:MainThread](2026-01-11 21:46:31,260) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:46:31,261) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:46:38,860) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b2b815210>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:13, 17.41it/s]backtest loop:   5%|▍         | 11/242 [00:00<00:05, 45.72it/s]backtest loop:   9%|▊         | 21/242 [00:00<00:03, 65.65it/s]backtest loop:  13%|█▎        | 31/242 [00:00<00:02, 76.69it/s]backtest loop:  17%|█▋        | 41/242 [00:00<00:02, 83.10it/s]backtest loop:  21%|██        | 50/242 [00:00<00:02, 82.71it/s]backtest loop:  25%|██▍       | 60/242 [00:00<00:02, 86.89it/s]backtest loop:  29%|██▉       | 70/242 [00:00<00:01, 89.69it/s]backtest loop:  33%|███▎      | 80/242 [00:01<00:01, 88.48it/s]backtest loop:  37%|███▋      | 90/242 [00:01<00:01, 91.70it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 92.93it/s]backtest loop:  45%|████▌     | 110/242 [00:01<00:01, 90.53it/s]backtest loop:  50%|████▉     | 120/242 [00:01<00:01, 91.80it/s]backtest loop:  54%|█████▎    | 130/242 [00:01<00:01, 92.97it/s]backtest loop:  58%|█████▊    | 140/242 [00:01<00:01, 93.81it/s]backtest loop:  62%|██████▏   | 150/242 [00:01<00:00, 94.35it/s]backtest loop:  66%|██████▌   | 160/242 [00:01<00:00, 94.72it/s]backtest loop:  70%|███████   | 170/242 [00:01<00:00, 94.96it/s]backtest loop:  74%|███████▍  | 180/242 [00:02<00:00, 88.24it/s]backtest loop:  79%|███████▊  | 190/242 [00:02<00:00, 88.74it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 91.37it/s]backtest loop:  87%|████████▋ | 210/242 [00:02<00:00, 93.34it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 94.25it/s]backtest loop:  95%|█████████▌| 230/242 [00:02<00:00, 93.02it/s]backtest loop:  99%|█████████▉| 240/242 [00:02<00:00, 93.84it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 87.45it/s]
2026-01-11 21:46:41.649 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0916, Sharpe(w/cost)=1.1519, MaxDD=-0.0676
2026-01-11 21:46:45.387 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 21:47:06.247 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:47:06.333 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/fold_8_pred.parquet
2026-01-11 21:47:06.346 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 21:47:06.346 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 21:47:09.320 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0083
2026-01-11 21:47:11.385 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0154
2026-01-11 21:47:12.980 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0143
2026-01-11 21:47:14.070 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0195
2026-01-11 21:47:15.259 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0235
2026-01-11 21:47:16.688 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0214
2026-01-11 21:47:17.818 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0246
2026-01-11 21:47:18.982 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0302
2026-01-11 21:47:19.419 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0215, ICIR=0.1357, RankIC=0.0338
[1303276:MainThread](2026-01-11 21:47:19,434) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1303276:MainThread](2026-01-11 21:48:20,019) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:48:20,020) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:48:30,058) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2b58a69d90>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:17, 14.00it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:06, 36.02it/s]backtest loop:   7%|▋         | 17/242 [00:00<00:04, 48.06it/s]backtest loop:  10%|▉         | 24/242 [00:00<00:03, 54.99it/s]backtest loop:  14%|█▎        | 33/242 [00:00<00:03, 62.42it/s]backtest loop:  17%|█▋        | 42/242 [00:00<00:02, 70.51it/s]backtest loop:  21%|██        | 50/242 [00:00<00:02, 70.91it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:02, 71.44it/s]backtest loop:  27%|██▋       | 66/242 [00:01<00:02, 71.39it/s]backtest loop:  31%|███       | 75/242 [00:01<00:02, 76.40it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:02, 71.57it/s]backtest loop:  38%|███▊      | 92/242 [00:01<00:01, 76.14it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 74.67it/s]backtest loop:  45%|████▍     | 108/242 [00:01<00:01, 74.06it/s]backtest loop:  48%|████▊     | 116/242 [00:01<00:01, 73.62it/s]backtest loop:  51%|█████     | 124/242 [00:01<00:01, 73.59it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 74.58it/s]backtest loop:  58%|█████▊    | 141/242 [00:02<00:01, 78.13it/s]backtest loop:  62%|██████▏   | 149/242 [00:02<00:01, 75.55it/s]backtest loop:  65%|██████▍   | 157/242 [00:02<00:01, 74.87it/s]backtest loop:  69%|██████▊   | 166/242 [00:02<00:00, 78.98it/s]backtest loop:  72%|███████▏  | 174/242 [00:02<00:00, 76.57it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 73.33it/s]backtest loop:  79%|███████▊  | 190/242 [00:02<00:00, 74.28it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 76.15it/s]backtest loop:  86%|████████▌ | 208/242 [00:02<00:00, 76.91it/s]backtest loop:  89%|████████▉ | 216/242 [00:03<00:00, 75.34it/s]backtest loop:  93%|█████████▎| 225/242 [00:03<00:00, 76.26it/s]backtest loop:  97%|█████████▋| 235/242 [00:03<00:00, 77.80it/s]backtest loop: 100%|██████████| 242/242 [00:03<00:00, 71.41it/s]
2026-01-11 21:48:33.476 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0138, Sharpe(w/cost)=0.1491
2026-01-11 21:48:33.561 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 21:48:33.561 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 21:48:33.562 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 21:48:33.572 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 21:48:33.573 | INFO     | __main__:_print_summary:827 -   IC: 0.0298
2026-01-11 21:48:33.573 | INFO     | __main__:_print_summary:828 -   ICIR: 0.2366
2026-01-11 21:48:33.573 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0448
2026-01-11 21:48:33.573 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0510
2026-01-11 21:48:33.574 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.6798
2026-01-11 21:48:33.574 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0385
2026-01-11 21:48:33.579 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/summary.csv
2026-01-11 21:48:33.579 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 21:48:33.579 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 21:48:33.579 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 21:48:33.579 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 21:48:33.582 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 21:48:33.582 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0448
2026-01-11 21:48:33.582 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0265
2026-01-11 21:48:33.582 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0265)
2026-01-11 21:48:33.582 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 21:48:33.583 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/ensemble_matrix.csv
2026-01-11 21:48:33.583 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 21:48:33.584 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 21:48:33.584 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 21:48:33.771 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 21:48:33.771 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 21:48:35.831 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0298, ICIR=0.2234, RankIC=0.0448
[1303276:MainThread](2026-01-11 21:48:35,841) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.074078 0.622129 0.095709  0.187207  1.793133 -0.032957         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.046257 0.330217 0.066870  0.138928  2.610523 -0.039602    0.068069    0.524104
    2 2018-01-01 ~ 2018-12-31 0.056390 0.504175 0.044710  0.019423  0.288752 -0.054738    0.042045   -0.303615
    3 2019-01-01 ~ 2019-12-31 0.015123 0.125519 0.031331 -0.053995 -0.781849 -0.112603    0.031097   -1.209843
    4 2020-01-01 ~ 2020-12-31 0.018601 0.126846 0.039778  0.010930  0.123864 -0.140247    0.040489    0.704186
    5 2021-01-01 ~ 2021-12-31 0.006761 0.048503 0.022320  0.002118  0.019788 -0.100044    0.025363   -0.269470
    6 2022-01-01 ~ 2022-12-31 0.020613 0.160420 0.034025  0.038032  0.491922 -0.063320    0.036895    1.760088
    7 2023-01-01 ~ 2023-12-31 0.007581 0.058980 0.030270  0.024334  0.419814 -0.034009    0.030238    0.638853
    8 2024-01-01 ~ 2024-12-31 0.022359 0.152905 0.038023  0.091617  1.151908 -0.067572    0.033835    0.149128

        M0      M1      M2      M3      M4      M5      M6      M7     M8
T0  0.0957     NaN     NaN     NaN     NaN     NaN     NaN     NaN    NaN
T1  0.0652  0.0669     NaN     NaN     NaN     NaN     NaN     NaN    NaN
T2  0.0305  0.0330  0.0447     NaN     NaN     NaN     NaN     NaN    NaN
T3  0.0213  0.0248  0.0339  0.0313     NaN     NaN     NaN     NaN    NaN
T4  0.0263  0.0275  0.0401  0.0407  0.0398     NaN     NaN     NaN    NaN
T5  0.0185  0.0223  0.0247  0.0273  0.0247  0.0223     NaN     NaN    NaN
T6  0.0242  0.0298  0.0279  0.0333  0.0332  0.0321  0.0340     NaN    NaN
T7  0.0099  0.0192  0.0253  0.0291  0.0187  0.0224  0.0290  0.0303    NaN
T8  0.0083  0.0154  0.0143  0.0195  0.0235  0.0214  0.0246  0.0302  0.038
[1303276:MainThread](2026-01-11 21:49:59,863) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:49:59,867) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1303276:MainThread](2026-01-11 21:51:01,470) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f2cc4f79750>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 3/2187 [00:00<01:30, 24.19it/s]backtest loop:   0%|          | 10/2187 [00:00<00:45, 47.95it/s]backtest loop:   1%|          | 20/2187 [00:00<00:34, 62.64it/s]backtest loop:   1%|▏         | 29/2187 [00:00<00:29, 72.28it/s]backtest loop:   2%|▏         | 37/2187 [00:00<00:29, 72.50it/s]backtest loop:   2%|▏         | 45/2187 [00:00<00:28, 74.76it/s]backtest loop:   3%|▎         | 55/2187 [00:00<00:27, 77.84it/s]backtest loop:   3%|▎         | 64/2187 [00:00<00:26, 79.39it/s]backtest loop:   3%|▎         | 73/2187 [00:00<00:25, 81.74it/s]backtest loop:   4%|▎         | 82/2187 [00:01<00:25, 83.15it/s]backtest loop:   4%|▍         | 91/2187 [00:01<00:25, 81.87it/s]backtest loop:   5%|▍         | 100/2187 [00:01<00:25, 81.73it/s]backtest loop:   5%|▍         | 109/2187 [00:01<00:25, 81.00it/s]backtest loop:   5%|▌         | 118/2187 [00:01<00:26, 79.35it/s]backtest loop:   6%|▌         | 126/2187 [00:01<00:26, 77.81it/s]backtest loop:   6%|▌         | 136/2187 [00:01<00:25, 79.07it/s]backtest loop:   7%|▋         | 146/2187 [00:01<00:25, 80.07it/s]backtest loop:   7%|▋         | 156/2187 [00:02<00:25, 79.75it/s]backtest loop:   8%|▊         | 166/2187 [00:02<00:24, 80.99it/s]backtest loop:   8%|▊         | 175/2187 [00:02<00:24, 81.27it/s]backtest loop:   8%|▊         | 184/2187 [00:02<00:24, 81.24it/s]backtest loop:   9%|▉         | 194/2187 [00:02<00:24, 82.27it/s]backtest loop:   9%|▉         | 204/2187 [00:02<00:23, 83.06it/s]backtest loop:  10%|▉         | 214/2187 [00:02<00:23, 83.31it/s]backtest loop:  10%|█         | 224/2187 [00:02<00:23, 85.05it/s]backtest loop:  11%|█         | 234/2187 [00:02<00:22, 87.27it/s]backtest loop:  11%|█         | 244/2187 [00:03<00:22, 87.36it/s]backtest loop:  12%|█▏        | 253/2187 [00:03<00:22, 84.51it/s]backtest loop:  12%|█▏        | 262/2187 [00:03<00:22, 85.06it/s]backtest loop:  12%|█▏        | 271/2187 [00:03<00:22, 86.20it/s]backtest loop:  13%|█▎        | 281/2187 [00:03<00:21, 88.59it/s]backtest loop:  13%|█▎        | 291/2187 [00:03<00:20, 90.86it/s]backtest loop:  14%|█▍        | 301/2187 [00:03<00:20, 91.53it/s]backtest loop:  14%|█▍        | 311/2187 [00:03<00:21, 88.21it/s]backtest loop:  15%|█▍        | 321/2187 [00:03<00:20, 90.59it/s]backtest loop:  15%|█▌        | 331/2187 [00:04<00:20, 92.24it/s]backtest loop:  16%|█▌        | 341/2187 [00:04<00:20, 91.99it/s]backtest loop:  16%|█▌        | 351/2187 [00:04<00:19, 92.29it/s]backtest loop:  17%|█▋        | 361/2187 [00:04<00:20, 91.13it/s]backtest loop:  17%|█▋        | 371/2187 [00:04<00:20, 89.52it/s]backtest loop:  17%|█▋        | 380/2187 [00:04<00:20, 88.67it/s]backtest loop:  18%|█▊        | 389/2187 [00:04<00:20, 87.66it/s]backtest loop:  18%|█▊        | 398/2187 [00:04<00:20, 87.61it/s]backtest loop:  19%|█▊        | 408/2187 [00:04<00:20, 88.20it/s]backtest loop:  19%|█▉        | 418/2187 [00:05<00:19, 88.81it/s]backtest loop:  20%|█▉        | 428/2187 [00:05<00:19, 90.49it/s]backtest loop:  20%|██        | 438/2187 [00:05<00:19, 91.30it/s]backtest loop:  20%|██        | 448/2187 [00:05<00:18, 91.97it/s]backtest loop:  21%|██        | 458/2187 [00:05<00:18, 93.33it/s]backtest loop:  21%|██▏       | 468/2187 [00:05<00:18, 93.25it/s]backtest loop:  22%|██▏       | 478/2187 [00:05<00:18, 92.97it/s]backtest loop:  22%|██▏       | 488/2187 [00:05<00:18, 93.92it/s]backtest loop:  23%|██▎       | 498/2187 [00:05<00:18, 92.34it/s]backtest loop:  23%|██▎       | 508/2187 [00:05<00:18, 91.94it/s]backtest loop:  24%|██▎       | 518/2187 [00:06<00:17, 93.38it/s]backtest loop:  24%|██▍       | 528/2187 [00:06<00:19, 87.17it/s]backtest loop:  25%|██▍       | 537/2187 [00:06<00:19, 86.30it/s]backtest loop:  25%|██▌       | 547/2187 [00:06<00:18, 86.72it/s]backtest loop:  25%|██▌       | 556/2187 [00:06<00:19, 85.62it/s]backtest loop:  26%|██▌       | 565/2187 [00:06<00:19, 84.92it/s]backtest loop:  26%|██▌       | 574/2187 [00:06<00:19, 83.81it/s]backtest loop:  27%|██▋       | 583/2187 [00:06<00:19, 83.86it/s]backtest loop:  27%|██▋       | 593/2187 [00:06<00:18, 84.71it/s]backtest loop:  28%|██▊       | 602/2187 [00:07<00:18, 85.85it/s]backtest loop:  28%|██▊       | 612/2187 [00:07<00:18, 87.39it/s]backtest loop:  28%|██▊       | 622/2187 [00:07<00:17, 88.56it/s]backtest loop:  29%|██▉       | 632/2187 [00:07<00:17, 87.91it/s]backtest loop:  29%|██▉       | 642/2187 [00:07<00:17, 87.92it/s]backtest loop:  30%|██▉       | 652/2187 [00:07<00:17, 89.17it/s]backtest loop:  30%|███       | 662/2187 [00:07<00:16, 89.79it/s]backtest loop:  31%|███       | 671/2187 [00:07<00:17, 89.04it/s]backtest loop:  31%|███       | 681/2187 [00:07<00:16, 88.95it/s]backtest loop:  32%|███▏      | 691/2187 [00:08<00:17, 85.60it/s]backtest loop:  32%|███▏      | 701/2187 [00:08<00:17, 82.93it/s]backtest loop:  32%|███▏      | 710/2187 [00:08<00:17, 84.46it/s]backtest loop:  33%|███▎      | 719/2187 [00:08<00:18, 80.92it/s]backtest loop:  33%|███▎      | 728/2187 [00:08<00:18, 78.97it/s]backtest loop:  34%|███▎      | 736/2187 [00:08<00:18, 77.55it/s]backtest loop:  34%|███▍      | 744/2187 [00:08<00:18, 76.72it/s]backtest loop:  34%|███▍      | 754/2187 [00:08<00:18, 77.96it/s]backtest loop:  35%|███▍      | 764/2187 [00:09<00:17, 79.10it/s]backtest loop:  35%|███▌      | 774/2187 [00:09<00:17, 80.19it/s]backtest loop:  36%|███▌      | 784/2187 [00:09<00:17, 79.24it/s]backtest loop:  36%|███▋      | 793/2187 [00:09<00:17, 78.55it/s]backtest loop:  37%|███▋      | 803/2187 [00:09<00:17, 79.62it/s]backtest loop:  37%|███▋      | 811/2187 [00:09<00:17, 78.32it/s]backtest loop:  37%|███▋      | 820/2187 [00:09<00:17, 77.89it/s]backtest loop:  38%|███▊      | 828/2187 [00:10<00:33, 40.07it/s]backtest loop:  38%|███▊      | 835/2187 [00:10<00:30, 44.94it/s]backtest loop:  39%|███▊      | 844/2187 [00:10<00:25, 52.07it/s]backtest loop:  39%|███▉      | 854/2187 [00:10<00:22, 58.97it/s]backtest loop:  40%|███▉      | 864/2187 [00:10<00:20, 64.52it/s]backtest loop:  40%|███▉      | 874/2187 [00:10<00:19, 68.41it/s]backtest loop:  40%|████      | 883/2187 [00:10<00:17, 73.12it/s]backtest loop:  41%|████      | 891/2187 [00:11<00:18, 71.56it/s]backtest loop:  41%|████      | 899/2187 [00:11<00:18, 71.24it/s]backtest loop:  42%|████▏     | 908/2187 [00:11<00:18, 70.83it/s]backtest loop:  42%|████▏     | 916/2187 [00:11<00:18, 69.29it/s]backtest loop:  42%|████▏     | 924/2187 [00:11<00:17, 70.20it/s]backtest loop:  43%|████▎     | 933/2187 [00:11<00:17, 70.56it/s]backtest loop:  43%|████▎     | 942/2187 [00:11<00:16, 74.11it/s]backtest loop:  43%|████▎     | 950/2187 [00:11<00:17, 70.83it/s]backtest loop:  44%|████▍     | 958/2187 [00:11<00:17, 68.93it/s]backtest loop:  44%|████▍     | 967/2187 [00:12<00:16, 73.89it/s]backtest loop:  45%|████▍     | 975/2187 [00:12<00:17, 69.56it/s]backtest loop:  45%|████▍     | 983/2187 [00:12<00:17, 70.77it/s]backtest loop:  45%|████▌     | 991/2187 [00:12<00:16, 71.98it/s]backtest loop:  46%|████▌     | 1001/2187 [00:12<00:15, 74.74it/s]backtest loop:  46%|████▌     | 1011/2187 [00:12<00:15, 75.79it/s]backtest loop:  47%|████▋     | 1021/2187 [00:12<00:15, 76.86it/s]backtest loop:  47%|████▋     | 1031/2187 [00:12<00:14, 77.66it/s]backtest loop:  48%|████▊     | 1040/2187 [00:13<00:14, 76.59it/s]backtest loop:  48%|████▊     | 1050/2187 [00:13<00:14, 77.41it/s]backtest loop:  48%|████▊     | 1058/2187 [00:13<00:14, 76.68it/s]backtest loop:  49%|████▉     | 1067/2187 [00:13<00:14, 76.47it/s]backtest loop:  49%|████▉     | 1077/2187 [00:13<00:14, 78.33it/s]backtest loop:  50%|████▉     | 1087/2187 [00:13<00:14, 77.83it/s]backtest loop:  50%|█████     | 1095/2187 [00:13<00:14, 76.13it/s]backtest loop:  51%|█████     | 1105/2187 [00:13<00:13, 77.34it/s]backtest loop:  51%|█████     | 1115/2187 [00:14<00:13, 77.95it/s]backtest loop:  51%|█████▏    | 1125/2187 [00:14<00:13, 78.77it/s]backtest loop:  52%|█████▏    | 1135/2187 [00:14<00:13, 78.83it/s]backtest loop:  52%|█████▏    | 1145/2187 [00:14<00:13, 79.00it/s]backtest loop:  53%|█████▎    | 1155/2187 [00:14<00:13, 78.97it/s]backtest loop:  53%|█████▎    | 1163/2187 [00:14<00:13, 77.47it/s]backtest loop:  54%|█████▎    | 1171/2187 [00:14<00:13, 76.08it/s]backtest loop:  54%|█████▍    | 1179/2187 [00:14<00:13, 75.27it/s]backtest loop:  54%|█████▍    | 1189/2187 [00:14<00:12, 76.97it/s]backtest loop:  55%|█████▍    | 1199/2187 [00:15<00:12, 78.31it/s]backtest loop:  55%|█████▌    | 1209/2187 [00:15<00:12, 78.74it/s]backtest loop:  56%|█████▌    | 1218/2187 [00:15<00:12, 78.25it/s]backtest loop:  56%|█████▌    | 1228/2187 [00:15<00:12, 78.53it/s]backtest loop:  57%|█████▋    | 1238/2187 [00:15<00:12, 79.04it/s]backtest loop:  57%|█████▋    | 1246/2187 [00:15<00:12, 77.30it/s]backtest loop:  57%|█████▋    | 1254/2187 [00:15<00:12, 75.96it/s]backtest loop:  58%|█████▊    | 1263/2187 [00:15<00:12, 75.48it/s]backtest loop:  58%|█████▊    | 1273/2187 [00:16<00:11, 76.18it/s]backtest loop:  59%|█████▊    | 1282/2187 [00:16<00:11, 75.74it/s]backtest loop:  59%|█████▉    | 1292/2187 [00:16<00:11, 76.68it/s]backtest loop:  59%|█████▉    | 1300/2187 [00:16<00:11, 75.97it/s]backtest loop:  60%|█████▉    | 1309/2187 [00:16<00:11, 76.35it/s]backtest loop:  60%|██████    | 1319/2187 [00:16<00:11, 77.14it/s]backtest loop:  61%|██████    | 1328/2187 [00:16<00:11, 76.73it/s]backtest loop:  61%|██████    | 1338/2187 [00:16<00:10, 77.42it/s]backtest loop:  62%|██████▏   | 1348/2187 [00:17<00:10, 77.97it/s]backtest loop:  62%|██████▏   | 1358/2187 [00:17<00:10, 78.26it/s]backtest loop:  63%|██████▎   | 1367/2187 [00:17<00:10, 81.09it/s]backtest loop:  63%|██████▎   | 1376/2187 [00:17<00:10, 79.79it/s]backtest loop:  63%|██████▎   | 1385/2187 [00:17<00:10, 78.83it/s]backtest loop:  64%|██████▎   | 1393/2187 [00:17<00:10, 77.76it/s]backtest loop:  64%|██████▍   | 1401/2187 [00:17<00:10, 72.47it/s]backtest loop:  65%|██████▍   | 1411/2187 [00:17<00:10, 74.67it/s]backtest loop:  65%|██████▍   | 1421/2187 [00:17<00:10, 75.94it/s]backtest loop:  65%|██████▌   | 1431/2187 [00:18<00:09, 76.88it/s]backtest loop:  66%|██████▌   | 1441/2187 [00:18<00:09, 77.34it/s]backtest loop:  66%|██████▋   | 1451/2187 [00:18<00:09, 77.81it/s]backtest loop:  67%|██████▋   | 1460/2187 [00:18<00:08, 80.83it/s]backtest loop:  67%|██████▋   | 1469/2187 [00:18<00:09, 79.31it/s]backtest loop:  68%|██████▊   | 1477/2187 [00:18<00:09, 77.15it/s]backtest loop:  68%|██████▊   | 1485/2187 [00:18<00:09, 75.57it/s]backtest loop:  68%|██████▊   | 1494/2187 [00:18<00:08, 79.49it/s]backtest loop:  69%|██████▊   | 1502/2187 [00:19<00:08, 77.21it/s]backtest loop:  69%|██████▉   | 1510/2187 [00:19<00:08, 75.77it/s]backtest loop:  70%|██████▉   | 1520/2187 [00:19<00:08, 76.69it/s]backtest loop:  70%|██████▉   | 1528/2187 [00:19<00:08, 75.24it/s]backtest loop:  70%|███████   | 1538/2187 [00:19<00:08, 76.25it/s]backtest loop:  71%|███████   | 1546/2187 [00:19<00:08, 75.47it/s]backtest loop:  71%|███████   | 1555/2187 [00:19<00:08, 75.31it/s]backtest loop:  72%|███████▏  | 1564/2187 [00:19<00:08, 75.52it/s]backtest loop:  72%|███████▏  | 1574/2187 [00:19<00:07, 76.86it/s]backtest loop:  72%|███████▏  | 1584/2187 [00:20<00:07, 77.56it/s]backtest loop:  73%|███████▎  | 1594/2187 [00:20<00:07, 77.88it/s]backtest loop:  73%|███████▎  | 1604/2187 [00:20<00:07, 77.72it/s]backtest loop:  74%|███████▍  | 1613/2187 [00:20<00:07, 80.67it/s]backtest loop:  74%|███████▍  | 1622/2187 [00:20<00:07, 79.31it/s]backtest loop:  75%|███████▍  | 1630/2187 [00:20<00:07, 77.44it/s]backtest loop:  75%|███████▍  | 1638/2187 [00:20<00:07, 76.41it/s]backtest loop:  75%|███████▌  | 1648/2187 [00:20<00:06, 77.43it/s]backtest loop:  76%|███████▌  | 1658/2187 [00:21<00:06, 77.98it/s]backtest loop:  76%|███████▋  | 1668/2187 [00:21<00:06, 78.11it/s]backtest loop:  77%|███████▋  | 1678/2187 [00:21<00:06, 78.27it/s]backtest loop:  77%|███████▋  | 1688/2187 [00:21<00:06, 78.26it/s]backtest loop:  78%|███████▊  | 1698/2187 [00:21<00:06, 78.65it/s]backtest loop:  78%|███████▊  | 1707/2187 [00:21<00:06, 77.92it/s]backtest loop:  79%|███████▊  | 1717/2187 [00:21<00:06, 77.71it/s]backtest loop:  79%|███████▉  | 1727/2187 [00:21<00:05, 77.93it/s]backtest loop:  79%|███████▉  | 1737/2187 [00:22<00:05, 79.17it/s]backtest loop:  80%|███████▉  | 1747/2187 [00:22<00:05, 79.10it/s]backtest loop:  80%|████████  | 1757/2187 [00:22<00:05, 78.86it/s]backtest loop:  81%|████████  | 1765/2187 [00:22<00:05, 77.07it/s]backtest loop:  81%|████████  | 1773/2187 [00:22<00:05, 75.78it/s]backtest loop:  81%|████████▏ | 1781/2187 [00:22<00:05, 74.86it/s]backtest loop:  82%|████████▏ | 1789/2187 [00:22<00:05, 74.30it/s]backtest loop:  82%|████████▏ | 1798/2187 [00:22<00:05, 74.64it/s]backtest loop:  83%|████████▎ | 1808/2187 [00:22<00:04, 76.30it/s]backtest loop:  83%|████████▎ | 1816/2187 [00:23<00:04, 75.38it/s]backtest loop:  83%|████████▎ | 1825/2187 [00:23<00:04, 79.31it/s]backtest loop:  84%|████████▍ | 1833/2187 [00:23<00:04, 77.21it/s]backtest loop:  84%|████████▍ | 1841/2187 [00:23<00:04, 75.75it/s]backtest loop:  85%|████████▍ | 1851/2187 [00:23<00:04, 76.50it/s]backtest loop:  85%|████████▌ | 1861/2187 [00:23<00:04, 76.88it/s]backtest loop:  86%|████████▌ | 1870/2187 [00:23<00:03, 79.56it/s]backtest loop:  86%|████████▌ | 1878/2187 [00:23<00:04, 77.24it/s]backtest loop:  86%|████████▌ | 1886/2187 [00:23<00:04, 74.72it/s]backtest loop:  87%|████████▋ | 1895/2187 [00:24<00:03, 74.08it/s]backtest loop:  87%|████████▋ | 1904/2187 [00:24<00:03, 78.04it/s]backtest loop:  87%|████████▋ | 1912/2187 [00:24<00:03, 75.70it/s]backtest loop:  88%|████████▊ | 1920/2187 [00:24<00:03, 74.77it/s]backtest loop:  88%|████████▊ | 1929/2187 [00:24<00:03, 78.76it/s]backtest loop:  89%|████████▊ | 1937/2187 [00:24<00:03, 75.90it/s]backtest loop:  89%|████████▉ | 1945/2187 [00:24<00:03, 74.17it/s]backtest loop:  89%|████████▉ | 1954/2187 [00:24<00:03, 73.31it/s]backtest loop:  90%|████████▉ | 1963/2187 [00:25<00:02, 77.47it/s]backtest loop:  90%|█████████ | 1971/2187 [00:25<00:02, 75.42it/s]backtest loop:  90%|█████████ | 1979/2187 [00:25<00:02, 73.68it/s]backtest loop:  91%|█████████ | 1988/2187 [00:25<00:02, 73.20it/s]backtest loop:  91%|█████████▏| 1997/2187 [00:25<00:02, 77.36it/s]backtest loop:  92%|█████████▏| 2005/2187 [00:25<00:02, 75.67it/s]backtest loop:  92%|█████████▏| 2013/2187 [00:25<00:02, 73.89it/s]backtest loop:  92%|█████████▏| 2021/2187 [00:25<00:02, 73.18it/s]backtest loop:  93%|█████████▎| 2029/2187 [00:25<00:02, 73.83it/s]backtest loop:  93%|█████████▎| 2038/2187 [00:26<00:02, 74.24it/s]backtest loop:  94%|█████████▎| 2047/2187 [00:26<00:01, 78.25it/s]backtest loop:  94%|█████████▍| 2055/2187 [00:26<00:01, 75.88it/s]backtest loop:  94%|█████████▍| 2063/2187 [00:26<00:01, 74.06it/s]backtest loop:  95%|█████████▍| 2072/2187 [00:26<00:01, 74.15it/s]backtest loop:  95%|█████████▌| 2082/2187 [00:26<00:01, 75.66it/s]backtest loop:  96%|█████████▌| 2092/2187 [00:26<00:01, 77.41it/s]backtest loop:  96%|█████████▌| 2102/2187 [00:26<00:01, 78.21it/s]backtest loop:  97%|█████████▋| 2112/2187 [00:26<00:00, 78.65it/s]backtest loop:  97%|█████████▋| 2120/2187 [00:27<00:00, 77.25it/s]backtest loop:  97%|█████████▋| 2128/2187 [00:27<00:00, 77.46it/s]backtest loop:  98%|█████████▊| 2136/2187 [00:27<00:00, 74.88it/s]backtest loop:  98%|█████████▊| 2145/2187 [00:27<00:00, 76.06it/s]backtest loop:  99%|█████████▊| 2155/2187 [00:27<00:00, 77.18it/s]backtest loop:  99%|█████████▉| 2165/2187 [00:27<00:00, 77.66it/s]backtest loop:  99%|█████████▉| 2175/2187 [00:27<00:00, 77.79it/s]backtest loop: 100%|█████████▉| 2185/2187 [00:27<00:00, 78.25it/s]backtest loop: 100%|██████████| 2187/2187 [00:27<00:00, 78.21it/s]
2026-01-11 21:51:29.537 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 21:51:29.537 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0432
2026-01-11 21:51:29.538 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 0.5367
2026-01-11 21:51:29.538 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2815
2026-01-11 21:51:35.182 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pdf/full_backtest_report.pdf
2026-01-11 21:51:56.485 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 21:51:56.776 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_205229_lgb_360_zscore_6y/pred/full_pred.parquet
[1303276:MainThread](2026-01-11 21:51:57,268) INFO - qlib.timer - [log.py:127] - Time cost: 0.000s | waiting `async_log` Done
