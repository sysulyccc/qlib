Gym has been unmaintained since 2022 and does not support NumPy 2.0 amongst other critical functionality.
Please upgrade to Gymnasium, the maintained drop-in replacement of Gym, or contact the authors of your software and request that they upgrade.
Users of this version of Gym should be able to simply replace 'import gym' with 'import gymnasium as gym' in the vast majority of cases.
See the migration guide at https://gymnasium.farama.org/introduction/migration_guide/ for additional information.
[1091829:MainThread](2026-01-11 18:52:18,394) INFO - qlib.Initialization - [config.py:452] - default_conf: client.
[1091829:MainThread](2026-01-11 18:52:18,879) INFO - qlib.Initialization - [__init__.py:82] - qlib successfully initialized based on client settings.
[1091829:MainThread](2026-01-11 18:52:18,880) INFO - qlib.Initialization - [__init__.py:84] - data_path={'__DEFAULT_FREQ': PosixPath('/home/ethan/.qlib/qlib_data/cn_data')}
2026-01-11 18:52:18.889 | INFO     | __main__:__init__:113 - Run directory: /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y
2026-01-11 18:52:18.889 | INFO     | __main__:__init__:114 - Logging to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/log/gru_360_zscore_csi500_topk_20260111_185218.log
2026-01-11 18:52:18.889 | INFO     | __main__:__init__:115 - Model name: gru_360_zscore_csi500_topk
2026-01-11 18:52:18.891 | INFO     | __main__:run:851 - Total 9 rolling folds to train
2026-01-11 18:52:18.892 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:52:18.892 | INFO     | __main__:train_single_fold:554 - Fold 0: train [2010-01-01, 2013-12-31], valid [2014-01-01, 2015-12-31], test [2016-01-01, 2016-12-31]
2026-01-11 18:52:18.892 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:52:18.892 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 18:52:41,377) INFO - qlib.timer - [log.py:127] - Time cost: 22.484s | Loading data Done
[1091829:MainThread](2026-01-11 18:52:44,055) INFO - qlib.timer - [log.py:127] - Time cost: 2.160s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 18:52:45,602) INFO - qlib.timer - [log.py:127] - Time cost: 1.546s | Fillna Done
[1091829:MainThread](2026-01-11 18:52:47,289) INFO - qlib.timer - [log.py:127] - Time cost: 0.307s | DropnaLabel Done
[1091829:MainThread](2026-01-11 18:52:47,488) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[1091829:MainThread](2026-01-11 18:52:47,491) INFO - qlib.timer - [log.py:127] - Time cost: 6.113s | fit & process data Done
[1091829:MainThread](2026-01-11 18:52:47,491) INFO - qlib.timer - [log.py:127] - Time cost: 28.598s | Init data Done
2026-01-11 18:52:47.491 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 18:52:47,695) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 18:52:47,696) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 18:52:47,721) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 18:52:47,722) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 18:52:49.063 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 18:52:50,035) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 18:52:50,036) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 18:52:50,037) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:52:53,286) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:52:54,401) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991167, valid -0.994603
[1091829:MainThread](2026-01-11 18:52:54,402) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 18:52:54,403) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:52:57,044) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:52:58,189) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.985905, valid -0.990055
[1091829:MainThread](2026-01-11 18:52:58,190) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 18:52:58,191) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:00,620) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:01,767) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.983781, valid -0.993923
[1091829:MainThread](2026-01-11 18:53:01,768) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 18:53:01,769) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:04,479) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:05,824) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982270, valid -0.993556
[1091829:MainThread](2026-01-11 18:53:05,825) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 18:53:05,825) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:08,234) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:09,409) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.980635, valid -0.996110
[1091829:MainThread](2026-01-11 18:53:09,410) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 18:53:09,410) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:11,660) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:12,819) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.979053, valid -0.993462
[1091829:MainThread](2026-01-11 18:53:12,819) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 18:53:12,820) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:15,211) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:16,558) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978052, valid -0.993946
[1091829:MainThread](2026-01-11 18:53:16,559) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 18:53:16,560) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:19,037) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:20,225) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.976766, valid -0.993503
[1091829:MainThread](2026-01-11 18:53:20,226) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 18:53:20,226) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:22,731) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:23,903) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.975431, valid -0.997821
[1091829:MainThread](2026-01-11 18:53:23,904) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 18:53:23,905) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:26,474) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:27,635) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.974747, valid -1.003185
[1091829:MainThread](2026-01-11 18:53:27,635) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 18:53:27,636) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:30,010) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:31,110) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.972627, valid -1.002043
[1091829:MainThread](2026-01-11 18:53:31,111) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 18:53:31,111) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:33,510) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:34,580) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.971036, valid -1.001528
[1091829:MainThread](2026-01-11 18:53:34,580) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 18:53:34,581) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:36,857) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:37,975) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.970421, valid -1.003007
[1091829:MainThread](2026-01-11 18:53:37,976) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 18:53:37,976) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:40,844) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:42,039) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969062, valid -1.004453
[1091829:MainThread](2026-01-11 18:53:42,040) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 18:53:42,040) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:44,723) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:46,158) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.966155, valid -1.007925
[1091829:MainThread](2026-01-11 18:53:46,159) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 18:53:46,159) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:48,549) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:49,658) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964991, valid -1.014619
[1091829:MainThread](2026-01-11 18:53:49,658) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 18:53:49,659) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:51,985) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:53,060) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.963378, valid -1.006866
[1091829:MainThread](2026-01-11 18:53:53,061) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 18:53:53,061) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:55,410) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:53:56,666) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.960540, valid -1.012526
[1091829:MainThread](2026-01-11 18:53:56,666) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 18:53:56,666) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:53:59,146) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:54:00,361) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.959354, valid -1.015446
[1091829:MainThread](2026-01-11 18:54:00,361) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 18:54:00,362) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:54:03,003) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:54:04,104) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.958435, valid -1.024501
[1091829:MainThread](2026-01-11 18:54:04,104) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 18:54:04,105) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:54:06,376) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:54:07,462) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.954266, valid -1.024159
[1091829:MainThread](2026-01-11 18:54:07,462) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 18:54:07,463) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:54:09,723) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:54:10,823) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.952025, valid -1.027943
[1091829:MainThread](2026-01-11 18:54:10,824) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 18:54:10,824) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.990055 @ 1
[1091829:MainThread](2026-01-11 18:54:10,840) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 18:54:11.048 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:54:13.126 | INFO     | __main__:train_single_fold:592 - Fold 0 Current Model Metrics:
2026-01-11 18:54:13.127 | INFO     | __main__:train_single_fold:593 -   IC=0.0804, ICIR=0.7064, RankIC=0.1026, RankICIR=0.9461
2026-01-11 18:54:13.127 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 18:54:13,133) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
ModuleNotFoundError. CatBoostModel are skipped. (optional: maybe installing CatBoostModel can fix it.)
ModuleNotFoundError. XGBModel is skipped(optional: maybe installing xgboost can fix it).
[1091829:MainThread](2026-01-11 18:54:31,396) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 18:54:31,397) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 18:54:35,546) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f121412a390>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   5%|▍         | 12/244 [00:00<00:01, 118.67it/s]backtest loop:  10%|▉         | 24/244 [00:00<00:01, 118.65it/s]backtest loop:  15%|█▍        | 36/244 [00:00<00:01, 111.49it/s]backtest loop:  20%|██        | 49/244 [00:00<00:01, 117.47it/s]backtest loop:  25%|██▌       | 61/244 [00:00<00:01, 110.50it/s]backtest loop:  30%|██▉       | 73/244 [00:00<00:01, 110.45it/s]backtest loop:  35%|███▍      | 85/244 [00:00<00:01, 106.15it/s]backtest loop:  39%|███▉      | 96/244 [00:00<00:01, 105.99it/s]backtest loop:  44%|████▍     | 107/244 [00:00<00:01, 102.40it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 102.74it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 103.72it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:00, 103.02it/s]backtest loop:  63%|██████▎   | 153/244 [00:01<00:00, 106.70it/s]backtest loop:  68%|██████▊   | 165/244 [00:01<00:00, 108.92it/s]backtest loop:  72%|███████▏  | 176/244 [00:01<00:00, 106.31it/s]backtest loop:  77%|███████▋  | 188/244 [00:01<00:00, 109.34it/s]backtest loop:  82%|████████▏ | 199/244 [00:01<00:00, 108.52it/s]backtest loop:  87%|████████▋ | 212/244 [00:01<00:00, 113.48it/s]backtest loop:  92%|█████████▏| 224/244 [00:02<00:00, 110.54it/s]backtest loop:  97%|█████████▋| 236/244 [00:02<00:00, 111.82it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 108.64it/s]
2026-01-11 18:54:37.809 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.3334, Sharpe(w/cost)=3.3766, MaxDD=-0.0326
2026-01-11 18:54:41.603 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_0_backtest_report.pdf
2026-01-11 18:54:55.830 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:54:55.892 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_0_pred.parquet
2026-01-11 18:54:55.911 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:54:55.911 | INFO     | __main__:train_single_fold:554 - Fold 1: train [2011-01-01, 2014-12-31], valid [2015-01-01, 2016-12-31], test [2017-01-01, 2017-12-31]
2026-01-11 18:54:55.911 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:54:55.911 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 18:55:51,495) INFO - qlib.timer - [log.py:127] - Time cost: 55.582s | Loading data Done
[1091829:MainThread](2026-01-11 18:55:54,705) INFO - qlib.timer - [log.py:127] - Time cost: 2.631s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 18:55:55,706) INFO - qlib.timer - [log.py:127] - Time cost: 0.999s | Fillna Done
[1091829:MainThread](2026-01-11 18:55:57,484) INFO - qlib.timer - [log.py:127] - Time cost: 0.326s | DropnaLabel Done
[1091829:MainThread](2026-01-11 18:55:57,693) INFO - qlib.timer - [log.py:127] - Time cost: 0.208s | CSRankNorm Done
[1091829:MainThread](2026-01-11 18:55:57,697) INFO - qlib.timer - [log.py:127] - Time cost: 6.201s | fit & process data Done
[1091829:MainThread](2026-01-11 18:55:57,698) INFO - qlib.timer - [log.py:127] - Time cost: 61.786s | Init data Done
2026-01-11 18:55:57.698 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 18:55:57,699) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 18:55:57,700) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 18:55:57,702) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 18:55:57,703) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 18:55:57.706 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 18:55:58,775) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 18:55:58,776) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 18:55:58,777) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:01,878) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:03,306) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.992139, valid -0.994488
[1091829:MainThread](2026-01-11 18:56:03,308) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 18:56:03,308) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:06,499) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:07,893) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.988232, valid -0.991831
[1091829:MainThread](2026-01-11 18:56:07,894) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 18:56:07,895) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:10,913) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:12,795) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.986442, valid -0.991670
[1091829:MainThread](2026-01-11 18:56:12,796) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 18:56:12,797) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:16,054) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:18,044) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.985086, valid -0.994680
[1091829:MainThread](2026-01-11 18:56:18,045) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 18:56:18,045) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:21,247) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:23,097) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984256, valid -0.998434
[1091829:MainThread](2026-01-11 18:56:23,097) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 18:56:23,098) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:26,158) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:27,733) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982887, valid -0.992594
[1091829:MainThread](2026-01-11 18:56:27,733) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 18:56:27,734) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:30,649) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:32,308) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982034, valid -0.991353
[1091829:MainThread](2026-01-11 18:56:32,310) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 18:56:32,311) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:35,235) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:36,671) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.980563, valid -0.990882
[1091829:MainThread](2026-01-11 18:56:36,672) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 18:56:36,673) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:39,658) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:41,306) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978851, valid -0.990014
[1091829:MainThread](2026-01-11 18:56:41,307) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 18:56:41,308) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:44,013) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:45,556) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.979448, valid -0.998375
[1091829:MainThread](2026-01-11 18:56:45,557) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 18:56:45,557) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:48,571) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:50,246) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978286, valid -0.993395
[1091829:MainThread](2026-01-11 18:56:50,247) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 18:56:50,248) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:53,026) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:54,491) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.975773, valid -0.999659
[1091829:MainThread](2026-01-11 18:56:54,492) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 18:56:54,492) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:56:57,673) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:56:59,105) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.974162, valid -0.995839
[1091829:MainThread](2026-01-11 18:56:59,106) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 18:56:59,106) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:02,041) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:03,561) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.973748, valid -1.003134
[1091829:MainThread](2026-01-11 18:57:03,562) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 18:57:03,562) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:06,441) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:08,143) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.971326, valid -1.000515
[1091829:MainThread](2026-01-11 18:57:08,144) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 18:57:08,144) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:11,335) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:12,844) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969926, valid -1.000797
[1091829:MainThread](2026-01-11 18:57:12,845) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 18:57:12,845) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:15,699) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:17,421) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969675, valid -1.005914
[1091829:MainThread](2026-01-11 18:57:17,422) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 18:57:17,422) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:20,379) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:21,759) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.967551, valid -1.010397
[1091829:MainThread](2026-01-11 18:57:21,759) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 18:57:21,760) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:24,712) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:26,012) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.966672, valid -1.007850
[1091829:MainThread](2026-01-11 18:57:26,013) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 18:57:26,013) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:29,081) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:30,772) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.963007, valid -1.008050
[1091829:MainThread](2026-01-11 18:57:30,773) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 18:57:30,773) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:33,730) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:35,175) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.961601, valid -1.013953
[1091829:MainThread](2026-01-11 18:57:35,175) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 18:57:35,176) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:38,555) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:40,264) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.959671, valid -1.022391
[1091829:MainThread](2026-01-11 18:57:40,265) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 18:57:40,265) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:43,037) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:44,751) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.957646, valid -1.019483
[1091829:MainThread](2026-01-11 18:57:44,752) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch23:
[1091829:MainThread](2026-01-11 18:57:44,752) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:47,345) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:48,816) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.953681, valid -1.023872
[1091829:MainThread](2026-01-11 18:57:48,818) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch24:
[1091829:MainThread](2026-01-11 18:57:48,819) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:52,025) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:53,711) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.950184, valid -1.027560
[1091829:MainThread](2026-01-11 18:57:53,712) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch25:
[1091829:MainThread](2026-01-11 18:57:53,712) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:57:56,495) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:57:58,176) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.948404, valid -1.036465
[1091829:MainThread](2026-01-11 18:57:58,177) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch26:
[1091829:MainThread](2026-01-11 18:57:58,177) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:58:01,475) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:58:02,848) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.944794, valid -1.039017
[1091829:MainThread](2026-01-11 18:58:02,849) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch27:
[1091829:MainThread](2026-01-11 18:58:02,849) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:58:05,857) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:58:07,262) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.942710, valid -1.040643
[1091829:MainThread](2026-01-11 18:58:07,262) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch28:
[1091829:MainThread](2026-01-11 18:58:07,263) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 18:58:10,207) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 18:58:11,828) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.939673, valid -1.046619
[1091829:MainThread](2026-01-11 18:58:11,829) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 18:58:11,829) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.990014 @ 8
[1091829:MainThread](2026-01-11 18:58:11,838) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 18:58:12.136 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 18:58:15.278 | INFO     | __main__:train_single_fold:592 - Fold 1 Current Model Metrics:
2026-01-11 18:58:15.279 | INFO     | __main__:train_single_fold:593 -   IC=0.0755, ICIR=0.6290, RankIC=0.0889, RankICIR=0.8869
2026-01-11 18:58:15.279 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 18:58:15,285) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 18:58:41,682) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 18:58:41,683) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 18:58:47,125) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a2a68650>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   3%|▎         | 7/244 [00:00<00:03, 67.69it/s]backtest loop:   7%|▋         | 18/244 [00:00<00:02, 83.16it/s]backtest loop:  12%|█▏        | 29/244 [00:00<00:02, 89.19it/s]backtest loop:  17%|█▋        | 41/244 [00:00<00:02, 99.38it/s]backtest loop:  22%|██▏       | 54/244 [00:00<00:01, 103.32it/s]backtest loop:  27%|██▋       | 66/244 [00:00<00:01, 108.42it/s]backtest loop:  32%|███▏      | 77/244 [00:00<00:01, 105.45it/s]backtest loop:  36%|███▋      | 89/244 [00:00<00:01, 109.23it/s]backtest loop:  41%|████      | 100/244 [00:00<00:01, 106.15it/s]backtest loop:  45%|████▌     | 111/244 [00:01<00:01, 105.73it/s]backtest loop:  50%|█████     | 122/244 [00:01<00:01, 105.80it/s]backtest loop:  55%|█████▍    | 133/244 [00:01<00:01, 105.97it/s]backtest loop:  59%|█████▉    | 144/244 [00:01<00:00, 103.47it/s]backtest loop:  64%|██████▍   | 156/244 [00:01<00:00, 106.49it/s]backtest loop:  68%|██████▊   | 167/244 [00:01<00:00, 103.52it/s]backtest loop:  73%|███████▎  | 178/244 [00:01<00:00, 100.33it/s]backtest loop:  77%|███████▋  | 189/244 [00:01<00:00, 98.50it/s] backtest loop:  82%|████████▏ | 200/244 [00:01<00:00, 100.42it/s]backtest loop:  86%|████████▋ | 211/244 [00:02<00:00, 102.25it/s]backtest loop:  91%|█████████ | 222/244 [00:02<00:00, 100.58it/s]backtest loop:  95%|█████████▌| 233/244 [00:02<00:00, 99.82it/s] backtest loop: 100%|██████████| 244/244 [00:02<00:00, 95.77it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 100.92it/s]
2026-01-11 18:58:49.562 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.2118, Sharpe(w/cost)=4.0383, MaxDD=-0.0194
2026-01-11 18:58:55.760 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_1_backtest_report.pdf
2026-01-11 18:59:17.071 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 18:59:17.128 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_1_pred.parquet
2026-01-11 18:59:17.140 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 1 historical models ---
2026-01-11 18:59:17.140 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 1 historical models on fold 1 test data ---
2026-01-11 18:59:19.274 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T1: RankIC=0.0816
2026-01-11 18:59:19.588 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0736, ICIR=0.5683, RankIC=0.0921
[1091829:MainThread](2026-01-11 18:59:19,592) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 18:59:47,042) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 18:59:47,043) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 18:59:52,841) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1214292c90>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/244 [00:00<00:07, 34.27it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 63.74it/s]backtest loop:   9%|▉         | 22/244 [00:00<00:03, 69.71it/s]backtest loop:  12%|█▏        | 30/244 [00:00<00:02, 73.49it/s]backtest loop:  16%|█▋        | 40/244 [00:00<00:02, 81.63it/s]backtest loop:  21%|██▏       | 52/244 [00:00<00:02, 92.61it/s]backtest loop:  25%|██▌       | 62/244 [00:00<00:01, 92.97it/s]backtest loop:  30%|███       | 74/244 [00:00<00:01, 99.68it/s]backtest loop:  35%|███▍      | 85/244 [00:00<00:01, 102.32it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 101.03it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 103.64it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 105.40it/s]backtest loop:  53%|█████▎    | 129/244 [00:01<00:01, 102.87it/s]backtest loop:  58%|█████▊    | 141/244 [00:01<00:00, 106.73it/s]backtest loop:  63%|██████▎   | 153/244 [00:01<00:00, 108.80it/s]backtest loop:  67%|██████▋   | 164/244 [00:01<00:00, 105.58it/s]backtest loop:  73%|███████▎  | 177/244 [00:01<00:00, 110.83it/s]backtest loop:  77%|███████▋  | 189/244 [00:01<00:00, 112.18it/s]backtest loop:  82%|████████▏ | 201/244 [00:02<00:00, 113.50it/s]backtest loop:  88%|████████▊ | 214/244 [00:02<00:00, 113.75it/s]backtest loop:  93%|█████████▎| 227/244 [00:02<00:00, 117.99it/s]backtest loop:  98%|█████████▊| 239/244 [00:02<00:00, 116.48it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 102.57it/s]
2026-01-11 18:59:55.239 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.2148, Sharpe(w/cost)=4.2194
2026-01-11 18:59:55.283 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 18:59:55.284 | INFO     | __main__:train_single_fold:554 - Fold 2: train [2012-01-01, 2015-12-31], valid [2016-01-01, 2017-12-31], test [2018-01-01, 2018-12-31]
2026-01-11 18:59:55.284 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 18:59:55.284 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:01:09,573) INFO - qlib.timer - [log.py:127] - Time cost: 74.287s | Loading data Done
[1091829:MainThread](2026-01-11 19:01:13,147) INFO - qlib.timer - [log.py:127] - Time cost: 3.029s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:01:14,172) INFO - qlib.timer - [log.py:127] - Time cost: 1.024s | Fillna Done
[1091829:MainThread](2026-01-11 19:01:15,826) INFO - qlib.timer - [log.py:127] - Time cost: 0.332s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:01:16,025) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:01:16,028) INFO - qlib.timer - [log.py:127] - Time cost: 6.454s | fit & process data Done
[1091829:MainThread](2026-01-11 19:01:16,029) INFO - qlib.timer - [log.py:127] - Time cost: 80.744s | Init data Done
2026-01-11 19:01:16.029 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:01:16,030) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:01:16,031) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:01:16,033) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:01:16,034) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:01:16.039 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:01:17,098) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:01:17,100) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:01:17,101) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:20,217) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:21,531) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991980, valid -0.993403
[1091829:MainThread](2026-01-11 19:01:21,532) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:01:21,532) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:24,286) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:25,885) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.990353, valid -0.993549
[1091829:MainThread](2026-01-11 19:01:25,885) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:01:25,886) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:28,619) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:29,923) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.987029, valid -0.991038
[1091829:MainThread](2026-01-11 19:01:29,924) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:01:29,925) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:32,864) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:34,146) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.983989, valid -0.989392
[1091829:MainThread](2026-01-11 19:01:34,148) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:01:34,148) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:37,329) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:38,893) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.981413, valid -0.988138
[1091829:MainThread](2026-01-11 19:01:38,895) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:01:38,896) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:41,654) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:43,125) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.979826, valid -0.989368
[1091829:MainThread](2026-01-11 19:01:43,126) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:01:43,127) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:46,273) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:47,641) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978584, valid -0.987914
[1091829:MainThread](2026-01-11 19:01:47,642) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:01:47,643) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:50,425) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:51,827) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.977324, valid -0.989617
[1091829:MainThread](2026-01-11 19:01:51,828) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:01:51,828) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:54,386) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:55,783) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.974074, valid -0.987408
[1091829:MainThread](2026-01-11 19:01:55,785) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:01:55,785) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:01:58,262) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:01:59,470) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.972272, valid -0.988367
[1091829:MainThread](2026-01-11 19:01:59,471) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:01:59,471) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:01,941) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:03,222) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969923, valid -0.988437
[1091829:MainThread](2026-01-11 19:02:03,223) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:02:03,223) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:05,586) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:06,835) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969383, valid -0.990775
[1091829:MainThread](2026-01-11 19:02:06,836) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:02:06,836) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:09,233) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:10,504) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.967039, valid -0.991398
[1091829:MainThread](2026-01-11 19:02:10,505) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:02:10,505) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:13,088) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:14,293) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964105, valid -0.990193
[1091829:MainThread](2026-01-11 19:02:14,294) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:02:14,294) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:17,040) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:18,402) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.965040, valid -0.992911
[1091829:MainThread](2026-01-11 19:02:18,403) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:02:18,403) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:20,755) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:21,966) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.960395, valid -0.992605
[1091829:MainThread](2026-01-11 19:02:21,966) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:02:21,967) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:24,329) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:25,509) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.958324, valid -0.992935
[1091829:MainThread](2026-01-11 19:02:25,510) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:02:25,510) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:27,806) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:29,037) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.956154, valid -0.992862
[1091829:MainThread](2026-01-11 19:02:29,038) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:02:29,038) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:31,733) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:32,976) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.953038, valid -0.993953
[1091829:MainThread](2026-01-11 19:02:32,976) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:02:32,977) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:35,325) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:36,528) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.951709, valid -0.995538
[1091829:MainThread](2026-01-11 19:02:36,529) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:02:36,529) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:38,975) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:40,171) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.950017, valid -0.997331
[1091829:MainThread](2026-01-11 19:02:40,172) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 19:02:40,172) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:42,645) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:43,992) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.947367, valid -0.998546
[1091829:MainThread](2026-01-11 19:02:43,993) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 19:02:43,993) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:46,987) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:48,205) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.944833, valid -0.999042
[1091829:MainThread](2026-01-11 19:02:48,205) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch23:
[1091829:MainThread](2026-01-11 19:02:48,206) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:50,514) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:51,732) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.940324, valid -1.001443
[1091829:MainThread](2026-01-11 19:02:51,733) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch24:
[1091829:MainThread](2026-01-11 19:02:51,733) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:54,174) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:55,426) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.938134, valid -1.003321
[1091829:MainThread](2026-01-11 19:02:55,426) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch25:
[1091829:MainThread](2026-01-11 19:02:55,427) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:02:57,840) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:02:59,050) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.935760, valid -1.003176
[1091829:MainThread](2026-01-11 19:02:59,051) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch26:
[1091829:MainThread](2026-01-11 19:02:59,051) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:03:01,405) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:03:02,626) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.934283, valid -1.005753
[1091829:MainThread](2026-01-11 19:03:02,627) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch27:
[1091829:MainThread](2026-01-11 19:03:02,627) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:03:04,971) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:03:06,169) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.929886, valid -1.004414
[1091829:MainThread](2026-01-11 19:03:06,170) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch28:
[1091829:MainThread](2026-01-11 19:03:06,170) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:03:08,555) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:03:09,739) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.929108, valid -1.008547
[1091829:MainThread](2026-01-11 19:03:09,739) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:03:09,740) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.987408 @ 8
[1091829:MainThread](2026-01-11 19:03:09,790) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:03:10.004 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:03:12.546 | INFO     | __main__:train_single_fold:592 - Fold 2 Current Model Metrics:
2026-01-11 19:03:12.547 | INFO     | __main__:train_single_fold:593 -   IC=0.0632, ICIR=0.6584, RankIC=0.0520, RankICIR=0.5752
2026-01-11 19:03:12.547 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:03:12,552) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:03:40,717) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:03:40,718) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:03:45,584) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a1b9e990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 6/243 [00:00<00:04, 56.87it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:02, 79.70it/s]backtest loop:  11%|█         | 26/243 [00:00<00:02, 87.57it/s]backtest loop:  14%|█▍        | 35/243 [00:00<00:02, 85.09it/s]backtest loop:  19%|█▊        | 45/243 [00:00<00:02, 88.77it/s]backtest loop:  23%|██▎       | 55/243 [00:00<00:02, 91.51it/s]backtest loop:  27%|██▋       | 65/243 [00:00<00:01, 93.95it/s]backtest loop:  31%|███▏      | 76/243 [00:00<00:01, 97.62it/s]backtest loop:  35%|███▌      | 86/243 [00:00<00:01, 94.46it/s]backtest loop:  40%|███▉      | 97/243 [00:01<00:01, 97.30it/s]backtest loop:  44%|████▍     | 108/243 [00:01<00:01, 100.32it/s]backtest loop:  49%|████▉     | 119/243 [00:01<00:01, 97.37it/s] backtest loop:  53%|█████▎    | 129/243 [00:01<00:01, 95.97it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 86.82it/s]backtest loop:  61%|██████    | 148/243 [00:01<00:01, 87.60it/s]backtest loop:  65%|██████▍   | 157/243 [00:01<00:01, 84.38it/s]backtest loop:  68%|██████▊   | 166/243 [00:01<00:00, 81.49it/s]backtest loop:  72%|███████▏  | 175/243 [00:01<00:00, 81.05it/s]backtest loop:  76%|███████▌  | 184/243 [00:02<00:00, 78.70it/s]backtest loop:  79%|███████▉  | 193/243 [00:02<00:00, 77.81it/s]backtest loop:  83%|████████▎ | 202/243 [00:02<00:00, 78.99it/s]backtest loop:  87%|████████▋ | 211/243 [00:02<00:00, 81.48it/s]backtest loop:  91%|█████████ | 221/243 [00:02<00:00, 85.33it/s]backtest loop:  95%|█████████▌| 231/243 [00:02<00:00, 88.77it/s]backtest loop:  99%|█████████▉| 241/243 [00:02<00:00, 91.27it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 87.70it/s]
2026-01-11 19:03:48.371 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0016, Sharpe(w/cost)=-0.0236, MaxDD=-0.0924
2026-01-11 19:03:53.574 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_2_backtest_report.pdf
2026-01-11 19:04:15.706 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:04:15.757 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_2_pred.parquet
2026-01-11 19:04:15.769 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 2 historical models ---
2026-01-11 19:04:15.769 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 2 historical models on fold 2 test data ---
2026-01-11 19:04:18.054 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T2: RankIC=0.0607
2026-01-11 19:04:19.989 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T2: RankIC=0.0496
2026-01-11 19:04:20.274 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0661, ICIR=0.6692, RankIC=0.0587
[1091829:MainThread](2026-01-11 19:04:20,277) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:04:53,310) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:04:53,311) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:04:59,080) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f121c4decd0>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/243 [00:00<00:06, 37.42it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 72.54it/s]backtest loop:  10%|▉         | 24/243 [00:00<00:02, 84.57it/s]backtest loop:  14%|█▎        | 33/243 [00:00<00:02, 86.31it/s]backtest loop:  17%|█▋        | 42/243 [00:00<00:02, 87.04it/s]backtest loop:  21%|██▏       | 52/243 [00:00<00:02, 90.15it/s]backtest loop:  26%|██▌       | 62/243 [00:00<00:02, 87.03it/s]backtest loop:  30%|██▉       | 72/243 [00:00<00:01, 89.71it/s]backtest loop:  34%|███▎      | 82/243 [00:00<00:01, 91.82it/s]backtest loop:  38%|███▊      | 92/243 [00:01<00:01, 93.80it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 95.23it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 96.45it/s]backtest loop:  50%|█████     | 122/243 [00:01<00:01, 96.51it/s]backtest loop:  54%|█████▍    | 132/243 [00:01<00:01, 95.11it/s]backtest loop:  58%|█████▊    | 142/243 [00:01<00:01, 94.50it/s]backtest loop:  63%|██████▎   | 152/243 [00:01<00:00, 93.44it/s]backtest loop:  67%|██████▋   | 162/243 [00:01<00:00, 92.75it/s]backtest loop:  71%|███████   | 172/243 [00:01<00:00, 90.84it/s]backtest loop:  75%|███████▍  | 182/243 [00:02<00:00, 88.39it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 87.16it/s]backtest loop:  82%|████████▏ | 200/243 [00:02<00:00, 84.72it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 82.16it/s]backtest loop:  90%|████████▉ | 218/243 [00:02<00:00, 80.30it/s]backtest loop:  94%|█████████▍| 228/243 [00:02<00:00, 80.18it/s]backtest loop:  98%|█████████▊| 237/243 [00:02<00:00, 82.79it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 87.06it/s]
2026-01-11 19:05:01.892 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0228, Sharpe(w/cost)=0.3257
2026-01-11 19:05:01.958 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:05:01.959 | INFO     | __main__:train_single_fold:554 - Fold 3: train [2013-01-01, 2016-12-31], valid [2017-01-01, 2018-12-31], test [2019-01-01, 2019-12-31]
2026-01-11 19:05:01.959 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:05:01.959 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:06:18,786) INFO - qlib.timer - [log.py:127] - Time cost: 76.825s | Loading data Done
[1091829:MainThread](2026-01-11 19:06:22,464) INFO - qlib.timer - [log.py:127] - Time cost: 3.120s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:06:23,457) INFO - qlib.timer - [log.py:127] - Time cost: 0.993s | Fillna Done
[1091829:MainThread](2026-01-11 19:06:25,174) INFO - qlib.timer - [log.py:127] - Time cost: 0.272s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:06:25,373) INFO - qlib.timer - [log.py:127] - Time cost: 0.198s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:06:25,376) INFO - qlib.timer - [log.py:127] - Time cost: 6.589s | fit & process data Done
[1091829:MainThread](2026-01-11 19:06:25,377) INFO - qlib.timer - [log.py:127] - Time cost: 83.417s | Init data Done
2026-01-11 19:06:25.377 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:06:25,378) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:06:25,378) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:06:25,380) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:06:25,380) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:06:25.385 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:06:26,381) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:06:26,382) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:06:26,383) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:29,118) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:30,661) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991271, valid -0.997003
[1091829:MainThread](2026-01-11 19:06:30,662) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:06:30,663) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:33,357) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:34,975) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.987745, valid -0.996412
[1091829:MainThread](2026-01-11 19:06:34,976) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:06:34,976) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:37,670) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:39,354) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984363, valid -0.994039
[1091829:MainThread](2026-01-11 19:06:39,356) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:06:39,356) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:42,214) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:43,596) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984184, valid -0.994845
[1091829:MainThread](2026-01-11 19:06:43,597) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:06:43,597) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:46,024) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:47,466) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.981673, valid -0.995600
[1091829:MainThread](2026-01-11 19:06:47,467) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:06:47,467) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:50,694) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:52,499) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978638, valid -0.994446
[1091829:MainThread](2026-01-11 19:06:52,499) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:06:52,500) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:06:55,614) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:06:57,857) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978709, valid -0.995453
[1091829:MainThread](2026-01-11 19:06:57,858) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:06:57,858) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:00,722) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:02,181) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.975594, valid -0.995211
[1091829:MainThread](2026-01-11 19:07:02,182) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:07:02,182) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:05,248) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:07,240) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.973878, valid -0.994719
[1091829:MainThread](2026-01-11 19:07:07,241) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:07:07,242) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:10,250) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:11,804) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.972367, valid -0.994516
[1091829:MainThread](2026-01-11 19:07:11,805) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:07:11,805) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:15,300) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:17,264) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.968928, valid -0.995635
[1091829:MainThread](2026-01-11 19:07:17,265) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:07:17,265) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:20,235) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:21,892) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.967850, valid -0.997268
[1091829:MainThread](2026-01-11 19:07:21,892) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:07:21,893) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:24,617) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:26,336) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.965609, valid -0.996411
[1091829:MainThread](2026-01-11 19:07:26,336) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:07:26,337) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:28,932) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:30,631) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964815, valid -1.001084
[1091829:MainThread](2026-01-11 19:07:30,632) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:07:30,632) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:33,744) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:35,231) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.961967, valid -0.997370
[1091829:MainThread](2026-01-11 19:07:35,232) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:07:35,232) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:38,278) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:40,529) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.959807, valid -1.003776
[1091829:MainThread](2026-01-11 19:07:40,530) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:07:40,531) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:43,145) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:44,775) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.957101, valid -1.000764
[1091829:MainThread](2026-01-11 19:07:44,776) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:07:44,776) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:47,277) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:48,808) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.955149, valid -1.000201
[1091829:MainThread](2026-01-11 19:07:48,808) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:07:48,809) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:52,372) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:53,952) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.953340, valid -1.002310
[1091829:MainThread](2026-01-11 19:07:53,953) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:07:53,953) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:07:57,098) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:07:58,928) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.951023, valid -1.001438
[1091829:MainThread](2026-01-11 19:07:58,929) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:07:58,929) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:08:01,830) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:08:03,190) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.948571, valid -1.003951
[1091829:MainThread](2026-01-11 19:08:03,190) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 19:08:03,191) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:08:06,355) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:08:08,083) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.946296, valid -1.002168
[1091829:MainThread](2026-01-11 19:08:08,084) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 19:08:08,084) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:08:10,887) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:08:12,266) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.942430, valid -1.003173
[1091829:MainThread](2026-01-11 19:08:12,267) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:08:12,267) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.994039 @ 2
[1091829:MainThread](2026-01-11 19:08:12,274) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:08:12.525 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:08:17.200 | INFO     | __main__:train_single_fold:592 - Fold 3 Current Model Metrics:
2026-01-11 19:08:17.201 | INFO     | __main__:train_single_fold:593 -   IC=0.0195, ICIR=0.1681, RankIC=0.0357, RankICIR=0.3211
2026-01-11 19:08:17.201 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:08:17,208) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:08:48,926) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:08:48,927) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:08:55,467) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a3a56990>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 29.21it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 73.33it/s]backtest loop:  10%|█         | 25/244 [00:00<00:02, 88.17it/s]backtest loop:  15%|█▍        | 36/244 [00:00<00:02, 94.40it/s]backtest loop:  19%|█▉        | 47/244 [00:00<00:01, 99.09it/s]backtest loop:  23%|██▎       | 57/244 [00:00<00:01, 97.24it/s]backtest loop:  27%|██▋       | 67/244 [00:00<00:01, 92.67it/s]backtest loop:  32%|███▏      | 77/244 [00:00<00:01, 94.27it/s]backtest loop:  36%|███▌      | 88/244 [00:00<00:01, 97.72it/s]backtest loop:  40%|████      | 98/244 [00:01<00:01, 97.67it/s]backtest loop:  44%|████▍     | 108/244 [00:01<00:01, 93.82it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 92.24it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 89.25it/s]backtest loop:  57%|█████▋    | 138/244 [00:01<00:01, 87.67it/s]backtest loop:  61%|██████    | 148/244 [00:01<00:01, 85.02it/s]backtest loop:  65%|██████▍   | 158/244 [00:01<00:01, 83.61it/s]backtest loop:  69%|██████▉   | 168/244 [00:01<00:00, 82.66it/s]backtest loop:  73%|███████▎  | 177/244 [00:02<00:00, 81.00it/s]backtest loop:  76%|███████▌  | 186/244 [00:02<00:00, 80.10it/s]backtest loop:  80%|███████▉  | 195/244 [00:02<00:00, 79.90it/s]backtest loop:  83%|████████▎ | 203/244 [00:02<00:00, 78.96it/s]backtest loop:  87%|████████▋ | 212/244 [00:02<00:00, 78.25it/s]backtest loop:  91%|█████████ | 222/244 [00:02<00:00, 78.94it/s]backtest loop:  95%|█████████▌| 232/244 [00:02<00:00, 79.20it/s]backtest loop:  99%|█████████▉| 242/244 [00:02<00:00, 79.35it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 84.84it/s]
2026-01-11 19:08:58.364 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.1312, Sharpe(w/cost)=-1.9953, MaxDD=-0.1557
2026-01-11 19:09:01.546 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_3_backtest_report.pdf
2026-01-11 19:09:16.746 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:09:16.797 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_3_pred.parquet
2026-01-11 19:09:16.809 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 3 historical models ---
2026-01-11 19:09:16.809 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 3 historical models on fold 3 test data ---
2026-01-11 19:09:19.155 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T3: RankIC=0.0432
2026-01-11 19:09:21.669 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T3: RankIC=0.0481
2026-01-11 19:09:23.638 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T3: RankIC=0.0514
2026-01-11 19:09:23.901 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0278, ICIR=0.2513, RankIC=0.0443
[1091829:MainThread](2026-01-11 19:09:23,905) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:09:54,176) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:09:54,177) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:10:00,485) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f1214aeae10>
backtest loop:   0%|          | 0/244 [00:00<?, ?it/s]backtest loop:   1%|          | 3/244 [00:00<00:08, 29.44it/s]backtest loop:   6%|▌         | 14/244 [00:00<00:03, 73.48it/s]backtest loop:  10%|▉         | 24/244 [00:00<00:02, 84.98it/s]backtest loop:  14%|█▍        | 35/244 [00:00<00:02, 92.63it/s]backtest loop:  18%|█▊        | 45/244 [00:00<00:02, 94.72it/s]backtest loop:  23%|██▎       | 55/244 [00:00<00:01, 96.01it/s]backtest loop:  27%|██▋       | 65/244 [00:00<00:01, 95.50it/s]backtest loop:  31%|███       | 75/244 [00:00<00:01, 93.72it/s]backtest loop:  35%|███▍      | 85/244 [00:00<00:01, 88.35it/s]backtest loop:  39%|███▉      | 96/244 [00:01<00:01, 92.91it/s]backtest loop:  44%|████▍     | 107/244 [00:01<00:01, 96.39it/s]backtest loop:  48%|████▊     | 118/244 [00:01<00:01, 94.69it/s]backtest loop:  52%|█████▏    | 128/244 [00:01<00:01, 95.93it/s]backtest loop:  57%|█████▋    | 139/244 [00:01<00:01, 99.40it/s]backtest loop:  61%|██████▏   | 150/244 [00:01<00:00, 100.85it/s]backtest loop:  66%|██████▌   | 161/244 [00:01<00:00, 103.08it/s]backtest loop:  70%|███████   | 172/244 [00:01<00:00, 100.71it/s]backtest loop:  75%|███████▌  | 183/244 [00:01<00:00, 94.75it/s] backtest loop:  79%|███████▉  | 193/244 [00:02<00:00, 95.73it/s]backtest loop:  83%|████████▎ | 203/244 [00:02<00:00, 95.99it/s]backtest loop:  87%|████████▋ | 213/244 [00:02<00:00, 95.30it/s]backtest loop:  91%|█████████▏| 223/244 [00:02<00:00, 94.98it/s]backtest loop:  95%|█████████▌| 233/244 [00:02<00:00, 95.08it/s]backtest loop: 100%|█████████▉| 243/244 [00:02<00:00, 94.38it/s]backtest loop: 100%|██████████| 244/244 [00:02<00:00, 93.70it/s]
2026-01-11 19:10:03.109 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.1128, Sharpe(w/cost)=-1.7246
2026-01-11 19:10:03.154 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:10:03.154 | INFO     | __main__:train_single_fold:554 - Fold 4: train [2014-01-01, 2017-12-31], valid [2018-01-01, 2019-12-31], test [2020-01-01, 2020-12-31]
2026-01-11 19:10:03.154 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:10:03.154 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:11:13,842) INFO - qlib.timer - [log.py:127] - Time cost: 70.685s | Loading data Done
[1091829:MainThread](2026-01-11 19:11:17,060) INFO - qlib.timer - [log.py:127] - Time cost: 2.681s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:11:18,165) INFO - qlib.timer - [log.py:127] - Time cost: 1.102s | Fillna Done
[1091829:MainThread](2026-01-11 19:11:19,804) INFO - qlib.timer - [log.py:127] - Time cost: 0.280s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:11:19,983) INFO - qlib.timer - [log.py:127] - Time cost: 0.178s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:11:19,986) INFO - qlib.timer - [log.py:127] - Time cost: 6.144s | fit & process data Done
[1091829:MainThread](2026-01-11 19:11:19,986) INFO - qlib.timer - [log.py:127] - Time cost: 76.831s | Init data Done
2026-01-11 19:11:19.987 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:11:19,987) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:11:19,988) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:11:19,990) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:11:19,990) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:11:19.994 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:11:20,923) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:11:20,925) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:11:20,925) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:23,299) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:24,621) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991463, valid -0.997007
[1091829:MainThread](2026-01-11 19:11:24,622) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:11:24,623) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:27,070) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:28,550) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.988883, valid -0.995409
[1091829:MainThread](2026-01-11 19:11:28,551) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:11:28,551) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:30,979) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:32,268) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.986531, valid -0.996441
[1091829:MainThread](2026-01-11 19:11:32,268) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:11:32,269) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:34,538) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:35,830) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984598, valid -0.995260
[1091829:MainThread](2026-01-11 19:11:35,831) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:11:35,831) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:38,364) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:39,705) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982742, valid -0.997160
[1091829:MainThread](2026-01-11 19:11:39,705) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:11:39,705) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:42,001) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:43,333) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.981056, valid -0.996581
[1091829:MainThread](2026-01-11 19:11:43,333) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:11:43,334) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:46,030) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:47,389) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.980917, valid -0.998279
[1091829:MainThread](2026-01-11 19:11:47,389) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:11:47,390) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:49,698) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:51,008) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.976814, valid -0.997581
[1091829:MainThread](2026-01-11 19:11:51,009) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:11:51,009) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:53,958) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:55,600) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.975075, valid -0.997880
[1091829:MainThread](2026-01-11 19:11:55,601) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:11:55,602) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:11:57,997) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:11:59,304) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.973624, valid -1.001009
[1091829:MainThread](2026-01-11 19:11:59,304) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:11:59,304) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:01,966) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:03,363) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.972285, valid -0.999619
[1091829:MainThread](2026-01-11 19:12:03,364) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:12:03,364) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:05,793) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:07,291) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969651, valid -1.002086
[1091829:MainThread](2026-01-11 19:12:07,292) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:12:07,292) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:09,689) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:11,207) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.967910, valid -1.001007
[1091829:MainThread](2026-01-11 19:12:11,213) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:12:11,213) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:13,683) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:15,029) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.965671, valid -1.000486
[1091829:MainThread](2026-01-11 19:12:15,030) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:12:15,030) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:17,601) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:19,072) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964307, valid -1.004394
[1091829:MainThread](2026-01-11 19:12:19,073) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:12:19,073) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:21,425) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:22,937) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.961326, valid -1.004208
[1091829:MainThread](2026-01-11 19:12:22,938) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:12:22,938) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:25,216) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:26,867) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.959771, valid -1.004658
[1091829:MainThread](2026-01-11 19:12:26,868) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:12:26,868) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:29,597) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:30,904) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.957082, valid -1.006633
[1091829:MainThread](2026-01-11 19:12:30,904) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:12:30,905) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:33,551) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:35,053) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.953553, valid -1.006655
[1091829:MainThread](2026-01-11 19:12:35,054) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:12:35,055) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:37,564) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:38,947) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.952586, valid -1.008239
[1091829:MainThread](2026-01-11 19:12:38,947) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:12:38,948) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:41,179) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:42,529) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.949974, valid -1.007954
[1091829:MainThread](2026-01-11 19:12:42,530) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 19:12:42,530) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:45,162) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:46,496) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.946949, valid -1.010537
[1091829:MainThread](2026-01-11 19:12:46,496) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 19:12:46,496) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:48,910) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:50,283) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.944493, valid -1.012781
[1091829:MainThread](2026-01-11 19:12:50,283) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch23:
[1091829:MainThread](2026-01-11 19:12:50,284) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:12:52,513) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:12:53,865) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.942107, valid -1.012830
[1091829:MainThread](2026-01-11 19:12:53,866) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:12:53,866) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.995260 @ 3
[1091829:MainThread](2026-01-11 19:12:53,875) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:12:54.121 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:12:56.321 | INFO     | __main__:train_single_fold:592 - Fold 4 Current Model Metrics:
2026-01-11 19:12:56.321 | INFO     | __main__:train_single_fold:593 -   IC=0.0267, ICIR=0.2109, RankIC=0.0463, RankICIR=0.3801
2026-01-11 19:12:56.321 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:12:56,327) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:13:26,756) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:13:26,757) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:13:32,529) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a0de6990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 27.67it/s]backtest loop:   6%|▌         | 14/243 [00:00<00:03, 71.82it/s]backtest loop:  10%|█         | 25/243 [00:00<00:02, 86.82it/s]backtest loop:  15%|█▍        | 36/243 [00:00<00:02, 90.81it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 93.06it/s]backtest loop:  23%|██▎       | 56/243 [00:00<00:01, 95.17it/s]backtest loop:  27%|██▋       | 66/243 [00:00<00:01, 95.57it/s]backtest loop:  31%|███▏      | 76/243 [00:00<00:01, 96.12it/s]backtest loop:  35%|███▌      | 86/243 [00:00<00:01, 96.06it/s]backtest loop:  40%|███▉      | 96/243 [00:01<00:01, 96.12it/s]backtest loop:  44%|████▎     | 106/243 [00:01<00:01, 96.10it/s]backtest loop:  48%|████▊     | 116/243 [00:01<00:01, 92.12it/s]backtest loop:  52%|█████▏    | 126/243 [00:01<00:01, 94.11it/s]backtest loop:  56%|█████▌    | 136/243 [00:01<00:01, 91.75it/s]backtest loop:  60%|██████    | 146/243 [00:01<00:01, 93.15it/s]backtest loop:  64%|██████▍   | 156/243 [00:01<00:00, 94.72it/s]backtest loop:  68%|██████▊   | 166/243 [00:01<00:00, 95.57it/s]backtest loop:  72%|███████▏  | 176/243 [00:01<00:00, 95.58it/s]backtest loop:  77%|███████▋  | 186/243 [00:02<00:00, 92.17it/s]backtest loop:  81%|████████  | 196/243 [00:02<00:00, 93.35it/s]backtest loop:  85%|████████▍ | 206/243 [00:02<00:00, 94.13it/s]backtest loop:  89%|████████▉ | 216/243 [00:02<00:00, 95.31it/s]backtest loop:  93%|█████████▎| 226/243 [00:02<00:00, 95.07it/s]backtest loop:  97%|█████████▋| 236/243 [00:02<00:00, 95.95it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 92.62it/s]
2026-01-11 19:13:35.174 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0054, Sharpe(w/cost)=0.0632, MaxDD=-0.1059
2026-01-11 19:13:40.171 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_4_backtest_report.pdf
2026-01-11 19:13:55.999 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:13:56.058 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_4_pred.parquet
2026-01-11 19:13:56.071 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 4 historical models ---
2026-01-11 19:13:56.071 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 4 historical models on fold 4 test data ---
2026-01-11 19:13:58.829 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T4: RankIC=0.0391
2026-01-11 19:14:01.639 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T4: RankIC=0.0473
2026-01-11 19:14:05.531 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T4: RankIC=0.0461
2026-01-11 19:14:07.767 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T4: RankIC=0.0439
2026-01-11 19:14:08.096 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0299, ICIR=0.2340, RankIC=0.0487
[1091829:MainThread](2026-01-11 19:14:08,101) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:14:46,866) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:14:46,867) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:14:53,955) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a75ae990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:08, 28.00it/s]backtest loop:   6%|▌         | 15/243 [00:00<00:02, 77.90it/s]backtest loop:  11%|█         | 26/243 [00:00<00:02, 87.75it/s]backtest loop:  15%|█▌        | 37/243 [00:00<00:02, 94.45it/s]backtest loop:  19%|█▉        | 47/243 [00:00<00:02, 93.39it/s]backtest loop:  23%|██▎       | 57/243 [00:00<00:02, 90.47it/s]backtest loop:  28%|██▊       | 67/243 [00:00<00:02, 86.43it/s]backtest loop:  31%|███▏      | 76/243 [00:00<00:01, 83.57it/s]backtest loop:  35%|███▍      | 85/243 [00:01<00:01, 80.98it/s]backtest loop:  39%|███▊      | 94/243 [00:01<00:01, 79.70it/s]backtest loop:  42%|████▏     | 102/243 [00:01<00:01, 78.24it/s]backtest loop:  46%|████▌     | 112/243 [00:01<00:01, 78.41it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 76.99it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 78.11it/s]backtest loop:  57%|█████▋    | 139/243 [00:01<00:01, 81.22it/s]backtest loop:  61%|██████    | 148/243 [00:01<00:01, 80.21it/s]backtest loop:  65%|██████▍   | 157/243 [00:01<00:01, 78.64it/s]backtest loop:  68%|██████▊   | 165/243 [00:02<00:00, 78.24it/s]backtest loop:  72%|███████▏  | 174/243 [00:02<00:00, 80.16it/s]backtest loop:  75%|███████▌  | 183/243 [00:02<00:00, 75.70it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 75.00it/s]backtest loop:  82%|████████▏ | 199/243 [00:02<00:00, 75.03it/s]backtest loop:  86%|████████▌ | 209/243 [00:02<00:00, 76.35it/s]backtest loop:  90%|█████████ | 219/243 [00:02<00:00, 80.58it/s]backtest loop:  94%|█████████▍| 229/243 [00:02<00:00, 83.11it/s]backtest loop:  98%|█████████▊| 239/243 [00:02<00:00, 83.46it/s]backtest loop: 100%|██████████| 243/243 [00:03<00:00, 80.53it/s]
2026-01-11 19:14:56.996 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1141, Sharpe(w/cost)=1.3685
2026-01-11 19:14:57.147 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:14:57.147 | INFO     | __main__:train_single_fold:554 - Fold 5: train [2015-01-01, 2018-12-31], valid [2019-01-01, 2020-12-31], test [2021-01-01, 2021-12-31]
2026-01-11 19:14:57.147 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:14:57.147 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:16:15,747) INFO - qlib.timer - [log.py:127] - Time cost: 78.596s | Loading data Done
[1091829:MainThread](2026-01-11 19:16:18,871) INFO - qlib.timer - [log.py:127] - Time cost: 2.623s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:16:20,135) INFO - qlib.timer - [log.py:127] - Time cost: 1.263s | Fillna Done
[1091829:MainThread](2026-01-11 19:16:21,662) INFO - qlib.timer - [log.py:127] - Time cost: 0.315s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:16:21,865) INFO - qlib.timer - [log.py:127] - Time cost: 0.202s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:16:21,868) INFO - qlib.timer - [log.py:127] - Time cost: 6.121s | fit & process data Done
[1091829:MainThread](2026-01-11 19:16:21,869) INFO - qlib.timer - [log.py:127] - Time cost: 84.719s | Init data Done
2026-01-11 19:16:21.869 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:16:21,870) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:16:21,870) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:16:21,873) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:16:21,873) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:16:21.878 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:16:22,873) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:16:22,875) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:16:22,875) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:25,371) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:26,623) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.993499, valid -0.995901
[1091829:MainThread](2026-01-11 19:16:26,624) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:16:26,624) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:29,078) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:30,331) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.990117, valid -0.996467
[1091829:MainThread](2026-01-11 19:16:30,332) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:16:30,332) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:32,874) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:34,611) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.987631, valid -0.996424
[1091829:MainThread](2026-01-11 19:16:34,611) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:16:34,612) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:37,158) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:38,336) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.985628, valid -0.996535
[1091829:MainThread](2026-01-11 19:16:38,336) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:16:38,337) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:41,237) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:42,500) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984899, valid -0.996400
[1091829:MainThread](2026-01-11 19:16:42,500) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:16:42,501) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:44,843) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:46,056) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982442, valid -0.998773
[1091829:MainThread](2026-01-11 19:16:46,057) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:16:46,057) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:48,360) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:49,523) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.981165, valid -0.997751
[1091829:MainThread](2026-01-11 19:16:49,524) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:16:49,524) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:51,883) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:53,040) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.979906, valid -0.997770
[1091829:MainThread](2026-01-11 19:16:53,041) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:16:53,041) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:55,370) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:56,518) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978001, valid -0.998653
[1091829:MainThread](2026-01-11 19:16:56,518) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:16:56,518) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:16:58,796) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:16:59,946) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.976465, valid -1.000138
[1091829:MainThread](2026-01-11 19:16:59,946) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:16:59,947) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:02,257) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:03,410) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.974269, valid -0.999932
[1091829:MainThread](2026-01-11 19:17:03,410) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:17:03,411) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:05,696) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:06,850) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.973446, valid -0.999211
[1091829:MainThread](2026-01-11 19:17:06,850) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:17:06,851) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:09,220) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:10,528) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.970587, valid -0.999511
[1091829:MainThread](2026-01-11 19:17:10,528) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:17:10,529) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:12,804) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:13,951) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.968729, valid -1.001240
[1091829:MainThread](2026-01-11 19:17:13,951) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:17:13,952) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:16,209) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:17,361) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.965182, valid -1.002511
[1091829:MainThread](2026-01-11 19:17:17,362) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:17:17,362) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:19,687) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:21,031) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.963616, valid -1.001873
[1091829:MainThread](2026-01-11 19:17:21,032) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:17:21,032) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:23,305) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:24,508) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964318, valid -1.007749
[1091829:MainThread](2026-01-11 19:17:24,509) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:17:24,509) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:27,251) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:28,486) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.959783, valid -1.005077
[1091829:MainThread](2026-01-11 19:17:28,487) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:17:28,487) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:30,941) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:32,201) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.957614, valid -1.005586
[1091829:MainThread](2026-01-11 19:17:32,202) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:17:32,202) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:34,637) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:35,874) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.955635, valid -1.008952
[1091829:MainThread](2026-01-11 19:17:35,874) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:17:35,874) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:17:38,245) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:17:39,490) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.952978, valid -1.008280
[1091829:MainThread](2026-01-11 19:17:39,490) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:17:39,490) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.995901 @ 0
[1091829:MainThread](2026-01-11 19:17:39,524) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:17:39.759 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:17:42.272 | INFO     | __main__:train_single_fold:592 - Fold 5 Current Model Metrics:
2026-01-11 19:17:42.272 | INFO     | __main__:train_single_fold:593 -   IC=0.0168, ICIR=0.1113, RankIC=0.0386, RankICIR=0.2512
2026-01-11 19:17:42.272 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:17:42,280) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:18:17,739) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:18:17,740) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:18:23,827) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a0b46990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   1%|          | 3/243 [00:00<00:09, 26.03it/s]backtest loop:   5%|▍         | 12/243 [00:00<00:03, 59.64it/s]backtest loop:   9%|▉         | 22/243 [00:00<00:02, 75.79it/s]backtest loop:  12%|█▏        | 30/243 [00:00<00:02, 76.19it/s]backtest loop:  16%|█▋        | 40/243 [00:00<00:02, 83.69it/s]backtest loop:  21%|██        | 50/243 [00:00<00:02, 87.72it/s]backtest loop:  25%|██▍       | 60/243 [00:00<00:02, 90.76it/s]backtest loop:  29%|██▉       | 70/243 [00:00<00:01, 92.64it/s]backtest loop:  33%|███▎      | 80/243 [00:00<00:01, 93.54it/s]backtest loop:  37%|███▋      | 90/243 [00:01<00:01, 94.64it/s]backtest loop:  41%|████      | 100/243 [00:01<00:01, 95.13it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 91.83it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 93.04it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 94.19it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 95.22it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:00, 95.39it/s]backtest loop:  66%|██████▌   | 160/243 [00:01<00:00, 95.72it/s]backtest loop:  70%|██████▉   | 170/243 [00:01<00:00, 96.04it/s]backtest loop:  74%|███████▍  | 180/243 [00:01<00:00, 97.11it/s]backtest loop:  78%|███████▊  | 190/243 [00:02<00:00, 93.14it/s]backtest loop:  82%|████████▏ | 200/243 [00:02<00:00, 93.57it/s]backtest loop:  86%|████████▋ | 210/243 [00:02<00:00, 94.59it/s]backtest loop:  91%|█████████ | 220/243 [00:02<00:00, 93.91it/s]backtest loop:  95%|█████████▍| 230/243 [00:02<00:00, 94.95it/s]backtest loop:  99%|█████████▉| 240/243 [00:02<00:00, 94.92it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 90.90it/s]
2026-01-11 19:18:26.520 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=-0.0360, Sharpe(w/cost)=-0.2926, MaxDD=-0.1776
2026-01-11 19:18:31.387 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_5_backtest_report.pdf
2026-01-11 19:18:51.524 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:18:51.648 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_5_pred.parquet
2026-01-11 19:18:51.663 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 5 historical models ---
2026-01-11 19:18:51.663 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 5 historical models on fold 5 test data ---
2026-01-11 19:18:54.258 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T5: RankIC=0.0261
2026-01-11 19:18:56.029 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T5: RankIC=0.0301
2026-01-11 19:18:58.077 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T5: RankIC=0.0265
2026-01-11 19:19:00.203 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T5: RankIC=0.0351
2026-01-11 19:19:02.409 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T5: RankIC=0.0362
2026-01-11 19:19:02.682 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0171, ICIR=0.1248, RankIC=0.0411
[1091829:MainThread](2026-01-11 19:19:02,686) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:19:38,604) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:19:38,610) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:19:44,777) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a187e990>
backtest loop:   0%|          | 0/243 [00:00<?, ?it/s]backtest loop:   2%|▏         | 5/243 [00:00<00:05, 45.35it/s]backtest loop:   7%|▋         | 16/243 [00:00<00:02, 81.05it/s]backtest loop:  10%|█         | 25/243 [00:00<00:02, 83.60it/s]backtest loop:  14%|█▍        | 35/243 [00:00<00:02, 84.10it/s]backtest loop:  19%|█▉        | 46/243 [00:00<00:02, 90.97it/s]backtest loop:  24%|██▍       | 58/243 [00:00<00:01, 98.28it/s]backtest loop:  28%|██▊       | 69/243 [00:00<00:01, 96.12it/s]backtest loop:  33%|███▎      | 80/243 [00:00<00:01, 99.43it/s]backtest loop:  37%|███▋      | 90/243 [00:00<00:01, 98.94it/s]backtest loop:  41%|████      | 100/243 [00:01<00:01, 99.16it/s]backtest loop:  45%|████▌     | 110/243 [00:01<00:01, 94.49it/s]backtest loop:  49%|████▉     | 120/243 [00:01<00:01, 95.10it/s]backtest loop:  53%|█████▎    | 130/243 [00:01<00:01, 96.00it/s]backtest loop:  58%|█████▊    | 140/243 [00:01<00:01, 96.87it/s]backtest loop:  62%|██████▏   | 150/243 [00:01<00:00, 97.16it/s]backtest loop:  66%|██████▌   | 160/243 [00:01<00:00, 97.44it/s]backtest loop:  70%|██████▉   | 170/243 [00:01<00:00, 97.52it/s]backtest loop:  74%|███████▍  | 181/243 [00:01<00:00, 99.20it/s]backtest loop:  79%|███████▊  | 191/243 [00:02<00:00, 95.16it/s]backtest loop:  83%|████████▎ | 201/243 [00:02<00:00, 95.76it/s]backtest loop:  87%|████████▋ | 211/243 [00:02<00:00, 96.61it/s]backtest loop:  91%|█████████ | 221/243 [00:02<00:00, 96.66it/s]backtest loop:  95%|█████████▌| 231/243 [00:02<00:00, 97.10it/s]backtest loop:  99%|█████████▉| 241/243 [00:02<00:00, 97.22it/s]backtest loop: 100%|██████████| 243/243 [00:02<00:00, 94.76it/s]
2026-01-11 19:19:47.356 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=-0.0149, Sharpe(w/cost)=-0.1368
2026-01-11 19:19:47.394 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:19:47.394 | INFO     | __main__:train_single_fold:554 - Fold 6: train [2016-01-01, 2019-12-31], valid [2020-01-01, 2021-12-31], test [2022-01-01, 2022-12-31]
2026-01-11 19:19:47.394 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:19:47.395 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:21:17,946) INFO - qlib.timer - [log.py:127] - Time cost: 90.550s | Loading data Done
[1091829:MainThread](2026-01-11 19:21:21,454) INFO - qlib.timer - [log.py:127] - Time cost: 2.928s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:21:22,691) INFO - qlib.timer - [log.py:127] - Time cost: 1.236s | Fillna Done
[1091829:MainThread](2026-01-11 19:21:24,417) INFO - qlib.timer - [log.py:127] - Time cost: 0.321s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:21:24,606) INFO - qlib.timer - [log.py:127] - Time cost: 0.188s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:21:24,609) INFO - qlib.timer - [log.py:127] - Time cost: 6.662s | fit & process data Done
[1091829:MainThread](2026-01-11 19:21:24,609) INFO - qlib.timer - [log.py:127] - Time cost: 97.213s | Init data Done
2026-01-11 19:21:24.609 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:21:24,610) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:21:24,611) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:21:24,613) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:21:24,613) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:21:24.618 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:21:25,569) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:21:25,571) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:21:25,571) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:28,391) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:30,040) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.992824, valid -0.998788
[1091829:MainThread](2026-01-11 19:21:30,041) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:21:30,041) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:32,838) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:34,226) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.992050, valid -0.997772
[1091829:MainThread](2026-01-11 19:21:34,227) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:21:34,227) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:36,879) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:38,420) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.990445, valid -0.997614
[1091829:MainThread](2026-01-11 19:21:38,422) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:21:38,423) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:41,155) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:42,528) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.989791, valid -0.999157
[1091829:MainThread](2026-01-11 19:21:42,529) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:21:42,529) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:45,058) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:46,355) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.988650, valid -1.002863
[1091829:MainThread](2026-01-11 19:21:46,355) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:21:46,356) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:49,060) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:50,302) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.987694, valid -0.999778
[1091829:MainThread](2026-01-11 19:21:50,302) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:21:50,302) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:52,926) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:54,220) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.986605, valid -1.000730
[1091829:MainThread](2026-01-11 19:21:54,220) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:21:54,221) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:21:56,789) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:21:58,179) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.985364, valid -1.001246
[1091829:MainThread](2026-01-11 19:21:58,179) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:21:58,179) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:00,727) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:02,050) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984708, valid -1.001454
[1091829:MainThread](2026-01-11 19:22:02,050) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:22:02,051) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:04,592) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:05,895) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984015, valid -1.001987
[1091829:MainThread](2026-01-11 19:22:05,896) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:22:05,896) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:08,473) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:09,726) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.983222, valid -1.003221
[1091829:MainThread](2026-01-11 19:22:09,727) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:22:09,727) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:12,224) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:13,532) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.980931, valid -1.002575
[1091829:MainThread](2026-01-11 19:22:13,532) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:22:13,533) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:15,932) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:17,313) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.979821, valid -1.005853
[1091829:MainThread](2026-01-11 19:22:17,314) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:22:17,314) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:20,130) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:21,379) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978360, valid -1.005816
[1091829:MainThread](2026-01-11 19:22:21,380) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:22:21,380) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:23,967) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:25,197) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.976572, valid -1.009369
[1091829:MainThread](2026-01-11 19:22:25,197) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:22:25,197) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:27,840) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:29,179) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.973873, valid -1.007188
[1091829:MainThread](2026-01-11 19:22:29,180) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:22:29,180) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:31,637) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:32,922) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.972251, valid -1.007551
[1091829:MainThread](2026-01-11 19:22:32,923) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:22:32,923) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:35,470) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:36,773) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.970227, valid -1.011290
[1091829:MainThread](2026-01-11 19:22:36,774) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:22:36,774) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:40,051) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:41,343) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.968859, valid -1.010326
[1091829:MainThread](2026-01-11 19:22:41,343) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:22:41,344) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:43,910) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:45,456) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.966416, valid -1.019079
[1091829:MainThread](2026-01-11 19:22:45,461) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:22:45,461) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:48,040) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:49,338) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.962708, valid -1.016293
[1091829:MainThread](2026-01-11 19:22:49,339) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 19:22:49,339) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:52,004) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:53,272) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.959488, valid -1.018694
[1091829:MainThread](2026-01-11 19:22:53,273) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 19:22:53,273) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:22:55,737) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:22:57,042) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.958188, valid -1.029276
[1091829:MainThread](2026-01-11 19:22:57,042) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:22:57,042) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.997614 @ 2
[1091829:MainThread](2026-01-11 19:22:57,049) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:22:57.262 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:22:59.456 | INFO     | __main__:train_single_fold:592 - Fold 6 Current Model Metrics:
2026-01-11 19:22:59.457 | INFO     | __main__:train_single_fold:593 -   IC=0.0289, ICIR=0.2298, RankIC=0.0515, RankICIR=0.4114
2026-01-11 19:22:59.457 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:22:59,462) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:23:38,201) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:23:38,202) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:23:45,910) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a5a0af50>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:08, 28.77it/s]backtest loop:   5%|▌         | 13/242 [00:00<00:03, 67.90it/s]backtest loop:  10%|▉         | 23/242 [00:00<00:02, 81.17it/s]backtest loop:  14%|█▍        | 34/242 [00:00<00:02, 88.17it/s]backtest loop:  19%|█▉        | 46/242 [00:00<00:02, 97.34it/s]backtest loop:  24%|██▍       | 58/242 [00:00<00:01, 104.21it/s]backtest loop:  29%|██▊       | 69/242 [00:00<00:01, 102.24it/s]backtest loop:  33%|███▎      | 80/242 [00:00<00:01, 101.65it/s]backtest loop:  38%|███▊      | 92/242 [00:00<00:01, 105.87it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 104.12it/s]backtest loop:  48%|████▊     | 115/242 [00:01<00:01, 107.18it/s]backtest loop:  52%|█████▏    | 126/242 [00:01<00:01, 107.83it/s]backtest loop:  57%|█████▋    | 137/242 [00:01<00:00, 107.25it/s]backtest loop:  61%|██████    | 148/242 [00:01<00:00, 104.49it/s]backtest loop:  66%|██████▌   | 160/242 [00:01<00:00, 108.57it/s]backtest loop:  71%|███████   | 172/242 [00:01<00:00, 106.52it/s]backtest loop:  76%|███████▌  | 184/242 [00:01<00:00, 109.09it/s]backtest loop:  81%|████████  | 196/242 [00:01<00:00, 111.11it/s]backtest loop:  86%|████████▌ | 208/242 [00:02<00:00, 108.82it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 111.09it/s]backtest loop:  96%|█████████▌| 232/242 [00:02<00:00, 108.94it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 103.58it/s]
2026-01-11 19:23:48.264 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.1591, Sharpe(w/cost)=2.1173, MaxDD=-0.0471
2026-01-11 19:23:51.831 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_6_backtest_report.pdf
2026-01-11 19:24:13.372 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:24:13.424 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_6_pred.parquet
2026-01-11 19:24:13.440 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 6 historical models ---
2026-01-11 19:24:13.440 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 6 historical models on fold 6 test data ---
2026-01-11 19:24:15.686 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T6: RankIC=0.0414
2026-01-11 19:24:17.735 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T6: RankIC=0.0400
2026-01-11 19:24:19.741 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T6: RankIC=0.0376
2026-01-11 19:24:22.214 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T6: RankIC=0.0435
2026-01-11 19:24:23.961 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T6: RankIC=0.0465
2026-01-11 19:24:26.059 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T6: RankIC=0.0434
2026-01-11 19:24:26.384 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0296, ICIR=0.2338, RankIC=0.0530
[1091829:MainThread](2026-01-11 19:24:26,389) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:25:04,102) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:25:04,103) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:25:11,029) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a2f06990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:08, 28.76it/s]backtest loop:   5%|▍         | 12/242 [00:00<00:03, 63.87it/s]backtest loop:   9%|▉         | 22/242 [00:00<00:02, 78.17it/s]backtest loop:  13%|█▎        | 32/242 [00:00<00:02, 84.31it/s]backtest loop:  17%|█▋        | 42/242 [00:00<00:02, 88.10it/s]backtest loop:  21%|██▏       | 52/242 [00:00<00:02, 90.53it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:02, 88.37it/s]backtest loop:  30%|██▉       | 72/242 [00:00<00:01, 89.31it/s]backtest loop:  34%|███▍      | 82/242 [00:00<00:01, 91.25it/s]backtest loop:  38%|███▊      | 92/242 [00:01<00:01, 91.38it/s]backtest loop:  42%|████▏     | 102/242 [00:01<00:01, 92.57it/s]backtest loop:  46%|████▋     | 112/242 [00:01<00:01, 92.59it/s]backtest loop:  50%|█████     | 122/242 [00:01<00:01, 93.31it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 93.86it/s]backtest loop:  59%|█████▊    | 142/242 [00:01<00:01, 94.48it/s]backtest loop:  63%|██████▎   | 152/242 [00:01<00:00, 94.34it/s]backtest loop:  67%|██████▋   | 163/242 [00:01<00:00, 95.57it/s]backtest loop:  72%|███████▏  | 175/242 [00:01<00:00, 101.21it/s]backtest loop:  77%|███████▋  | 187/242 [00:02<00:00, 100.94it/s]backtest loop:  82%|████████▏ | 198/242 [00:02<00:00, 102.42it/s]backtest loop:  86%|████████▋ | 209/242 [00:02<00:00, 103.55it/s]backtest loop:  91%|█████████ | 220/242 [00:02<00:00, 104.63it/s]backtest loop:  95%|█████████▌| 231/242 [00:02<00:00, 105.82it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 95.67it/s] backtest loop: 100%|██████████| 242/242 [00:02<00:00, 93.38it/s]
2026-01-11 19:25:13.639 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.1346, Sharpe(w/cost)=1.8302
2026-01-11 19:25:13.684 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:25:13.684 | INFO     | __main__:train_single_fold:554 - Fold 7: train [2017-01-01, 2020-12-31], valid [2021-01-01, 2022-12-31], test [2023-01-01, 2023-12-31]
2026-01-11 19:25:13.684 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:25:13.684 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:26:36,923) INFO - qlib.timer - [log.py:127] - Time cost: 83.236s | Loading data Done
[1091829:MainThread](2026-01-11 19:26:39,844) INFO - qlib.timer - [log.py:127] - Time cost: 2.267s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:26:40,723) INFO - qlib.timer - [log.py:127] - Time cost: 0.879s | Fillna Done
[1091829:MainThread](2026-01-11 19:26:42,255) INFO - qlib.timer - [log.py:127] - Time cost: 0.297s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:26:42,433) INFO - qlib.timer - [log.py:127] - Time cost: 0.177s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:26:42,435) INFO - qlib.timer - [log.py:127] - Time cost: 5.512s | fit & process data Done
[1091829:MainThread](2026-01-11 19:26:42,436) INFO - qlib.timer - [log.py:127] - Time cost: 88.750s | Init data Done
2026-01-11 19:26:42.436 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:26:42,437) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:26:42,437) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:26:42,439) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:26:42,439) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:26:42.443 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:26:43,370) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:26:43,371) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:26:43,372) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:26:46,264) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:26:48,044) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.995843, valid -0.997923
[1091829:MainThread](2026-01-11 19:26:48,045) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:26:48,045) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:26:51,092) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:26:52,528) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.993115, valid -0.995854
[1091829:MainThread](2026-01-11 19:26:52,529) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:26:52,529) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:26:55,562) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:26:57,341) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.992440, valid -0.995444
[1091829:MainThread](2026-01-11 19:26:57,343) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:26:57,343) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:00,052) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:01,446) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991864, valid -0.995825
[1091829:MainThread](2026-01-11 19:27:01,446) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:27:01,447) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:04,356) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:06,219) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.990932, valid -0.995454
[1091829:MainThread](2026-01-11 19:27:06,219) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:27:06,220) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:09,399) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:11,194) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.990773, valid -0.996873
[1091829:MainThread](2026-01-11 19:27:11,195) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:27:11,195) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:14,157) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:15,562) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.990574, valid -0.997647
[1091829:MainThread](2026-01-11 19:27:15,562) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:27:15,563) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:18,676) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:20,463) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.989395, valid -0.997640
[1091829:MainThread](2026-01-11 19:27:20,463) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:27:20,464) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:23,417) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:24,896) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.987543, valid -0.998189
[1091829:MainThread](2026-01-11 19:27:24,897) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:27:24,897) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:27,966) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:29,337) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.986969, valid -0.999650
[1091829:MainThread](2026-01-11 19:27:29,338) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:27:29,338) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:32,279) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:34,050) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.986107, valid -0.999938
[1091829:MainThread](2026-01-11 19:27:34,050) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:27:34,051) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:37,194) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:38,636) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984363, valid -1.001482
[1091829:MainThread](2026-01-11 19:27:38,636) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:27:38,637) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:41,329) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:43,102) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.983339, valid -1.003900
[1091829:MainThread](2026-01-11 19:27:43,103) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:27:43,103) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:46,376) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:47,840) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982439, valid -1.003431
[1091829:MainThread](2026-01-11 19:27:47,840) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:27:47,841) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:50,504) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:52,258) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.980458, valid -1.005119
[1091829:MainThread](2026-01-11 19:27:52,259) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:27:52,259) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:54,806) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:27:56,261) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.977554, valid -1.006398
[1091829:MainThread](2026-01-11 19:27:56,262) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:27:56,262) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:27:59,496) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:01,280) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.977099, valid -1.006490
[1091829:MainThread](2026-01-11 19:28:01,280) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:28:01,281) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:28:03,786) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:05,262) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.973898, valid -1.010421
[1091829:MainThread](2026-01-11 19:28:05,263) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:28:05,263) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:28:08,494) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:10,131) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.971746, valid -1.009830
[1091829:MainThread](2026-01-11 19:28:10,132) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:28:10,132) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:28:12,544) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:14,208) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.969461, valid -1.011984
[1091829:MainThread](2026-01-11 19:28:14,209) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:28:14,210) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:28:16,781) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:18,215) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.968667, valid -1.013964
[1091829:MainThread](2026-01-11 19:28:18,215) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 19:28:18,216) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:28:21,532) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:23,324) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964991, valid -1.016321
[1091829:MainThread](2026-01-11 19:28:23,325) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 19:28:23,326) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:28:26,093) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:28:27,498) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.962028, valid -1.017335
[1091829:MainThread](2026-01-11 19:28:27,498) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:28:27,499) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.995444 @ 2
[1091829:MainThread](2026-01-11 19:28:27,506) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:28:27.760 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:28:32.487 | INFO     | __main__:train_single_fold:592 - Fold 7 Current Model Metrics:
2026-01-11 19:28:32.488 | INFO     | __main__:train_single_fold:593 -   IC=0.0144, ICIR=0.0995, RankIC=0.0450, RankICIR=0.3632
2026-01-11 19:28:32.488 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:28:32,501) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:29:16,213) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:29:16,214) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:29:24,837) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a0ff2f50>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 20.98it/s]backtest loop:   4%|▍         | 10/242 [00:00<00:05, 45.06it/s]backtest loop:   8%|▊         | 19/242 [00:00<00:03, 59.81it/s]backtest loop:  12%|█▏        | 29/242 [00:00<00:03, 67.89it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 72.40it/s]backtest loop:  20%|█▉        | 48/242 [00:00<00:02, 77.55it/s]backtest loop:  23%|██▎       | 56/242 [00:00<00:02, 76.64it/s]backtest loop:  26%|██▋       | 64/242 [00:00<00:02, 73.04it/s]backtest loop:  30%|███       | 73/242 [00:01<00:02, 74.36it/s]backtest loop:  33%|███▎      | 81/242 [00:01<00:02, 74.65it/s]backtest loop:  37%|███▋      | 90/242 [00:01<00:02, 75.81it/s]backtest loop:  41%|████▏     | 100/242 [00:01<00:01, 77.30it/s]backtest loop:  45%|████▌     | 109/242 [00:01<00:01, 80.12it/s]backtest loop:  49%|████▉     | 118/242 [00:01<00:01, 73.65it/s]backtest loop:  52%|█████▏    | 127/242 [00:01<00:01, 76.52it/s]backtest loop:  56%|█████▌    | 135/242 [00:01<00:01, 74.18it/s]backtest loop:  60%|█████▉    | 145/242 [00:01<00:01, 79.63it/s]backtest loop:  64%|██████▍   | 155/242 [00:02<00:01, 84.21it/s]backtest loop:  68%|██████▊   | 165/242 [00:02<00:00, 87.61it/s]backtest loop:  72%|███████▏  | 175/242 [00:02<00:00, 90.02it/s]backtest loop:  76%|███████▋  | 185/242 [00:02<00:00, 92.86it/s]backtest loop:  81%|████████  | 196/242 [00:02<00:00, 96.63it/s]backtest loop:  86%|████████▌ | 207/242 [00:02<00:00, 95.35it/s]backtest loop:  90%|█████████ | 218/242 [00:02<00:00, 98.58it/s]backtest loop:  95%|█████████▍| 229/242 [00:02<00:00, 100.33it/s]backtest loop:  99%|█████████▉| 240/242 [00:02<00:00, 101.88it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 81.88it/s] 
2026-01-11 19:29:27.813 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0325, Sharpe(w/cost)=0.4779, MaxDD=-0.0616
2026-01-11 19:29:31.280 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_7_backtest_report.pdf
2026-01-11 19:29:57.287 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:29:57.338 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_7_pred.parquet
2026-01-11 19:29:57.351 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 7 historical models ---
2026-01-11 19:29:57.351 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 7 historical models on fold 7 test data ---
2026-01-11 19:29:59.768 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T7: RankIC=0.0213
2026-01-11 19:30:01.860 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T7: RankIC=0.0329
2026-01-11 19:30:05.885 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T7: RankIC=0.0279
2026-01-11 19:30:07.925 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T7: RankIC=0.0398
2026-01-11 19:30:09.777 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T7: RankIC=0.0408
2026-01-11 19:30:11.737 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T7: RankIC=0.0502
2026-01-11 19:30:14.007 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T7: RankIC=0.0388
2026-01-11 19:30:14.349 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0168, ICIR=0.1172, RankIC=0.0458
[1091829:MainThread](2026-01-11 19:30:14,354) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:30:52,078) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:30:52,079) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:30:59,354) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a186be50>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   2%|▏         | 4/242 [00:00<00:06, 34.69it/s]backtest loop:   7%|▋         | 16/242 [00:00<00:02, 80.09it/s]backtest loop:  12%|█▏        | 28/242 [00:00<00:02, 95.63it/s]backtest loop:  16%|█▌        | 39/242 [00:00<00:02, 97.30it/s]backtest loop:  21%|██        | 51/242 [00:00<00:01, 103.87it/s]backtest loop:  26%|██▌       | 62/242 [00:00<00:01, 102.18it/s]backtest loop:  30%|███       | 73/242 [00:00<00:01, 96.94it/s] backtest loop:  34%|███▍      | 83/242 [00:00<00:01, 96.85it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 86.03it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 88.80it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 87.63it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 90.35it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 92.84it/s]backtest loop:  60%|█████▉    | 144/242 [00:01<00:01, 96.62it/s]backtest loop:  64%|██████▍   | 155/242 [00:01<00:00, 98.66it/s]backtest loop:  69%|██████▉   | 167/242 [00:01<00:00, 102.92it/s]backtest loop:  74%|███████▎  | 178/242 [00:01<00:00, 100.78it/s]backtest loop:  78%|███████▊  | 189/242 [00:01<00:00, 102.53it/s]backtest loop:  83%|████████▎ | 200/242 [00:02<00:00, 104.19it/s]backtest loop:  87%|████████▋ | 211/242 [00:02<00:00, 105.06it/s]backtest loop:  92%|█████████▏| 222/242 [00:02<00:00, 101.60it/s]backtest loop:  96%|█████████▋| 233/242 [00:02<00:00, 103.18it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 96.93it/s] 
2026-01-11 19:31:01.865 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0750, Sharpe(w/cost)=1.1239
2026-01-11 19:31:01.901 | INFO     | __main__:train_single_fold:553 - 
============================================================
2026-01-11 19:31:01.901 | INFO     | __main__:train_single_fold:554 - Fold 8: train [2018-01-01, 2021-12-31], valid [2022-01-01, 2023-12-31], test [2024-01-01, 2024-12-31]
2026-01-11 19:31:01.901 | INFO     | __main__:train_single_fold:556 - ============================================================
2026-01-11 19:31:01.901 | INFO     | __main__:_create_dataset:231 - Initializing Alpha360...
[1091829:MainThread](2026-01-11 19:32:29,297) INFO - qlib.timer - [log.py:127] - Time cost: 87.394s | Loading data Done
[1091829:MainThread](2026-01-11 19:32:31,592) INFO - qlib.timer - [log.py:127] - Time cost: 1.798s | ZScoreNorm Done
[1091829:MainThread](2026-01-11 19:32:32,569) INFO - qlib.timer - [log.py:127] - Time cost: 0.977s | Fillna Done
[1091829:MainThread](2026-01-11 19:32:34,017) INFO - qlib.timer - [log.py:127] - Time cost: 0.300s | DropnaLabel Done
[1091829:MainThread](2026-01-11 19:32:34,200) INFO - qlib.timer - [log.py:127] - Time cost: 0.183s | CSRankNorm Done
[1091829:MainThread](2026-01-11 19:32:34,203) INFO - qlib.timer - [log.py:127] - Time cost: 4.905s | fit & process data Done
[1091829:MainThread](2026-01-11 19:32:34,204) INFO - qlib.timer - [log.py:127] - Time cost: 92.301s | Init data Done
2026-01-11 19:32:34.204 | INFO     | __main__:_create_dataset:237 - Label Config: (['Ref($close, -2)/Ref($close, -1) - 1'], ['LABEL0'])
[1091829:MainThread](2026-01-11 19:32:34,205) INFO - qlib.GRU - [pytorch_gru.py:59] - GRU pytorch version...
[1091829:MainThread](2026-01-11 19:32:34,205) INFO - qlib.GRU - [pytorch_gru.py:76] - GRU parameters setting:
d_feat : 6
hidden_size : 64
num_layers : 2
dropout : 0.0
n_epochs : 200
lr : 0.001
metric : loss
batch_size : 800
early_stop : 20
optimizer : adam
loss_type : mse
visible_GPU : 0
use_GPU : True
seed : None
[1091829:MainThread](2026-01-11 19:32:34,207) INFO - qlib.GRU - [pytorch_gru.py:119] - model:
GRUModel(
  (rnn): GRU(6, 64, num_layers=2, batch_first=True)
  (fc_out): Linear(in_features=64, out_features=1, bias=True)
)
[1091829:MainThread](2026-01-11 19:32:34,207) INFO - qlib.GRU - [pytorch_gru.py:120] - model size: 0.0370 MB
2026-01-11 19:32:34.211 | INFO     | __main__:train_single_fold:569 - Training gru_360_zscore model (GPU=0)...
[1091829:MainThread](2026-01-11 19:32:35,212) INFO - qlib.GRU - [pytorch_gru.py:250] - training...
[1091829:MainThread](2026-01-11 19:32:35,214) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch0:
[1091829:MainThread](2026-01-11 19:32:35,214) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:32:37,986) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:32:39,321) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.994422, valid -0.994882
[1091829:MainThread](2026-01-11 19:32:39,323) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch1:
[1091829:MainThread](2026-01-11 19:32:39,323) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:32:41,876) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:32:43,176) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.994335, valid -0.995287
[1091829:MainThread](2026-01-11 19:32:43,177) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch2:
[1091829:MainThread](2026-01-11 19:32:43,177) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:32:45,762) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:32:47,122) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.993085, valid -0.994964
[1091829:MainThread](2026-01-11 19:32:47,122) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch3:
[1091829:MainThread](2026-01-11 19:32:47,122) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:32:50,358) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:32:51,769) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.993073, valid -0.995352
[1091829:MainThread](2026-01-11 19:32:51,770) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch4:
[1091829:MainThread](2026-01-11 19:32:51,771) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:32:54,364) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:32:55,735) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.993276, valid -0.996308
[1091829:MainThread](2026-01-11 19:32:55,736) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch5:
[1091829:MainThread](2026-01-11 19:32:55,736) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:32:58,333) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:32:59,664) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.992681, valid -0.995071
[1091829:MainThread](2026-01-11 19:32:59,664) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch6:
[1091829:MainThread](2026-01-11 19:32:59,665) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:02,373) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:03,782) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.992366, valid -0.995674
[1091829:MainThread](2026-01-11 19:33:03,783) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch7:
[1091829:MainThread](2026-01-11 19:33:03,783) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:06,353) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:07,724) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991374, valid -0.994676
[1091829:MainThread](2026-01-11 19:33:07,726) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch8:
[1091829:MainThread](2026-01-11 19:33:07,726) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:10,419) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:11,697) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991016, valid -0.994878
[1091829:MainThread](2026-01-11 19:33:11,697) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch9:
[1091829:MainThread](2026-01-11 19:33:11,698) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:14,185) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:15,461) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.991127, valid -0.997014
[1091829:MainThread](2026-01-11 19:33:15,462) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch10:
[1091829:MainThread](2026-01-11 19:33:15,462) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:17,989) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:19,407) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.989804, valid -0.996161
[1091829:MainThread](2026-01-11 19:33:19,408) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch11:
[1091829:MainThread](2026-01-11 19:33:19,408) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:22,471) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:23,815) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.989441, valid -0.996976
[1091829:MainThread](2026-01-11 19:33:23,815) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch12:
[1091829:MainThread](2026-01-11 19:33:23,816) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:26,468) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:27,821) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.988347, valid -0.996442
[1091829:MainThread](2026-01-11 19:33:27,822) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch13:
[1091829:MainThread](2026-01-11 19:33:27,822) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:30,192) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:31,654) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.988156, valid -0.998367
[1091829:MainThread](2026-01-11 19:33:31,655) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch14:
[1091829:MainThread](2026-01-11 19:33:31,655) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:34,199) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:35,516) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.986460, valid -0.996614
[1091829:MainThread](2026-01-11 19:33:35,517) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch15:
[1091829:MainThread](2026-01-11 19:33:35,517) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:38,423) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:40,012) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.984859, valid -0.996462
[1091829:MainThread](2026-01-11 19:33:40,013) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch16:
[1091829:MainThread](2026-01-11 19:33:40,013) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:42,842) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:44,572) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.985212, valid -1.000030
[1091829:MainThread](2026-01-11 19:33:44,573) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch17:
[1091829:MainThread](2026-01-11 19:33:44,574) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:47,560) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:48,889) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.982853, valid -0.999105
[1091829:MainThread](2026-01-11 19:33:48,889) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch18:
[1091829:MainThread](2026-01-11 19:33:48,890) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:51,633) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:52,936) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.981454, valid -0.998639
[1091829:MainThread](2026-01-11 19:33:52,937) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch19:
[1091829:MainThread](2026-01-11 19:33:52,937) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:55,565) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:33:56,977) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.979578, valid -1.000632
[1091829:MainThread](2026-01-11 19:33:56,978) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch20:
[1091829:MainThread](2026-01-11 19:33:56,978) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:33:59,689) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:01,017) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.978601, valid -0.999635
[1091829:MainThread](2026-01-11 19:34:01,018) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch21:
[1091829:MainThread](2026-01-11 19:34:01,018) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:03,640) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:05,092) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.976183, valid -1.001828
[1091829:MainThread](2026-01-11 19:34:05,092) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch22:
[1091829:MainThread](2026-01-11 19:34:05,093) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:07,654) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:08,982) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.974164, valid -1.002446
[1091829:MainThread](2026-01-11 19:34:08,982) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch23:
[1091829:MainThread](2026-01-11 19:34:08,983) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:11,683) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:12,973) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.972106, valid -1.003436
[1091829:MainThread](2026-01-11 19:34:12,974) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch24:
[1091829:MainThread](2026-01-11 19:34:12,974) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:15,465) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:16,844) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.970068, valid -1.004847
[1091829:MainThread](2026-01-11 19:34:16,845) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch25:
[1091829:MainThread](2026-01-11 19:34:16,845) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:19,712) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:21,003) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.967638, valid -1.006134
[1091829:MainThread](2026-01-11 19:34:21,004) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch26:
[1091829:MainThread](2026-01-11 19:34:21,004) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:23,449) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:24,902) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.964609, valid -1.006588
[1091829:MainThread](2026-01-11 19:34:24,903) INFO - qlib.GRU - [pytorch_gru.py:255] - Epoch27:
[1091829:MainThread](2026-01-11 19:34:24,903) INFO - qlib.GRU - [pytorch_gru.py:256] - training...
[1091829:MainThread](2026-01-11 19:34:27,720) INFO - qlib.GRU - [pytorch_gru.py:258] - evaluating...
[1091829:MainThread](2026-01-11 19:34:29,089) INFO - qlib.GRU - [pytorch_gru.py:265] - train -0.962451, valid -1.007188
[1091829:MainThread](2026-01-11 19:34:29,090) INFO - qlib.GRU - [pytorch_gru.py:276] - early stop
[1091829:MainThread](2026-01-11 19:34:29,090) INFO - qlib.GRU - [pytorch_gru.py:279] - best score: -0.994676 @ 7
[1091829:MainThread](2026-01-11 19:34:29,097) WARNING - qlib.workflow - [exp.py:308] - Please make sure the recorder name mlflow_recorder is unique, we will only return the latest recorder if there exist several matched the given name.
2026-01-11 19:34:29.323 | INFO     | __main__:train_single_fold:573 - Generating predictions...
2026-01-11 19:34:31.804 | INFO     | __main__:train_single_fold:592 - Fold 8 Current Model Metrics:
2026-01-11 19:34:31.804 | INFO     | __main__:train_single_fold:593 -   IC=0.0277, ICIR=0.1511, RankIC=0.0477, RankICIR=0.2459
2026-01-11 19:34:31.804 | INFO     | __main__:train_single_fold:602 - Running backtest for current model...
[1091829:MainThread](2026-01-11 19:34:31,810) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:35:13,508) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:35:13,509) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:35:22,199) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a4c0e990>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:11, 20.48it/s]backtest loop:   5%|▌         | 13/242 [00:00<00:03, 58.25it/s]backtest loop:  10%|▉         | 23/242 [00:00<00:02, 74.06it/s]backtest loop:  14%|█▎        | 33/242 [00:00<00:02, 78.32it/s]backtest loop:  18%|█▊        | 43/242 [00:00<00:02, 84.44it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 88.31it/s]backtest loop:  26%|██▌       | 63/242 [00:00<00:01, 90.84it/s]backtest loop:  30%|███       | 73/242 [00:00<00:01, 92.13it/s]backtest loop:  34%|███▍      | 83/242 [00:01<00:01, 89.44it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 90.80it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 92.65it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 92.87it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 88.33it/s]backtest loop:  55%|█████▍    | 132/242 [00:01<00:01, 86.41it/s]backtest loop:  59%|█████▊    | 142/242 [00:01<00:01, 89.32it/s]backtest loop:  63%|██████▎   | 152/242 [00:01<00:00, 91.43it/s]backtest loop:  67%|██████▋   | 162/242 [00:01<00:00, 89.99it/s]backtest loop:  71%|███████   | 172/242 [00:01<00:00, 91.22it/s]backtest loop:  75%|███████▌  | 182/242 [00:02<00:00, 89.61it/s]backtest loop:  79%|███████▉  | 192/242 [00:02<00:00, 91.91it/s]backtest loop:  83%|████████▎ | 202/242 [00:02<00:00, 93.52it/s]backtest loop:  88%|████████▊ | 212/242 [00:02<00:00, 94.94it/s]backtest loop:  92%|█████████▏| 223/242 [00:02<00:00, 97.45it/s]backtest loop:  97%|█████████▋| 234/242 [00:02<00:00, 100.32it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 88.75it/s] 
2026-01-11 19:35:24.942 | INFO     | __main__:train_single_fold:606 - Current Model Backtest: Ann.Return(w/cost)=0.0515, Sharpe(w/cost)=0.5117, MaxDD=-0.1340
2026-01-11 19:35:28.708 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/fold_8_backtest_report.pdf
2026-01-11 19:35:49.329 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:35:49.402 | INFO     | __main__:_save_predictions_parquet:491 - Saved predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/fold_8_pred.parquet
2026-01-11 19:35:49.416 | INFO     | __main__:train_single_fold:637 - 
--- Ensemble with 8 historical models ---
2026-01-11 19:35:49.417 | INFO     | __main__:_generate_historical_predictions:412 - 
--- Evaluating 8 historical models on fold 8 test data ---
2026-01-11 19:35:53.130 | INFO     | __main__:_generate_historical_predictions:431 -   Model M0 on T8: RankIC=0.0179
2026-01-11 19:35:56.641 | INFO     | __main__:_generate_historical_predictions:431 -   Model M1 on T8: RankIC=0.0381
2026-01-11 19:35:59.416 | INFO     | __main__:_generate_historical_predictions:431 -   Model M2 on T8: RankIC=0.0324
2026-01-11 19:36:02.374 | INFO     | __main__:_generate_historical_predictions:431 -   Model M3 on T8: RankIC=0.0475
2026-01-11 19:36:05.986 | INFO     | __main__:_generate_historical_predictions:431 -   Model M4 on T8: RankIC=0.0428
2026-01-11 19:36:09.139 | INFO     | __main__:_generate_historical_predictions:431 -   Model M5 on T8: RankIC=0.0463
2026-01-11 19:36:11.207 | INFO     | __main__:_generate_historical_predictions:431 -   Model M6 on T8: RankIC=0.0431
2026-01-11 19:36:13.674 | INFO     | __main__:_generate_historical_predictions:431 -   Model M7 on T8: RankIC=0.0470
2026-01-11 19:36:14.083 | INFO     | __main__:train_single_fold:647 - Ensemble Metrics: IC=0.0299, ICIR=0.1671, RankIC=0.0515
[1091829:MainThread](2026-01-11 19:36:14,090) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange
[1091829:MainThread](2026-01-11 19:36:57,147) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:36:57,149) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:37:05,693) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f10a1e21d50>
backtest loop:   0%|          | 0/242 [00:00<?, ?it/s]backtest loop:   1%|          | 3/242 [00:00<00:09, 26.06it/s]backtest loop:   5%|▍         | 12/242 [00:00<00:03, 61.07it/s]backtest loop:  10%|▉         | 23/242 [00:00<00:02, 80.99it/s]backtest loop:  14%|█▎        | 33/242 [00:00<00:02, 83.86it/s]backtest loop:  18%|█▊        | 43/242 [00:00<00:02, 87.45it/s]backtest loop:  22%|██▏       | 53/242 [00:00<00:02, 90.28it/s]backtest loop:  26%|██▌       | 63/242 [00:00<00:01, 91.76it/s]backtest loop:  30%|███       | 73/242 [00:00<00:01, 92.74it/s]backtest loop:  34%|███▍      | 83/242 [00:00<00:01, 88.98it/s]backtest loop:  38%|███▊      | 93/242 [00:01<00:01, 90.86it/s]backtest loop:  43%|████▎     | 103/242 [00:01<00:01, 91.78it/s]backtest loop:  47%|████▋     | 113/242 [00:01<00:01, 93.15it/s]backtest loop:  51%|█████     | 123/242 [00:01<00:01, 93.44it/s]backtest loop:  55%|█████▍    | 133/242 [00:01<00:01, 94.17it/s]backtest loop:  59%|█████▉    | 143/242 [00:01<00:01, 94.48it/s]backtest loop:  63%|██████▎   | 153/242 [00:01<00:00, 95.00it/s]backtest loop:  67%|██████▋   | 163/242 [00:01<00:00, 95.10it/s]backtest loop:  71%|███████▏  | 173/242 [00:01<00:00, 95.17it/s]backtest loop:  76%|███████▌  | 183/242 [00:02<00:00, 92.31it/s]backtest loop:  80%|███████▉  | 193/242 [00:02<00:00, 91.66it/s]backtest loop:  84%|████████▍ | 203/242 [00:02<00:00, 92.63it/s]backtest loop:  88%|████████▊ | 213/242 [00:02<00:00, 93.72it/s]backtest loop:  93%|█████████▎| 224/242 [00:02<00:00, 96.68it/s]backtest loop:  97%|█████████▋| 235/242 [00:02<00:00, 94.98it/s]backtest loop: 100%|██████████| 242/242 [00:02<00:00, 90.75it/s]
2026-01-11 19:37:08.379 | INFO     | __main__:train_single_fold:654 - Ensemble Backtest: Ann.Return(w/cost)=0.0335, Sharpe(w/cost)=0.3306
2026-01-11 19:37:08.422 | INFO     | __main__:_print_summary:799 - 
================================================================================
2026-01-11 19:37:08.422 | INFO     | __main__:_print_summary:800 - ROLLING TRAINING SUMMARY
2026-01-11 19:37:08.423 | INFO     | __main__:_print_summary:801 - ================================================================================
2026-01-11 19:37:08.428 | INFO     | __main__:_print_summary:826 - 
Average Metrics:
2026-01-11 19:37:08.428 | INFO     | __main__:_print_summary:827 -   IC: 0.0392
2026-01-11 19:37:08.428 | INFO     | __main__:_print_summary:828 -   ICIR: 0.3294
2026-01-11 19:37:08.428 | INFO     | __main__:_print_summary:829 -   RankIC: 0.0565
2026-01-11 19:37:08.429 | INFO     | __main__:_print_summary:830 -   Ann.Return: 0.0694
2026-01-11 19:37:08.429 | INFO     | __main__:_print_summary:831 -   Sharpe: 0.9193
2026-01-11 19:37:08.429 | INFO     | __main__:_print_summary:836 -   Ensemble RankIC (avg): 0.0544
2026-01-11 19:37:08.432 | INFO     | __main__:_print_summary:840 - 
Summary saved to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/summary.csv
2026-01-11 19:37:08.432 | INFO     | __main__:_print_ensemble_matrix:740 - 
================================================================================
2026-01-11 19:37:08.432 | INFO     | __main__:_print_ensemble_matrix:741 - ENSEMBLE ANALYSIS MATRIX (RankIC)
2026-01-11 19:37:08.432 | INFO     | __main__:_print_ensemble_matrix:742 - Rows: Test Fold, Columns: Model trained on Fold
2026-01-11 19:37:08.432 | INFO     | __main__:_print_ensemble_matrix:743 - ================================================================================
2026-01-11 19:37:08.435 | INFO     | __main__:_print_ensemble_matrix:766 - 
Analysis:
2026-01-11 19:37:08.435 | INFO     | __main__:_print_ensemble_matrix:770 -   Diagonal Mean (self-test): 0.0565
2026-01-11 19:37:08.435 | INFO     | __main__:_print_ensemble_matrix:780 -   Off-diagonal Mean (historical on future): 0.0412
2026-01-11 19:37:08.435 | INFO     | __main__:_print_ensemble_matrix:787 -   Historical models still have predictive power (avg RankIC=0.0412)
2026-01-11 19:37:08.435 | INFO     | __main__:_print_ensemble_matrix:788 -   Ensemble is likely beneficial!
2026-01-11 19:37:08.436 | INFO     | __main__:_print_ensemble_matrix:795 - 
Ensemble matrix saved to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/ensemble_matrix.csv
2026-01-11 19:37:08.436 | INFO     | __main__:_run_full_backtest:678 - 
================================================================================
2026-01-11 19:37:08.436 | INFO     | __main__:_run_full_backtest:679 - FULL BACKTEST (All Folds Combined)
2026-01-11 19:37:08.436 | INFO     | __main__:_run_full_backtest:680 - ================================================================================
2026-01-11 19:37:08.559 | INFO     | __main__:_run_full_backtest:705 - Full backtest period: 2016-01-01 to 2024-12-31
2026-01-11 19:37:08.559 | INFO     | __main__:_run_full_backtest:706 - Total predictions: 1093245
2026-01-11 19:37:10.255 | INFO     | __main__:_run_full_backtest:710 - Full Period Metrics: IC=0.0393, ICIR=0.2910, RankIC=0.0565
[1091829:MainThread](2026-01-11 19:37:10,266) INFO - qlib.backtest caller - [__init__.py:93] - Create new exchange

 Fold             Test Period       IC     ICIR   RankIC   Ann.Ret    Sharpe     MaxDD  Ens.RankIC  Ens.Sharpe
    0 2016-01-01 ~ 2016-12-31 0.080361 0.706384 0.102555  0.333420  3.376609 -0.032601         NaN         NaN
    1 2017-01-01 ~ 2017-12-31 0.075489 0.629050 0.088906  0.211759  4.038256 -0.019405    0.092052    4.219408
    2 2018-01-01 ~ 2018-12-31 0.063223 0.658433 0.051976 -0.001627 -0.023629 -0.092414    0.058697    0.325677
    3 2019-01-01 ~ 2019-12-31 0.019546 0.168120 0.035702 -0.131224 -1.995291 -0.155727    0.044347   -1.724584
    4 2020-01-01 ~ 2020-12-31 0.026711 0.210883 0.046270  0.005379  0.063232 -0.105884    0.048686    1.368502
    5 2021-01-01 ~ 2021-12-31 0.016773 0.111310 0.038604 -0.035961 -0.292627 -0.177615    0.041087   -0.136810
    6 2022-01-01 ~ 2022-12-31 0.028863 0.229786 0.051516  0.159063  2.117316 -0.047115    0.053045    1.830249
    7 2023-01-01 ~ 2023-12-31 0.014404 0.099483 0.044973  0.032524  0.477883 -0.061570    0.045780    1.123861
    8 2024-01-01 ~ 2024-12-31 0.027706 0.151051 0.047662  0.051460  0.511746 -0.134041    0.051500    0.330610

        M0      M1      M2      M3      M4      M5      M6     M7      M8
T0  0.1026     NaN     NaN     NaN     NaN     NaN     NaN    NaN     NaN
T1  0.0816  0.0889     NaN     NaN     NaN     NaN     NaN    NaN     NaN
T2  0.0607  0.0496  0.0520     NaN     NaN     NaN     NaN    NaN     NaN
T3  0.0432  0.0481  0.0514  0.0357     NaN     NaN     NaN    NaN     NaN
T4  0.0391  0.0473  0.0461  0.0439  0.0463     NaN     NaN    NaN     NaN
T5  0.0261  0.0301  0.0265  0.0351  0.0362  0.0386     NaN    NaN     NaN
T6  0.0414  0.0400  0.0376  0.0435  0.0465  0.0434  0.0515    NaN     NaN
T7  0.0213  0.0329  0.0279  0.0398  0.0408  0.0502  0.0388  0.045     NaN
T8  0.0179  0.0381  0.0324  0.0475  0.0428  0.0463  0.0431  0.047  0.0477
[1091829:MainThread](2026-01-11 19:37:50,132) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:37:50,134) WARNING - qlib.online operator - [exchange.py:219] - $close field data contains nan.
[1091829:MainThread](2026-01-11 19:38:32,814) WARNING - qlib.BaseExecutor - [executor.py:121] - `common_infra` is not set for <qlib.backtest.executor.SimulatorExecutor object at 0x7f12b33efd90>
backtest loop:   0%|          | 0/2187 [00:00<?, ?it/s]backtest loop:   0%|          | 4/2187 [00:00<00:56, 38.65it/s]backtest loop:   1%|          | 14/2187 [00:00<00:29, 72.92it/s]backtest loop:   1%|          | 24/2187 [00:00<00:25, 84.67it/s]backtest loop:   2%|▏         | 33/2187 [00:00<00:24, 86.50it/s]backtest loop:   2%|▏         | 44/2187 [00:00<00:22, 94.06it/s]backtest loop:   2%|▏         | 54/2187 [00:00<00:22, 96.00it/s]backtest loop:   3%|▎         | 64/2187 [00:00<00:23, 89.02it/s]backtest loop:   3%|▎         | 75/2187 [00:00<00:22, 93.75it/s]backtest loop:   4%|▍         | 86/2187 [00:00<00:21, 97.05it/s]backtest loop:   4%|▍         | 97/2187 [00:01<00:20, 100.50it/s]backtest loop:   5%|▍         | 108/2187 [00:01<00:20, 101.13it/s]backtest loop:   5%|▌         | 120/2187 [00:01<00:19, 104.95it/s]backtest loop:   6%|▌         | 131/2187 [00:01<00:19, 103.51it/s]backtest loop:   7%|▋         | 143/2187 [00:01<00:18, 107.59it/s]backtest loop:   7%|▋         | 155/2187 [00:01<00:18, 110.31it/s]backtest loop:   8%|▊         | 167/2187 [00:01<00:18, 109.39it/s]backtest loop:   8%|▊         | 179/2187 [00:01<00:18, 108.91it/s]backtest loop:   9%|▊         | 191/2187 [00:01<00:17, 111.32it/s]backtest loop:   9%|▉         | 204/2187 [00:02<00:17, 114.00it/s]backtest loop:  10%|█         | 219/2187 [00:02<00:16, 119.34it/s]backtest loop:  11%|█         | 233/2187 [00:02<00:15, 124.99it/s]backtest loop:  11%|█         | 246/2187 [00:02<00:15, 121.72it/s]backtest loop:  12%|█▏        | 259/2187 [00:02<00:16, 117.64it/s]backtest loop:  12%|█▏        | 271/2187 [00:02<00:16, 116.78it/s]backtest loop:  13%|█▎        | 283/2187 [00:02<00:16, 116.34it/s]backtest loop:  14%|█▎        | 298/2187 [00:02<00:15, 119.67it/s]backtest loop:  14%|█▍        | 311/2187 [00:02<00:16, 116.70it/s]backtest loop:  15%|█▍        | 323/2187 [00:03<00:15, 117.39it/s]backtest loop:  15%|█▌        | 335/2187 [00:03<00:16, 114.65it/s]backtest loop:  16%|█▌        | 348/2187 [00:03<00:16, 114.39it/s]backtest loop:  16%|█▋        | 360/2187 [00:03<00:15, 115.39it/s]backtest loop:  17%|█▋        | 372/2187 [00:03<00:15, 115.37it/s]backtest loop:  18%|█▊        | 384/2187 [00:03<00:16, 110.50it/s]backtest loop:  18%|█▊        | 396/2187 [00:03<00:16, 111.03it/s]backtest loop:  19%|█▊        | 408/2187 [00:03<00:16, 108.05it/s]backtest loop:  19%|█▉        | 421/2187 [00:03<00:15, 113.68it/s]backtest loop:  20%|█▉        | 433/2187 [00:03<00:15, 113.38it/s]backtest loop:  20%|██        | 446/2187 [00:04<00:14, 117.63it/s]backtest loop:  21%|██        | 458/2187 [00:04<00:15, 114.38it/s]backtest loop:  22%|██▏       | 471/2187 [00:04<00:14, 117.53it/s]backtest loop:  22%|██▏       | 483/2187 [00:04<00:14, 113.70it/s]backtest loop:  23%|██▎       | 496/2187 [00:04<00:14, 116.62it/s]backtest loop:  23%|██▎       | 508/2187 [00:04<00:14, 112.55it/s]backtest loop:  24%|██▍       | 520/2187 [00:04<00:15, 108.01it/s]backtest loop:  24%|██▍       | 531/2187 [00:04<00:15, 107.51it/s]backtest loop:  25%|██▍       | 542/2187 [00:04<00:15, 103.52it/s]backtest loop:  25%|██▌       | 553/2187 [00:05<00:15, 103.46it/s]backtest loop:  26%|██▌       | 565/2187 [00:05<00:15, 102.57it/s]backtest loop:  26%|██▋       | 576/2187 [00:05<00:15, 103.74it/s]backtest loop:  27%|██▋       | 587/2187 [00:05<00:15, 105.36it/s]backtest loop:  27%|██▋       | 598/2187 [00:05<00:15, 103.02it/s]backtest loop:  28%|██▊       | 610/2187 [00:05<00:14, 106.33it/s]backtest loop:  28%|██▊       | 622/2187 [00:05<00:14, 105.44it/s]backtest loop:  29%|██▉       | 635/2187 [00:05<00:14, 110.68it/s]backtest loop:  30%|██▉       | 647/2187 [00:05<00:14, 108.82it/s]backtest loop:  30%|███       | 660/2187 [00:06<00:13, 113.56it/s]backtest loop:  31%|███       | 672/2187 [00:06<00:13, 109.61it/s]backtest loop:  31%|███▏      | 684/2187 [00:06<00:13, 112.14it/s]backtest loop:  32%|███▏      | 696/2187 [00:06<00:13, 106.72it/s]backtest loop:  32%|███▏      | 707/2187 [00:06<00:13, 107.04it/s]backtest loop:  33%|███▎      | 718/2187 [00:06<00:13, 107.38it/s]backtest loop:  33%|███▎      | 729/2187 [00:06<00:13, 107.73it/s]backtest loop:  34%|███▍      | 740/2187 [00:06<00:13, 105.10it/s]backtest loop:  34%|███▍      | 752/2187 [00:06<00:13, 108.10it/s]backtest loop:  35%|███▍      | 764/2187 [00:07<00:13, 106.41it/s]backtest loop:  35%|███▌      | 776/2187 [00:07<00:12, 109.69it/s]backtest loop:  36%|███▌      | 788/2187 [00:07<00:12, 111.74it/s]backtest loop:  37%|███▋      | 800/2187 [00:07<00:12, 108.86it/s]backtest loop:  37%|███▋      | 811/2187 [00:07<00:13, 103.99it/s]backtest loop:  38%|███▊      | 822/2187 [00:07<00:13, 104.37it/s]backtest loop:  38%|███▊      | 833/2187 [00:07<00:12, 105.54it/s]backtest loop:  39%|███▊      | 844/2187 [00:07<00:13, 101.39it/s]backtest loop:  39%|███▉      | 855/2187 [00:07<00:12, 103.58it/s]backtest loop:  40%|███▉      | 866/2187 [00:08<00:12, 103.60it/s]backtest loop:  40%|████      | 877/2187 [00:08<00:12, 102.33it/s]backtest loop:  41%|████      | 888/2187 [00:08<00:12, 101.86it/s]backtest loop:  41%|████      | 899/2187 [00:08<00:13, 95.39it/s] backtest loop:  42%|████▏     | 909/2187 [00:08<00:13, 93.57it/s]backtest loop:  42%|████▏     | 919/2187 [00:08<00:14, 89.66it/s]backtest loop:  43%|████▎     | 930/2187 [00:08<00:13, 93.57it/s]backtest loop:  43%|████▎     | 940/2187 [00:08<00:13, 95.19it/s]backtest loop:  43%|████▎     | 951/2187 [00:08<00:12, 98.65it/s]backtest loop:  44%|████▍     | 962/2187 [00:09<00:12, 100.69it/s]backtest loop:  44%|████▍     | 973/2187 [00:09<00:12, 98.68it/s] backtest loop:  45%|████▍     | 983/2187 [00:09<00:12, 97.05it/s]backtest loop:  46%|████▌     | 996/2187 [00:09<00:11, 100.32it/s]backtest loop:  46%|████▌     | 1008/2187 [00:09<00:11, 104.18it/s]backtest loop:  47%|████▋     | 1019/2187 [00:09<00:11, 105.61it/s]backtest loop:  47%|████▋     | 1031/2187 [00:09<00:10, 105.10it/s]backtest loop:  48%|████▊     | 1043/2187 [00:09<00:10, 108.10it/s]backtest loop:  48%|████▊     | 1054/2187 [00:09<00:10, 105.59it/s]backtest loop:  49%|████▊     | 1066/2187 [00:10<00:10, 108.94it/s]backtest loop:  49%|████▉     | 1077/2187 [00:10<00:10, 106.33it/s]backtest loop:  50%|████▉     | 1089/2187 [00:10<00:10, 108.98it/s]backtest loop:  50%|█████     | 1100/2187 [00:10<00:10, 106.58it/s]backtest loop:  51%|█████     | 1112/2187 [00:10<00:09, 108.44it/s]backtest loop:  51%|█████▏    | 1123/2187 [00:10<00:09, 108.76it/s]backtest loop:  52%|█████▏    | 1135/2187 [00:10<00:09, 106.29it/s]backtest loop:  52%|█████▏    | 1147/2187 [00:10<00:09, 109.14it/s]backtest loop:  53%|█████▎    | 1158/2187 [00:10<00:10, 100.78it/s]backtest loop:  53%|█████▎    | 1169/2187 [00:11<00:10, 96.34it/s] backtest loop:  54%|█████▍    | 1180/2187 [00:11<00:10, 98.30it/s]backtest loop:  55%|█████▍    | 1192/2187 [00:11<00:09, 102.93it/s]backtest loop:  55%|█████▌    | 1204/2187 [00:11<00:09, 102.97it/s]backtest loop:  56%|█████▌    | 1216/2187 [00:11<00:09, 107.01it/s]backtest loop:  56%|█████▌    | 1227/2187 [00:11<00:08, 107.75it/s]backtest loop:  57%|█████▋    | 1238/2187 [00:11<00:09, 103.77it/s]backtest loop:  57%|█████▋    | 1249/2187 [00:11<00:09, 101.06it/s]backtest loop:  58%|█████▊    | 1261/2187 [00:11<00:08, 105.28it/s]backtest loop:  58%|█████▊    | 1273/2187 [00:11<00:08, 104.50it/s]backtest loop:  59%|█████▉    | 1285/2187 [00:12<00:08, 107.62it/s]backtest loop:  59%|█████▉    | 1297/2187 [00:12<00:08, 105.89it/s]backtest loop:  60%|█████▉    | 1309/2187 [00:12<00:08, 104.50it/s]backtest loop:  60%|██████    | 1320/2187 [00:12<00:08, 102.99it/s]backtest loop:  61%|██████    | 1331/2187 [00:12<00:08, 102.13it/s]backtest loop:  61%|██████▏   | 1342/2187 [00:12<00:08, 99.94it/s] backtest loop:  62%|██████▏   | 1353/2187 [00:12<00:08, 94.94it/s]backtest loop:  62%|██████▏   | 1363/2187 [00:12<00:08, 95.13it/s]backtest loop:  63%|██████▎   | 1373/2187 [00:13<00:08, 94.68it/s]backtest loop:  63%|██████▎   | 1383/2187 [00:13<00:08, 95.17it/s]backtest loop:  64%|██████▎   | 1393/2187 [00:13<00:08, 95.79it/s]backtest loop:  64%|██████▍   | 1403/2187 [00:13<00:08, 95.13it/s]backtest loop:  65%|██████▍   | 1415/2187 [00:13<00:07, 101.28it/s]backtest loop:  65%|██████▌   | 1426/2187 [00:13<00:07, 99.52it/s] backtest loop:  66%|██████▌   | 1438/2187 [00:13<00:07, 104.04it/s]backtest loop:  66%|██████▋   | 1450/2187 [00:13<00:06, 107.42it/s]backtest loop:  67%|██████▋   | 1461/2187 [00:13<00:07, 103.57it/s]backtest loop:  67%|██████▋   | 1473/2187 [00:13<00:06, 106.82it/s]backtest loop:  68%|██████▊   | 1484/2187 [00:14<00:06, 106.70it/s]backtest loop:  68%|██████▊   | 1495/2187 [00:14<00:06, 100.31it/s]backtest loop:  69%|██████▉   | 1506/2187 [00:14<00:06, 100.67it/s]backtest loop:  69%|██████▉   | 1517/2187 [00:14<00:06, 101.16it/s]backtest loop:  70%|██████▉   | 1528/2187 [00:14<00:06, 96.56it/s] backtest loop:  70%|███████   | 1538/2187 [00:14<00:06, 96.95it/s]backtest loop:  71%|███████   | 1548/2187 [00:14<00:06, 96.13it/s]backtest loop:  71%|███████   | 1558/2187 [00:14<00:06, 96.31it/s]backtest loop:  72%|███████▏  | 1568/2187 [00:14<00:06, 96.62it/s]backtest loop:  72%|███████▏  | 1578/2187 [00:15<00:06, 96.97it/s]backtest loop:  73%|███████▎  | 1588/2187 [00:15<00:06, 96.94it/s]backtest loop:  73%|███████▎  | 1598/2187 [00:15<00:06, 97.34it/s]backtest loop:  74%|███████▎  | 1609/2187 [00:15<00:06, 95.01it/s]backtest loop:  74%|███████▍  | 1620/2187 [00:15<00:05, 97.75it/s]backtest loop:  75%|███████▍  | 1630/2187 [00:15<00:05, 94.60it/s]backtest loop:  75%|███████▍  | 1640/2187 [00:15<00:06, 87.78it/s]backtest loop:  75%|███████▌  | 1649/2187 [00:15<00:06, 84.25it/s]backtest loop:  76%|███████▌  | 1658/2187 [00:15<00:06, 79.48it/s]backtest loop:  76%|███████▌  | 1667/2187 [00:16<00:06, 79.64it/s]backtest loop:  77%|███████▋  | 1676/2187 [00:16<00:06, 75.53it/s]backtest loop:  77%|███████▋  | 1684/2187 [00:16<00:06, 72.63it/s]backtest loop:  77%|███████▋  | 1693/2187 [00:16<00:06, 73.60it/s]backtest loop:  78%|███████▊  | 1703/2187 [00:16<00:06, 79.61it/s]backtest loop:  78%|███████▊  | 1713/2187 [00:16<00:05, 84.19it/s]backtest loop:  79%|███████▉  | 1724/2187 [00:16<00:05, 89.90it/s]backtest loop:  79%|███████▉  | 1736/2187 [00:16<00:04, 97.33it/s]backtest loop:  80%|███████▉  | 1747/2187 [00:17<00:04, 97.21it/s]backtest loop:  80%|████████  | 1757/2187 [00:17<00:04, 97.10it/s]backtest loop:  81%|████████  | 1767/2187 [00:17<00:04, 93.01it/s]backtest loop:  81%|████████▏ | 1777/2187 [00:17<00:04, 94.09it/s]backtest loop:  82%|████████▏ | 1787/2187 [00:17<00:04, 94.92it/s]backtest loop:  82%|████████▏ | 1797/2187 [00:17<00:04, 91.25it/s]backtest loop:  83%|████████▎ | 1807/2187 [00:17<00:04, 91.49it/s]backtest loop:  83%|████████▎ | 1817/2187 [00:17<00:04, 89.14it/s]backtest loop:  84%|████████▎ | 1827/2187 [00:17<00:03, 90.51it/s]backtest loop:  84%|████████▍ | 1838/2187 [00:17<00:03, 95.85it/s]backtest loop:  85%|████████▍ | 1850/2187 [00:18<00:03, 101.46it/s]backtest loop:  85%|████████▌ | 1861/2187 [00:18<00:03, 100.70it/s]backtest loop:  86%|████████▌ | 1873/2187 [00:18<00:02, 105.02it/s]backtest loop:  86%|████████▌ | 1885/2187 [00:18<00:02, 103.94it/s]backtest loop:  87%|████████▋ | 1897/2187 [00:18<00:02, 107.03it/s]backtest loop:  87%|████████▋ | 1909/2187 [00:18<00:02, 108.88it/s]backtest loop:  88%|████████▊ | 1920/2187 [00:18<00:02, 105.48it/s]backtest loop:  88%|████████▊ | 1932/2187 [00:18<00:02, 108.31it/s]backtest loop:  89%|████████▉ | 1944/2187 [00:18<00:02, 110.42it/s]backtest loop:  89%|████████▉ | 1956/2187 [00:19<00:02, 107.69it/s]backtest loop:  90%|████████▉ | 1968/2187 [00:19<00:01, 110.13it/s]backtest loop:  91%|█████████ | 1980/2187 [00:19<00:01, 107.70it/s]backtest loop:  91%|█████████ | 1992/2187 [00:19<00:01, 110.39it/s]backtest loop:  92%|█████████▏| 2004/2187 [00:19<00:01, 106.90it/s]backtest loop:  92%|█████████▏| 2015/2187 [00:19<00:01, 107.55it/s]backtest loop:  93%|█████████▎| 2026/2187 [00:19<00:01, 104.37it/s]backtest loop:  93%|█████████▎| 2038/2187 [00:19<00:01, 103.73it/s]backtest loop:  94%|█████████▎| 2050/2187 [00:19<00:01, 107.32it/s]backtest loop:  94%|█████████▍| 2062/2187 [00:20<00:01, 105.54it/s]backtest loop:  95%|█████████▍| 2074/2187 [00:20<00:01, 108.80it/s]backtest loop:  95%|█████████▌| 2086/2187 [00:20<00:00, 111.02it/s]backtest loop:  96%|█████████▌| 2098/2187 [00:20<00:00, 108.29it/s]backtest loop:  96%|█████████▋| 2110/2187 [00:20<00:00, 110.43it/s]backtest loop:  97%|█████████▋| 2122/2187 [00:20<00:00, 106.81it/s]backtest loop:  98%|█████████▊| 2133/2187 [00:20<00:00, 105.07it/s]backtest loop:  98%|█████████▊| 2145/2187 [00:20<00:00, 104.18it/s]backtest loop:  99%|█████████▊| 2157/2187 [00:20<00:00, 107.56it/s]backtest loop:  99%|█████████▉| 2169/2187 [00:21<00:00, 109.78it/s]backtest loop: 100%|█████████▉| 2181/2187 [00:21<00:00, 100.30it/s]backtest loop: 100%|██████████| 2187/2187 [00:21<00:00, 102.83it/s]
2026-01-11 19:38:54.158 | INFO     | __main__:_run_full_backtest:717 - Full Backtest Results:
2026-01-11 19:38:54.158 | INFO     | __main__:_run_full_backtest:718 -   Ann.Return(w/cost): 0.0841
2026-01-11 19:38:54.158 | INFO     | __main__:_run_full_backtest:719 -   Sharpe(w/cost): 1.0136
2026-01-11 19:38:54.158 | INFO     | __main__:_run_full_backtest:720 -   MaxDD: -0.2984
2026-01-11 19:38:58.328 | INFO     | __main__:_generate_and_save_reports:518 - Saved backtest report to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pdf/full_backtest_report.pdf
2026-01-11 19:39:16.288 | INFO     | __main__:_generate_and_save_reports:538 - Saved 5 model performance graphs
2026-01-11 19:39:16.475 | INFO     | __main__:_run_full_backtest:734 - Saved full predictions to /home/ethan/qlib/custom_exp/run_20260111_185218_gru_360_zscore_6y/pred/full_pred.parquet
